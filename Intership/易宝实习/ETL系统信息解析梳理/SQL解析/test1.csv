taskId,sourceId,sql,dbname
zhangguitongym,zgtnetsilverkey,"select  COALESCE(CHAR(p.CUSTOMERNUMBER),'null')||COALESCE(CHAR(date(p.CALLBACK_DATE)),'null')||'zgtnetsilverkey'||coalesce(t.BANK_ID,'')||coalesce(p.CARD_TYPE,'') as IDNOUSE,t.BANK_ID as bank_code,p.CARD_TYPE as cardtype,p.CUSTOMERNUMBER as RECEIVERID,year(date(p.CALLBACK_DATE))*100+month(date(p.CALLBACK_DATE)) as month,date(p.CALLBACK_DATE) as trxdate,222 as biztypeid,'SALES' as ordertype,'Sales' as type,'YJZF-NET' as payproduct, '3011001003001' as PRODUCT_CODE,sum(p.amount)-sum(p.real_amount) as trxfee from zgt.tbl_payment p left join zgt.tbl_trxorder t on t.external_id = p.externalid left join zgt.tbl_customer_config c on c.customer_identity_no = (case when t.agent_no is null then t.customer_no else t.agent_no end) where 1 = 1 and t.status in ('SUCCESS','SETTLECONFIRM') and p.CALLBACK_DATE >= ${START} and p.CALLBACK_DATE < ${STOP} and c.belong  != 'YEEPAY_SKB'  and p.PAY_PRODUCT in ('ONEKEY_NORMAL','WAP_SM') group by p.CUSTOMERNUMBER,date(p.CALLBACK_DATE),t.BANK_ID,p.CARD_TYPE with ur",zgt_standby
zhangguitongym,zgtnet,"select  COALESCE(CHAR(p.CUSTOMERNUMBER),'null')||COALESCE(CHAR(date(p.CALLBACK_DATE)),'null')||'zgtnet'||coalesce(t.BANK_ID,'')||coalesce(p.CARD_TYPE,'') ||p.PAY_PRODUCT as IDNOUSE,t.BANK_ID as bank_code,p.CARD_TYPE as cardtype,p.CUSTOMERNUMBER as RECEIVERID,year(date(p.CALLBACK_DATE))*100+month(date(p.CALLBACK_DATE)) as month,date(p.CALLBACK_DATE) as trxdate,4 as biztypeid,'SALES' as ordertype,'Sales' as type,p.PAY_PRODUCT as payproduct,case when p.PAY_PRODUCT= 'NET_B2C' then '3011001002001' else '3011001002002' end as PRODUCT_CODE,sum(p.amount)-sum(p.real_amount) as trxfee from zgt.tbl_payment p left join zgt.tbl_trxorder t on t.external_id = p.externalid left join zgt.tbl_customer_config c on c.customer_identity_no = (case when t.agent_no is null then t.customer_no else t.agent_no end) where 1 = 1 and t.status in ('SUCCESS','SETTLECONFIRM') and p.CALLBACK_DATE >= ${START} and p.CALLBACK_DATE  < ${STOP} and c.belong  != 'YEEPAY_SKB' and  p.PAY_PRODUCT in  ('NET_B2B','NET_B2C') group by p.CUSTOMERNUMBER,date(p.CALLBACK_DATE),t.BANK_ID,p.CARD_TYPE,p.PAY_PRODUCT with ur",zgt_standby
zhangguitongym,zgtwap,"select  COALESCE(CHAR(p.CUSTOMERNUMBER),'null')||COALESCE(CHAR(date(p.CALLBACK_DATE)),'null')||'zgtwap'||coalesce(t.BANK_ID,'')||coalesce(p.CARD_TYPE,'') as IDNOUSE,t.BANK_ID as bank_code,p.CARD_TYPE as cardtype,p.CUSTOMERNUMBER as RECEIVERID,year(date(p.CALLBACK_DATE))*100+month(date(p.CALLBACK_DATE)) as month,date(p.CALLBACK_DATE) as trxdate,222 as biztypeid,'SALES' as ordertype,'Sales' as type,'YJZF-WAP' as payproduct,'3011001003001' as PRODUCT_CODE,sum(p.amount)-sum(p.real_amount) as trxfee,sum(p.amount) as trxamount, count(p.id) as trxcount, sum(p.BANK_COST) as accountingcost,sum(p.BANK_COST) as frpcost from zgt.tbl_payment p left join zgt.tbl_trxorder t on t.external_id = p.externalid left join zgt.tbl_customer_config c on c.customer_identity_no = (case when t.agent_no is null then t.customer_no else t.agent_no end) where 1 = 1 and t.status in ('SUCCESS','SETTLECONFIRM') and p.CALLBACK_DATE >= ${START} and p.CALLBACK_DATE  < ${STOP} and c.belong  != 'YEEPAY_SKB' and p.PAY_PRODUCT  in  ('WAP-ZHT') group by p.CUSTOMERNUMBER,date(p.CALLBACK_DATE),t.BANK_ID,p.CARD_TYPE with ur",zgt_standby
zhangguitongym,zgtdirect,"select  COALESCE(CHAR(p.CUSTOMERNUMBER),'null')||COALESCE(CHAR(date(p.CALLBACK_DATE)),'null')||'zgtdirect'||coalesce(t.BANK_ID,'')||coalesce(p.CARD_TYPE,'') as IDNOUSE,t.BANK_ID as bank_code,p.CARD_TYPE as cardtype,p.CUSTOMERNUMBER as RECEIVERID,year(date(p.CALLBACK_DATE))*100+month(date(p.CALLBACK_DATE)) as month,date(p.CALLBACK_DATE) as trxdate,222 as biztypeid,'SALES' as ordertype,'Sales' as type,'YJZF-NCPAY' as payproduct,'3011001003001' as PRODUCT_CODE,sum(p.amount)-sum(p.real_amount) as trxfee,sum(p.amount) as trxamount, count(p.id) as trxcount, sum(p.BANK_COST) as accountingcost,sum(p.BANK_COST) as frpcost from zgt.tbl_payment p left join zgt.tbl_trxorder t on t.external_id = p.externalid left join zgt.tbl_customer_config c on c.customer_identity_no = (case when t.agent_no is null then t.customer_no else t.agent_no end) where 1 = 1 and t.status in ('SUCCESS','SETTLECONFIRM') and p.CALLBACK_DATE >= ${START} and p.CALLBACK_DATE  < ${STOP} and c.belong  != 'YEEPAY_SKB' and p.PAY_PRODUCT in ('4G_PAY','4G_PAY_FIRST','4G_PAY_BIND') group by p.CUSTOMERNUMBER,date(p.CALLBACK_DATE),t.BANK_ID,p.CARD_TYPE with ur",zgt_standby
zhangguitongym,zgtaccountpayment,"select  COALESCE(CHAR(p.CUSTOMERNUMBER),'null')||COALESCE(CHAR(date(p.CALLBACK_DATE)),'null')||'zgtaccountpayment'||coalesce(t.BANK_ID,'')||coalesce(p.CARD_TYPE,'') as IDNOUSE,t.BANK_ID as bank_code,p.CARD_TYPE as cardtype,p.CUSTOMERNUMBER as RECEIVERID,year(date(p.CALLBACK_DATE))*100+month(date(p.CALLBACK_DATE)) as month,date(p.CALLBACK_DATE) as trxdate,18 as biztypeid,'SALES' as ordertype,'Sales' as type,'MERCHANT_ACCOUNT_PAY' as payproduct,'3011001004002' as PRODUCT_CODE,sum(p.amount)-sum(p.real_amount) as trxfee,sum(p.amount) as trxamount, count(p.id) as trxcount from zgt.tbl_payment p left join zgt.tbl_trxorder t on t.external_id = p.externalid left join zgt.tbl_customer_config c on c.customer_identity_no = (case when t.agent_no is null then t.customer_no else t.agent_no end) where 1 = 1 and t.status in ('SUCCESS','SETTLECONFIRM') and p.CALLBACK_DATE >= ${START} and p.CALLBACK_DATE  < ${STOP} and c.belong  != 'YEEPAY_SKB' and t.pay_product_type = 'LEDGER' group by p.CUSTOMERNUMBER,date(p.CALLBACK_DATE),t.BANK_ID,p.CARD_TYPE with ur",zgt_standby
zhangguitongym,zgtmembershippayment,"select  COALESCE(CHAR(p.CUSTOMERNUMBER),'null')||COALESCE(CHAR(date(p.CALLBACK_DATE)),'null')||'zgtmembershippayment'||coalesce(t.BANK_ID,'')||coalesce(p.CARD_TYPE,'') as IDNOUSE,t.BANK_ID as bank_code,p.CARD_TYPE as cardtype,p.CUSTOMERNUMBER as RECEIVERID,year(date(p.CALLBACK_DATE))*100+month(date(p.CALLBACK_DATE)) as month,date(p.CALLBACK_DATE) as trxdate,18 as biztypeid,'SALES' as ordertype,'Sales' as type,'PERSONAL_ACCOUNT_PAY' as payproduct,'3011001004001' as PRODUCT_CODE,sum(p.amount)-sum(p.real_amount) as trxfee,sum(p.amount) as trxamount, count(p.id) as trxcount from zgt.tbl_payment p left join zgt.tbl_trxorder t on t.external_id = p.externalid left join zgt.tbl_customer_config c on c.customer_identity_no = (case when t.agent_no is null then t.customer_no else t.agent_no end) where 1 = 1 and t.status in ('SUCCESS','SETTLECONFIRM') and p.CALLBACK_DATE >= ${START} and p.CALLBACK_DATE  < ${STOP} and c.belong  != 'YEEPAY_SKB' and t.pay_product_type = 'MEMBER' group by p.CUSTOMERNUMBER,date(p.CALLBACK_DATE),t.BANK_ID,p.CARD_TYPE,t.BANK_ID,p.CARD_TYPE with ur",zgt_standby
zhangguitongym,customeridnummap,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
shoukuanbaototal,shoukuanbaototalold,"select COALESCE(CHAR(CUSTOMERNUMBER),'null')||COALESCE(CHAR(SRC),'null') as IDNOUSE,'SKB' as dataorigin,CUSTOMERNUMBER as RECEIVERID,case SRC when 'W' then 260 when 'B' then 222 when 'D' then 222  when 'T' then 222 when 'S' then 222 end as biztypeid ,case SRC when 'W' then '3011001006001' when 'B' then '3011001003001' when 'D' then '3011001003001'  when 'T' then '3011001003001' when 'S' then '3011001003001' end as PRODUCT_CODE,date(CREATETIME) as trxdate, '3011004001004' as SALES_PRODUCT_CODE,sum(AMOUNT) as trxamount,count(*) as trxcount from SKB.TBL_SKB_RECEIVE where CREATETIME >= ${START} AND CREATETIME < ${STOP}   and  YORDERID is not null AND YORDERID != ''  AND YORDERID NOT LIKE '%ZGT'  group by CUSTOMERNUMBER,SRC,CREATETIME with ur",accnt
shoukuanbaototal,customeridnummap1,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
shoukuanbao,shoukuanbaosuccess,"select COALESCE(CHAR(reg.MAINCUSTOMERNUMBER),'null')||COALESCE(CHAR(rec.SRC),'null')||COALESCE(CHAR(date(rec.UPDATETIME)),'null')||COALESCE(CHAR(rec.BANK_CHANNEL_NO),'null')||COALESCE(CHAR(rec.BANKCODE),'null')||COALESCE(CHAR(rec.PAYER_CARD_TYPE),'null')||'shoukuanbaosuccess' as IDNOUSE,'SKB' as dataorigin
,year(rec.UPDATETIME)*100+month(rec.UPDATETIME) as month,reg.MAINCUSTOMERNUMBER as RECEIVERID
,case rec.SRC when 'W' then 260 when 'B' then 222 when 'D' then 222  when 'T' then 222 when 'S' then 222 when 'J' then 260 end as biztypeid 
,case rec.SRC when 'W' then '3011001006001' when 'B' then '3011001003001' when 'D' then '3011001003001'  when 'T' then '3011001003001' when 'S' then '3011001003001'  when 'J' then '3011001006001' else '3011001003001' end as PRODUCT_CODE 
,date(rec.UPDATETIME) as trxdate
, '3011004001004A' as SALES_PRODUCT_CODE
,sum(rec.AMOUNT) as trxamount
,count(*) as trxcount
,sum(rec.COUNTERFEE) as TRXSOURCEFEE
, 0 as TRXTARGETFEE
,SUM(rec.COST) as FRPCOST
,SUM(rec.COST) as ACCOUNTINGCOST
,SUM(rec.INCOME) as TRXFEE,rec.BANK_CHANNEL_NO as trxchannelid,rec.BANKCODE as bank_code,rec.PAYER_CARD_TYPE  as cardtype
from SKB.TBL_SKB_RECEIVE  rec, SKB.TBL_SKB_REGISTER reg where  reg.LEDGECUSTOMERNUMBER = rec.CUSTOMERNUMBER AND rec.UPDATETIME >= ${START} AND rec.UPDATETIME < ${STOP} and rec.PAYSTATUS in ('1','3','4') and rec.ENTERACCOUNT_STATUS='SUCCESS'  AND rec.PAYTIME IS NOT NULL   and rec.INCOME is not null      group by reg.MAINCUSTOMERNUMBER,rec.SRC,date(rec.UPDATETIME),month(rec.UPDATETIME),year(rec.UPDATETIME),rec.BANK_CHANNEL_NO,rec.BANKCODE,rec.PAYER_CARD_TYPE with ur",accnt
shoukuanbao,shoukuanbaotransform,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
shoukuanbao,shoukuanbaototal,"select COALESCE(CHAR(reg.MAINCUSTOMERNUMBER),'null')||COALESCE(CHAR(rec.SRC),'null')||COALESCE(CHAR(rec.UPDATETIME),'null')||'shoukuanbaototal' as IDNOUSE,'SKB' as dataorigin
, year(rec.UPDATETIME)*100+month(rec.UPDATETIME) as month,reg.MAINCUSTOMERNUMBER  as RECEIVERID
,case rec.SRC when 'W' then 260 when 'B' then 222 when 'D' then 222  when 'T' then 222 when 'S' then 222 when 'J' then 260 end as biztypeid
 ,case rec.SRC when 'W' then '3011001006001' when 'B' then '3011001003001' when 'D' then '3011001003001'  when 'T' then '3011001003001' when 'S' then '3011001003001'   when 'J' then '3011001006001' else 'unknown' end as PRODUCT_CODE
,date(rec.UPDATETIME) as trxdate
, '3011004001004A' as SALES_PRODUCT_CODE
,sum(rec.AMOUNT) as wholeorderamount
,count(*) as wholeordercount
 from SKB.TBL_SKB_RECEIVE  rec, SKB.TBL_SKB_REGISTER  reg where  reg.LEDGECUSTOMERNUMBER = rec.CUSTOMERNUMBER AND rec.UPDATETIME >= ${START} AND rec.UPDATETIME < ${STOP}  and  rec.YORDERID is not null AND rec.YORDERID <> ''  AND rec.YORDERID NOT LIKE '%ZGT'  group by reg.MAINCUSTOMERNUMBER,rec.SRC,rec.UPDATETIME with ur",accnt
online2g,b2csuccesstrx2g,"SELECT COALESCE(CHAR(p.TARGET_CUSTID),'null')||COALESCE(CHAR(p.SOURCE_CUSTID),'null')||COALESCE(CHAR(p.FRPID),'null')||COALESCE(CHAR(p.payproduct),'null')||COALESCE(CHAR(p.confirmDateOnly),'null')||'b2csuccesstrx2g' as IDNOUSE,'YP2G' as dataorigin,year(p.confirmDateOnly)*100+month(p.confirmDateOnly) as month,p.confirmDateOnly as trxdate,p.TARGET_CUSTID as receiverId,p.SOURCE_CUSTID as payerId,p.frpId as trxchannelid,f.bank_id as bank_code,
p.payproduct,count(*) as trxCount,sum(-p.target_trxamount) as trxAmount,
sum(p.SOURCE_FEE) as TRXSOURCEFEE,sum(p.TARGET_FEE) as TRXTARGETFEE,sum(p.SOURCE_FEE+p.TARGET_FEE) as trxfee,
sum(p.frpFee) as ACCOUNTINGCOST,sum(p.manageFee) as FRPCOST,'Sales' as type 
from PublishedTrx p left join Customer t on p.target_custid=t.id left join frp f on f.id=p.frpid
where p.confirmDateOnly=${START} and p.orderType in('SALES','SUBSCRIPT','LOAD_EXT','AUTHANDCONFIRM','AUTH','AUNUALCARD','COLLECT','DEBITNOCARDPAY','POS_SPLITBILL') 
and t.customerType='ENTERPRISE' and p.trxType in('SALES','AUTHORIZE')  and p.payproduct<>'POS'
group by p.TARGET_CUSTID,p.SOURCE_CUSTID,p.FRPID,p.payproduct,p.confirmDateOnly,f.bank_id with ur",COPY2
online2g,b2cwholetrx2g,"SELECT COALESCE(CHAR(ALLTRX.TRXDATE),'null')||COALESCE(CHAR(ALLTRX.PAYERID),'null')||COALESCE(CHAR(ALLTRX.RECEIVERID),'null')||COALESCE(CHAR(ALLTRX.TRXCHANNELID),'null')||COALESCE(CHAR(ALLTRX.PAYPRODUCT),'null')||'B2CWHOLETRX2G' AS IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(ALLTRX.TRXDATE)*100+MONTH(ALLTRX.TRXDATE) AS MONTH,ALLTRX.TRXDATE,ALLTRX.PAYERID,ALLTRX.RECEIVERID,ALLTRX.TRXCHANNELID,ALLTRX.PAYPRODUCT,COUNT(*) AS WHOLEORDERCOUNT,
SUM(ALLTRX.AMOUNT) AS WHOLEORDERAMOUNT,SUM(ALLTRX.PAY_COUNT) AS WHOLEPAYCOUNT,'Sales' AS TYPE 
FROM (SELECT T.ID,T.AMOUNT,T.ORDERDATEONLY AS TRXDATE,T.PAYER_ID AS PAYERID,T.RECEIVER_ID AS RECEIVERID,P.FRP_ID AS TRXCHANNELID,
T.ORDERTYPE,P.PAYPRODUCT,COUNT(P.ID) AS PAY_COUNT FROM TRXORDER T 
LEFT JOIN PAYMENT P ON P.TRXORDER_ID = T.ID AND P.TRXTYPE<>'REFUND'
WHERE T.ORDERDATEONLY = ${START}  AND P.PAYPRODUCT<>'POS' AND T.ORDERTYPE IN ('SALES','SUBSCRIPT','LOAD_EXT','AUTHANDCONFIRM','AUTH','AUNUALCARD','COLLECT','DEBITNOCARDPAY','POS_SPLITBILL') 
GROUP BY T.ORDERDATEONLY,T.PAYER_ID,T.RECEIVER_ID,P.FRP_ID,T.ORDERTYPE,P.PAYPRODUCT,T.ID,T.AMOUNT) AS ALLTRX 
GROUP BY ALLTRX.TRXDATE,ALLTRX.PAYERID,ALLTRX.RECEIVERID,ALLTRX.TRXCHANNELID,ALLTRX.PAYPRODUCT WITH UR",COPY2
online2g,refund2g,"SELECT COALESCE(CHAR(P.CONFIRMDATEONLY),'null')||COALESCE(CHAR(P.SOURCE_CUSTID),'null')||COALESCE(CHAR(P.TARGET_CUSTID),'null')||COALESCE(CHAR(P.FRPID),'null')||COALESCE(CHAR(P.PAYPRODUCT),'null')||'REFUND2G' AS IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(P.CONFIRMDATEONLY)*100+MONTH(P.CONFIRMDATEONLY) AS MONTH,P.CONFIRMDATEONLY AS TRXDATE,P.SOURCE_CUSTID AS PAYERID,P.TARGET_CUSTID AS RECEIVERID,P.FRPID AS TRXCHANNELID,
P.PAYPRODUCT AS PAYPRODUCT,COUNT(*) AS REFUNDCOUNT,SUM(-SOURCE_TRXAMOUNT) AS REFUNDAMOUNT,
SUM(-P.TARGET_FEE) AS REFUNDFEE,0 AS REFUNDFRPCOST,'Sales' AS TYPE 
FROM PUBLISHEDTRX P WHERE P.CONFIRMDATEONLY=${START} AND 
P.ORDERTYPE IN('SALES','SUBSCRIPT','LOAD_EXT','AUTHANDCONFIRM','AUTH','AUNUALCARD','COLLECT','DEBITNOCARDPAY','POS_SPLITBILL') 
AND P.TRXTYPE='REFUND' GROUP BY P.CONFIRMDATEONLY,P.SOURCE_CUSTID,P.TARGET_CUSTID,P.FRPID,P.PAYPRODUCT WITH UR",COPY2
online2g,online2gtransform,"select FRPCHANNELID as TRXCHANNELID, BIZTYPE_ID as biztypeid from db2inst1.biztypecomposite with ur",reportdb
online2gtest,b2csuccesstrx2gtest,"SELECT COALESCE(CHAR(p.TARGET_CUSTID),'null')||COALESCE(CHAR(p.SOURCE_CUSTID),'null')||COALESCE(CHAR(p.FRPID),'null')||'b2csuccesstrx2g' as IDNOUSE,'YP2G' as dataorigin,year(p.confirmDateOnly)*100+month(p.confirmDateOnly) as month,p.confirmDateOnly as trxdate,p.TARGET_CUSTID as receiverId,p.SOURCE_CUSTID as payerId,p.frpId as TRXCHANNELID,
p.payproduct,count(*) as trxCount,sum(-p.target_trxamount) as trxAmount,
sum(p.SOURCE_FEE) as TRXSOURCEFEE,sum(p.TARGET_FEE) as TRXTARGETFEE,sum(p.SOURCE_FEE+p.TARGET_FEE) as trxfee,
sum(p.frpFee) as ACCOUNTINGCOST,sum(p.manageFee) as FRPCOST,'Sales' as type 
from PublishedTrx p left join Customer t on p.target_custid=t.id 
where p.confirmDateOnly=${START} and p.orderType in('SALES','SUBSCRIPT','LOAD_EXT','AUTHANDCONFIRM','AUTH','AUNUALCARD','COLLECT','DEBITNOCARDPAY','POS_SPLITBILL') 
and t.customerType='ENTERPRISE' and p.trxType in('SALES','AUTHORIZE')  and p.payproduct<>'POS'
group by p.TARGET_CUSTID,p.SOURCE_CUSTID,p.FRPID,p.payproduct,p.confirmDateOnly with ur",COPY2
online2gtest,online2gtransformtest,"select FRPCHANNELID as TRXCHANNELID, BIZTYPE_ID as biztypeid from biztypecomposite with ur",reportdb
online2g,online2gtransform2,"select PAYPRODUCT,salesproductcode as SALES_PRODUCT_CODE from db2inst1.payproduct2productcode",reportdb
online2g,online2gtransform3,"select PAYPRODUCT,productcode as PRODUCT_CODE from db2inst1.payproduct2productcode",reportdb
online2g,online2gtransform4,"select PAYPRODUCT,ORDERTYPE from db2inst1.payproduct2productcode",reportdb
wtjs,wtjssuccess,"SELECT  COALESCE(CHAR(T.CUSTOMERID),'null')||COALESCE(CHAR(TE.CHARVALUE),'null')||COALESCE(CHAR(TE1.CHARVALUE),'null')||COALESCE(CHAR(DATE(AH.CREATEDATE)),'null')||'wtjssuccess'||COALESCE(CHAR(TE2.CHARVALUE),'null')||COALESCE(T.BANKID,'')  as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(AH.CREATEDATE))*100+MONTH(DATE(AH.CREATEDATE)) AS MONTH,DATE(AH.CREATEDATE) AS TRXDATE,13 AS BIZTYPEID,
T.CUSTOMERID AS RECEIVERID , TE.CHARVALUE AS TRXCHANNELID, 'REMIT' AS ORDERTYPE,T.BANKID AS BANK_CODE,
CASE COALESCE(TE1.CHARVALUE,'TRANSFEXT') WHEN 'TRANSFEXT_ZZY' THEN 'ZZY' WHEN 'TRANSFEXT_ZZYP' THEN 'ZZYP' ELSE 'Transf' END AS TYPE,
COALESCE(TE1.CHARVALUE,'TRANSFEXT') AS PAYPRODUCT,
CASE COALESCE(TE1.CHARVALUE,'TRANSFEXT') WHEN 'TRANSFEXT_ZZY' THEN '3011101002001' WHEN 'TRANSFEXT_ZZYP' THEN '3011101002001' ELSE '3011002001001' END AS PRODUCT_CODE,
CASE COALESCE(TE2.CHARVALUE,'') WHEN 'TZT_DRAW' THEN '3011004001005A' WHEN 'TZT_DRAW_NEW' THEN '3011004001005B' WHEN 'TZT_REFUND_NEW' THEN '3011004001005B'  ELSE ( 
CASE COALESCE(TE1.CHARVALUE,'TRANSFEXT') WHEN 'TRANSFEXT_ZZY' THEN '3011101002001A' WHEN 'TRANSFEXT_ZZYP' THEN '3011101002001A' ELSE '3011002001001A' END) END AS SALES_PRODUCT_CODE, 
COUNT(*) AS TRXCOUNT, SUM(T.SRCAMOUNT) AS TRXAMOUNT,
SUM(T.SRCFEE) AS TRXSOURCEFEE, SUM(T.TARGETFEE) AS TRXTARGETFEE, SUM(T.SRCFEE+T.TARGETFEE) AS  TRXFEE
FROM  TRANSFER T  JOIN  CUSTOMER C  ON T.CUSTOMERID=C.ID AND C.CUSTOMERTYPE='ENTERPRISE'
LEFT JOIN  TRANSFEREXTINFO TE  ON  T.ID=TE.TRANSFER_ID  AND TE.EXTSOURCE='CHANNELID3G22G'
LEFT JOIN  TRANSFEREXTINFO TE1  ON  T.ID=TE1.TRANSFER_ID  AND TE1.EXTSOURCE='WTJS_PRODUCT'
LEFT JOIN  TRANSFEREXTINFO TE2  ON T.ID=TE2.TRANSFER_ID AND TE2.EXTSOURCE='SECOND_PRODUCT_CODE'
JOIN ACCOUNTHISTORY AH ON AH.TRXID=T.ID WHERE  T.BUSITYPE = 'TRANSFEXT'  AND  AH.HISTORYTYPE='TRANSFEXT'
AND AH.CREATEDATE >= ${START} AND AH.CREATEDATE < ${STOP} GROUP BY  T.CUSTOMERID,
TE.CHARVALUE,  TE1.CHARVALUE ,DATE(AH.CREATEDATE),TE2.CHARVALUE,T.BANKID WITH UR",COPY2
wtjs,wtjsall,"SELECT  COALESCE(CHAR(T.CUSTOMERID),'null')||COALESCE(CHAR(TE.CHARVALUE),'null')||COALESCE(CHAR(TE1.CHARVALUE),'null')||COALESCE(CHAR(DATE(T.CREATEDATE)),'null')||'wtjsall'||COALESCE(CHAR(TE2.CHARVALUE),'null')||COALESCE(T.BANKID,'')  as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(T.CREATEDATE))*100+MONTH(DATE(T.CREATEDATE)) AS MONTH,DATE(T.CREATEDATE) AS TRXDATE,13 AS BIZTYPEID,
T.CUSTOMERID AS RECEIVERID , TE.CHARVALUE AS TRXCHANNELID, 'REMIT' AS ORDERTYPE,T.BANKID AS BANK_CODE,
CASE COALESCE(TE1.CHARVALUE,'TRANSFEXT') WHEN 'TRANSFEXT_ZZY' THEN 'ZZY' WHEN 'TRANSFEXT_ZZYP' THEN 'ZZYP' ELSE 'Transf' END AS TYPE,
COALESCE(TE1.CHARVALUE,'TRANSFEXT') AS PAYPRODUCT,
CASE COALESCE(TE1.CHARVALUE,'TRANSFEXT') WHEN 'TRANSFEXT_ZZY' THEN '3011101002001' WHEN 'TRANSFEXT_ZZYP' THEN '3011101002001' ELSE '3011002001001' END AS PRODUCT_CODE,
CASE COALESCE(TE2.CHARVALUE,'') WHEN 'TZT_DRAW' THEN '3011004001005A' WHEN 'TZT_DRAW_NEW' THEN '3011004001005B' WHEN 'TZT_REFUND_NEW' THEN '3011004001005B' ELSE ( 
CASE COALESCE(TE1.CHARVALUE,'TRANSFEXT') WHEN 'TRANSFEXT_ZZY' THEN '3011101002001A' WHEN 'TRANSFEXT_ZZYP' THEN '3011101002001A' ELSE '3011002001001A' END) END AS SALES_PRODUCT_CODE, 
COUNT(*) AS WHOLEORDERCOUNT, SUM(T.SRCAMOUNT) AS WHOLEORDERAMOUNT
FROM  TRANSFER T  JOIN  CUSTOMER C  ON T.CUSTOMERID=C.ID AND C.CUSTOMERTYPE='ENTERPRISE'
LEFT JOIN  TRANSFEREXTINFO TE  ON  T.ID=TE.TRANSFER_ID  AND TE.EXTSOURCE='CHANNELID3G22G'
LEFT JOIN  TRANSFEREXTINFO TE1  ON  T.ID=TE1.TRANSFER_ID  AND TE1.EXTSOURCE='WTJS_PRODUCT'
LEFT JOIN  TRANSFEREXTINFO TE2  ON T.ID=TE2.TRANSFER_ID AND TE2.EXTSOURCE='SECOND_PRODUCT_CODE'
WHERE  T.BUSITYPE = 'TRANSFEXT'
AND T.CREATEDATE >= ${START} AND T.CREATEDATE < ${STOP} GROUP BY  T.CUSTOMERID,
TE.CHARVALUE,  TE1.CHARVALUE,DATE(T.CREATEDATE),TE2.CHARVALUE,T.BANKID  WITH UR
",COPY2
wtjs,wtjsrefund,"SELECT COALESCE(CHAR(T.CUSTOMERID),'null')||COALESCE(CHAR(TE.CHARVALUE),'null')||COALESCE(CHAR(TE1.CHARVALUE),'null')||COALESCE(CHAR(DATE(TRF.CONFIRMDATE)),'null')||'wtjsrefund'||COALESCE(CHAR(TE2.CHARVALUE),'null')||COALESCE(T.BANKID,'')  as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(TRF.CONFIRMDATE))*100+MONTH(DATE(TRF.CONFIRMDATE)) AS MONTH,DATE(TRF.CONFIRMDATE) AS TRXDATE,13 AS BIZTYPEID,
 T.CUSTOMERID AS RECEIVERID , TE.CHARVALUE AS TRXCHANNELID,'TRANSFEREXT' AS ORDERTYPE,T.BANKID AS BANK_CODE,
CASE COALESCE(TE1.CHARVALUE,'TRANSFEXT') WHEN 'TRANSFEXT_ZZY' THEN 'ZZY' WHEN 'TRANSFEXT_ZZYP' THEN 'ZZYP' ELSE 'Transf' END AS TYPE,
COALESCE(TE1.CHARVALUE,'TRANSFEXT') AS PAYPRODUCT,
CASE COALESCE(TE1.CHARVALUE,'TRANSFEXT') WHEN 'TRANSFEXT_ZZY' THEN '3011101002001' WHEN 'TRANSFEXT_ZZYP' THEN '3011101002001' ELSE '3011002001001' END AS PRODUCT_CODE, 
CASE COALESCE(TE2.CHARVALUE,'') WHEN 'TZT_DRAW' THEN '3011004001005A' WHEN 'TZT_DRAW_NEW' THEN '3011004001005B' WHEN 'TZT_REFUND_NEW' THEN '3011004001005B' ELSE ( 
CASE COALESCE(TE1.CHARVALUE,'TRANSFEXT') WHEN 'TRANSFEXT_ZZY' THEN '3011101002001A' WHEN 'TRANSFEXT_ZZYP' THEN '3011101002001A' ELSE '3011002001001A' END) END AS SALES_PRODUCT_CODE, 
SUM(CASE WHEN T.STATUS = 'REFUNDED' THEN 1 ELSE 0 END) AS REFUNDCOUNT,
SUM(CASE WHEN T.STATUS = 'REFUNDED' THEN T.SRCAMOUNT ELSE 0 END) AS REFUNDAMOUNT,
SUM(CASE WHEN T.STATUS = 'REFUNDED' AND T.REFUNDTYPE='REFUNDALL' THEN T.SRCFEE ELSE 0 END)+
SUM(CASE WHEN T.STATUS = 'REFUNDED' AND T.REFUNDTYPE='REFUNDALL'  THEN T.TARGETFEE ELSE 0 END) AS REFUNDFEE
FROM  TRANSFER T  JOIN  CUSTOMER C  ON T.CUSTOMERID=C.ID AND C.CUSTOMERTYPE='ENTERPRISE'
LEFT JOIN  TRANSFEREXTINFO TE  ON  T.ID=TE.TRANSFER_ID  AND TE.EXTSOURCE='CHANNELID3G22G'
LEFT JOIN  TRANSFEREXTINFO TE1  ON  T.ID=TE1.TRANSFER_ID  AND TE1.EXTSOURCE='WTJS_PRODUCT'
LEFT JOIN  TRANSFEREXTINFO TE2  ON T.ID=TE2.TRANSFER_ID AND TE2.EXTSOURCE='SECOND_PRODUCT_CODE'
INNER JOIN TRANSFERREFUNDRECORD TRF ON TRF.ORGTRANSFER_ID=T.ID
WHERE C.ID<>11333454 AND
TRF.STATUS='SUCCESS' AND TRF.CONFIRMDATE >= ${START} AND TRF.CONFIRMDATE < ${STOP} AND T.BUSITYPE = 'TRANSFEXT'
GROUP BY  T.CUSTOMERID,  TE.CHARVALUE,  TE1.CHARVALUE,DATE(TRF.CONFIRMDATE),TE2.CHARVALUE,T.BANKID WITH UR",COPY2
wtjshr,wtjshrsuccess,"SELECT COALESCE(CHAR(P.TARGET_CUSTID),'null')||COALESCE(CHAR(P.SOURCE_CUSTID),'null')||COALESCE(CHAR(P.FRPID),'null')||COALESCE(CHAR(P.PAYPRODUCT),'null')||COALESCE(CHAR(P.CONFIRMDATEONLY),'null')||'wtjshrsuccess' as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(P.CONFIRMDATEONLY)*100+MONTH(P.CONFIRMDATEONLY) AS MONTH,P.CONFIRMDATEONLY AS TRXDATE,P.TARGET_CUSTID AS RECEIVERID,P.SOURCE_CUSTID AS PAYERID,P.FRPID AS TRXCHANNELID,
P.PAYPRODUCT,COUNT(*) AS TRXCOUNT,SUM(-P.TARGET_TRXAMOUNT) AS TRXAMOUNT,
SUM(P.SOURCE_FEE) AS TRXSOURCEFEE,SUM(P.TARGET_FEE) AS TRXTARGETFEE,SUM(P.SOURCE_FEE+P.TARGET_FEE) AS TRXFEE,
SUM(P.FRPFEE) AS ACCOUNTINGCOST,SUM(P.MANAGEFEE) AS FRPCOST,'Sales' AS TYPE,
4 as BIZTYPEID,'3011002001001' as PRODUCT_CODE,'3011002001001A' as SALES_PRODUCT_CODE,'REMIT_LOAD' as ORDERTYPE
FROM PUBLISHEDTRX P LEFT JOIN CUSTOMER T ON P.TARGET_CUSTID=T.ID 
WHERE P.CONFIRMDATEONLY= ${START} AND P.ORDERTYPE IN('REMIT_LOAD') 
AND T.CUSTOMERTYPE='ENTERPRISE' AND P.TRXTYPE IN('SALES','AUTHORIZE')  AND P.PAYPRODUCT<>'POS'
GROUP BY P.TARGET_CUSTID,P.SOURCE_CUSTID,P.FRPID,P.PAYPRODUCT,P.CONFIRMDATEONLY WITH UR",COPY2
wtjshr,wtjshrrefund,"SELECT COALESCE(CHAR(P.CONFIRMDATEONLY),'null')||COALESCE(CHAR(P.SOURCE_CUSTID),'null')||COALESCE(CHAR(P.TARGET_CUSTID),'null')||COALESCE(CHAR(P.FRPID),'null')||COALESCE(CHAR(P.PAYPRODUCT),'null')||'wtjshrrefund' as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(P.CONFIRMDATEONLY)*100+MONTH(P.CONFIRMDATEONLY) AS MONTH,
P.CONFIRMDATEONLY AS TRXDATE,P.SOURCE_CUSTID AS PAYERID,P.TARGET_CUSTID AS RECEIVERID,P.FRPID AS TRXCHANNELID,
P.PAYPRODUCT AS PAYPRODUCT,COUNT(*) AS REFUNDCOUNT,SUM(-SOURCE_TRXAMOUNT) AS REFUNDAMOUNT,
SUM(-P.TARGET_FEE) AS REFUNDFEE,0 AS REFUNDFRPCOST,'Sales' AS TYPE ,
4 as BIZTYPEID,'3011002001001' as PRODUCT_CODE,'3011002001001A' as SALES_PRODUCT_CODE,'REMIT_LOAD' as ORDERTYPE
FROM PUBLISHEDTRX P WHERE P.CONFIRMDATEONLY= ${START} AND 
P.ORDERTYPE IN('REMIT_LOAD') 
AND P.TRXTYPE='REFUND' AND P.PAYPRODUCT<>'POS' GROUP BY P.CONFIRMDATEONLY,P.SOURCE_CUSTID,P.TARGET_CUSTID,P.FRPID,P.PAYPRODUCT WITH UR",COPY2
rjtonline,rjtonlinecktj," SELECT 
 COALESCE(CHAR(T.CUSTOMERID),'null')||COALESCE(CHAR(DATE(TB.DEBITDATE)),'null')||COALESCE(CHAR(TE.CHARVALUE),'null')||coalesce(char(T.BANKID),'null')||'rjtonlinecktj' as IDNOUSE,
 'YP2G' AS DATAORIGIN,YEAR(DATE(TB.DEBITDATE))*100+MONTH(DATE(TB.DEBITDATE)) AS MONTH,
 DATE(TB.DEBITDATE) AS TRXDATE,T.CUSTOMERID AS RECEIVERID ,
 TE.CHARVALUE AS TRXCHANNELID,
 T.BANKID AS BANK_CODE,
 'TRANSFEXT_INDAY' AS PAYPRODUCT,
 COUNT(*) TRXCOUNT, SUM(T.SRCAMOUNT) TRXAMOUNT,
 SUM(T.SRCFEE) TRXSOURCEFEE,
 SUM(T.TARGETFEE) TRXTARGETFEE,
 SUM(T.SRCFEE+T.TARGETFEE) AS TRXFEE,
 'REMIT' AS ORDERTYPE, '3011101001001' AS PRODUCT_CODE,
 '3011101001001A' AS SALES_PRODUCT_CODE,
  13 AS BIZTYPEID, 'TRANSFINDAY' AS TYPE 
        FROM TRANSFER T 
        left join TBL_BALANCE_REQUEST TB ON TB.ID=T.ID
        LEFT JOIN TRANSFEREXTINFO TE ON T.ID=TE.TRANSFER_ID AND TE.EXTSOURCE='CHANNELID3G22G' 
       left join TRANSFEREXTINFO TEE on T.ID=TEE.TRANSFER_ID AND TEE.EXTSOURCE = 'SECOND_PRODUCT_CODE' 
        WHERE
         TB.REMITSTATUS IN ('ACCOUNTDEBITED','GENERATEBATCH','FAIL','SUCCESS','REFUNDED')  
          AND (TEE.CHARVALUE IS NULL OR TEE.CHARVALUE NOT IN ('LIKER')) 
          AND TB.DEBITDATE >= ${START} AND TB.DEBITDATE < ${STOP} 
          AND T.BUSITYPE IN('TRANSFEXT_INDAY') 
          GROUP BY T.CUSTOMERID,DATE(TB.DEBITDATE), TE.CHARVALUE,T.BANKID WITH UR",COPY2
rjtonline,rjtonlinetktj,"SELECT COALESCE(CHAR(TR.CUSTOMERID),'null')||COALESCE(CHAR(DATE(TR.CONFIRMDATE)),'null')||COALESCE(CHAR(TE.CHARVALUE),'null')||coalesce(char(T.BANKID),'null')||'rjtonlinetktj' as IDNOUSE,
  'YP2G' AS DATAORIGIN,YEAR(DATE(TR.CONFIRMDATE))*100+MONTH(DATE(TR.CONFIRMDATE)) AS MONTH,DATE(TR.CONFIRMDATE) AS TRXDATE,
TR.CUSTOMERID AS RECEIVERID ,
             TE.CHARVALUE AS TRXCHANNELID,T.BANKID AS BANK_CODE,
             'TRANSFEXT_INDAY' AS PAYPRODUCT,
             COUNT(*) REFUNDCOUNT,
                      SUM(T.SRCAMOUNT) REFUNDAMOUNT,
                                       SUM(REFUNDSRCFEE+REFUNDTARGETFEE) AS REFUNDFEE,
                                       'REMIT' AS ORDERTYPE,
             '3011101001001' AS PRODUCT_CODE,
             '3011101001001A' AS SALES_PRODUCT_CODE,
             13 AS BIZTYPEID,
             'TRANSFINDAY' AS TYPE
      FROM TRANSFERREFUNDRECORD TR
      LEFT JOIN TRANSFER T ON TR.ORGTRANSFER_ID=T.ID
      LEFT JOIN TRANSFEREXTINFO TE ON T.ID=TE.TRANSFER_ID AND TE.EXTSOURCE='CHANNELID3G22G' 
      left join TRANSFEREXTINFO TEE on T.ID=TEE.TRANSFER_ID AND TEE.EXTSOURCE = 'SECOND_PRODUCT_CODE' 
      WHERE T.BUSITYPE IN('TRANSFEXT_INDAY')
        AND TR.STATUS='SUCCESS' 
        AND (TEE.CHARVALUE IS NULL OR TEE.CHARVALUE NOT IN ('LIKER')) 
        AND TR.CONFIRMDATE >= ${START} AND TR.CONFIRMDATE < ${STOP} 
      GROUP BY TR.CUSTOMERID,DATE(TR.CONFIRMDATE),
               TE.CHARVALUE,T.BANKID WITH UR",COPY2
offlinepos,offlinepossuccess,"SELECT COALESCE(CHAR(DATE(A.COMPLETE_TIME)),'null')||COALESCE(CHAR(A.CUSTOMER_NUMBER),'null')||COALESCE(CHAR(C.PRODUCT_CODE),'null')||COALESCE(CHAR(B.FRP_CODE),'null')||'offlinepossuccess' as IDNOUSE,
'POSP' AS DATAORIGIN,YEAR(DATE(A.COMPLETE_TIME))*100+MONTH(DATE(A.COMPLETE_TIME)) AS MONTH,DATE(A.COMPLETE_TIME) AS TRXDATE,
C.PRODUCT_CODE AS PAYPRODUCT,'Sales' AS TYPE,29 AS BIZTYPEID,B.FRP_CODE AS TRXCHANNELID,A.CUSTOMER_NUMBER AS RECEIVERID,
COUNT(*) AS TRXCOUNT,SUM(A.TRX_AMOUNT) AS TRXAMOUNT,SUM(B.CUSTOMER_FEE) AS TRXTARGETFEE,SUM(B.CUSTOMER_FEE) AS TRXFEE,
SUM(B.BANK_COST) AS ACCOUNTINGCOST,SUM(B.BANK_COST) AS FRPCOST,MAX(CA.ISSUER) as bank_code,MAX(CA.CARD_TYPE) as CARDTYPE
FROM POSWRITE.TBL_POS_ORDER A 
LEFT JOIN POSWRITE.TBL_POS_PAYMENT B ON A.ID = B.ORDER_ID AND B.STATUS = 'SUCCESS' AND B.TRX_TYPE IN ('PURCHASE','PRE_AUTHORIZATION_COMPLETION')
LEFT JOIN POSWRITE.TBL_POS_ORDERPRODUCT C ON C.ORDER_ID = A.ID
LEFT JOIN POSWRITE.TBL_POS_CUSTOMER CU ON  CU.CUSTOMER_NUMBER = A.CUSTOMER_NUMBER 
LEFT JOIN POSWRITE.TBL_POS_CARDINFO CA ON A.CARDINFO_ID=CA.ID
WHERE A.ORDER_STATUS IN ('SUCCESS','SETTLED') AND A.BUSINESS_TYPE NOT IN ('UNION_BILL_PURCHASE_PAY1','UNION_BILL_PURCHASE_PAY2','UNION_BANKTO_TRANSFER_PURCHASE') AND 
A.COMPLETE_TIME >= ${START} AND A.COMPLETE_TIME < ${STOP}
and B.COMPLETE_TIME >= ${START}  and B.COMPLETE_TIME < ${STOP} 
GROUP BY DATE(A.COMPLETE_TIME),A.CUSTOMER_NUMBER,C.PRODUCT_CODE,B.FRP_CODE with ur",opendb
offlinepos,offlineposall,"SELECT COALESCE(CHAR(DATE(A.CREATE_TIME)),'null')||COALESCE(CHAR(A.CUSTOMER_NUMBER),'null')||COALESCE(CHAR(C.PRODUCT_CODE),'null')||COALESCE(CHAR(B.FRP_CODE),'null')||'offlineposall' as IDNOUSE,
'POSP' AS DATAORIGIN,YEAR(DATE(A.CREATE_TIME))*100+MONTH(DATE(A.CREATE_TIME)) AS MONTH,DATE(A.CREATE_TIME) AS TRXDATE,
C.PRODUCT_CODE AS PAYPRODUCT,'Sales' AS TYPE,29 AS BIZTYPEID,B.FRP_CODE AS TRXCHANNELID,A.CUSTOMER_NUMBER AS RECEIVERID,
COUNT(*) AS WHOLEORDERCOUNT,SUM(A.TRX_AMOUNT) AS WHOLEORDERAMOUNT,MAX(CA.ISSUER) as bank_code,MAX(CA.CARD_TYPE) AS CARDTYPE
FROM POSWRITE.TBL_POS_ORDER A 
LEFT JOIN POSWRITE.TBL_POS_PAYMENT B ON A.ID = B.ORDER_ID AND B.STATUS = 'SUCCESS' AND B.TRX_TYPE IN ('PURCHASE','PRE_AUTHORIZATION_COMPLETION')
LEFT JOIN POSWRITE.TBL_POS_ORDERPRODUCT C ON C.ORDER_ID = A.ID
LEFT JOIN POSWRITE.TBL_POS_CUSTOMER CU ON  CU.CUSTOMER_NUMBER = A.CUSTOMER_NUMBER 
LEFT JOIN POSWRITE.TBL_POS_CARDINFO CA ON A.CARDINFO_ID=CA.ID
WHERE 
A.CREATE_TIME >= ${START} AND A.CREATE_TIME < ${STOP} 
and B.TRX_TIME >= ${START}  and B.TRX_TIME < ${STOP} 
GROUP BY DATE(A.CREATE_TIME),A.CUSTOMER_NUMBER,C.PRODUCT_CODE,B.FRP_CODE
with ur",opendb
offlinepos,offlinepostransform1,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
offlinepos,offlinepostransform2,"select PAYPRODUCT,salesproductcode as SALES_PRODUCT_CODE from db2inst1.payproduct2productcode",reportdb
offlinepos,offlinepostransform3,"select PAYPRODUCT,productcode as PRODUCT_CODE from db2inst1.payproduct2productcode",reportdb
offlinepos,offlinepostransform4,"select PAYPRODUCT,ORDERTYPE from db2inst1.payproduct2productcode",reportdb
hssxf,hssxftrade,"SELECT COALESCE(CHAR(TTO.CUSTOMER_NUMBER),'null')||COALESCE(CHAR(TTO.CAL_FEE_CATEGORY),'null')||COALESCE(CHAR(TTO.PRIMITIVE_PAY_PRODUCT),'null')||COALESCE(CHAR(TTO.INTERFACE_NUMBER),'null')||COALESCE(CHAR(TTO.REMARK),'null')||COALESCE(CHAR(DATE(TTO.TRANSFER_TIME)),'null')||COALESCE(CHAR(TTO.PRIMITIVE_PAY_WAY),'null')||'hssxftrade' as IDNOUSE,
'YP3G-FEE' AS DATAORIGIN,YEAR(DATE(TTO.TRANSFER_TIME))*100+MONTH(DATE(TTO.TRANSFER_TIME)) AS MONTH,DATE(TTO.TRANSFER_TIME) AS TRXDATE,
(CASE TTO.CAL_FEE_CATEGORY WHEN 'ONLINE_MINIPOS'  then 'ONLINE_MINIPOS'  
else (case TTO.PRIMITIVE_PAY_WAY
      when 'PAYMENTS_BEHALF' then 'entrusted' 
      when 'TZT_WITHDRAW' then 'TZT_HSSXF' 
      when 'TZTNEW_WITHDRAW' then 'TZT_NEW_HSSXF' 
      when 'TZT_DRAW' then 'TZT_HSSXF' 
      when 'TZT_DRAW_NEW' then 'TZT_NEW_HSSXF'
     when 'TRANSFEXT_INDAY' then 'transferinday'
    else TTO.PRIMITIVE_PAY_PRODUCT end) end ) AS PAYPRODUCT,'POSTPAID' AS TYPE,TTO.CUSTOMER_NUMBER AS RECEIVERID,
CASE TTO.CAL_FEE_CATEGORY WHEN 'DEBIT_ACQUIRING' THEN 182 WHEN 'EPOS_ACQUIRING' THEN 6 WHEN 'FP_ACQUIRING' THEN 6 WHEN 'PAYMENTS_BEHALF' THEN 13 WHEN 'POS_ACQUIRING' THEN 29 WHEN 'OL_ONEPAY' THEN 222 WHEN 'ONLINE_MINIPOS'  then 18  ELSE 4 END AS BIZTYPEID,
TTO.INTERFACE_NUMBER AS TRXCHANNELID,TTO.REMARK AS PAYERID,
     SUM(COALESCE(TTO.PAYEE_FEE,0) + COALESCE(TTO.PAYER_FEE,0)) AS TRXFEE,
SUM(COALESCE(TTO.PAYEE_FEE,0) + COALESCE(TTO.PAYER_FEE,0)) AS NEWTRXFEE,
SUM(COALESCE(TTO.PAYEE_FEE,0)) as trxtargetfee,
 SUM(COALESCE(TTO.PAYER_FEE,0)) as trxsourcefee  
     FROM FEE.TBL_FRONT_POST_TRANSFER_ORDER TTO  
     WHERE TTO.TRANSFER_TIME >= ${START} AND TTO.TRANSFER_TIME < ${STOP} AND TTO.ORDER_TYPE='TRADE'  
     GROUP BY TTO.CUSTOMER_NUMBER,TTO.CAL_FEE_CATEGORY,TTO.PRIMITIVE_PAY_WAY,TTO.PRIMITIVE_PAY_PRODUCT,TTO.INTERFACE_NUMBER,TTO.REMARK,DATE(TTO.TRANSFER_TIME)
     WITH UR   ",feedb
hssxf,hssxfrefund,"SELECT COALESCE(CHAR(TRO.CUSTOMER_NUMBER),'null')||COALESCE(CHAR(TRO.CAL_FEE_CATEGORY),'null')||COALESCE(CHAR(TRO.PRIMITIVE_PAY_PRODUCT),'null')||COALESCE(CHAR(TRO.INTERFACE_NUMBER),'null')||COALESCE(CHAR(TRO.REMARK),'null')||COALESCE(CHAR(DATE(TRO.REFUND_TIME)),'null')||COALESCE(CHAR(TRO.PRIMITIVE_PAY_WAY),'null')||'hssxfrefund' as IDNOUSE,'YP3G-FEE' AS DATAORIGIN,YEAR(DATE(TRO.REFUND_TIME))*100+MONTH(DATE(TRO.REFUND_TIME)) AS MONTH,DATE(TRO.REFUND_TIME) AS TRXDATE,
(CASE TRO.CAL_FEE_CATEGORY WHEN 'ONLINE_MINIPOS'  then 'ONLINE_MINIPOS'  
else (case TRO.PRIMITIVE_PAY_WAY
      when 'PAYMENTS_BEHALF' then 'entrusted' 
      when 'TZT_WITHDRAW' then 'TZT_HSSXF' 
      when 'TZTNEW_WITHDRAW' then 'TZT_NEW_HSSXF' 
      when 'TZT_DRAW' then 'TZT_HSSXF' 
      when 'TZT_DRAW_NEW' then 'TZT_NEW_HSSXF'
     when 'TRANSFEXT_INDAY' then 'transferinday'
    else TRO.PRIMITIVE_PAY_PRODUCT end) end ) AS PAYPRODUCT,'POSTPAID' AS TYPE,TRO.CUSTOMER_NUMBER AS RECEIVERID,
CASE TRO.CAL_FEE_CATEGORY WHEN 'DEBIT_ACQUIRING' THEN 182 WHEN 'EPOS_ACQUIRING' THEN 6 WHEN 'FP_ACQUIRING' THEN 6 WHEN 'PAYMENTS_BEHALF' THEN 13 WHEN 'POS_ACQUIRING' THEN 29 WHEN 'OL_ONEPAY' THEN 222 ELSE 4 END AS BIZTYPEID,
TRO.INTERFACE_NUMBER AS TRXCHANNELID,TRO.REMARK AS PAYERID,
     SUM(COALESCE(TRO.PAYEE_FEE,0) + COALESCE(TRO.PAYER_FEE,0)) AS REFUNDFEE ,
SUM(COALESCE(TRO.PAYEE_FEE,0) + COALESCE(TRO.PAYER_FEE,0)) AS NEWREFUNDFEE 
     FROM FEE.TBL_FRONT_REFUND_ORDER TRO  
     WHERE TRO.REFUND_TIME >=${START}  AND TRO.REFUND_TIME <${STOP}  AND TRO.CHARGE_TYPE='UN_REAL_TIME'  
     GROUP BY TRO.CUSTOMER_NUMBER,TRO.CAL_FEE_CATEGORY,TRO.PRIMITIVE_PAY_PRODUCT,TRO.PRIMITIVE_PAY_WAY,TRO.INTERFACE_NUMBER,TRO.REMARK,DATE(TRO.REFUND_TIME)
     WITH UR ",feedb
hssxf,hssxftransform1,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
hssxf,hssxftransform3,"select PAYPRODUCT,salesproductcode as SALES_PRODUCT_CODE from db2inst1.payproduct2productcode",reportdb
hssxf,hssxftransform4,"select PAYPRODUCT,ORDERTYPE from db2inst1.payproduct2productcode",reportdb
hssxf,hssxftransform2,"select PAYPRODUCT,productcode as PRODUCT_CODE from db2inst1.payproduct2productcode",reportdb
hssxf,hssxftransform5,"select CUSTOMERNUMBER as PAYERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
edcztx,edcztxchongzhi,"SELECT COALESCE(CHAR(TARGET_CUSTID),'null')||COALESCE(CHAR(FRPID),'null')||COALESCE(CHAR(DATE(CONFIRMORCANCEL)),'null')||'edcztxchongzhi' as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(CONFIRMORCANCEL))*100+MONTH(DATE(CONFIRMORCANCEL)) AS MONTH,DATE(CONFIRMORCANCEL) AS TRXDATE,
TARGET_CUSTID AS RECEIVERID,FRPID AS TRXCHANNELID,'LOAD' AS ORDERTYPE,11 AS BIZTYPEID,'Load' AS TYPE,'MERCHANT_ACCOUNT_PAY' AS PAYPRODUCT,
'3011001004002A' AS SALES_PRODUCT_CODE,'3011001004002' AS PRODUCT_CODE,
COALESCE(COUNT(*),0) AS TRXCOUNT,COALESCE(SUM(ORDERAMOUNT),0) AS TRXAMOUNT,
COALESCE(SUM(SOURCE_FEE),0) AS TRXSOURCEFEE,SUM(TARGET_FEE) AS TRXTARGETFEE,SUM(SOURCE_FEE+TARGET_FEE) as TRXFEE,SUM(FRPFEE) AS ACCOUNTINGCOST,SUM(P.FRPFEE) AS FRPCOST
FROM PUBLISHEDTRX P LEFT JOIN CUSTOMER T ON P.TARGET_CUSTID=T.ID WHERE CONFIRMORCANCEL >= ${START} AND  CONFIRMORCANCEL < ${STOP}  AND ORDERTYPE ='LOAD' AND T.CUSTOMERTYPE='ENTERPRISE'
AND P.TRXTYPE='SALES' GROUP BY TARGET_CUSTID,FRPID,DATE(CONFIRMORCANCEL) WITH UR",COPY2
edcztx,erdcztxtixian,"SELECT COALESCE(CHAR(T.CUSTOMERID),'null')||COALESCE(CHAR(CHANNEL),'null')||COALESCE(CHAR(DATE(T.CONFIRMORCANCELDATE)),'null')||'edcztxtixian' as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(T.CONFIRMORCANCELDATE))*100+MONTH(DATE(T.CONFIRMORCANCELDATE)) AS MONTH,DATE(T.CONFIRMORCANCELDATE) AS TRXDATE,
T.CUSTOMERID AS RECEIVERID ,TB.CHANNEL AS TRXCHANNELID,'CASH' AS ORDERTYPE,11 AS BIZTYPEID,'Cash' AS TYPE,'MERCHANT_ACCOUNT_PAY' AS PAYPRODUCT,
'3011001004002A' AS SALES_PRODUCT_CODE,'3011001004002' AS PRODUCT_CODE,
COALESCE(COUNT(*),0) AS TRXCOUNT,COALESCE(SUM(T.SRCAMOUNT),0) AS TRXAMOUNT,
COALESCE(SUM(SRCFEE),0) AS TRXSOURCEFEE,COALESCE(SUM(TARGETFEE),0) AS TRXTARGETFEE,COALESCE(SUM(SRCFEE+TARGETFEE),0) AS TRXFEE
FROM TRANSFER T LEFT JOIN TRANSFERBATCH TB ON T.BATCH_ID=TB.ID  WHERE T.STATUS IN ('GENERATEBATCH','GENERATEBATCH_3G','GENERATEBATCH_DOING')
AND T.CONFIRMORCANCELDATE >= ${START} AND T.CONFIRMORCANCELDATE < ${STOP} AND T.BUSITYPE ='CASH'
 GROUP BY T.CUSTOMERID,CHANNEL,DATE(T.CONFIRMORCANCELDATE) WITH UR",COPY2
rzsxf,rzsxf,"select COALESCE(CHAR(a.CUSTOMERID),'null')||COALESCE(CHAR(a.FROMPRODUCT),'null')||COALESCE(CHAR(date(a.payTIME)),'null')||'rzsxf' as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(a.payTIME))*100+MONTH(DATE(a.payTIME)) AS MONTH,DATE(a.payTIME) AS TRXDATE,
CUSTOMERID as RECEIVERID,226 as BIZTYPEID,
case a.FROMPRODUCT when 'FastRealIdName' then '3011004003001' when 'FastRealNameAuth' then '3011004003002' when 'FastRealNameVerify' then '3011004003002' else '3011004003002' end as PRODUCT_CODE,
case a.FROMPRODUCT when 'FastRealIdName' then '3011004003001A' when 'FastRealNameAuth' then '3011004003002B' when 'FastRealNameVerify' then '3011004003002A' else '3011004003002B' end as SALES_PRODUCT_CODE,
case a.FROMPRODUCT when 'FastRealIdName' then 'RealNameAuth' else 'CARDJIANQUAN' end as TYPE,
case a.FROMPRODUCT when 'FastRealIdName' then 'REALNAMEAUTH' else 'CARDJIANQUAN' end as PAYPRODUCT,
case a.FROMPRODUCT when 'FastRealIdName' then 'REALNAMEAUTH' else 'CARDJIANQUAN' end as ORDERTYPE,
cast(sum(payamount)+sum(refundamount) as decimal(10,2)) as TRXFEE,count(*) as TRXCOUNT from mobilebe.fastrealnameauthrecord a
where a.payTIME >= ${START}
and a.payTIME < ${STOP}
and a.feestatus in ('PAID','REFUND')
group by a.CUSTOMERID,a.FROMPRODUCT,date(a.payTIME) with ur",COPY2
rzsxf,rzsxftransform1,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
bxxyzf,bxxyzf,"SELECT COALESCE(CHAR(O.ACCOUNTTYPE),'null')||COALESCE(CHAR(O.CREDITCUSTOMERNUMBER),'null')||COALESCE(CHAR(DATE(O.REPAYREQUESTDATE)),'null')||'bxxyzf' as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(O.REPAYREQUESTDATE))*100+MONTH(DATE(O.REPAYREQUESTDATE)) AS MONTH,DATE(O.REPAYREQUESTDATE) AS TRXDATE,
CASE COALESCE(O.ACCOUNTTYPE,'') WHEN 'CLAIM' THEN 'INSURANCECREDITCLAIM' WHEN 'ORDER' THEN 'INSURANCECREDITORDER' END AS TYPE,
CASE COALESCE(O.ACCOUNTTYPE,'') WHEN 'CLAIM' THEN 'INSURANCECREDITCLAIM' WHEN 'ORDER' THEN 'INSURANCECREDITORDER' END AS ORDERTYPE,
'3011001004003' AS PRODUCT_CODE,'3011001004003B' AS SALES_PRODUCT_CODE,
221 AS BIZTYPEID,'INSURANCECREDIT' AS PAYPRODUCT,O.CREDITCUSTOMERNUMBER AS RECEIVERID,SUM(O.TOTOALFEE) AS TRXFEE
FROM INSUREPREPAYORDER O WHERE O.REPAYSTATUS='SUCCESS' AND O.REPAYREQUESTDATE >= ${START} AND O.REPAYREQUESTDATE < ${STOP}
GROUP BY O.ACCOUNTTYPE,O.CREDITCUSTOMERNUMBER,DATE(O.REPAYREQUESTDATE) WITH UR",COPY2
bxxyzf,bxxyzftransform1,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
zzyyysxf,zzyyysxf,"SELECT COALESCE(CHAR(A.CUSTOMER_ID),'null')||COALESCE(CHAR(DATE(AH.CREATEDATE)),'null')||'zzyyysxf' as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(AH.CREATEDATE))*100+MONTH(DATE(AH.CREATEDATE)) AS MONTH,DATE(AH.CREATEDATE) AS TRXDATE,
A.CUSTOMER_ID AS RECEIVERID,SUM(AH.TRXAMOUNT) AS TRXFEE,'ZZYORDER' AS TYPE,'ZZYORDER' AS ORDERTYPE,13 AS BIZTYPEID,'TRANSFEXT_ZZY' AS PAYPRODUCT, 
'3011101002001A' AS SALES_PRODUCT_CODE,'3011101002001' AS PRODUCT_CODE
FROM ACCOUNTHISTORY AH 
LEFT JOIN ACCOUNT A ON A.ID = AH.ACCOUNT_ID WHERE AH.CREATEDATE >= ${START} AND AH.CREATEDATE < ${STOP}
AND AH.HISTORYTYPE = 'ADJUST'  AND AH.DESCRIPTION = '_¨è½¬__çº¦æ_ç»´¹' GROUP BY A.CUSTOMER_ID,DATE(AH.CREATEDATE) WITH UR",COPY2
jssxf,jssxf,"SELECT COALESCE(CHAR(CUSTOMER_ID),'null')||COALESCE(CHAR(CHANNELNO),'null')||COALESCE(CHAR(DATE(SETTLEMENTDATE)),'null')||'jssxf' as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(SETTLEMENTDATE))*100+MONTH(DATE(SETTLEMENTDATE)) AS MONTH,DATE(SETTLEMENTDATE) AS TRXDATE,
'SETTLEMENT' AS PAYPRODUCT,'3011002002001' AS PRODUCT_CODE,'3011002002001A' AS SALES_PRODUCT_CODE,
CUSTOMER_ID AS RECEIVERID,COUNT(*) AS TRXCOUNT,SUM(REMITFEE) AS TRXFEE,'MERCHANT_SETTLE' AS ORDERTYPE,'SettleFee' AS TYPE,11 AS BIZTYPEID,CHANNELNO as TRXCHANNELID  
FROM settlementrecord 
WHERE settlementdate >= ${START} AND settlementdate < ${STOP} GROUP BY CUSTOMER_ID,DATE(SETTLEMENTDATE), CHANNELNO WITH UR",COPY2
ytj,ytj,"SELECT COALESCE(CHAR(D.PRODUCT_CODE),'null')||COALESCE(CHAR(D.SALES_PRODUCT_CODE),'null')||COALESCE(CHAR(D.RECEIVERID),'null')||COALESCE(CHAR(D.BIZTYPEID),'null')||COALESCE(CHAR(D.TYPE),'null')||COALESCE(CHAR(R.EMPLOYEEID),'null')||COALESCE(CHAR(C.PRODUCTLINEID),'null')||COALESCE(CHAR(C.AREAID),'null')||COALESCE(CHAR(R.ISSELF),'null')||COALESCE(CHAR(R.ISSHARE),'null')||COALESCE(CHAR(R.SHARESCALE),'null')||COALESCE(CHAR(R.TRANSFDATE),'null')||COALESCE(CHAR(C.PRODUCTGROUP),'null')||COALESCE(CHAR(C.BUSSINESSCATID),'null')||COALESCE(CHAR(C.PROVINCE),'null')||COALESCE(CHAR(C.LEVEL),'null')||COALESCE(CHAR(C.BRANCHCOMPANY),'null')||COALESCE(CHAR(D.FEETYPE),'null')||COALESCE(CHAR(D.DATAORIGIN),'null')||COALESCE(CHAR(D.PAYPRODUCT),'null')||COALESCE(CHAR(D.PAYSCENE),'null')||COALESCE(CHAR(D.GOODSCATE),'null')||COALESCE(CHAR(D.PAYTERMINAL),'null')||'ytj' as IDNOUSE,D.PRODUCT_CODE,D.SALES_PRODUCT_CODE,D.RECEIVERID AS CUSTOMERID,D.BIZTYPEID,D.TYPE,R.EMPLOYEEID AS SALESID,C.PRODUCTLINEID,C.AREAID,
C.PRODUCTGROUP,R.ISSELF,R.ISSHARE AS ISSHARECUSTOMER,R.SHARESCALE AS SALESSCALE,R.TRANSFDATE,SUM(TRXCOUNT)-SUM(REFUNDCOUNT) AS TRXCOUNT,
SUM(TRXAMOUNT)-SUM(REFUNDAMOUNT) AS TRXAMOUNT,SUM(TRXFEE)-SUM(REFUNDFEE) AS TRXFEE,SUM(FRPCOST) AS INNERCOST,SUM(ACCOUNTINGCOST) AS ACCOUNTINGCOST,
SUM(REFUNDCOUNT) AS REFUNDCOUNT,SUM(REFUNDAMOUNT) AS REFUNDAMOUNT,C.BUSSINESSCATID AS BUSINESSCATID,C.PROVINCE AS CUSTOMERPROVINCE,C.LEVEL AS CUSTOMERLEVEL,
C.BRANCHCOMPANY,D.FEETYPE,D.DATAORIGIN,D.PAYPRODUCT,D.PAYSCENE,D.GOODSCATE,D.PAYTERMINAL
            FROM DAILYTRXSTAT D LEFT JOIN CUSTOMERINFO C ON D.RECEIVERID=C.ID
            LEFT JOIN CUSTOMERRELATIONSHIP R ON R.CUSTOMERID=D.RECEIVERID
            WHERE RECEIVERID IS NOT NULL AND RECEIVERID NOT IN(524857,980067,11219567) AND D.ISCOMPUTEPROFIT=1
            AND D.TYPE NOT IN ('SETTLETRANSF') AND TRXDATE>=${START} AND TRXDATE< ${STOP}
            GROUP BY D.PRODUCT_CODE,D.SALES_PRODUCT_CODE,D.RECEIVERID,D.BIZTYPEID,D.TYPE,R.EMPLOYEEID,C.PRODUCTLINEID,C.AREAID,
            R.ISSELF,R.ISSHARE,R.SHARESCALE,R.TRANSFDATE,C.PRODUCTGROUP,C.BUSSINESSCATID,C.PROVINCE,C.LEVEL,C.BRANCHCOMPANY,D.FEETYPE,
            D.DATAORIGIN,D.PAYPRODUCT,D.PAYSCENE,D.GOODSCATE,D.PAYTERMINAL WITH UR",reportdb
zgtrz,zgtrz,"SELECT COALESCE(CHAR(IDENTITY_NO),'null')||COALESCE(CHAR(DATE(AUTH_DATE)),'null')||'zgtrz' as IDNOUSE,'ZGT' AS DATAORIGIN,YEAR(DATE(AUTH_DATE))*100+MONTH(DATE(AUTH_DATE)) AS MONTH,DATE(AUTH_DATE) AS TRXDATE,
'ZGT' AS PAYPRODUCT,226 AS BIZTYPEID,sum(COST) as ACCOUNTINGCOST,sum(COST) as FRPCOST,
CASE AUTH_TYPE WHEN 'BANKCARD' THEN 'CARDJIANQUAN' ELSE 'RealNameAuth' END AS TYPE,
CASE AUTH_TYPE WHEN 'BANKCARD' THEN 'CARDJIANQUAN' ELSE 'REALNAMEAUTH' END AS ORDERTYPE,
CASE AUTH_TYPE WHEN 'BANKCARD' THEN 'CARDJIANQUAN' ELSE 'REALNAMEAUTH' END AS PAYPROUCT,
CASE AUTH_TYPE WHEN 'BANKCARD' THEN '3011004003002' ELSE '3011004003001' END AS PRODUCT_CODE,
IDENTITY_NO AS RECEIVERID,DATE(AUTH_DATE) AS TRXDATE,COUNT(ID) AS TRXCOUNT,SUM(FEE) AS TRXFEE
FROM ZGT.TBL_AUTH_FEE_RECORD
WHERE FEE_STATUS IN ('SUCCESS')
AND AUTH_DATE >= ${START}
AND AUTH_DATE < ${STOP}
GROUP BY IDENTITY_NO,DATE(AUTH_DATE),AUTH_TYPE
WITH UR",billdb
instantpay,instantpayTrade,"SELECT COALESCE(
    CHAR(merchant_account_code) ,
    'null'
) || COALESCE(
    CHAR(a.product_catalog) ,
    'null'
) || COALESCE(
    CHAR(a.order_origin) ,
    'null'
) || COALESCE(
    CHAR(a.fee_type) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(a.PAY_TIME)
    ) ,
    'null'
) || COALESCE(
    a.CARD_TYPE_ID ,
    'null'
) || COALESCE(
    a.bank_code ,
    'null'
) || COALESCE(
    b.frp_code ,
    'null'
) || 'instantpayTrade' as IDNOUSE ,
'YJZF' as dataorigin ,
'3011001003001' as product_code ,
case when a.order_origin in(
    '6' ,
    '10' ,
    '15'
) then '3011001003001B' else '3011001003001A' end as SALES_PRODUCT_CODE ,
merchant_account_code as RECEIVERID ,
SUM(
    a.ORDER_AMOUNT / 100.00
) AS trxamount ,
SUM(
    a.SELLER_FEE / 100.00
) AS trxfee ,
COUNT(*) AS trxcount ,
SUM(
    a.BANK_COST / 100.00
) AS accountingcost ,
SUM(
    a.BANK_COST / 100.00
) AS frpcost ,
a.product_catalog as goodscate ,
a.order_origin as ordertype ,
case a.fee_type when 1 then 'POSTPAID' else 'PAID' end as feetype ,
DATE(a.PAY_TIME) AS trxdate ,
case a.CARD_TYPE_ID when 1 then 'CREDITCARD' when '2' then 'DEBITCARD' else 'UNKNOWN' end as cardtype ,
a.bank_code ,
b.frp_code as trxchannelid ,
year(a.PAY_TIME) * 100 + month(a.PAY_TIME) as month FROM EWALLET.DATA_PAY_SUCCESS a left join ewallet.pay_biz_order b on a.order_id = b.order_id WHERE a.PAY_TIME >= ${START} AND a.PAY_TIME < ${STOP} and a.order_origin not in(
    11 ,
    24 ,
    25
) and a.merchant_account_code not like 'YB%' GROUP BY merchant_account_code ,
a.product_catalog ,
a.order_origin ,
a.fee_type ,
DATE(a.PAY_TIME) ,
a.CARD_TYPE_ID ,
a.bank_code ,
b.frp_code ,
month(a.PAY_TIME) ,
year(a.PAY_TIME) with ur ",INNO_STANBY
instantpay,instantpaytotal,"SELECT COALESCE(
    CHAR(PB.TRADER_ID) ,
    'null'
) || COALESCE(
    CHAR(pb.ORDER_ORIGIN) ,
    'null'
) || COALESCE(
    CHAR(pb.PRODUCT_CATALOG) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(pb.ORDER_TIME)
    ) ,
    'null'
) || COALESCE(
    PB.frp_code ,
    'null'
) || COALESCE(
    s.bank_code ,
    'null'
) || 'instantpaytotal' as IDNOUSE ,
'YJZF' as dataorigin ,
'3011001003001' as PRODUCT_CODE ,
case when PB.order_origin in(
    '6' ,
    '10' ,
    '15'
) then '3011001003001B' else '3011001003001A' end as SALES_PRODUCT_CODE ,
PB.TRADER_ID as RECEIVERID ,
COUNT(*) as wholeordercount ,
SUM(
    PB.ORDER_AMOUNT / 100.00
) as wholeorderamount ,
pb.ORDER_ORIGIN as ordertype ,
pb.PRODUCT_CATALOG as goodscate ,
DATE(pb.ORDER_TIME) as trxdate ,
PB.frp_code as trxchannelid ,
s.bank_code,year(pb.ORDER_TIME)*100+month(pb.ORDER_TIME) as month 
FROM EWALLET.PAY_BIZ_ORDER AS PB left join ewallet.data_pay_success s on PB.order_id = s.order_id WHERE PB.CREATE_TIME >= ${START} AND PB.CREATE_TIME < ${STOP} and pb.ORDER_ORIGIN not in(
    11 ,
    24 ,
    25
) and PB.TRADER_ID not like 'YB%' GROUP BY PB.TRADER_ID ,
pb.ORDER_ORIGIN ,
pb.PRODUCT_CATALOG ,
DATE(pb.ORDER_TIME) ,
PB.frp_code ,
s.bank_code,month(pb.ORDER_TIME),year(pb.ORDER_TIME) with ur ",INNO_STANBY
instantpay,instantpayrefund,"SELECT COALESCE(
    CHAR(a.merchant_account_code) ,
    'null'
) || COALESCE(
    CHAR(a.product_catalog) ,
    'null'
) || COALESCE(
    CHAR(a.order_origin) ,
    'null'
) || COALESCE(
    CHAR(a.fee_type) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(b.REFUND_ACCOUNT_TIME)
    ) ,
    'null'
) || COALESCE(
    CHAR(pb.frp_code) ,
    'null'
) || COALESCE(
    CHAR(a.bank_code) ,
    'null'
) || 'instantpayrefund' as IDNOUSE ,
'YJZF' as dataorigin ,
'3011001003001' as PRODUCT_CODE ,
case when a.order_origin in(
    '6' ,
    '10' ,
    '15'
) then '3011001003001B' else '3011001003001A' end as SALES_PRODUCT_CODE ,
a.merchant_account_code as RECEIVERID ,
a.product_catalog as goodscate ,
a.order_origin as ordertype ,
case a.fee_type when 1 then 'POSTPAID' else 'PAID' end as feetype ,
DATE(b.REFUND_ACCOUNT_TIME) as trxdate ,
SUM(
    b.refund_money / 100.00
) as refundamount ,
SUM(
    b.return_refund_fee / 100.00
) as refundfee ,
COUNT(b.id) as refundcount ,
pb.frp_code as trxchannelid ,
a.bank_code,
year(b.REFUND_ACCOUNT_TIME)*100+month(b.REFUND_ACCOUNT_TIME) as month 
 FROM EWALLET.DATA_PAY_SUCCESS a LEFT JOIN EWALLET.PAY_REFUND_REQUEST b ON a.order_id = b.customer_order_id left join ewallet.pay_biz_order pb on a.order_id = pb.order_id WHERE b.REFUND_ACCOUNT_TIME >= ${START} AND b.REFUND_ACCOUNT_TIME < ${STOP} AND b.STATUS = 5 and a.order_origin not in(
    11 ,
    24 ,
    25
) and a.merchant_account_code not like 'YB%' GROUP BY a.merchant_account_code ,
a.product_catalog ,
a.order_origin ,
a.fee_type ,
DATE(b.REFUND_ACCOUNT_TIME) ,
pb.frp_code ,
a.bank_code,month(b.REFUND_ACCOUNT_TIME),year(b.REFUND_ACCOUNT_TIME)  with ur",INNO_STANBY
instantpay,instantpaytransform,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
weixin,weixinrefund,"SELECT o.CUSTOMER_NO||char(DATE(r.COMPLETE_TIME))||'wxrefund' as IDNOUSE,year(DATE(r.COMPLETE_TIME))*100+month(DATE(r.COMPLETE_TIME)) as month,DATE(r.COMPLETE_TIME) AS trxdate ,'POSP' as dataorigin,    o.CUSTOMER_NO AS RECEIVERID ,    260 AS biztypeid ,'Sales' as type,'SALES' as ordertype,    '3011001006001' AS product_code ,    '3011001006001A' AS sales_product_code ,    COUNT(*) AS refundcount ,    SUM(r.REFUND_AMOUNT) AS refundamount ,    SUM(r.REFUND_FEE) AS refundfee FROM    poswrite.tbl_mpay_refundrecord r LEFT JOIN poswrite.tbl_mpay_order o        ON r.ORDER_NO = o.ORDER_NO WHERE    r.COMPLETE_TIME >= ${START} AND r.COMPLETE_TIME < ${STOP}    AND o.SOURCE in ('POS','ONLINE','GENERAL')  and o.PLATFORM_TYPE != 'NCTRADE'   AND r.REFUND_STATUS = 'SUCCESS' GROUP BY    o.CUSTOMER_NO ,    DATE(r.COMPLETE_TIME) WITH UR",opendb
weixin,weixintransform,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
rijietong,rijietongtrx,"select char(date(r.COMPLETE_TIME))||'fund'||r.customer_no||coalesce(r.PRODUCT_CODE,'D0WORK')||coalesce(r.BANK,'null')||'rijietongtrx' as IDNOUSE,
    year(date(r.COMPLETE_TIME))*100+month(date(r.COMPLETE_TIME)) as month,date(r.COMPLETE_TIME) as trxdate, r.customer_no as RECEIVERID,
    sum(r.AMOUNT) as trxamount,sum(r.FEE) as trxfee,count(*) as trxcount,coalesce(r.PRODUCT_CODE,'D0WORK') as ordertype,'3011101001001C' as sales_product_code,
    '3011101001001' as product_code,13 as biztypeid,'TRANSFINDAY' as type,'POSP' as dataorigin,'SYSTEM' as usetype,r.BANK as bank_code
    from poswrite.T_TD0_REMITRECORD r where r.COMPLETE_TIME >= ${START} and r.COMPLETE_TIME < ${STOP} and r.STATUS in ('SUCCESS','REFUND')
    group by date(r.COMPLETE_TIME),r.customer_no,coalesce(r.PRODUCT_CODE,'D0WORK'),r.BANK with ur",opendb
rijietong,rijietongrefund,"select char(date(r.REFUND_TIME))||'refund'||r.customer_no||coalesce(r.PRODUCT_CODE,'D0WORK')||coalesce(r.BANK,'null')||'rijietongrefund'  as IDNOUSE,
    year(date(r.REFUND_TIME))*100+month(date(r.REFUND_TIME)) as month, date(r.REFUND_TIME) as trxdate,r.customer_no as RECEIVERID,
    sum(r.AMOUNT) as refundamount,sum(r.FEE) as refundfee, count(*) as refundcount,coalesce(r.PRODUCT_CODE,'D0WORK') as ordertype,'3011101001001C' as sales_product_code,
    '3011101001001' as product_code,13 as biztypeid,'TRANSFINDAY' as type ,'POSP' as dataorigin,'SYSTEM' as usetype,r.BANK as bank_code
    from poswrite.T_TD0_REMITRECORD r where r.REFUND_TIME >= ${START} and r.REFUND_TIME < ${STOP} and r.STATUS = 'REFUND'
    group by date(r.REFUND_TIME),r.customer_no,coalesce(r.PRODUCT_CODE,'D0WORK'),r.BANK  with ur",opendb
rijietong,rijietongtransform,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
importPOSCUSTOMER,importPOSCUSTOMER,"select cu.start_using_time,cu.id,cu.customer_number,CU.INDUSTRY,CU.TYPE,CU.STATUS,CU.REMARK,CU.SPECIAL_CHARGE_TYPE,CF.UPPER_LIMIT,CF.UPPER_LIMIT_FEE,CF.LOWER_LIMIT,CF.LOWER_LIMIT_FEE,CF.RATE,CF.EFFECT_TIME,CF.FIXED_FEE,CF.EXPIRE_TIME,temp2.BANK_CUSTOMER_NUMBER  from tbl_pos_customer cu left join (select customer_number as customer_number,max(id) as id from TBL_POS_CUSTOMERFEERULE where status='ACTIVE' group by customer_number) temp1 on cu.CUSTOMER_NUMBER=temp1.customer_number left join TBL_POS_CUSTOMERFEERULE cf on temp1.id=cf.id left JOIN (select POS_CUSTOMER_NUMBER as customer_number,max(bank_customer_number) as bank_customer_number from TBL_POS_BANKCHANNELCUSTOMER where status='ACTIVE' group by POS_CUSTOMER_NUMBER) temp2 on cu.customer_number=temp2.customer_number with ur",opendb
importTrxStatShareCustomer,trxstatsharecustomer,"select char(CUSTOMERID)||char(SALESID)||char(OPERATORID)||char(MEMO) as IDNOTUSE, ACTIVE, CUSTOMERID, MEMO,  SALESID,sum(SHARESCALE) as SHARESCALE, OPERATORID from ShareCustomer where active = 1 group by CUSTOMERID,ACTIVE,MEMO,SALESID,OPERATORID with ur",COPY2
updateSomeCustomerRelationShip,queryCustomerRelationFromShare,"select char(CUSTOMERID)||char(SALESID) as IDNOTUSE, CUSTOMERID, SALESID as EMPLOYEEID, SHARESCALE, 1 as ISSELF, 1 as ISSHARE, 0 as month from TRXSTATSHARECUSTOMER where active=1 with ur",reportdb
importSalesInfotask,salesinfo,"select e.id,e.name,e.loginUserId,u.userName as loginUserName,e.superior_id as superiorId,e.position_Id as positionId,e.rank,e.company_id as companyId, 0 as MONTH, su.userName as superLoginName,date(e.createDate) as comedate,e.productLine, 3 as productLineId,e.businessCat as businessCatId, 'CHN' as BRANCHCOMPANY,e.email FROM Employee e left join User u on e.loginUserId=u.id left join Employee s on e.superior_id=s.id left join User su on s.loginUserId=su.id with ur",COPY2
importSalesInfotask,companyareamap,"select COMPANYID,AREA from (values(6,'BJ'),(7,'CD'),(8,'NM'),(9,'GZ'),(10,'SH'),(11,'SZ'),(12,'HZ'),(13,'FZ'),(14,'GD'),(15,'NJ'),(16,'JN'),(17,'ZZ'),(18,'WH'),(19,'SY'),(20,'XA'),(21,'CHN')) companyareamap(COMPANYID,AREA) with ur",COPY2
importSalesInfotask,productLineidnamemap,"select PRODUCTLINE, id as PRODUCTLINEID from trxstatcustomerproductline with ur",reportdb
importcustomerrelationship,customerrelationship,"select char(emp_id)||char(cust_id) as IDUNIQUE, emp_id as EMPLOYEEID, cust_id as CUSTOMERID, 1 as ISSELF, 0 as ISSHARE, 1 as SHARESCALE, 0 as MONTH from employee2customer with ur",COPY2
importcustomerrelationship,modifyhismap,"select CUSTOMERID,max(modifytime) as TRANSFDATE, 0 as ISSELF from CustomerModifyHistory where name='SALES' group by customerId with ur",COPY2
customerinfo,customerinfo32,"select 'baiweioutkill20161125' as baiweioutkill20161125,c.id as id,c.active,c.customerNumber,c.fullname,c.groupId,c.shortname,c.createDate,bc.name as businessCat,subBusinessCat,c.area,pf1.value as linkman,pf2.value as webUrl,pf.value as signedName,a.balance as accountBalance,ca.balance as creditBalance,ca.creditLimit,c.bindMobile as mobile,c.phone,date(si.lastsettledate) as lastsettledate, pf3.value as netSigned, c.productGroup,pf4.value as address,bc.id as bussinessCatId,pf5.value as province,si.cycleType as cycletype,si.reserveDays,coalesce(cg.grade,'') as gradelevel, 'NETSIGNED' as customertype,c.customerNumber as MERCHANTNO,a.balancelastupdatedate,cd.DOCUMENTNUMBER as legal_idcard,cd.DESCRIPTION as legal_name,pf6.value as audit_Status,a.status as account_status,r.BANKACTID as settle_bankaccount,r.province as settle_bankprovince,r.city as settle_bankcity,r.branchName as settle_bankbranch,ba.fullname as settle_bankname,r.accountName as settle_accountname,pf7.value as icp,c.customertype as signed_type   from Customer c left join profile pf on c.ID=pf.customer_id and pf.name='p_signedName'  left join profile pf1 on c.id=pf1.customer_id and pf1.name='p_linkman'  left join profile pf2 on c.id=pf2.customer_id and pf2.name='p_customerSiteUrl'  left join profile pf3 on c.id=pf3.customer_id and pf3.name='p_signed'  left join profile pf4 on c.id=pf4.customer_id and pf4.name='p_address'  left join profile pf5 on c.id=pf5.customer_id and pf5.name='p_province'  left join profile pf6 on c.id=pf6.customer_id and pf6.name='p_auditStatus' left join profile pf7 on c.ID=pf7.CUSTOMER_ID and pf7.NAME='p_icp' left join account a on (c.id=a.customer_id and a.classtype='LocalAccount' and a.localAccountType='SVA')  left join CreditAccount ca on (c.id=ca.customerId)  left join settlementinfo si on c.id=si.customer_id left join account r on si.bankAccount_id=r.id and r.classtype='RemoteAccount' left join bank ba on r.bank_id=ba.id left join BusinessCategorie  bc on bc.id=c.businessCat  left join customergradeinfo cg on c.id=cg.customerid and cg.status in ('WAITRESCORE','COMPLETE','NOQUESSCORE') left join customerdocinfo  cd on  (c.CUSTOMERNUMBER=cd.CUSTOMERNUMBER and  cd.DOCUMENTNAME='æ³_ººèº»½è¯')  where c.customerType='ENTERPRISE' and c.customerNumber is not null  with ur",COPY2
customerinfo,posagent,"select b.customer_number as CUSTOMERNUMBER,a.code as AGENTCODE,a.name as AGENTNAME,bt.type as AGENTTYPE from tbl_daili_agent a left join tbl_daili_agentrelation b on a.id=b.agent_id left join TBL_DAILI_AGENTBIZTYPE bt  on a.id=bt.AGENT_ID where b.status='ACTIVE' and b.customer_number is not null with ur",opendb
customerinfo,netagent,"select customer_num as CUSTOMERNUMBER,num as AGENTCODE,name as AGENTNAME,'NET' as AGENTTYPE from agentfr.tbl_agency_relation ar left join agentfr.tbl_agent a on a.id = ar.agent_id where ar.state='ENABLE' and a.agency_state!='STOP' and customer_num is not null with ur",agentfr
customerinfo,posarea,"select c.CUSTOMER_NUMBER as CUSTOMERNUMBER,sheng.NAME as PROVINCE,shi.NAME as CITY from poswrite.TBL_POS_CUSTOMER c left join poswrite.TBL_POS_ORGANIZATION shi on c.ORG_CODE=shi.CODE left join poswrite.TBL_POS_ORGANIZATION sheng on shi.PARENT_CODE=sheng.CODE where c.CUSTOMER_NUMBER is not null with ur",opendb
customerinfo,poscount,"select b.customer_number as CUSTOMERNUMBER, count(*) as POSCOUNT from tbl_pos_pos a, tbl_pos_customer b where a.CUSTOMER_ID=b.id group by b.customer_number having b.customer_number is not null with ur",opendb
customerinfo,vmark,"select CUSTOMERNUMBER CUSTOMERNUMBER, coalesce(CUSTOMERLEVEL,'V') as VMARK from CUSTOMERGRADELEVEL where CUSTOMERNUMBER is not null with ur",COPY2
customerinfo,accmark,"select customerExt.CUSTOMERNUMBER as CUSTOMERNUMBER,customerExt.PERFORMANCE_ATTRIBUTE as ACCMARK from SIGNING.TBL_CUSTOMER_EXT customerExt,SIGNING.TBL_PERFORMANCE_ATTRIBUTE attribute  where customerExt.PERFORMANCE_ATTRIBUTE=attribute.ATTRIBUTE_CODE and customerExt.customernumber is not null and customerExt.PERFORMANCE_ATTRIBUTE != '5' with ur",BOSS
customerinfo,merchantno,"SELECT b.MERCHANT_NO as CUSTOMERNUMBER,a.sn as MERCHANTNO from SIGNING.tbl_yp_cus_info a , SIGNING.TBL_YP_CUS_MER_RELATION b where a.ID=b.TBL_YP_CUS_INFOID",BOSS
customerinfo,productgroupzgt,"select CUSTOMERNUMBER, 'ZGT' as PRODUCTGROUP from customerext c left join customer cu on c.id=cu.id where c.zgt=1 and customernumber is not null with ur",COPY2
customerinfo,productgrouptouzitong,"select MERCHANT_ACCOUNT_CODE as CUSTOMERNUMBER, 'TOUZITONG' as PRODUCTGROUP from EWALLET.merchant_to_goods where goods_id in(18,30) and MERCHANT_ACCOUNT_CODE is not null with ur",INNO
customerinfo,productgroupshoukuanbao,"select distinct(MAINCUSTOMERNUMBER) as CUSTOMERNUMBER, 'SHOUKUANBAO' as PRODUCTGROUP from SKB.TBL_SKB_REGISTER union all select LEDGECUSTOMERNUMBER as CUSTOMERNUMBER, 'SHOUKUANBAO' as PRODUCTGROUP from SKB.TBL_SKB_REGISTER with ur",accnt
customerinfo,branchcompany,"SELECT s.cust_id as CUSTOMERID, e.branchcompany as BRANCHCOMPANY FROM EmployeeInfo e LEFT JOIN employee2customer s ON e.id = s.emp_id WHERE s.cust_id IN(SELECT customerid FROM customerrelationship) with ur",reportdb
customerinfo,relegation,"select CUSTOMER_NUMBER as CUSTOMERNUMBER, 'OFFLINE' as RELEGATION from poswrite.tbl_pos_customer with ur",opendb
customerinfo,customertype,"select CUSTOMER_ID,'ENTERPRISE' as CUSTOMERTYPE from PROFILE where name = 'p_signed' and value = '1' and value is not null with ur",COPY2
shxxkb,shxxkb1,"select CUSTOMER_NUMBER,FULL_NAME,SHORT_NAME,SIGNED_NAME,CREATE_TIME,AGENT_CODE,AGENT_NAME,ADDRESS,LINKMAN,POSCOUNT,BRANCH_COMPANY,BUSINESSCAT,SALES_ID,SALES_NAME,RELEGATION,GRADELEVEL,PROVINCE,CITY,STATUS,PRODUCTGROUP,PHONE,WEBURL,SIGNED_TIME,START_USING_TIME,CUSTOMER_TYPE,MCC_CODE,LAST_TRXTIME,CLOSE_TIME,AGENTRELATION_STATUS,BANK_CUSTOMER_NUMBER,BINDSTATUS,BINDTIME,UNBINDTIME,BUSI_LICENSE,LEGAL_NAME,LEGAL_IDCARD,REALNAME_STATUS,BANK_CODE,BANK_ACCOUNT_NAME,POS_FEERATE,SIGNED_TYPE,TRX_REGION_CODE,BANK_ACCOUNT_NUM,BANK_ACCOUNT_PROVINCE,BANK_ACCOUNT_CITY,POS_TRX_STATUS,POS_UPPER_LIMIT,POS_UPPER_LIMIT_FEE,POS_LOWER_LIMIT,POS_LOWER_LIMIT_FEE,POS_REMARK,POS_BANK_PRODUCT,POS_PRODUCT,POS_FAVOUR_REGION,POS_MCC_NAME,POS_CUSTOMER_CN_NAME,POS_TRXCUSTOMER_TYPE,SETTLE_ACCOUNT_TYPE,BUSINESS_SCOPE,FILE_NO,INVOICE_FINANCIAL_CONTACT,INVOICE_PHONE,INVOICE_TITLEFORTRADE,INVOICE_ADDRESS ,INVOICE_POSTCODE,INVOICE_UPDATEOPERATOR,INVOICE_UPDATEDATE,GRADE_UPDATEDATE ,AGENT_PHONE,MOBILE,CUSTOMERLEVEL from customer_info limit 0,350000",bigdata_report
shxxkb,shxxkb2,"select CUSTOMER_NUMBER,FULL_NAME,SHORT_NAME,SIGNED_NAME,CREATE_TIME,AGENT_CODE,AGENT_NAME,ADDRESS,LINKMAN,POSCOUNT,BRANCH_COMPANY,BUSINESSCAT,SALES_ID,SALES_NAME,RELEGATION,GRADELEVEL,PROVINCE,CITY,STATUS,PRODUCTGROUP,PHONE,WEBURL,SIGNED_TIME,START_USING_TIME,CUSTOMER_TYPE,MCC_CODE,LAST_TRXTIME,CLOSE_TIME,AGENTRELATION_STATUS,BANK_CUSTOMER_NUMBER,BINDSTATUS,BINDTIME,UNBINDTIME,BUSI_LICENSE,LEGAL_NAME,LEGAL_IDCARD,REALNAME_STATUS,BANK_CODE,BANK_ACCOUNT_NAME,POS_FEERATE,SIGNED_TYPE,TRX_REGION_CODE,BANK_ACCOUNT_NUM,BANK_ACCOUNT_PROVINCE,BANK_ACCOUNT_CITY,POS_TRX_STATUS,POS_UPPER_LIMIT,POS_UPPER_LIMIT_FEE,POS_LOWER_LIMIT,POS_LOWER_LIMIT_FEE,POS_REMARK,POS_BANK_PRODUCT,POS_PRODUCT,POS_FAVOUR_REGION,POS_MCC_NAME,POS_CUSTOMER_CN_NAME,POS_TRXCUSTOMER_TYPE,SETTLE_ACCOUNT_TYPE,BUSINESS_SCOPE,FILE_NO,INVOICE_FINANCIAL_CONTACT,INVOICE_PHONE,INVOICE_TITLEFORTRADE,INVOICE_ADDRESS ,INVOICE_POSTCODE,INVOICE_UPDATEOPERATOR,INVOICE_UPDATEDATE,GRADE_UPDATEDATE ,AGENT_PHONE,MOBILE,CUSTOMERLEVEL from customer_info limit 350000,350000",bigdata_report
shxxkb,shxxkb3,"select CUSTOMER_NUMBER,FULL_NAME,SHORT_NAME,SIGNED_NAME,CREATE_TIME,AGENT_CODE,AGENT_NAME,ADDRESS,LINKMAN,POSCOUNT,BRANCH_COMPANY,BUSINESSCAT,SALES_ID,SALES_NAME,RELEGATION,GRADELEVEL,PROVINCE,CITY,STATUS,PRODUCTGROUP,PHONE,WEBURL,SIGNED_TIME,START_USING_TIME,CUSTOMER_TYPE,MCC_CODE,LAST_TRXTIME,CLOSE_TIME,AGENTRELATION_STATUS,BANK_CUSTOMER_NUMBER,BINDSTATUS,BINDTIME,UNBINDTIME,BUSI_LICENSE,LEGAL_NAME,LEGAL_IDCARD,REALNAME_STATUS,BANK_CODE,BANK_ACCOUNT_NAME,POS_FEERATE,SIGNED_TYPE,TRX_REGION_CODE,BANK_ACCOUNT_NUM,BANK_ACCOUNT_PROVINCE,BANK_ACCOUNT_CITY,POS_TRX_STATUS,POS_UPPER_LIMIT,POS_UPPER_LIMIT_FEE,POS_LOWER_LIMIT,POS_LOWER_LIMIT_FEE,POS_REMARK,POS_BANK_PRODUCT,POS_PRODUCT,POS_FAVOUR_REGION,POS_MCC_NAME,POS_CUSTOMER_CN_NAME,POS_TRXCUSTOMER_TYPE,SETTLE_ACCOUNT_TYPE,BUSINESS_SCOPE,FILE_NO,INVOICE_FINANCIAL_CONTACT,INVOICE_PHONE,INVOICE_TITLEFORTRADE,INVOICE_ADDRESS ,INVOICE_POSTCODE,INVOICE_UPDATEOPERATOR,INVOICE_UPDATEDATE,GRADE_UPDATEDATE ,AGENT_PHONE,MOBILE,CUSTOMERLEVEL from customer_info limit 700000,1500000",bigdata_report
taskTest,taskTest,"SELECT ID , NAME , AMOUNT, PRODUCTLINEID,LASTSETTLEDATE FROM ETL_TEST_FROM",reportdb
yjzfpzsjTest,successcount,"select COALESCE(CHAR(date(payo.CREATE_TIME)),'null')||COALESCE(CHAR(hour(payo.CREATE_TIME)),'null')||COALESCE(CHAR(minute(payo.CREATE_TIME)),'null')||COALESCE(CHAR(minute(payo.CREATE_TIME)/5),'null')||COALESCE(CHAR(apip.CARD_CATALOG),'null')||'successcount' as IDNOUSE,date(payo.CREATE_TIME) as trxdate,hour(payo.CREATE_TIME) as trxhour,minute(payo.CREATE_TIME) as trxmin,minute(payo.CREATE_TIME)/5 as trx5min,
apip.CARD_CATALOG as cardtype,count(*) as succcount 
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP} and payo. ORDER_STATE = 1
and apio.API_TYPE in (5,6,10)
group by date(payo.CREATE_TIME),hour(payo.CREATE_TIME),minute(payo.CREATE_TIME),minute(payo.CREATE_TIME)/5,apip.CARD_CATALOG
order by date(payo.CREATE_TIME),hour(payo.CREATE_TIME),minute(payo.CREATE_TIME),minute(payo.CREATE_TIME)/5,apip.CARD_CATALOG",INNO_STANBY
yjzfpzsjTest,totalcount,"select COALESCE(CHAR(date(payo.CREATE_TIME)),'null')||COALESCE(CHAR(hour(payo.CREATE_TIME)),'null')||COALESCE(CHAR(minute(payo.CREATE_TIME)),'null')||COALESCE(CHAR(minute(payo.CREATE_TIME)/5),'null')||COALESCE(CHAR(apip.CARD_CATALOG),'null')||'totalcount' as IDNOUSE,date(payo.CREATE_TIME) trxdate,hour(payo.CREATE_TIME) trxhour,minute(payo.CREATE_TIME) trxmin,minute(payo.CREATE_TIME)/5 trx5min,
apip.CARD_CATALOG cardtype,count(*) wholecount
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (5,6,10)
group by date(payo.CREATE_TIME),hour(payo.CREATE_TIME),minute(payo.CREATE_TIME),minute(payo.CREATE_TIME)/5,apip.CARD_CATALOG
order by date(payo.CREATE_TIME),hour(payo.CREATE_TIME),minute(payo.CREATE_TIME),minute(payo.CREATE_TIME)/5,apip.CARD_CATALOG",INNO_STANBY
yjzfpzsjTest,failcount,"select COALESCE(CHAR(date(payo.CREATE_TIME)),'null')||COALESCE(CHAR(hour(payo.CREATE_TIME)),'null')||COALESCE(CHAR(minute(payo.CREATE_TIME)),'null')||COALESCE(CHAR(minute(payo.CREATE_TIME)/5),'null')||COALESCE(CHAR(apip.CARD_CATALOG),'null')||'failcount' as IDNOUSE,date(payo.CREATE_TIME) trxdate,hour(payo.CREATE_TIME) trxhour,minute(payo.CREATE_TIME) trxmin,minute(payo.CREATE_TIME)/5 trx5min,
apip.CARD_CATALOG cardtype,count(*) cufailcount
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (5,6,10)
and apip.ERROR_CODE in ('100048','100057','100228','100234','100235','100236','100248','411138','411151','411152','411155')
group by date(payo.CREATE_TIME),hour(payo.CREATE_TIME),minute(payo.CREATE_TIME),minute(payo.CREATE_TIME)/5,apip.CARD_CATALOG
order by date(payo.CREATE_TIME),hour(payo.CREATE_TIME),minute(payo.CREATE_TIME),minute(payo.CREATE_TIME)/5,apip.CARD_CATALOG",INNO_STANBY
yjzfpzsjrate,yjzfpzsjrate,"select COALESCE(CHAR(trxdate),'null')||COALESCE(CHAR(trxhour),'null')||COALESCE(CHAR(trx5min*5),'null')||COALESCE(CHAR(cardtype),'null')||'yjzfpzsjrate' as IDNOUSE,trxdate,trxhour,trx5min,wholecount,cardtype,
succcount*1.0000/(wholecount-cufailcount) as trxrate
from (
select trxdate,trxhour,trx5min*5 as trx5min,sum(coalesce(succcount,0)) as succcount,sum(coalesce(wholecount,0)) as wholecount,sum(coalesce(cufailcount,0)) as cufailcount,cardtype
from db2inst1.temp_yijianapipinzhi 
where TRXDATE = ${START} 
group by trxdate,trxhour,trx5min*5,cardtype
)
where wholecount>cufailcount with ur ",reportdb
customer2achievement,customer2achievement,"SELECT
ID as id,
CUSTOMER_NUMBER as CUSTOMER_NUMBER,
ATTRIBUTE_ID as ACHIEVEMENT_ID,
PERCENT as PERCENT,
CREATE_TIME as CREATE_TIME
FROM
SIGNING.TBL_CUSTOMER_PERFORMANCE_ATTRIBUTE",BOSS
qiaobao,qiaobao,"SELECT
	ID,
	AGENT_NO ,
	MEMBER_NO ,
	MCC ,
	ID_CARD_NO ,
	BANK_LAST_NO as CARD_INFO,
CREATE_DATE as ORDER_DATE,
	AMOUNT as ORDER_AMOUNT,
	CARD_INFO_TYPE
FROM
	ZGT.TBL_TRXORDER
WHERE
	AGENT_NO='10012034088' AND
	COMPLETE_DATE >= ${START} AND 
	COMPLETE_DATE < ${STOP} AND
	STATUS='SUCCESS' AND
	CARD_INFO_TYPE in ('TEMP','BIND')",billdb
nonbank,nonbank,"select ID,OPTIMISTIC as VERSION,ACCOUNTNO as CARD_NO,ACCOUNTPWD as CARD_PWD,BALANCE as BANLANCE,BALANCELASTUPDATEDATE as LAST_UPDATE_DATE,CREATEDATE as CREATE_DATE ,BANKID as CARD_TYPE,ACTIVE as VALID_STATUS,TIMEOUT as TIMEOUT_DATE,RESETFLAG as RESET_COUNT,CARDID as  CONSUME_CARD_ID,FIRSTBALANCE as FIRST_BALANCE,BENEFITTYPE as BENEFIT_AMOUNT,BENEFITAMOUNT as BENEFIT_TYPE 
	from  MOBILEBE.STOREACCOUNT with ur",qaetl
nonbank1,nonbank1,"select ID,ACCOUNTPWD as CARD_PWD,CREATEDATE as CREATE_DATE from  MOBILEBE.STOREACCOUNT where CREATEDATE <= ${STOP} and BALANCE >0 and ACTIVE=1 and TIMEOUT >= '2016-04-13 00:00:00' with ur",mobile_sc
nonbank2,nonbank2,"select ID,ACCOUNTPWD as CARD_PWD,CREATEDATE as CREATE_DATE from  MOBILEBE.STOREACCOUNT where id in (8555550,9020774,9127772,9198857,9213583,9214413,9214591,9215403,9215491,9215622,9215759,9216153,9217654,9217693,9217733,9218742,9219260,9219875,9219952,9219997,9220739,9220816,9222050,9222180,9222669,9222694,9222762)",mobile_sc
nonbank3,nonbank3,"select ID,OPTIMISTIC as VERSION,ACCOUNTNO as CARD_NO,ACCOUNTPWD as CARD_PWD,BALANCE as BANLANCE,BALANCELASTUPDATEDATE as LAST_UPDATE_DATE,CREATEDATE as CREATE_DATE ,
		CASE BANKID
		WHEN 'JUNNET' THEN 'JW'
		WHEN 'SNDACARD' THEN 'SD'
		WHEN 'SZX' THEN 'MOBILE'
		WHEN 'ZHENGTU' THEN 'ZT'
		WHEN 'QQCARD' THEN 'QQ'
		WHEN 'UNICOM' THEN 'UNICOM'
		WHEN 'JIUYOU' THEN 'JY'
		WHEN 'NETEASE' THEN 'WY'
		WHEN 'WANMEI' THEN 'WM'
		WHEN 'SOHU' THEN 'SH'
		WHEN 'TELECOM' THEN 'TELECOM'
		WHEN 'ZONGYOU' THEN 'ZY'
		WHEN 'TIANXIA' THEN 'TX'
		WHEN 'TIANHONG' THEN 'TH'
		WHEN 'THIRTYTWOCARD' THEN 'CARDTW'
		WHEN 'YICHONGCARD' THEN 'YC'
		WHEN 'YICHONGTIANHONGCARD' THEN 'YCTH'
		WHEN 'YICHONGZONGYOUCARD' THEN 'YCZY'
		WHEN 'YICHONGTHIRTYTWOCARD' THEN 'YCCARDTW'
		WHEN 'JUNCARDHUAFEITONG' THEN 'JKHFT'
		WHEN 'ZYZC' THEN 'ZYZC'
		ELSE 'UNKNOWN'
		END as CARD_TYPE,
		'VALID' as VALID_STATUS,TIMEOUT as TIMEOUT_DATE,RESETFLAG as RESET_COUNT,CARDID as  CONSUME_CARD_ID,FIRSTBALANCE as FIRST_BALANCE,BENEFITTYPE as BENEFIT_TYPE,BENEFITAMOUNT as BENEFIT_AMOUNT,0 as FEE,0 as COST
from  MOBILEBE.STOREACCOUNT
where  TIMEOUT >= '2016-04-13 00:00:00' and BALANCE >0 and ACTIVE=1  with ur",mobile_sc
zxqianbaohyxx,zxqianbaohyxx,"select m.member_no,m.create_date ,r. ACCOUNT_NO ,m.REAL_NAME , ci.VOCATION ,adr. ADDRESS,id. IDENTIFICATION_NO_CIPHER as IDCARDNO,
m.REG_TYPE , m.CA_STATUS,
m.level as risklevel
,m.BIND_MOBILE_NO as MOBILE, m.BIND_EMAIL as EMAIL
from  MEMBER.tbl_member m
left join MEMBER.TBL_MEMBER_ADDRESS  adr on m.member_no = adr.member_no
left join MEMBER.TBL_MEMBER_BANKCARD bankCard on bankCard.member_no = m.member_no
left join MEMBER.TBL_MEMBER_CONTACT_INFO ci on ci.member_no = m.member_no
left join MEMBER.TBL_MEMBER_IDENTIFICATION id on id.member_no = m.member_no
left join MEMBER.TBL_MEMBER_ACCOUNT_R r on r.member_no = m.member_no
where m.member_type = 'PLATFORM'
and m.create_date=${START}",member
zxqianbaobkxx,zxqianbaobkxx,"select t.id,ti.card_no,ti.card_type,ti.bank_name,ti.bank_code,ti.owner,ti.idcard,ti.province,ti.city,ti.bank_mobile,ti.STATUS,ti.CREATE_TIME,ti.UPDATE_TIME from MEMBER.TBL_CWH_BIND_CARD t left join MEMBER.TBL_CWH_BANK_CARD_INFO ti on t.card_id=ti.id  where ti.CREATE_TIME >= ${START} and ti.CREATE_TIME < ${STOP}",member
etltimestamp,etltimestamp,"SELECT
	id,
	name,
CREATE_TIME
FROM
	bigdata_report.etl_timestamp",bigdata_report
zxqianbaojylsxx,zxqianbaojylsxx,"select  REQUEST_NO,AGENT_NO as customer_number,MEMBER_NO ,MCC  ,BANK_LAST_NO ,CREATE_DATE ,AMOUNT,COMPLETE_DATE,CARD_INFO_ID,CARD_INFO_TYPE,IP,ERROR_MSG from ZGT.TBL_TRXORDER  where AGENT_NO='10012034088'  and COMPLETE_DATE >= ${START} and  COMPLETE_DATE < ${STOP} and STATUS='SUCCESS'",billdb
phoenixtest,phoenixtest,"SELECT id,sourceId,taskId,colNameType,extractorType,isActive,isTypeCleanNeeded,create_time,etltaskid FROM econf_test_hour where CREATE_TIME >= ${START} and CREATE_TIME < ${STOP}",bigdata_report
trxorderdo,trxorderdo,"SELECT COALESCE(CHAR(rece.customernumber),'null')||COALESCE(CHAR(o.orderdate),'null')||COALESCE(CHAR(o.id),'null') as IDNOUSE,rece.customernumber AS RECEIVER_CUSTNO, o.orderdate AS CREATE_ORDER_TIME,o.id AS ID, o.requestid AS REQUEST_ID, p.bankorderid AS BANKORDER_ID, o.externalid AS EXTERNAL_ID, o.payermobile AS PAYER_MOBILE, o.amount AS ORDER_AMOUNT, p.sourcefee AS SOURCE_FEE, p.targetfee AS RECEIVER_FEE, p.frp_id AS FRP_ID, -p.targetAmount AS TRX_AMOUNT, -p.targetAmount-targetfee AS REAL_AMOUNT, o.status AS ORDER_STATUS, o.closedate AS COMPLETE_TIME, f.channel AS BIZ_TYPE, b.fullname AS TRX_CHANNEL, r.refundamount AS REFUND_AMOUNT, o.productname AS PRODUCT_NAME, o.productcat AS PRODUCT_CAT, o.tempinfo AS TEMP_INFO, o.receiver_id AS RECEIVER_ID, o.refund AS REFUND_STATUS, o.productdesc AS PRODUCT_DESC, df.username AS USER_NAME, df.address AS USER_ADDRESS, payer.FULLNAME AS PAYER_NAME, payer.customernumber AS PAYER_CUSTNO, rece.fullname AS RECEIVER_NAME, df.postalcode AS PAYER_POSTALCODE, df.teleno AS PAYER_TELENO, df.email AS PAYER_EMAIL, df.leavemessage AS PAYER_LEAVE_MESSAGE, df.invoicetitle AS PAYER_INVOICETITLE, o.orderoper AS ORDER_OPERATOR, user.uniquename AS USER_LOGIN_NAME, toe.pnr AS AIR_PNR, toe.ticketnumberstart AS TICKETNUM_START,toe.ticketnumberend as TICKETNUM_END  from TRXORDER o  left join PAYMENT p on o.id=p.trxorder_id  left join FRP f on p.frp_id=f.id  left join REFUNDRECORD r on r.orderId=o.id  left join DELIVERINFO df on o.deliverinfo_id=df.id  left join TRXORDEREXT toe on toe.id = o.id  left join USER user on p.operatorid = user.id  left join BANK b on f.bank_id = b.id  left join CUSTOMER payer on o.PAYER_ID=payer.id  left join CUSTOMER rece on o.RECEIVER_ID = rece.id where  p.TRXSTATUS = 'SUCCESS' AND p.TRXTYPE != 'REFUND' AND o.CLOSEDATE >= ${START} and o.CLOSEDATE < ${STOP} ",COPY2
hldzxq,hldzxq,"select coalesce(char(t.receiver_id),'null')||coalesce(char(p.CONFIRMORCANCEL),'null')||coalesce(char(p.requestId),'null') as IDNOUSE,t.receiver_id,p.CONFIRMORCANCEL,p.requestId, p.externalId,a.account_id,
c.id as splitid, p.trxDate, p.orderAmount, p.productName, c.splitStatus, c.billdetails, t.tempinfo, p.bankOrderId,
f.bank_id ||'-'||f.channel as externalfrp, p.frpid, t.closedate, f.channel,
t.orderoper, t.amount as trxOrderAmount, pm.sourceamount as amount, ABS(COALESCE(p.target_fee, 0)) as targetFee, t.status, 0 as rtargetFee, 'SALES' as orderType, t.productCat, t.productDesc, t.extendInfo, t.orderType as trxordertype, p.trxType,
CASE WHEN rp.id is not null THEN 'SUCCESS' END as revocationStatus, rp.trxStatus as rpStatus, a.trxDate as ahTrxDate,
a.historyType as ahHistoryType,a.trxAmount as ahTrxAmount,a.bizType as ahBizType, a.description as ahDescription,
cci.customerTerminalCode as customerTerminalCode,a.CREATEDATE 
from accountHistory a
left join PublishedTrx p  on a.trxId = p.id 
left join payment pm on pm.id = p.id 
left join trxorder t on p.orderid=t.id 
left join complexorder c on p.externalid=c.externalid  
left join frp f on p.frpid=f.id  
left join RevocationPayment rp on rp.originalTrx_id = pm.id and rp.revocation_flg <> rp.id  
left join creditcardinfo cci on cci.charid = pm.extinfo  
where 
p.CONFIRMORCANCEL >= ${START} and p.CONFIRMORCANCEL < ${STOP}  
and p.orderType<>'MERCHANT_SETTLE'   
and pm.trxStatus = 'SUCCESS' 
with ur",COPY2
qianbaodailytrx,qianbaodailytrx,"select 
  COALESCE(CHAR(ORDER_TYPE),'null')||
  COALESCE(CHAR(BIZ),'null')||
  COALESCE(CHAR(INDUSTRY_CODE),'null')||
  COALESCE(CHAR(MERCHANT_NO),'null')||
  COALESCE(CHAR(MEMBER_TYPE),'null')||
  COALESCE(CHAR(date(CREATE_TIME)),'null')||
  COALESCE(CHAR(BANK_CODE),'null')||
  COALESCE(CHAR(CARD_TYPE),'null')||
  COALESCE(CHAR(FRP_CODE),'null')||
  COALESCE(CHAR(TRADE_ERROR),'null')||
  COALESCE(CHAR(TRADE_MSG),'null')||
  COALESCE(CHAR(BANK_STATE),'null')||
  COALESCE(CHAR(BANK_ERROR),'null')||
  COALESCE(CHAR(BANK_MSG),'null')||
  COALESCE(CHAR(PAY_CARDINFO_TYPE),'null')||
  COALESCE(CHAR(GOODS_CODE),'null')||
  COALESCE(CHAR(ERROR_CODE),'null')||
  COALESCE(CHAR(ERROR_MSG),'null') as IDNOUSE,
  ORDER_TYPE,BIZ,INDUSTRY_CODE,MERCHANT_NO,MEMBER_TYPE,date(CREATE_TIME) as trxdate,BANK_CODE,
  CARD_TYPE,FRP_CODE,TRADE_ERROR, TRADE_MSG,BANK_STATE,BANK_ERROR,BANK_MSG,
  PAY_CARDINFO_TYPE,GOODS_CODE,ERROR_CODE,ERROR_MSG,
  sum(PAYER_FEE) as SUM_PAYER_FEE,sum(REAL_AMOUNT) as SUM_REAL_AMOUNT,sum(COST) as SUM_COST,
  count(*) as SUM_COUNT, 
  sum(case when state = 'FAILURE' then 1 else 0 end) as SUM_FAIL_COUNT, 
  sum(case when state = 'SUCCESS' then 1 else 0 end) as SUM_SUCC_COUNT,  
  sum(case when state not in ('FAILURE','DOING','REVERSE','INIT','FAULT_REFUND','SUCCESS')  then 1 else 0 end) as SUM_OTHER_COUNT ,
  sum(case when state = 'DOING' then 1 else 0 end) as SUM_DOING_COUNT, 
  sum(case when state = 'REVERSE' then 1 else 0 end) as SUM_REVERSE_COUNT, 
  sum(case when state = 'INIT' then 1 else 0 end) as SUM_INIT_COUNT, 
  sum(case when state = 'FAULT_REFUND' then 1 else 0 end) as SUM_FAULT_REFUND_COUNT, 
  sum(ORDER_AMOUNT) as SUM_AMOUNT, 
  sum(case when state = 'FAILURE' then ORDER_AMOUNT else 0 end) as SUM_FAIL_AMOUNT, 
  sum(case when state = 'SUCCESS' then ORDER_AMOUNT else 0 end) as SUM_SUCC_AMOUNT,
  sum(case when state not in ('FAILURE','DOING','REVERSE','INIT','FAULT_REFUND','SUCCESS') then ORDER_AMOUNT else 0 end) as SUM_OTHER_AMOUNT, 
  sum(case when state = 'DOING' then ORDER_AMOUNT else 0 end) as SUM_DOING_AMOUNT, 
  sum(case when state = 'REVERSE' then ORDER_AMOUNT else 0 end) as SUM_REVERSE_AMOUNT, 
  sum(case when state = 'INIT' then ORDER_AMOUNT else 0 end) as SUM_INIT_AMOUNT, 
  sum(case when state = 'FAULT_REFUND' then ORDER_AMOUNT else 0 end) as SUM_FAULT_REFUND_AMOUNT
from NCC.TBL_NC_PAY_ORDER
  where CREATE_TIME >= ${START} and CREATE_TIME < ${STOP}
group by 
  ORDER_TYPE,BIZ,INDUSTRY_CODE,MERCHANT_NO,MEMBER_TYPE,date(CREATE_TIME),BANK_CODE,
  CARD_TYPE,FRP_CODE,TRADE_ERROR, TRADE_MSG,BANK_STATE,BANK_ERROR,BANK_MSG,
 PAY_CARDINFO_TYPE,GOODS_CODE,ERROR_CODE,ERROR_MSG
with ur",INNO
authstat,authstat,"select                                                                                                                           
   COALESCE(CHAR(ob.SYSTEM_ID),'null')||                                                                  
   COALESCE(CHAR(ob.REQUEST_CUSTOMER_ID),'null')||                                                        
   COALESCE(CHAR(ob.AUTH_TYPE),'null')||                                                                  
   COALESCE(CHAR(ob.BANK_CODE),'null')||                                                                  
   COALESCE(CHAR(ob.PROVINCE),'null')||                                                                   
   COALESCE(CHAR(ob.CITY),'null')||                                                                       
   COALESCE(CHAR(ob.BANKCARD_TYPE),'null')||                                                              
   COALESCE(CHAR(ob.AUTH_INTERFACE_ID),'null')||                                                          
   COALESCE(CHAR(ob.REQUEST_DATE),'null')||                                                               
   COALESCE(CHAR(ob.RETURN_CODE),'null')||                                                                
   COALESCE(CHAR(ob.RETURN_MSG),'null')||                                                                 
   COALESCE(CHAR(ds.SYSTEM_CODE),'null')||                                                                
   COALESCE(CHAR(ds.SYSTEM_NAME),'null') as IDNOUSE,                                                       
   ob.SYSTEM_ID,ob.REQUEST_CUSTOMER_ID,ob.AUTH_TYPE,ob.BANK_CODE,ob.PROVINCE,ob.CITY,ob.BANKCARD_TYPE,     
   ob.AUTH_INTERFACE_ID,ob.REQUEST_DATE,                                                                 
   ob.RETURN_CODE,ob.RETURN_MSG,ds.SYSTEM_CODE,ds.SYSTEM_NAME,                                          
   sum(ob.fee) as FEE,sum(ob.cost) as COST,                                                             
   sum(case when ob.auth_status = 'SUCCESS' then 1 else 0 end) as SUCC_COUNT,                           
   sum(case when ob.auth_status = 'FAILURE' then 1 else 0 end) as FAIL_COUNT,                           
   sum(case when ob.auth_status = 'NOT_AUTH' then 1 else 0 end) as OTHER_COUNT,                         
   sum(case when 1=1 then 1 else 0 end) as TOTAL_COUNT                                                  
from AUTH2.TBL_ORDER_BANKCARD_VIEW  ob                                                                             
   left join AUTH2.TBL_DOCKING_SYSTEM   ds on ob.SYSTEM_ID=ds.ID                                              
   where  ob.REQUEST_DATE >= ${START} and ob.REQUEST_DATE<${STOP}                                              
group by                                                                                                
     ob.SYSTEM_ID,ob.REQUEST_CUSTOMER_ID,ob.AUTH_TYPE,ob.BANK_CODE,ob.PROVINCE,ob.CITY,ob.BANKCARD_TYPE,
     ob.AUTH_INTERFACE_ID,ob.REQUEST_DATE, ob.RETURN_CODE,ob.RETURN_MSG,ds.SYSTEM_CODE,ds.SYSTEM_NAME   
with ur   ",basic
zxqianbaohyxxnew,zxqianbaohyxxnew,"select COALESCE(m.member_no,'null')||COALESCE(m.create_date,date('2029-09-09'))||COALESCE(r.ACCOUNT_NO,'null')||COALESCE(m.REAL_NAME,'null')||COALESCE(ci.VOCATION,'null')||COALESCE(adr.ADDRESS,'null')||COALESCE(id.IDENTIFICATION_NO_CIPHER,'null')||COALESCE(m.REG_TYPE,'null')||COALESCE(m.CA_STATUS,'null')||COALESCE(m.level,'null')||COALESCE(m.BIND_MOBILE_NO,'null')||COALESCE(m.BIND_EMAIL,'null')||COALESCE(m.CREDENTIALS_NO,'null')||COALESCE(m.MEMBER_TYPE,'null')||COALESCE(m.PLATFORM_ID,'null')||COALESCE(date(id.CREATE_DATE),date('2029-09-09')) as IDNOUSE,
m.member_no,m.create_date as REGISTERDATE,r. ACCOUNT_NO,m.REAL_NAME, ci.VOCATION,adr. ADDRESS,id. IDENTIFICATION_NO_CIPHER as IDCARDNO,
m.REG_TYPE , m.CA_STATUS,
m.level as risklevel
,m.BIND_MOBILE_NO as MOBILE, m.BIND_EMAIL as EMAIL,
m.CREDENTIALS_NO,m.MEMBER_TYPE,m.PLATFORM_ID,date(id.CREATE_DATE) as VERIFYDATE 
from  MEMBER.tbl_member m
left join MEMBER.TBL_MEMBER_ADDRESS  adr on m.member_no = adr.member_no
left join MEMBER.TBL_MEMBER_BANKCARD bankCard on m.member_no = bankCard.member_no
left join MEMBER.TBL_MEMBER_CONTACT_INFO ci on m.member_no = ci.member_no
left join MEMBER.TBL_MEMBER_IDENTIFICATION id on m.member_no = id.member_no
left join MEMBER.TBL_MEMBER_ACCOUNT_R r on m.member_no = r.member_no
where m.member_type = 'PLATFORM'
and id.CREATE_DATE>= ${START} and id.CREATE_DATE< ${STOP}
group by  m.member_no,m.create_date,r. ACCOUNT_NO,m.REAL_NAME, ci.VOCATION,adr. ADDRESS,id. IDENTIFICATION_NO_CIPHER,
m.REG_TYPE , m.CA_STATUS,
m.level,m.BIND_MOBILE_NO, m.BIND_EMAIL,
m.CREDENTIALS_NO,m.MEMBER_TYPE,m.PLATFORM_ID,date(id.CREATE_DATE)
with ur",member
tblorderbankcard,tblorderbankcard,"select COALESCE(CHAR(IDCARD_NUMBER),'null')||COALESCE(CHAR(BANKCARD_NUMBER),'null')||COALESCE(CHAR(NAME),'null')||COALESCE(CHAR(BIND_MOBILE),'null') as IDNOUSE,AUTH_DATE,IDCARD_NUMBER as IDCARD,IDCARD_NUMBER as IDCARD1,IDCARD_NUMBER as IDCARD2,BANKCARD_NUMBER as BANKCARD,BANKCARD_NUMBER as BANKCARD1,BANKCARD_NUMBER as BANKCARD2,NAME as REALNAME,NAME as REALNAME1,NAME as REALNAME2,BIND_MOBILE as MOBILE,BIND_MOBILE as MOBILE1,BIND_MOBILE as MOBILE2 from AUTH2.TBL_ORDER_BANKCARD_VIEW where AUTH_STATUS='SUCCESS' and AUTH_DATE >= ${START} and AUTH_DATE < ${STOP} group by AUTH_DATE,IDCARD_NUMBER,BANKCARD_NUMBER,NAME,BIND_MOBILE with ur",basic
channeldailytrx,channeldailytrx_nocardnow,"select 
      COALESCE(CHAR(date(a.create_time)),'null')||
      COALESCE(CHAR(a.trade_interface),'null')||
      COALESCE(CHAR(a.yeepay_merchant_no),'null')||
      COALESCE(CHAR(a.bankid),'null')||
      COALESCE(CHAR(a.card_type),'null')||
      COALESCE(CHAR(a.mcc),'null')||
      COALESCE(CHAR(a.product_identifier),'null')||
      COALESCE(CHAR(a.request_type),'null') as IDNOUSE,
      date(a.create_time) as createdate,
      'nocard' as biztype,
      a.trade_interface as channel_code,
      a.yeepay_merchant_no as customer_number,
      a.bankid as bank_code,
      a.card_type as cardtype,
      a.mcc as mcc_code,
      a.report_mcc as report_mcc,
      a.product_identifier as product_code,
      a.request_type as trxtype,
      count(1) as sum_trxcount,
      sum(nvl(a.trade_amount,0)) as sum_trxamount,
      sum(decode(a.deal_status,'SUCCESS',1,0)) as succ_trxcount,
      sum(decode(a.deal_status,'SUCCESS',nvl(a.trade_amount,0),0)) as succ_trxamount,
      sum(decode(a.deal_status,'FAILED',1,0)) as fail_trxcount,
      sum(decode(a.deal_status,'FAILED',nvl(a.trade_amount,0),0)) as fail_trxamount,
      sum(decode(a.deal_status,'SUCCESS',nvl(a.order_cost,0),0)) as cost
      from bank.tbl_bank_nocard_order a
      where a.create_time >= ${START} and a.create_time < ${STOP}
group by
       date(a.create_time),
       a.trade_interface,
       a.yeepay_merchant_no,
       a.bankid,
       a.card_type,
       a.mcc,
       a.report_mcc,
       a.product_identifier,
       a.request_type
with ur",cashier_bank
channeldailytrx,channeldailytrx_onlinenow,"select 
    COALESCE(CHAR(date(a.create_time)),'null')||
    COALESCE(CHAR(a.pay_interface),'null')||
    COALESCE(CHAR(a.platform),'null')||
    COALESCE(CHAR(a.yeepay_merchant_no),'null')||
    COALESCE(CHAR(a.card_type),'null') as IDNOUSE,
    date(a.create_time) as createdate,
    'online' as biztype,
    a.pay_interface as channel_code,
    a.platform as cashierdesk,
    a.yeepay_merchant_no as customer_number,
    a.card_type as cardtype,
    count(1) as sum_trxcount,
    sum(nvl(a.pay_amount,0)) as sum_trxamount,
    sum(decode(a.status,'PAY',1,0)) as succ_trxcount,
    sum(decode(a.status,'PAY',nvl(a.pay_amount,0),0)) as succ_trxamount,
    sum(decode(a.status,'INIT',1,0)) as fail_trxcount,
    sum(decode(a.status,'INIT',nvl(a.pay_amount,0),0)) as fail_trxamount
from bank.tbl_bank_order a
   where a.create_time >= ${START} and a.create_time < ${STOP}
group by date(a.create_time),
     a.pay_interface,
     a.platform,
     a.yeepay_merchant_no,
     a.card_type
with ur",cashier_bank
monthlytrxstatreceiver,monthlytrxstatreceiver,"select COALESCE(CHAR(d.product_code),'null')||
COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(d.receiverid),'null')||
COALESCE(CHAR(d.bizTypeId),'null')||
COALESCE(CHAR(d.type),'null')||
COALESCE(CHAR(r.employeeid),'null')||
COALESCE(CHAR(c.productlineid),'null')||
COALESCE(CHAR(c.areaid),'null')||
COALESCE(CHAR(r.isSelf),'null')||
COALESCE(CHAR(r.isShare),'null')||
COALESCE(CHAR(r.shareScale),'null')||
COALESCE(CHAR(r.transfDate),'null')||
COALESCE(CHAR(c.productGroup),'null')||
COALESCE(CHAR(c.bussinessCatId),'null')||
COALESCE(CHAR(c.level),'null')||
COALESCE(CHAR(em.BRANCHCOMPANY),'null')||
COALESCE(CHAR(d.feetype),'null')||
COALESCE(CHAR(month(trxdate)),'null')||
COALESCE(CHAR(year(trxdate)),'null')||
COALESCE(CHAR(month(true_trxdate)),'null')||
COALESCE(CHAR(year(true_trxdate)),'null') as IDNOUSE,month(trxdate)+year(trxdate)*100 as month,month(true_trxdate)+year(true_trxdate)*100 as true_month,d.product_code,d.sales_product_code,d.receiverid as customerid,d.bizTypeId,d.type,coalesce(r.employeeid,25) as salesid,c.productlineid,c.areaid,c.productGroup,r.isSelf,r.isShare as issharecustomer,coalesce(r.shareScale,1) as salesscale,
r.transfDate,sum(trxCount)-sum(refundCount) as trxCount,sum(trxAmount)-sum(refundAmount) as trxAmount,sum(trxFee)-sum(refundFee) as trxFee,
sum(frpCost) as innerCost,sum(externalCost) as externalCost,sum(shareFrpCost) as shareFrpCost,sum(accountingCost) as accountingcost
,c.bussinessCatId as businessCatId,c.level as customerlevel,em.BRANCHCOMPANY,d.feetype,sum(refundCount) as refundcount,sum(refundAmount) as refundamount,'RECEIVER' as customertype
  from DailyTrxStat d left join CustomerInfo c on d.receiverid=c.id
  left join CustomerRelationship r on r.customerid=d.receiverid
  left join employeeinfo em on r.EMPLOYEEID=em.ID
  where receiverid is not null and receiverid not in(524857,980067,11219567) and d.ISCOMPUTEPROFIT=1 and d.type not in ('SettleTransf') and trxdate>=${START} and trxdate<${STOP}  
  group by d.product_code,d.sales_product_code,d.receiverid,d.bizTypeId,d.type,r.employeeid,c.productlineid,c.areaid,r.isSelf,r.isShare,r.shareScale,r.transfDate,c.productGroup,c.bussinessCatId,c.level,em.BRANCHCOMPANY,d.feetype,month(trxdate),year(trxdate),month(true_trxdate),year(true_trxdate) with ur",reportdb
channeldailytrxhistory,channeldailytrxhistory_nocard,"select 
      COALESCE(CHAR(date(a.create_time)),'null')||
      COALESCE(CHAR(a.trade_interface),'null')||
      COALESCE(CHAR(a.yeepay_merchant_no),'null')||
      COALESCE(CHAR(a.bankid),'null')||
      COALESCE(CHAR(a.card_type),'null')||
      COALESCE(CHAR(a.mcc),'null')||
      COALESCE(CHAR(a.product_identifier),'null')||
      COALESCE(CHAR(a.request_type),'null') as IDNOUSE,
      date(a.create_time) as createdate,
      'nocard' as biztype,
      a.trade_interface as channel_code,
      a.yeepay_merchant_no as customer_number,
      a.bankid as bank_code,
      a.card_type as cardtype,
      a.mcc as mcc_code,
      a.product_identifier as product_code,
      a.request_type as trxtype,
      count(1) as sum_trxcount,
      sum(nvl(a.trade_amount,0)) as sum_trxamount,
      sum(decode(a.deal_status,'SUCCESS',1,0)) as succ_trxcount,
      sum(decode(a.deal_status,'SUCCESS',nvl(a.trade_amount,0),0)) as succ_trxamount,
      sum(decode(a.deal_status,'FAILED',1,0)) as fail_trxcount,
      sum(decode(a.deal_status,'FAILED',nvl(a.trade_amount,0),0)) as fail_trxamount,
      sum(nvl(a.order_cost,0)) as cost
      from bank.tbl_bank_nocard_order a
      where a.create_time >= ${START} and a.create_time < ${STOP}
group by
       date(a.create_time),
       a.trade_interface,
       a.yeepay_merchant_no,
       a.bankid,
       a.card_type,
       a.mcc,
       a.product_identifier,
       a.request_type
with ur",dbhis01_bank
channeldailytrxhistory,channeldailytrxhistory_online ,"select 
    COALESCE(CHAR(date(a.create_time)),'null')||
    COALESCE(CHAR(a.pay_interface),'null')||
    COALESCE(CHAR(a.platform),'null')||
    COALESCE(CHAR(a.yeepay_merchant_no),'null')||
    COALESCE(CHAR(a.card_type),'null') as IDNOUSE,
    date(a.create_time) as createdate,
    'online' as biztype,
    a.pay_interface as channel_code,
    a.platform as cashierdesk,
    a.yeepay_merchant_no as customer_number,
    a.card_type as cardtype,
    count(1) as sum_trxcount,
    sum(nvl(a.pay_amount,0)) as sum_trxamount,
    sum(decode(a.status,'PAY',1,0)) as succ_trxcount,
    sum(decode(a.status,'PAY',nvl(a.pay_amount,0),0)) as succ_trxamount,
    sum(decode(a.status,'INIT',1,0)) as fail_trxcount,
    sum(decode(a.status,'INIT',nvl(a.pay_amount,0),0)) as fail_trxamount
from bank.tbl_bank_order a
   where a.create_time >= ${START} and a.create_time < ${STOP}
group by date(a.create_time),
     a.pay_interface,
     a.platform,
     a.yeepay_merchant_no,
     a.card_type
with ur",dbhis01_bank
banktblbankbasicchannel,banktblbankbasicchannel,"select  distinct BANK_CHANNEL_CODE as TRXCHANNELID,BANK_CHANNEL_NAME as CHANNELNAME
from bank.tbl_bank_basic_channel 
with ur",cashier_bank
monthlytrxstatpayer,monthlytrxstatpayer,"select COALESCE(CHAR(d.product_code),'null')||
COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(d.receiverid),'null')||
COALESCE(CHAR(d.bizTypeId),'null')||
COALESCE(CHAR(d.type),'null')||
COALESCE(CHAR(r.employeeid),'null')||
COALESCE(CHAR(c.productlineid),'null')||
COALESCE(CHAR(c.areaid),'null')||
COALESCE(CHAR(r.isSelf),'null')||
COALESCE(CHAR(r.isShare),'null')||
COALESCE(CHAR(r.shareScale),'null')||
COALESCE(CHAR(r.transfDate),'null')||
COALESCE(CHAR(c.productGroup),'null')||
COALESCE(CHAR(c.bussinessCatId),'null')||
COALESCE(CHAR(c.level),'null')||
COALESCE(CHAR(em.BRANCHCOMPANY),'null')||
COALESCE(CHAR(d.feetype),'null')||
COALESCE(CHAR(month(trxdate)),'null')||
COALESCE(CHAR(year(trxdate)),'null')||
COALESCE(CHAR(month(true_trxdate)),'null')||
COALESCE(CHAR(year(true_trxdate)),'null')  as IDNOUSE,month(trxDate)+year(trxDate)*100 as month,month(true_trxDate)+year(true_trxDate)*100 as true_month,d.product_code,d.sales_product_code,d.receiverid as customerid,d.bizTypeId,d.type,coalesce(r.employeeid,25) as salesid,c.productlineid,c.areaid,c.productGroup,r.isSelf,r.isShare as issharecustomer,coalesce(r.shareScale,1) as salesscale,
r.transfDate,sum(trxCount)-sum(refundCount) as trxCount,sum(trxAmount)-sum(refundAmount) as trxAmount,sum(trxFee)-sum(refundFee) as trxFee,
sum(frpCost) as innerCost,sum(externalCost) as externalCost,sum(shareFrpCost) as shareFrpCost,sum(accountingCost) as accountingcost
,c.bussinessCatId as businessCatId,c.level as customerlevel,em.BRANCHCOMPANY,d.feetype,sum(refundCount) as refundcount,sum(refundAmount) as refundamount ,'PAYER' as customertype
  from DailyTrxStat d left join CustomerInfo c on d.payerid=c.id
  left join CustomerRelationship r on r.customerid=d.payerid
  left join employeeinfo em on r.EMPLOYEEID=em.ID
  where trxDate>=${START} and trxDate<${STOP} and bizTypeId in(2,5,18,241) and d.ISCOMPUTEPROFIT=1 and d.type not in ('POSTPAID','ADJUST','SettleTransf')  and (d.receiverId not in(524857,980067,11219567) or d.receiverid is null) and payerId is not null and c.customerType='ENTERPRISE'
  group by d.product_code,d.sales_product_code,d.receiverid,d.bizTypeId,d.type,r.employeeid,c.productlineid,c.areaid,r.isSelf,r.isShare,r.shareScale,r.transfDate,c.productGroup,c.bussinessCatId,c.level,em.BRANCHCOMPANY,d.feetype,month(trxDate),year(trxDate),month(true_trxDate),year(true_trxDate)  with ur",reportdb
monthlytrxstatindi,monthlytrxstatindi,"select COALESCE(CHAR(d.product_code),'null')||
COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(d.receiverid),'null')||
COALESCE(CHAR(d.bizTypeId),'null')||
COALESCE(CHAR(d.type),'null')||
COALESCE(CHAR(r.employeeid),'null')||
COALESCE(CHAR(c.productlineid),'null')||
COALESCE(CHAR(c.areaid),'null')||
COALESCE(CHAR(r.isSelf),'null')||
COALESCE(CHAR(r.isShare),'null')||
COALESCE(CHAR(r.shareScale),'null')||
COALESCE(CHAR(r.transfDate),'null')||
COALESCE(CHAR(c.productGroup),'null')||
COALESCE(CHAR(c.bussinessCatId),'null')||
COALESCE(CHAR(c.level),'null')||
COALESCE(CHAR(em.BRANCHCOMPANY),'null')||
COALESCE(CHAR(d.feetype),'null')||
COALESCE(CHAR(month(trxdate)),'null')||
COALESCE(CHAR(year(trxdate)),'null')||
COALESCE(CHAR(month(true_trxdate)),'null')||
COALESCE(CHAR(year(true_trxdate)),'null') as IDNOUSE,month(trxdate)+year(trxdate)*100 as month,month(true_trxdate)+year(true_trxdate)*100 as true_month,d.product_code,d.sales_product_code,d.receiverid as customerid,d.bizTypeId,d.type,coalesce(r.employeeid,25) as salesid,c.productlineid,c.areaid,c.productGroup,r.isSelf,r.isShare as issharecustomer,coalesce(r.shareScale,1) as salesscale,
r.transfDate,sum(trxCount)-sum(refundCount) as trxCount,sum(trxAmount)-sum(refundAmount) as trxAmount,sum(trxFee)-sum(refundFee) as trxFee,
sum(frpCost) as innerCost,sum(externalCost) as externalCost,sum(shareFrpCost) as shareFrpCost,sum(accountingCost) as accountingcost
,c.bussinessCatId as businessCatId,c.level as customerlevel,em.BRANCHCOMPANY,d.feetype,sum(refundCount) as refundcount,sum(refundAmount) as refundamount ,'INDI' as customertype
  from DailyTrxStat d left join CustomerInfo c on d.receiverid=c.id
  left join CustomerRelationship r on r.customerid=d.receiverid
  left join Customer cu on d.payerId=cu.id
  left join employeeinfo em on r.EMPLOYEEID=em.ID
  where receiverid is not null and receiverid not in(524857,980067,11219567) and trxdate>=${START} and trxdate<${STOP} 
   and d.ISCOMPUTEPROFIT=1 and d.bizTypeId in(2,18) and (cu.customerType is null or cu.customerType = 'PERSON') and TYPE NOT IN ('POSTPAID','ADJUST','SettleTransf')
  group by d.product_code,d.sales_product_code,d.receiverid,d.bizTypeId,d.type,r.employeeid,c.productlineid,c.areaid,r.isSelf,r.isShare,r.shareScale,r.transfDate,c.productGroup,c.bussinessCatId,c.level,em.BRANCHCOMPANY,d.feetype,month(trxdate),year(trxdate),month(true_trxdate),year(true_trxdate) with ur",reportdb
dailyamountover2m,dailyamountover2m,"select cu.id as CUSTID,cu.customernumber as CUSTNUMBER
from dailytrxstat d
left join customerinfo cu on cu.id=d.receiverid
where d.trxdate between current date - 2 months and current date
group by cu.id,cu.customernumber
having sum(d.trxamount)/60>=2000000
with ur",reportdb
zgtverifywechatxieyi,zgtrealnameauth,"select 
COALESCE(CHAR(date(UPDATE_DATE )),'null')||COALESCE(CHAR(identity_no),'null')||'zgtrealnameauth' as IDNOUSE,
date(UPDATE_DATE ) AS TRXDATE,
year(date(UPDATE_DATE ))*100+month(date(UPDATE_DATE))  AS MONTH,
identity_no AS RECEIVERID,
'3011004003001' AS PRODUCT_CODE,
'3011004001003A' AS SALES_PRODUCT_CODE,
'REALNAMEAUTH' AS ORDERTYPE,
'ZGT_REALNAMEAUTH' AS PAYPRODUCT,
226  AS BIZTYPEID,
'RealNameAuth' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'ZGT' AS DATAORIGIN,
count(id) AS TRXCOUNT,
sum(fee) AS TRXFEE,
sum(cost) AS FRPCOST,
sum(cost) AS ACCOUNTINGCOST
from zgt.tbl_auth_fee_record
where FEE_STATUS = 'SUCCESS'
and UPDATE_DATE >= ${START}
and UPDATE_DATE < ${STOP}
and AUTH_TYPE in ('ENTERPRISE','IDCARD') 
GROUP BY date(UPDATE_DATE ),identity_no
with ur",zgt_standby
zgtverifywechatxieyi,zgtcardjianquan1,"select 
COALESCE(CHAR(date(UPDATE_DATE )),'null')||COALESCE(CHAR(identity_no),'null')||'zgtcardjianquan1' as IDNOUSE,
date(UPDATE_DATE ) AS TRXDATE,
year(date(UPDATE_DATE ))*100+month(date(UPDATE_DATE )) AS MONTH,
identity_no AS RECEIVERID,
'3011004003002' AS PRODUCT_CODE,
'3011004001003A' AS SALES_PRODUCT_CODE,
'CARDJIANQUAN' AS ORDERTYPE,
'ZGT_CARDJIANQUAN' AS PAYPRODUCT,
226  AS BIZTYPEID,
'CARDJIANQUAN' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'ZGT' AS DATAORIGIN,
count(id) AS TRXCOUNT,
sum(fee) AS TRXFEE,
sum(cost) AS FRPCOST,
sum(cost) AS ACCOUNTINGCOST
from zgt.tbl_auth_fee_record
where FEE_STATUS = 'SUCCESS'
and UPDATE_DATE >= ${START}
and UPDATE_DATE < ${STOP}
and AUTH_TYPE in ('BANKCARD','VERIFY')
GROUP BY date(UPDATE_DATE ),identity_no
with ur",zgt_standby
zgtverifywechatxieyi,zgtwechat,"select
COALESCE(CHAR(date(p.CALLBACK_DATE)),'null')||COALESCE(CHAR(p.CUSTOMERNUMBER),'null')||'zgtwechat'||coalesce(t.BANK_ID,'')||coalesce(p.CARD_TYPE,'') as IDNOUSE,
date(p.CALLBACK_DATE) AS TRXDATE,t.BANK_ID as bank_code,p.CARD_TYPE as cardtype,
year(date(p.CALLBACK_DATE))*100+month(date(p.CALLBACK_DATE)) AS MONTH,
p.CUSTOMERNUMBER AS RECEIVERID,
'3011001006001' AS PRODUCT_CODE,
'3011004001003A' AS SALES_PRODUCT_CODE,
'SALES' AS ORDERTYPE,
'ZGT_WECHAT' AS PAYPRODUCT,
260  AS BIZTYPEID,
'Sales' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'ZGT' AS DATAORIGIN,
count(p.id) AS TRXCOUNT,
sum(p.amount) AS TRXAMOUNT,
sum(p.amount)-sum(p.real_amount) AS TRXFEE 
from zgt.tbl_payment p
left join zgt.tbl_trxorder t on t.external_id = p.externalid
left join zgt.tbl_merchant m  on m.IDENTITY_NO=t.customer_no
where 1 = 1
and p.CALLBACK_DATE >= ${START}
and p.CALLBACK_DATE < ${STOP}
and p.PAY_PRODUCT in ('WECHATU','WECHATG','WAP_ALIPAYAPP','ALIPAY_APP','WAP_WECHATG') 
group by date(p.CALLBACK_DATE),p.CUSTOMERNUMBER,t.BANK_ID,p.CARD_TYPE
with ur",zgt_standby
zgtverifywechatxieyi,zgtxieyipay,"select
COALESCE(CHAR(date(p.CALLBACK_DATE)),'null')||COALESCE(CHAR(p.CUSTOMERNUMBER),'null')||'zgtxieyipay'||coalesce(t.BANK_ID,'')||coalesce(p.CARD_TYPE,'') as IDNOUSE,
date(p.CALLBACK_DATE) AS TRXDATE,t.BANK_ID as bank_code,p.CARD_TYPE as cardtype,
year(date(p.CALLBACK_DATE))*100+month(date(p.CALLBACK_DATE)) AS MONTH,
p.CUSTOMERNUMBER AS RECEIVERID,
'3011001005002' AS PRODUCT_CODE,
'3011004001003A' AS SALES_PRODUCT_CODE,
'SALES' AS ORDERTYPE,
'ZGT_XIEYIPAY' AS PAYPRODUCT,
287 AS BIZTYPEID,
'Sales' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'ZGT' AS DATAORIGIN,
count(p.id) AS TRXCOUNT,
sum(p.amount) AS TRXAMOUNT,
sum(p.amount)-sum(p.real_amount) AS TRXFEE,
sum(p.BANK_COST) AS FRPCOST,
sum(p.BANK_COST) AS ACCOUNTINGCOST
from zgt.tbl_payment p
left join zgt.tbl_trxorder t on t.external_id = p.externalid
left join zgt.tbl_merchant m  on m.IDENTITY_NO=t.customer_no
where 1 = 1
and p.CALLBACK_DATE >= ${START}
and p.CALLBACK_DATE < ${STOP}
and p.PAY_PRODUCT = 'AGREEMENT_NORMAL'
group by date(p.CALLBACK_DATE),p.CUSTOMERNUMBER,t.BANK_ID,p.CARD_TYPE
with ur",zgt_standby
zgtverifywechatxieyi,zgtcustomeridnum,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
POSSHARECOST,possharecosttrx,"select COALESCE(CHAR(customer_number),'null')||char(year(SHARE_TIME))||char(month(SHARE_TIME))||pp.SERIES||'possharecosttrx' as IDNOUSE,
customer_number as RECEIVERID,-sum(amount) as TRXFEE,(case pp.SERIES when 'EASILY' then '3011001001001H' when 'EASYPOS' then '3011001001001D' when 'QUICKMARK' then '3011001006001A' when 'SMOOTH' then '3011001001001J' when 'TRADE' then '3011001001001A' when 'VEasyWallet' then '3011001001001F' else '3011001001001A' end) as SALES_PRODUCT_CODE,'3011001001001' as PRODUCT_CODE,29 as BIZTYPEID,'POSSHARECOST' as TYPE,'POSP' as dataorigin,year(SHARE_TIME)*100+month(SHARE_TIME) as month, date(${STOP}) - 1 days as trxdate
			 from poswrite.TDA_HESUAN a
left join (
	select CUSTOMER_CODE,f.SERIES,d.DICT_NAME 
	from poswrite.TBL_POS_PRODUCTONCUSTOMER p 
	left join poswrite.TBL_POS_PRODUCTINFO f on p.PRODUCT_CODE = f.CODE
	left join posread.TBL_POS_DICTIONARY d on d.DICT_ID = f.SERIES and d.DICT_TYPE_ID = 'productSeries'
	where p.STATUS = 'NORMAL' and  p.TRADE_TYPE = 'BANKCARD'
	group by CUSTOMER_CODE,f.SERIES,d.DICT_NAME 
) pp on pp.CUSTOMER_CODE  = a.CUSTOMER_NUMBER
			 where SHARE_TIME >= ${START} and SHARE_TIME <${STOP}
			 group by customer_number,year(SHARE_TIME),month(SHARE_TIME),pp.SERIES
			  with ur",opendb
POSSHARECOST,customernumber2id,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
sdf,sdfsdfdsf,sdfdsfa,bigdata_report
zxmembermonthlytrx,zxmembermonthlytrx,"SELECT
    CONCAT(COALESCE( year(date(trxcreatetime))*100+month(date(trxcreatetime)) ,'null' ) ,COALESCE( customernumber ,'null' ) ,COALESCE( membernumber ,'null' ) ) AS IDNOUSE, 
    year(date(trxcreatetime))*100+month(date(trxcreatetime)) as TRXMONTH,
    customernumber,
    membernumber,
    SUM(trxcount) as trxcount,
    SUM(trxamount) as trxamount
FROM
    zx_member_trx_daily_stat
WHERE
    trxcreatetime >= ${START} and trxcreatetime < ${STOP}
GROUP BY
    year(date(trxcreatetime))*100+month(date(trxcreatetime)),
    customernumber,
    membernumber",bigdata_report
zxmemberdailytrx,zxmemberdailytrx,"select 
COALESCE(date(CREATE_TIME),'null')||COALESCE(MERCHANT_NO,'null')||COALESCE(MEMBER_NO,'null') as IDNOUSE,
date(CREATE_TIME) as trxcreatetime,
MERCHANT_NO as customernumber,
MEMBER_NO as membernumber,
count(*) as trxcount,
sum(ORDER_AMOUNT) as trxamount
from NCC.TBL_NC_PAY_ORDER
where CREATE_TIME >= ${START} and CREATE_TIME < ${STOP} and state = 'SUCCESS'
group by date(CREATE_TIME), MERCHANT_NO,MEMBER_NO
with ur",INNO
PublishedMonthlyTrxStat,PublishedMonthlyTrx,"select 
char(COALESCE(m.CUSTOMERID,0))||COALESCE(c.CUSTOMERNUMBER,'null')||COALESCE(c.FULLNAME,'null')||char(COALESCE(m.SALESID,0))||char(COALESCE(m.AREAID,0))||char(COALESCE(m.biztypeid,0))||COALESCE(m.TYPE,'null') ||char(COALESCE(m.salesscale,1))||char(COALESCE(m.isShareCustomer,0))||char(COALESCE(m.isself,1))||COALESCE(m.productgroup,'null')||COALESCE(m.businesscatid,'null')||COALESCE(m.branchcompany,'null')||COALESCE(m.product_code,'null')||COALESCE(m.sales_product_code,'null')||COALESCE(m.managemark,'null')||char(COALESCE(c2a.ACHIEVEMENT_ID,0))||'RECEIVER'||char(COALESCE(m.true_month,0))||char(COALESCE(m.payerid,0))||char(coalesce(c.productline,'')) as IDNOUSE,
1598 as timeLatitudeId,201801 as MONTH,m.true_month,m.CUSTOMERID,m.payerid,c.CUSTOMERNUMBER,c.FULLNAME as customerName,m.SALESID as saleid,0 as teamId,m.AREAID,0 as productLineId,c.productline as hangyeyejishuxing,
m.biztypeid, m.TYPE as trxTypeId,sum(m.trxcount*m.salesscale*coalesce(c2a.PERCENT,1)) as trxcount,sum(m.trxamount*m.salesscale*coalesce(c2a.PERCENT,1)) as trxamount,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)) as innerincome,
sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as innerCost,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as innerprofit,'RECEIVER' as grouptype,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as accountingCost,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as accountingProfit,
m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT
from monthlytrxstat m left join customerinfo c on m.CUSTOMERID=c.ID left join customer2achievement c2a on c. customernumber=c2a.customer_number
where m.month=201801 and m.customertype='RECEIVER'   group by m.CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME,m.SALESID,m.AREAID,m.biztypeid, m.TYPE,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT,m.true_month,m.payerid,c.productline with ur",reportdb
zxmemberdailytrxhis,zxmemberdailytrxhis,"select 
COALESCE(date(CREATE_TIME),'null')||COALESCE(MERCHANT_NO,'null')||COALESCE(MEMBER_NO,'null') as IDNOUSE,
date(CREATE_TIME) as trxcreatetime,
MERCHANT_NO as customernumber,
MEMBER_NO as membernumber,
count(*) as trxcount,
sum(ORDER_AMOUNT) as trxamount
from NCC.TBL_NC_PAY_ORDER
where CREATE_TIME >= ${START} and CREATE_TIME < ${STOP} and state = 'SUCCESS'
group by date(CREATE_TIME), MERCHANT_NO,MEMBER_NO
with ur",dbhis01_bank
jfincomeprofitmonthlytrx,jfincomeprofitmonthlytrx,"select 
m.id as IDNOUSE,
ex.NAME AS ACHIEVEMENT_ATTRIBUTE,
cu.CUSTOMERNUMBER AS CUSTOMERNUMBER,
biz.DISPLAYNAME AS BIZTYPE,
type.NAME AS TRXTYPE,
m.GROUPTYPE AS RECEIVER,
c2a.PERCENT AS ACHIEVEMENT_PROPORTION,
date(t.DATE) AS FINANCE_DATE,
t.FINANCEYEARMONTH AS YEARMONTH,
em.NAME AS SALES,
area.DISPLAYNAME AS AREA,
(case m.ISSELF when 1 then '_' else 'è½' end) AS ISSELF,
m.SALESSCALE AS SALESSCALE,
cu.VMARK AS VMARK,
pgt.NAME AS BIZTYPE_DETAIL,
date(cu.CREATETIME) AS REGISTER_DATE,
m.ISSHARECUSTOMER AS ISSHARE,
tp.PRODUCTLINE AS PRODUCTLINE,
cat.NAME AS BUSINESSCAT,
cu.SIGNEDNAME AS SIGNED_NAME,
scat.NAME AS SUB_BUSINESSCAT,
cu.FULLNAME AS FULLNAME,
rea.BRANCHNAME AS BRANCHNAME,
m.MANAGEMARK AS MANAGEMARK,
(case when pp.ACCOUNTCLASS is null then 'çº¿ä_' else pp.ACCOUNTCLASS end) AS ACCOUNTING_CLASS,
(case when cu.AGENTTYPE='AIR' then '__ä»£ç_' when cu.AGENTTYPE='NET' then 'çº¿ä_ä»£ç_' when cu.AGENTTYPE='NONE' then '_´é_'  when cu.AGENTTYPE in('POS','QCB') then 'POSä»£ç_' else cu.AGENTTYPE end) AS AGENT_TYPE,
p2pg.PRODUCT_GROUP AS PRODUCT_GROUP,
em1.NAME AS SUPERIORNAME,
cat1.NAME AS BUSINESSCAT_NOW,
(case when pp.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else pp.ACCOUNTINGTYPE end) AS ACCOUNTING_TYPE,
acc.NAME AS ACCMARK,
p.PRODUCTNAME AS PRODUCT_NAME,
p1.PRODUCTNAME AS SALES_PRODUCT_NAME,
m.ACCOUNTINGPROFIT*coalesce(c2a.PERCENT,1) AS ACCOUNTING_PROFIT,
(CASE WHEN (m.BIZTYPEID IN (29,129) and m.TRXTYPEID not in ('POSRENT','POSSALES')) THEN m.ACCOUNTINGPROFIT*coalesce(c2a.PERCENT,1) 
     ELSE m.INNERINCOME*coalesce(c2a.PERCENT,1) END) AS INCOME,
m.INNERPROFIT*coalesce(c2a.PERCENT,1) AS PROFIT,
m.INNERINCOME*coalesce(c2a.PERCENT,1) AS INCOME_FINANCE,
m.ACCOUNTINGCOST*coalesce(c2a.PERCENT,1) AS ACCOUNTING_COST_FINANCE,
m.TRXCOUNT*coalesce(c2a.PERCENT,1) AS TRXCOUNT,
(CASE WHEN (m.BIZTYPEID IN (29,129) and m.TRXTYPEID not in ('POSRENT','POSSALES')) THEN 0 
      ELSE m.ACCOUNTINGCOST*coalesce(c2a.PERCENT,1) END) AS ACCOUNTING_COST,
m.TRXAMOUNT*coalesce(c2a.PERCENT,1) AS TRXAMOUNT
from publishedmonthlytrxstat m
left join timelatitude t on t.id=m.timelatitudeid
left join trxstatcustomerarea area on area.id=m.areaid
left join trxstatbiztype biz on biz.id=m.biztypeid
left join employeeinfo em on em.id=m.saleid
left join trxstattrxtype type on type.id=m.trxtypeid
left join customerinfo cu on cu.id=m.customerid
left join productgrouptype pgt on pgt.id=m.productgroup
left join trxstatcustomerarea rea on rea.areaid=m.branchcompany
left join trxstatbusinesscategorie cat on m.businesscatid=cat.id
left join trxstatbusinesscategorie cat1 on cu.bussinesscatid=cat1.id
left join trxstatbiztype_profile tp on m.biztypeid=tp.biztypeid
left join trxstataccmark  acc on cu.accmark=acc.code
left join productcode p on m.product_code=p.productcode and p.producttype=2
left join productcode p1 on m.sales_product_code=p1.productcode and p1.producttype=1
left join employeeinfo em1 on em.superiorid=em1.id
left join productcode_profile pp on m.sales_product_code=pp.sales_product_code and m.product_code=pp.PRODUCT_CODE
left join customer2achievement c2a on cu.customernumber=c2a.customer_number
left join existence ex on c2a.achievement_id=ex.id and ex.classtype='Department'
left join trxstatsubbusinesscategorie scat on cu.subbusinesscat=scat.code
left join productcode2productgroup p2pg on m.product_code=p2pg.product_code and m.sales_product_code=p2pg.sales_product_code
where date(t.DATE) >= ${START} and date(t.DATE) < ${STOP}
and m.product_code in ()
with ur
",reportdb
risk31,left3,"SELECT
    syn.PAY_ID, syn.CRD_TYP, syn.BNK_ID, syn.USE_TOOL, syn.USR_ID, syn.CRD_NO, syn.CRD_AREA, syn.USR_IP, syn.USR_IP_AREA, syn.MOBILE, syn.MOBILE_AREA, syn.FIRST_PAY, syn.TOOLS_IF, syn.SUB_PROD_ID, syn.GOODS_NM, syn.PROD, syn.MEC_NO, syn.OCC_TM, syn.AMT, syn.RID, syn.REQ_ID, syn.SEQ_ID, asy.PAY_RESULT, syn.DOORGOD_RETCODE, syn.SUB_SYS, syn.REQ_IF, syn.GOODS_IF, asy.REQ_IF as AREQ_IF, trig.RULECODE
FROM
    TL.TBL_RRS_SYNREQ syn 
    LEFT JOIN TL.TBL_RRS_ASYNREQ asy
  	ON syn.REQ_ID = asy.REQ_ID
    	AND syn.MEC_NO = asy.MEC_NO
    	AND syn.CRD_NO = asy.CRD_NO
    	AND syn.AMT = asy.AMT
    	AND syn.biz = asy.biz
    LEFT JOIN RR.RR_TRIGGERRULES_DOSET trig
     	ON syn.REQ_ID=trig.SEQUENCELD 
	    AND syn.MEC_NO=trig.MERCHANTNO 
	    AND syn.CRD_NO=trig.BANKACCOUNTNO 
	    AND syn.AMT=trig.AMOUNT
	    AND syn.biz = trig.PRODUCTION
WHERE
	syn.OCC_TM >= ${START} and syn.OCC_TM < ${STOP}
	AND syn.biz != 'EPOS'
	AND asy.OCC_TM >= syn.OCC_TM - 1 hours and asy.OCC_TM < syn.OCC_TM + 12 hours
	AND trig.OCCURTIME >= syn.OCC_TM - 1 hours and trig.OCCURTIME < syn.OCC_TM + 12 hours
WITH UR",tldb
risk111,r_syn,"SELECT
	COALESCE(REQ_ID, 'null')||COALESCE(MEC_NO, 'null')||COALESCE(CRD_NO, 'null')||COALESCE(AMT, 'null')||COALESCE(biz, 'null') as IDNOUSE,
    BIZ, PAY_ID, CRD_TYP, BNK_ID, USE_TOOL, USR_ID, CRD_NO, CRD_AREA, USR_IP, USR_IP_AREA, MOBILE, MOBILE_AREA, FIRST_PAY, TOOLS_IF, SUB_PROD_ID, GOODS_NM, PROD, MEC_NO, OCC_TM, AMT, RID, REQ_ID, SEQ_ID, DOORGOD_RETCODE, SUB_SYS, REQ_IF, GOODS_IF
FROM
    TL.TBL_RRS_SYNREQ
WHERE
    OCC_TM >= ${START} and OCC_TM < ${STOP}
AND BIZ != 'EPOS'
WITH UR",tldb
risk111,r_asy,"SELECT 
	COALESCE(REQ_ID, 'null')||COALESCE(MEC_NO, 'null')||COALESCE(CRD_NO, 'null')||COALESCE(AMT, 'null')||COALESCE(biz, 'null') as IDNOUSE,
     PAY_RESULT, 
	REQ_IF as AREQ_IF
FROM 
	TL.TBL_RRS_ASYNREQ
WHERE 
	OCC_TM >= timestamp(${START}) - 1 hours and OCC_TM < timestamp(${STOP}) + 2 hours
        AND BIZ != 'EPOS'
WITH UR",tldb
yjzffinancegroupbinddailytrx,yjzffinancegroupbinddailytrx,"select COALESCE(date(r.create_time),date('2029-09-09'))||COALESCE((case when r.PRODUCT_CATALOG in('18','30','56','62') then '____' when r.PRODUCT_CATALOG in('54') then '____' when r.PRODUCT_CATALOG in('55') then '_¶æå®' else 'ä¸__ä»' end),'null')||COALESCE(r.merchant_account,'null')||COALESCE((case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end),'null')||COALESCE(pb.code,'null') as IDNOUSE,
'ONEKEYPAY' as BIZ_GROUP,
date(r.create_time) as TRXDATE,
(case when r.PRODUCT_CATALOG in('18','30','56','62') then '____' 
     when r.PRODUCT_CATALOG in('54') then '____' 
     when r.PRODUCT_CATALOG in('55') then '_¶æå®' 
     else 'ä¸__ä»' end) as BIZ_SYSTEM_NAME,
r.merchant_account as CUSTOMERNUMBER,
(case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end) as CARDTYPE,
pb.code as BANK_CODE,
count(1) as TOTAL_COUNT,
sum(case when r.status=1 then 1 else 0 end) as SUCC_COUNT,
sum(case when r.status in (0,5,6) then 1 else 0 end) as FAIL_COUNT,
sum(r.auth_cost) as AUTH_COST
from ewallet.PAYAPI_BINDCARD_REQUEST_RECORD r 
left join ewallet.pay_tmp_card t on r.tmp_card_id=t.tmp_card_id 
left join ewallet.pay_card_species cs on t.card_species_id=cs.card_species_id 
left join ewallet.pay_bank pb on cs.bank_id=pb.bank_id 
left join ncauth.tbl_nc_auth_order o on r. REQUEST_ID=o.CUSTOMER_ORDER_ID 
left join ncauth.tbl_nc_auth_request r on o.AUTH_ORDER_FLOW_ID = r.AUTH_ORDER_FLOW_ID
where r.create_time >= ${START} and r.create_time< ${STOP}
group by date(r.create_time),
(case when r.PRODUCT_CATALOG in('18','30','56','62') then '____' 
     when r.PRODUCT_CATALOG in('54') then '____' 
     when r.PRODUCT_CATALOG in('55') then '_¶æå®' 
     else 'ä¸__ä»' end),
r.merchant_account,
(case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end),
pb.code
with ur

",INNO_STANBY
yjzffinancegroupdailytrx,yjzffinancegroupdailytrx1,"select COALESCE(date(b.order_time),date('2029-09-09'))||COALESCE((case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' when b.PRODUCT_CATALOG in ('55') then '_¶æå®' when b.PRODUCT_CATALOG='' then 'ä¸__PI' else (case when b.order_origin=0 then '_µè__' when b.order_origin=1 then 'ä¸__EB' when b.order_origin=2 then 'ä¸__OBILE' when b.order_origin=8 then '_____´¢' when b.order_origin=9 then 'ç½__ä¸_' when b.order_origin=11 then '____' else 'ä¸__PI' end) end),'null')||COALESCE(b.trader_id,'null')||COALESCE(n.card_type,'null')||COALESCE((case when n.PAY_CARDINFO_TYPE ='TEMP' then 'é¦___' else 'ç»____' end),'null')||COALESCE((case when s.fee_type=1 then '___' when s.fee_type=2 then 'é¢__' when s.fee_type=3 then 'å®__' when s.fee_type=4 then 'é¢__å®__' else null end),'null')||COALESCE(n.bank_code,'null') as IDNOUSE,
'ONEKEYPAY' as BIZ_GROUP,
date(b.order_time) as TRXDATE,
(case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' 
      when b.PRODUCT_CATALOG in ('55') then '_¶æå®'
      when b.PRODUCT_CATALOG='' then 'ä¸__PI' 
     else (case when b.order_origin=0 then '_µè__' 
                when b.order_origin=1 then 'ä¸__EB' 
                when b.order_origin=2 then 'ä¸__OBILE'  
                when b.order_origin=8 then '_____´¢' 
                when b.order_origin=9 then 'ç½__ä¸_' 
                when b.order_origin=11 then '____' 
                else 'ä¸__PI' end) 
 end) as BIZ_SYSTEM_NAME,
b.trader_id as CUSTOMERNUMBER,
n.card_type as CARDTYPE,
(case when n.PAY_CARDINFO_TYPE ='TEMP' then 'é¦___' else 'ç»____' end) as PAYTYPE,
(case when s.fee_type=1 then '___' 
     when s.fee_type=2 then 'é¢__' 
     when s.fee_type=3 then 'å®__' 
     when s.fee_type=4 then 'é¢__å®__' 
     else null end) as FEETYPE,
n.bank_code as BANK_CODE,
count(1) as TOTAL_COUNT, 
sum(b.ORDER_AMOUNT) as TOTAL_AMOUNT,
sum(case when b.order_state=1 then 1 else 0 end) as SUCC_COUNT, 
sum(case when b.order_state=1 then b.ORDER_AMOUNT else 0 end) as SUCC_AMOUNT,
sum(case when b.order_state=4 then 1 else 0 end) FAIL_COUNT,
sum(case when b.order_state=4 then b.ORDER_AMOUNT else 0 end) as FAIL_AMOUNT,
sum(s.seller_fee) as TOTAL_INCOME,
cast(sum(n.COST)*100 as bigint) as COST
from ewallet.pay_biz_order b 
left join ncc.tbl_nc_pay_order n on b.pay_order_id=n.payment_no 
left join ewallet.data_pay_success s on b.order_id=s.order_id
where b.order_time>= ${START} and b.order_time< ${STOP} and b.pay_sys_type=2 
group by date(b.order_time),
(case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' 
      when b.PRODUCT_CATALOG in ('55') then '_¶æå®' 
      when b.PRODUCT_CATALOG='' then 'ä¸__PI'
      else (case when b.order_origin=0 then '_µè__' 
            when b.order_origin=1 then 'ä¸__EB' 
            when b.order_origin=2 then 'ä¸__OBILE'  
            when b.order_origin=8 then '_____´¢' 
            when b.order_origin=9 then 'ç½__ä¸_' 
            when b.order_origin=11 then '____' else 'ä¸__PI' end) end),
b.trader_id,
n.card_type,
(case when n.PAY_CARDINFO_TYPE ='TEMP' then 'é¦___' else 'ç»____' end),
(case when s.fee_type=1 then '___' 
     when s.fee_type=2 then 'é¢__' 
     when s.fee_type=3 then 'å®__' 
     when s.fee_type=4 then 'é¢__å®__' 
     else null end),
n.bank_code
with ur",INNO_STANBY
yjzffinancegroupfaildailytrx,yjzffinancegroupfaildailytrxbind,"select COALESCE(date(r.create_time),date('2029-09-09'))||COALESCE((case when r.PRODUCT_CATALOG in('18','30','56','62') then '____' when r.PRODUCT_CATALOG in('54') then '____' when r.PRODUCT_CATALOG in('55') then '_¶æå®' else 'ä¸__ä»' end),'null')||COALESCE(r.merchant_account,'null')||COALESCE((case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end),'null')||COALESCE(pb.code,'null')||COALESCE(r.AUTH_VERIFY_CODE,'null') as IDNOUSE,
'ONEKEYPAY' as BIZ_GROUP,
'ç»__' as FAIL_TYPE,
date(r.create_time) as TRXDATE,
(case when r.PRODUCT_CATALOG in('18','30','56','62') then '____' 
      when r.PRODUCT_CATALOG in('54') then '____' 
      when r.PRODUCT_CATALOG in('55') then '_¶æå®' 
      else 'ä¸__ä»' end) as BIZ_SYSTEM_NAME,
r.merchant_account as CUSTOMERNUMBER,
(case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end) as CARDTYPE,
pb.code as BANK_CODE,
r.AUTH_VERIFY_CODE as ERROR_CODE,
max(r.AUTH_VERIFY_MSG) as ERROR_MSG,
sum(case when r.status in (0,5,6) then 1 else 0 end) as FAIL_COUNT 
from ewallet.PAYAPI_BINDCARD_REQUEST_RECORD r 
left join ewallet.pay_tmp_card t on r.tmp_card_id=t.tmp_card_id 
left join ewallet.pay_card_species cs on t.card_species_id=cs.card_species_id 
left join ewallet.pay_bank pb on cs.bank_id=pb.bank_id  
where r.status in (0,5,6) and r.create_time >=${START} and r.create_time< ${STOP}
group by date(r.create_time),
(case when r.PRODUCT_CATALOG in('18','30','56','62') then '____' 
      when r.PRODUCT_CATALOG in('54') then '____' 
      when r.PRODUCT_CATALOG in('55') then '_¶æå®' 
else 'ä¸__ä»' end),
r.merchant_account,
(case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end),
pb.code,
r.AUTH_VERIFY_CODE
with ur",INNO_STANBY
yjzffinancegroupfaildailytrx,yjzffinancegroupfaildailytrx1,"select COALESCE(date(b.order_time),date('2029-09-09'))||COALESCE((case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' when b.PRODUCT_CATALOG in ('55') then '_¶æå®' when b.PRODUCT_CATALOG='' then 'ä¸__PI' else (case when b.order_origin=0 then '_µè__' when b.order_origin=1 then 'ä¸__EB' when b.order_origin=2 then 'ä¸__OBILE' when b.order_origin=8 then '_____´¢' when b.order_origin=9 then 'ç½__ä¸_' when b.order_origin=11 then '____' else 'ä¸__PI' end) end),'null')||COALESCE(b.trader_id,'null')||COALESCE(n.card_type,'null')||COALESCE(n.bank_code,'null')||COALESCE((case when b.order_state=1 then '' when n.error_code is not null then n.error_code when n.trade_error is not null then n.trade_error else n.bank_error end),'null') as IDNOUSE,
'ONEKEYPAY' as BIZ_GROUP,
'__' as FAIL_TYPE,
date(b.order_time) as TRXDATE,
(case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' 
      when b.PRODUCT_CATALOG in ('55') then '_¶æå®' 
      when b.PRODUCT_CATALOG='' then 'ä¸__PI'
      else (case when b.order_origin=0 then '_µè__' 
                 when b.order_origin=1 then 'ä¸__EB' 
                 when b.order_origin=2 then 'ä¸__OBILE'  
                 when b.order_origin=8 then '_____´¢' 
                 when b.order_origin=9 then 'ç½__ä¸_' 
                 when b.order_origin=11 then '____' 
            else 'ä¸__PI' end) end) as BIZ_SYSTEM_NAME,
b.trader_id as CUSTOMERNUMBER,
n.card_type as CARDTYPE,
n.bank_code as BANK_CODE,
(case when b.order_state=1 then '' when n.error_code is not null then n.error_code when n.trade_error is not null then n.trade_error else n.bank_error end) as ERROR_CODE,
max(case when b.order_state=1 then '' when n.error_code is not null then n.error_msg when n.trade_error is not null then n.trade_msg else n.bank_msg end) as ERROR_MSG,
sum(case when b.order_state=4 then 1 else 0 end) as FAIL_COUNT 
from ewallet.pay_biz_order b 
left join ncc.tbl_nc_pay_order n on b.pay_order_id=n.payment_no 
left join ewallet.data_pay_success s on b.order_id=s.order_id
where b.order_state=4 and b.order_time>= ${START} and b.order_time< ${STOP}  and b.pay_sys_type=2
group by date(b.order_time),
(case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' 
      when b.PRODUCT_CATALOG in ('55') then '_¶æå®' 
      when b.PRODUCT_CATALOG='' then 'ä¸__PI'
      else (case when b.order_origin=0 then '_µè__' 
                 when b.order_origin=1 then 'ä¸__EB' 
                 when b.order_origin=2 then 'ä¸__OBILE'  
                 when b.order_origin=8 then '_____´¢' 
                 when b.order_origin=9 then 'ç½__ä¸_' 
                 when b.order_origin=11 then '____' 
            else 'ä¸__PI' end) end),
b.trader_id,
n.card_type,
n.bank_code,
(case when b.order_state=1 then '' when n.error_code is not null then n.error_code when n.trade_error is not null then n.trade_error else n.bank_error end) 
with ur",INNO_STANBY
yjzffinancegroupfaildailytrx,yjzffinancegroupfaildailytrx2,"select COALESCE(date(b.order_time),date('2029-09-09'))||COALESCE((case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' when b.PRODUCT_CATALOG in ('55') then '_¶æå®' when b.PRODUCT_CATALOG='' then 'ä¸__PI' else (case when b.order_origin=0 then '_µè__' when b.order_origin=1 then 'ä¸__EB' when b.order_origin=2 then 'ä¸__OBILE' when b.order_origin=8 then '_____´¢' when b.order_origin=9 then 'ç½__ä¸_' when b.order_origin=11 then '____' else 'ä¸__PI' end) end),'null')||COALESCE(b.trader_id,'null')||COALESCE((case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end),'null')||COALESCE(pb.code,'null')||COALESCE(n.biz_code,'null') as IDNOUSE,
'ONEKEYPAY' as BIZ_GROUP,
'__' as FAIL_TYPE,
date(b.order_time) as TRXDATE,
(case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' 
when b.PRODUCT_CATALOG in ('55') then '_¶æå®' 
when b.PRODUCT_CATALOG='' then 'ä¸__PI' 
else (case when b.order_origin=0 then '_µè__' 
when b.order_origin=1 then 'ä¸__EB' 
when b.order_origin=2 then 'ä¸__OBILE'  
when b.order_origin=8 then '_____´¢' 
when b.order_origin=9 then 'ç½__ä¸_' 
when b.order_origin=11 then '____' 
else 'ä¸__PI' end) end) as BIZ_SYSTEM_NAME,
b.trader_id as CUSTOMERNUMBER,
(case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end) as CARDTYPE,
pb.code as BANK_CODE,
n.biz_code as ERROR_CODE,
max(n.biz_msg) as ERROR_MSG,
sum(case when s2.transaction_state=3 then 1 else 0 end) as FAIL_COUNT 
from ewallet.pay_biz_order b 
left join ewallet.data_pay_success s on s.order_id=b.order_id 
left join ewallet. pay_transaction_sub_order s2 on b.pay_order_id=s2.trans_sub_order_id 
left join ewallet.pay_card_species cs on s2.card_species_id=cs.card_species_id 
left join ewallet.pay_bank pb on cs.bank_id=pb.bank_id 
left join ewallet.upp_trade_record r on r.platform_id=1 and r.platform_order_id=s2.trans_sub_order_id 
left join ewallet.upp_trade_nocard n on r.id=n.id 
where s2.transaction_state=3 and b.order_time>= ${START} and b.order_time< ${STOP} and b.pay_sys_type<>2 
group by date(b.order_time),
(case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' 
 when b.PRODUCT_CATALOG in ('55') then '_¶æå®' 
 when b.PRODUCT_CATALOG='' then 'ä¸__PI' 
else (case when b.order_origin=0 then '_µè__' 
when b.order_origin=1 then 'ä¸__EB' 
when b.order_origin=2 then 'ä¸__OBILE' 
when b.order_origin=8 then '_____´¢' 
when b.order_origin=9 then 'ç½__ä¸_' 
when b.order_origin=11 then '____' 
else 'ä¸__PI' end) end),
b.trader_id,
(case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end),
pb.code,
n.biz_code
with ur",INNO_STANBY
yjzffinancegroupdailytrx,yjzffinancegroupdailytrx2,"select COALESCE(date(b.order_time),date('2029-09-09'))||
COALESCE((case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' 
when b.PRODUCT_CATALOG in ('55') then '_¶æå®' when b.PRODUCT_CATALOG='' then 'ä¸__PI' else (case when b.order_origin=0 then '_µè__' 
when b.order_origin=1 then 'ä¸__EB' when b.order_origin=2 then 'ä¸__OBILE' when b.order_origin=8 then '_____´¢' 
when b.order_origin=9 then 'ç½__ä¸_' when b.order_origin=11 then '____' else 'ä¸__PI' end) end),'null')||
COALESCE(b.trader_id,'null')||
COALESCE((case when cs.CARD_TYPE_ID=2 then 'DEBIT' when cs.CARD_TYPE_ID=1 then 'CREDIT' else null end),'null')||
COALESCE((case when s2.TMP_CARD_ID > 0 then 'é¦___' else 'ç»____' end),'null')||
COALESCE((case when s.fee_type=1 then '___' when s.fee_type=2 then 'é¢__' when s.fee_type=3 then 'å®__' when s.fee_type=4 then 'é¢__å®__' else null end),'null')||
COALESCE(pb.code,'null') as IDNOUSE,
'ONEKEYPAY' as BIZ_GROUP,
date(b.order_time) as TRXDATE,
(case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' 
      when b.PRODUCT_CATALOG in ('55') then '_¶æå®'
      when b.PRODUCT_CATALOG='' then 'ä¸__PI'  
      else (case when b.order_origin=0 then '_µè__' 
            when b.order_origin=1 then 'ä¸__EB' 
            when b.order_origin=2 then 'ä¸__OBILE'  
            when b.order_origin=8 then '_____´¢' 
            when b.order_origin=9 then 'ç½__ä¸_' 
            when b.order_origin=11 then '____' 
            else 'ä¸__PI' end) 
 end) as BIZ_SYSTEM_NAME,
b.trader_id as CUSTOMERNUMBER,
(case when cs.CARD_TYPE_ID=2 then 'DEBIT' 
     when cs.CARD_TYPE_ID=1 then 'CREDIT' 
     else null end) as CARDTYPE,
(case when s2.TMP_CARD_ID > 0 then 'é¦___' else 'ç»____' end) as PAYTYPE,
(case when s.fee_type=1 then '___' 
     when s.fee_type=2 then 'é¢__' 
     when s.fee_type=3 then 'å®__' 
     when s.fee_type=4 then 'é¢__å®__' 
     else null end) as FEETYPE,
pb.code as BANK_CODE,
count(1) as TOTAL_COUNT, 
sum(b.ORDER_AMOUNT) as TOTAL_AMOUNT,
sum(case when b.order_state=1 then 1 else 0 end) as SUCC_COUNT, 
sum(case when b.order_state=1 then b.ORDER_AMOUNT else 0 end) as SUCC_AMOUNT,
sum(case when s2.transaction_state=3 then 1 else 0 end) as FAIL_COUNT,
sum(case when s2.transaction_state=3 then b.ORDER_AMOUNT else 0 end) as FAIL_AMOUNT,
sum(s.seller_fee) as TOTAL_INCOME,
sum(b.BANK_COST) as COST
from ewallet.pay_biz_order b 
left join ewallet.data_pay_success s on b.order_id=s.order_id
left join ewallet.pay_transaction_sub_order s2 on b.pay_order_id=s2.trans_sub_order_id 
left join ewallet.pay_card_species cs on s2.card_species_id=cs.card_species_id 
left join ewallet.pay_bank pb on cs.bank_id=pb.bank_id 
left join ewallet.upp_trade_record r on r.platform_id=1 and s2.trans_sub_order_id =r.platform_order_id
left join ewallet.upp_trade_nocard n on r.id=n.id
where b.order_time>= ${START} and b.order_time< ${STOP} and b.pay_sys_type<>2 
group by date(b.order_time),
(case when b.PRODUCT_CATALOG in ('18','30','56','62') then '____' 
      when b.PRODUCT_CATALOG in ('55') then '_¶æå®' 
      when b.PRODUCT_CATALOG='' then 'ä¸__PI'  
      else (case when b.order_origin=0 then '_µè__' 
            when b.order_origin=1 then 'ä¸__EB' 
            when b.order_origin=2 then 'ä¸__OBILE'  
            when b.order_origin=8 then '_____´¢' 
            when b.order_origin=9 then 'ç½__ä¸_' 
            when b.order_origin=11 then '____' 
            else 'ä¸__PI' end) 
 end),
b.trader_id,
(case when cs.CARD_TYPE_ID=2 then 'DEBIT' 
     when cs.CARD_TYPE_ID=1 then 'CREDIT' 
     else null end),
(case when s2.TMP_CARD_ID > 0 then 'é¦___' else 'ç»____' end),
(case when s.fee_type=1 then '___' 
     when s.fee_type=2 then 'é¢__' 
     when s.fee_type=3 then 'å®__' 
     when s.fee_type=4 then 'é¢__å®__' 
     else null end),
pb.code
with ur",INNO_STANBY
zxmembermonthlytrx,zxprovincebusinesscat1,"select cu.customernumber as CUSTOMERNUMBER,cr.name as PROVINCE,tg.name as BUSINESSCAT
from bigdata_report.CUSTOMERINFO as cu 
left join bigdata_report.cfg_region_info as cr on cu.province=cr.code
left join bigdata_report.cfg_businesscat_info as tg on cu.bussinesscatid=tg.code",bigdata_report
localTest,TBL_TEST_FROM,"SELECT CUSTOMER_NUM, TRX_TOTAL_AMOUNT, BANK_CODE, TRX_DATE, CREATE_TIME
FROM ETL.TBL_TEST_FROM WITH UR",DEV3G
devTaskTest,testfrom,"SELECT CUSTOMER_NUM, TRX_TOTAL_AMOUNT, BANK_CODE, TRX_DATE,CREATE_TIME
FROM ETL.TBL_TEST_FROM WITH UR",DEV3G
frpchannelincrement,frpchannelincrement,"select 
f.id as FRPID,
f.name as CHANNELNAME,
b.id as BANKCODE,
b.briefname as BANKNAME,
'' as CHANNELCARDTYPE,
char(f.id) as TRXCHANNELID
from frp f 
left join bank b on f.bank_id=b.id 
where f.id not in (select frpid from frpchannel)",reportdb
onekeyQualityAnalysis,total,"select ${START} as START, ${STOP} as STOP, TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) TRADE_COUNT,'YJZF_API_FIRST' PRODUCT_TYPE
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID
and apio. CREATE_TIME >=  ${START} and apio. CREATE_TIME <  ${STOP}
and apio.API_TYPE in (5,6,10)
group by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",INNO_STANBY
onekeyQualityAnalysis,succ,"select TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) SUCCESS_COUNT
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (5,6,10) and payo. ORDER_STATE = 1 
group by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",INNO_STANBY
onekeyQualityAnalysis,excep,"select TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) CARDHOLDER_COUNT
from EWALLET.payapi_transaction_order apio,EWALLET.pay_biz_order payo,EWALLET.payapi_payment_order apip
where apio.YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio.CREATE_TIME>=${START} and apio.CREATE_TIME<${STOP}
and apio.API_TYPE in (5,6,10)
and apip.ERROR_CODE in ('100048','100057','100228','100234','100235','100236','100248','411138','411151','411152','411155','411056','400117')
group by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",INNO_STANBY
onekeyQualityTop3error,total_orders,"select TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,min(payo.order_id) id,'YJZF_API_FIRST' PRODUCT_TYPE, 'cnt_total' data_type,count(*) data_value 
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START}  and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (5,6,10)
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5
",INNO_STANBY
onekeyQualityTop3error,err_bank_prp_zong,"select min(payo.order_id) id,'YJZF_API_FIRST' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'1' ANALYSIS_TYPE,apip.ERROR_CODE error, apip.BANK bank, payo.FRP_CODE INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (5,6,10)
and apip.ERROR_CODE not in ('411138','411151','411152','411155','411056','400117')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apip.BANK, payo.FRP_CODE with ur",INNO_STANBY
onekeyQualityTop3error,err_bank_prp_acc,"select min(payo.order_id) id,'YJZF_API_FIRST' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct apip.phone) data_value,TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(apio.CREATE_TIME)/5 rtime,'1' ANALYSIS_TYPE, apip.ERROR_CODE error,apip.BANK bank, payo.FRP_CODE INTER_OR_MER,rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio,EWALLET.pay_biz_order payo,EWALLET.payapi_payment_order apip
where payo.ORDER_STATE<> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (5,6,10)
and apip.ERROR_CODE not in ('411138','411151','411152','411155','411056','400117')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apip.BANK, payo.FRP_CODE with ur",INNO_STANBY
onekeyQualityTop3error,err_mercht_zong,"select min(payo.order_id) id,'YJZF_API_FIRST' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'2' ANALYSIS_TYPE,apip.ERROR_CODE error, apio. MERCHANT_ACCOUNT INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (5,6,10)
and apip.ERROR_CODE not in ('411138','411151','411152','411155','411056','400117')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apio. MERCHANT_ACCOUNT with ur
",INNO_STANBY
onekeyQualityTop3error,err_mercht_acc,"select min(payo.order_id) id,'YJZF_API_FIRST' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct apip.phone) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'2' ANALYSIS_TYPE,apip.ERROR_CODE error, apio. MERCHANT_ACCOUNT INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (5,6,10)
and apip.ERROR_CODE not in ('411138','411151','411152','411155','411056','400117')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apio. MERCHANT_ACCOUNT with ur
",INNO_STANBY
COMMISSIONRJT,COMMISSIONRJT2,"select COALESCE(CHAR(s.customer_number),'null')||COALESCE(CHAR(s.product_code),'null')||char(year(s.SHARE_TIME))||char(month(s.SHARE_TIME))||'COMMISSIONRJT'  as IDNOUSE,  
'COMMISSION_RJT' as type,
13 as biztypeid,
'3011101001001' as product_code,
'3011101001001C' as sales_product_code,
'POSP' as dataorigin,
date(${STOP}) - 1 days as trxdate,
s.customer_number as receiverid,
year(s.SHARE_TIME)*100+month(s.SHARE_TIME) as month,
s.product_code as ordertype,
sum(-s.SHARE_AMOUNT) as trxfee
from poswrite.TD_DADAYSHARE s
where s.agent_code in (select  distinct agent_code from poswrite.TD_SHAREMONTH where SHARE_TIME>= ${START} and SHARE_TIME<${STOP} and status !='WRONG')
and s.share_time>= ${START} and s.share_time<${STOP}  and s.status !='WRONG' 
group by s.customer_number,s.product_code,year(s.SHARE_TIME),month(s.SHARE_TIME)
with ur
",opendb
COMMISSIONRJT,customernumber2id1,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
COMMISSION,COMMISSIONadjust_nohk,"SELECT COALESCE(CHAR(CUSTOMER_NUM),'null')||'COMMISSIONadjust_nohk'||char(coalesce(C.BIZ_TYPE,'null'))||char(coalesce(R.REASON,'null'))||char(coalesce(R.PROFIT_MONTH,'null')) as IDNOUSE,
    year(${START})*100+month(${START}) as month, date(${STOP}) - 1 days as trxdate,
    CUSTOMER_NUM AS receiverid,
    (case when C.BIZ_TYPE='netPay' then 4
      when C.BIZ_TYPE='memberPay' then 18
      when C.BIZ_TYPE='creditPay' then 5
      when C.BIZ_TYPE='epos' then 6
      when C.BIZ_TYPE='noBankCard' then 19
      when C.BIZ_TYPE='entrusted' then 13
      when C.BIZ_TYPE='pos' then 29
      when C.BIZ_TYPE='transferinday' then 13
      when C.BIZ_TYPE='yjzf' then 222
 ELSE 4 END) as biztypeid,
 C.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION_ADJUST' as ORDERTYPE,
'COMMISSION' as TYPE,
'YP3G_COMMISSION' as dataorigin,
R.REASON as MEMO,
date(R.PROFIT_MONTH||'-1') as true_trxdate,
year(date(R.PROFIT_MONTH||'-1') )*100+month(date(R.PROFIT_MONTH||'-1') ) as true_month,
SUM(-c.ADJUST_AMOUNT) AS trxfee   
FROM
    AGENTFR.TBL_ADJUST_DETAIL_CUS C
LEFT JOIN
    AGENTFR.TBL_AGENT A
ON
    C.AGENT_ID = A.ID 
LEFT JOIN  
AGENTFR.TBL_ADJUST_RECORD R 
ON R.ID=C.ADJUST_RECORD_ID 
WHERE
    R.FINISH_YEAR_MONTH='2018-04'
AND (A.PRODUCTION_LINE != 'airTravel'  or A.PRODUCTION_LINE IS NULL)
AND C.BIZ_TYPE !='noBankCard'  
AND R.STATE = 'ADJUSTED' 
GROUP BY
    CUSTOMER_NUM,
    C.BIZ_TYPE,
R.REASON,R.PROFIT_MONTH 
 with ur",agentfr
COMMISSION,COMMISSIONadjust_hk,"SELECT  COALESCE(CHAR(A.NUM),'null')||'COMMISSIONadjust_hk'||char(coalesce(C.BIZ_TYPE,'null'))||coalesce(R.PROFIT_MONTH,'null')||char(coalesce(R.REASON,'null')) as IDNOUSE,
   year(${START})*100+month(${START}) as month, date(${STOP}) - 1 days as trxdate,
    A.NUM  AS receiverid,
    (case when C.BIZ_TYPE='netPay' then 4
      when C.BIZ_TYPE='memberPay' then 18
      when C.BIZ_TYPE='creditPay' then 5
      when C.BIZ_TYPE='epos' then 6
      when C.BIZ_TYPE='noBankCard' then 19
      when C.BIZ_TYPE='entrusted' then 13
      when C.BIZ_TYPE='pos' then 29
      when C.BIZ_TYPE='transferinday' then 13
      when C.BIZ_TYPE='yjzf' then 222
ELSE 4 END) as biztypeid,
C.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION_ADJUST' as ORDERTYPE,
'COMMISSION_HK' as TYPE,
'YP3G_COMMISSION' as dataorigin,
R.REASON as MEMO,
date(R.PROFIT_MONTH||'-1') as true_trxdate,
year(date(R.PROFIT_MONTH||'-1') )*100+month(date(R.PROFIT_MONTH||'-1') ) as true_month,
 SUM(-c.ADJUST_AMOUNT) AS trxfee
FROM
    AGENTFR.TBL_ADJUST_DETAIL_CUS C
LEFT JOIN
    AGENTFR.TBL_AGENT A
ON
    C.AGENT_ID = A.ID 
LEFT JOIN 
AGENTFR.TBL_ADJUST_RECORD R 
ON R.ID=C.ADJUST_RECORD_ID 
WHERE
    R.FINISH_YEAR_MONTH='2018-04'
AND A.PRODUCTION_LINE = 'airTravel' 
AND C.BIZ_TYPE!='noBankCard'   
AND R.STATE = 'ADJUSTED'
GROUP BY
    A.NUM,
    C.BIZ_TYPE,R.REASON,R.PROFIT_MONTH  
with ur",agentfr
COMMISSION,COMMISSION_nohk," SELECT COALESCE(CHAR(d.CUSTOMER_NUM),'null')||'201804'||'COMMISSION_nohk'||char(coalesce(d.BIZ_TYPE,'null'))||coalesce(d.BANK_CODE,'null')  as IDNOUSE,
    201804 as month, '2018-04-30' as trxdate,
   d.CUSTOMER_NUM AS receiverid,
   (case when d.BIZ_TYPE='netPay' then 4
      when d.BIZ_TYPE='memberPay' then 18
      when d.BIZ_TYPE='creditPay' then 5
      when d.BIZ_TYPE='epos' then 6
      when d.BIZ_TYPE='noBankCard' then
      (case
        when d.BANK_CODE='JIUYOU' then 7
        when d.BANK_CODE='JUNNET' then 8
        when d.BANK_CODE='LIANHUAOKCARD' then 9
        when d.BANK_CODE='NETEASE' then 10
        when d.BANK_CODE='QQCARD' then 12
        when d.BANK_CODE='SHTEL' then 14
        when d.BANK_CODE='SHTELCARD' then 15
        when d.BANK_CODE='SNDACARD' then 16
        when d.BANK_CODE='SOHU' then 17
        when d.BANK_CODE='SZX' then 19
        when d.BANK_CODE='TELECOM' then 20
        when d.BANK_CODE='UNICOM' then 22
        when d.BANK_CODE='WANMEI' then 23
        when d.BANK_CODE='YPCARD' then 24
        when d.BANK_CODE='ZHENGTU' then 25
        when d.BANK_CODE='ZHIFUKA' then 26
        when d.BANK_CODE='TIANXIA' then 41
        when d.BANK_CODE='ZONGYOU' then 81
        when d.BANK_CODE='TIANHONG' then 101
        when d.BANK_CODE='THIRTYTWOCARD' then 242
        when d.BANK_CODE='YICHONGCARD' then 243
        when d.BANK_CODE='YICHONGTIANHONGCARD' then 281
        when d.BANK_CODE='YICHONGZONGYOUCARD' then 282
        when d.BANK_CODE='YICHONGTHIRTYTWOCARD' then 283
        when d.BANK_CODE='ZYZC' then 285
        when d.BANK_CODE='ZYFK' then 286
        else 19 end)
      when d.BIZ_TYPE='entrusted' then 13
      when d.BIZ_TYPE='pos' then 29
      when d.BIZ_TYPE='transferinday' then 13
      when d.BIZ_TYPE='yjzf' then 222
ELSE 4 END) as biztypeid,
  d.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION' as ORDERTYPE,
'COMMISSION' as TYPE, 
'YP3G_COMMISSION' as dataorigin,
  SUM(-d.PROFIT_AMOUNT) AS trxfee
FROM
    agentfr.TBL_PROFIT_DETAIL d
LEFT JOIN
    agentfr.TBL_PROFIT_RECORD r
ON
    d.PROFIT_RECORD_ID = r.id
LEFT JOIN
    agentfr.TBL_AGENT a
ON
    a.id = d.AGENT_ID
AND a.id = r.AGENT_ID
WHERE
    r.PROFIT_CONFIRM_STATE='CALCULATED'
AND d.STATUS='ACTIVE'
AND r.PROFIT_YEAR='2018'  
AND r.PROFIT_MONTH='4'
AND (a.PRODUCTION_LINE != 'airTravel' or  a.PRODUCTION_LINE IS NULL)
AND (d.BIZ_TYPE!='noBankCard' or d.BIZ_TYPE is null)
GROUP BY
    d.CUSTOMER_NUM,
    d.BANK_CODE,
    d.BIZ_TYPE
    with ur",agentfr
COMMISSION,COMMISSION_hk,"SELECT COALESCE(CHAR(a.NUM),'null')||'201804'||'COMMISSION_hk'||char(coalesce(d.BIZ_TYPE,'null'))||coalesce(d.BANK_CODE,'null')   as IDNOUSE,
 201804 as month, '2018-04-30' as trxdate,
    a.NUM AS receiverid ,
   (case when d.BIZ_TYPE='netPay' then 4
      when d.BIZ_TYPE='memberPay' then 18
      when d.BIZ_TYPE='creditPay' then 5
      when d.BIZ_TYPE='epos' then 6
      when d.BIZ_TYPE='noBankCard' then
      (case
        when d.BANK_CODE='JIUYOU' then 7
        when d.BANK_CODE='JUNNET' then 8
        when d.BANK_CODE='LIANHUAOKCARD' then 9
        when d.BANK_CODE='NETEASE' then 10
        when d.BANK_CODE='QQCARD' then 12
        when d.BANK_CODE='SHTEL' then 14
        when d.BANK_CODE='SHTELCARD' then 15
        when d.BANK_CODE='SNDACARD' then 16
        when d.BANK_CODE='SOHU' then 17
        when d.BANK_CODE='SZX' then 19
        when d.BANK_CODE='TELECOM' then 20
        when d.BANK_CODE='UNICOM' then 22
        when d.BANK_CODE='WANMEI' then 23
        when d.BANK_CODE='YPCARD' then 24
        when d.BANK_CODE='ZHENGTU' then 25
        when d.BANK_CODE='ZHIFUKA' then 26
        when d.BANK_CODE='TIANXIA' then 41
        when d.BANK_CODE='ZONGYOU' then 81
        when d.BANK_CODE='TIANHONG' then 101
        when d.BANK_CODE='THIRTYTWOCARD' then 242
        when d.BANK_CODE='YICHONGCARD' then 243
        when d.BANK_CODE='YICHONGTIANHONGCARD' then 281
        when d.BANK_CODE='YICHONGZONGYOUCARD' then 282
        when d.BANK_CODE='YICHONGTHIRTYTWOCARD' then 283
        when d.BANK_CODE='ZYZC' then 285
        when d.BANK_CODE='ZYFK' then 286
        else 19 end)
      when d.BIZ_TYPE='entrusted' then 13
      when d.BIZ_TYPE='pos' then 29
      when d.BIZ_TYPE='transferinday' then 13
      when d.BIZ_TYPE='yjzf' then 222
ELSE 4 END) as biztypeid,
d.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION' as ORDERTYPE,
'COMMISSION_HK' as TYPE, 
'YP3G_COMMISSION' as dataorigin,
  SUM(-d.PROFIT_AMOUNT) AS trxfee
FROM
    agentfr.TBL_PROFIT_DETAIL d
LEFT JOIN
    agentfr.TBL_PROFIT_RECORD r
ON
    d.PROFIT_RECORD_ID = r.id
LEFT JOIN
    agentfr.TBL_AGENT a
ON
    a.id = d.AGENT_ID
AND a.id = r.AGENT_ID
WHERE
    r.PROFIT_CONFIRM_STATE='CALCULATED'
AND d.STATUS='ACTIVE'
AND r.PROFIT_YEAR='2018'
AND r.PROFIT_MONTH='4'
AND a.PRODUCTION_LINE = 'airTravel' 
AND d.BIZ_TYPE!='noBankCard'
GROUP BY
   a.num,
d.BANK_CODE,
    d.BIZ_TYPE
    with ur",agentfr
COMMISSION,COMMISSIONftransform1,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
COMMISSION,COMMISSIONftransform2,"select PAYPRODUCT,salesproductcode as SALES_PRODUCT_CODE from payproduct2productcode",reportdb
COMMISSION,COMMISSIONftransform3,"select PAYPRODUCT,productcode as PRODUCT_CODE from payproduct2productcode",reportdb
PublishedMonthlyTrxStat,PublishedMonthlyTrxStatpayer,"select 
char(COALESCE(m.CUSTOMERID,0))||COALESCE(c.CUSTOMERNUMBER,'null')||COALESCE(c.FULLNAME,'null')||char(COALESCE(m.SALESID,0))||char(COALESCE(m.AREAID,0))||char(COALESCE(m.biztypeid,0))||COALESCE(m.TYPE,'null') ||char(COALESCE(m.salesscale,1))||char(COALESCE(m.isShareCustomer,0))||char(COALESCE(m.isself,1))||COALESCE(m.productgroup,'null')||COALESCE(m.businesscatid,'null')||COALESCE(m.branchcompany,'null')||COALESCE(m.product_code,'null')||COALESCE(m.sales_product_code,'null')||COALESCE(m.managemark,'null')||char(COALESCE(c2a.ACHIEVEMENT_ID,0))||'PAYER'||char(COALESCE(m.true_month,0)) as IDNOUSE,
1586 as timeLatitudeId,201701 as MONTH,m.true_month,m.CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME as customerName,m.SALESID as saleid,0 as teamId,m.AREAID,0 as productLineId,
m.biztypeid, m.TYPE as trxTypeId,sum(m.trxcount*m.salesscale*coalesce(c2a.PERCENT,1)) as trxcount,sum(m.trxamount*m.salesscale*coalesce(c2a.PERCENT,1)) as trxamount,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)) as innerincome,
sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as innerCost,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as innerprofit,'PAYER' as grouptype,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as accountingCost,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as accountingProfit,
m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT
from monthlytrxstat m left join customerinfo c on m.CUSTOMERID=c.ID left join customer2achievement c2a on c. customernumber=c2a.customer_number
where m.month=201701 and m.customertype in ('PAYER','INDI') group by m.CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME,m.SALESID,m.AREAID,m.biztypeid, m.TYPE,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT,m.true_month with ur",reportdb
PublishedMonthlyTrxStat,PublishedMonthlyTrxStatpayer2,"select 
char(COALESCE(m.CUSTOMERID,0))||COALESCE(c.CUSTOMERNUMBER,'null')||COALESCE(c.FULLNAME,'null')||char(COALESCE(m.SALESID,0))||char(COALESCE(m.AREAID,0))||char(COALESCE(m.biztypeid,0))||COALESCE(m.TYPE,'null') ||char(COALESCE(m.salesscale,1))||char(COALESCE(m.isShareCustomer,0))||char(COALESCE(m.isself,1))||COALESCE(m.productgroup,'null')||COALESCE(m.businesscatid,'null')||COALESCE(m.branchcompany,'null')||COALESCE(m.product_code,'null')||COALESCE(m.sales_product_code,'null')||COALESCE(m.managemark,'null')||char(COALESCE(c2a.ACHIEVEMENT_ID,0))||'PAYER'||char(COALESCE(m.true_month,0)) as IDNOUSE,
1586 as timeLatitudeId,201701 as MONTH,m.true_month,m.CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME as customerName,m.SALESID as saleid,0 as teamId,m.AREAID,0 as productLineId,
m.biztypeid, m.TYPE as trxTypeId,coalesce(sum(m.trxcount*m.salesscale*coalesce(c2a.PERCENT,1)),0) as trxcount,coalesce(sum(m.trxamount*m.salesscale*coalesce(c2a.PERCENT,1)),0) as trxamount,coalesce(sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)),0) as innerincome,
coalesce(sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)),0) as innerCost,coalesce(sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)),0) as innerprofit,'PAYER' as grouptype,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,coalesce(sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)),0) as accountingCost,coalesce(sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)),0) as accountingProfit,
m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT 
from monthlytrxstat m left join customerinfo c on m.CUSTOMERID=c.ID  left join customer2achievement c2a on c. customernumber=c2a.customer_number
where m.month=201701 and m.customertype = 'RECEIVER' and (m.biztypeid not in (2,5,18,241) or m.type in ('POSTPAID','ADJUST')) group by m.CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME,m.SALESID,m.AREAID,m.biztypeid, m.TYPE,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT,m.true_month  with ur",reportdb
PublishedMonthlyTrxStat,PublishedMonthlyTrxStatadd,"select char(coalesce(salesid,0))||char(coalesce(bizTypeId,0))||char(coalesce(salesid,0))||char(coalesce(productlineid,0))||char(coalesce(t.areaid,0))||coalesce(type,'')||coalesce(productGroup,'')||coalesce(businessCatId,'')||coalesce(a.AREAID,'')||coalesce(product_code,'')||coalesce(sales_product_code,'')||char(coalesce(t.yejishuxing,0))||'RECEIVER'||char(COALESCE(t.memomonth,0)) as IDNOUSE,1586 as timeLatitudeId,201701 as MONTH,t.memomonth as true_month,salesid,bizTypeId,salesid as saleid,0 as teamId,productlineid,t.areaid,type as trxTypeId,productGroup,businessCatId,a.AREAID as branchcompany,product_code,sales_product_code,'RECEIVER' as grouptype,sum(income) as innerincome,sum(cost) as innerCost,sum(income-cost) as INNERPROFIT,sum(accountingcost) as accountingCost,sum(income-accountingcost) as ACCOUNTINGPROFIT, sum(trxcount) as trxcount, sum(trxamount) as trxamount,t.yejishuxing as ACHIEVEMENT_ID,1 as PERCENT from TrxStatAdditionalStatFee t left join trxstatcustomerarea a on t.branchid=a.id where  month=201701 and iscomputeprofit=1 group by salesid,bizTypeId,salesid,productlineid,t.areaid,type,productGroup,businessCatId,a.AREAID,product_code,sales_product_code,t.yejishuxing,t.memomonth  with ur
",reportdb
PublishedMonthlyTrxStat,PublishedMonthlyTrxStatadd2,"select char(coalesce(salesid,0))||char(coalesce(bizTypeId,0))||char(coalesce(salesid,0))||char(coalesce(productlineid,0))||char(coalesce(t.areaid,0))||coalesce(type,'')||coalesce(productGroup,'')||coalesce(businessCatId,'')||coalesce(a.AREAID,'')||coalesce(product_code,'')||coalesce(sales_product_code,'')||char(coalesce(t.yejishuxing,0))||'PAYER'||char(COALESCE(t.memomonth,0)) as IDNOUSE,1586 as timeLatitudeId,201701 as MONTH,t.memomonth as true_month,salesid,bizTypeId,salesid as saleid,0 as teamId,productlineid,t.areaid,type as trxTypeId,productGroup,businessCatId,a.AREAID as branchcompany,product_code,sales_product_code,'PAYER' as grouptype,sum(income) as innerincome,sum(cost) as innerCost,sum(income-cost) as INNERPROFIT,sum(accountingcost) as accountingCost,sum(income-accountingcost) as ACCOUNTINGPROFIT, sum(trxcount) as trxcount, sum(trxamount) as trxamount, t.yejishuxing as ACHIEVEMENT_ID,1 as PERCENT from TrxStatAdditionalStatFee t left join trxstatcustomerarea a on t.branchid=a.id where  month=201701 and iscomputeprofit=1 group by salesid,bizTypeId,salesid,productlineid,t.areaid,type,productGroup,businessCatId,a.AREAID,product_code,sales_product_code,t.yejishuxing,t.memomonth  with ur
",reportdb
remitrealtime,remitrealtimetotal,"SELECT  COALESCE(dt,date('2029-09-09'))||'remitrealtimetotal' as IDNOUSE,
    dt as dt_str,
    dt,
    t_n,
    s_n,
    f_n,
 (case when t_n<>0 then CAST((s_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) s_p,
 (case when t_n<>0 then CAST((f_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) f_p
FROM
    (
        SELECT
            dt,
            SUM(1)                                  t_n,
            SUM(DECODE(status,'REMIT_SUCCESS',1,0)) s_n,
            SUM(DECODE(status,'REMIT_FAILURE',1,0)) f_n
        FROM
            (
                SELECT
                    DATE(DECODE(req0.remit_appointment_date,NULL,req0.create_date,
                    req0.remit_appointment_date)) dt,
                    req0.id,
                    req0.status
                FROM
                    remit.tbl_remit_request req0
                WHERE
                    req0.id IN
                    (
                        SELECT
                            req.id
                        FROM
                            remit.tbl_remit_request req
                        LEFT JOIN
                            remit.tbl_remit_process pro
                        ON
                            req.remit_request_no = pro.remit_request_no
                        LEFT JOIN
                            remit.tbl_remit_batch bat
                        ON
                            pro.remit_batch_no = bat.remit_batch_no
                        WHERE 1=1
                          AND req.create_date >=${START}
                       AND req.create_date  < ${STOP}
                        AND req.status <> 'CANCEL'
                        AND bat.batch_remit_type = 'AUTO_REAL_TIME'
                        AND instr(bat.remit_channel_no,'CROSSBORDER') < 1
                        AND bat.remit_channel_no not in ('BCCB_KH_YBT_PRI','BCCB_KH_YBT_PUB','NXY','CMBCHINA_YBT_BJ_PUB','BCCB_KRKH_PUB','BCCB_KRKH_PRI','GDBIB_PRI')))
        GROUP BY
            dt)
 with ur
",fundtx
remitrealtime,remitrealtimetoday,"    SELECT 
    dt_str,
    tp_s_n,
    tp_f_n,
    ntp_n,
    (case when t_n<>0 then CAST((tp_s_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) tp_s_p,
    (case when t_n<>0 then CAST((tp_f_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) tp_f_p
FROM
    (
        SELECT
            dt_str,
            SUM(1) t_n,
            SUM(DECODE(status,'REMIT_SUCCESS',
            CASE
                WHEN dt_str = dp
                THEN 1
                ELSE 0
            END,0)) tp_s_n,
            SUM(DECODE(status,'REMIT_FAILURE',
            CASE
                WHEN dt_str = dp
                THEN 1
                ELSE 0
            END,0)) tp_f_n,
            SUM(
                CASE
                    WHEN dt_str <> dp
                    AND dp IS NOT NULL
                    THEN 1
                    ELSE 0
                END) ntp_n
        FROM
            (
                SELECT
                    DATE(DECODE(req0.remit_appointment_date,NULL,req0.create_date,
                    req0.remit_appointment_date)) dt_str ,
                    req0.id,
                    req0.status,
                    DATE(req0.process_date) dp
                FROM
                    remit.tbl_remit_request req0
                WHERE
                    req0.id IN
                    (
                        SELECT
                            req.id
                        FROM
                            remit.tbl_remit_request req
                        LEFT JOIN
                            remit.tbl_remit_process pro
                        ON
                            req.remit_request_no = pro.remit_request_no
                        LEFT JOIN
                            remit.tbl_remit_batch bat
                        ON
                            pro.remit_batch_no = bat.remit_batch_no
                        WHERE
                         1=1
                        AND req.create_date >=${START}
                     AND req.create_date < ${STOP}
                        AND req.status <> 'CANCEL'
                        AND bat.batch_remit_type = 'AUTO_REAL_TIME'
                        AND instr(bat.remit_channel_no,'CROSSBORDER') < 1
                        AND bat.remit_channel_no not in ('BCCB_KH_YBT_PRI','BCCB_KH_YBT_PUB','NXY','CMBCHINA_YBT_BJ_PUB','BCCB_KRKH_PUB','BCCB_KRKH_PRI','GDBIB_PRI')))
        GROUP BY
            dt_str)
 with ur",fundtx
remitrealtime,remitrealtimehour,"SELECT
	dt_str,
	p_30_n,
	p_60_n,
	p_120_n,
	p_240_n,
	p_241_n,
	(
		CASE
			WHEN t_n <> 0 THEN CAST(
				(p_30_n*1.00000) / t_n AS DECIMAL(
					14,
					5
				)
			)
			ELSE 0
		END
	) s_30_p,
	(
		CASE
			WHEN t_n <> 0 THEN CAST(
				(p_60_n*1.00000) / t_n AS DECIMAL(
					14,
					5
				)
			)
			ELSE 0
		END
	) s_60_p,
	(
		CASE
			WHEN t_n <> 0 THEN CAST(
				(p_120_n*1.00000) / t_n AS DECIMAL(
					14,
					5
				)
			)
			ELSE 0
		END
	) s_120_p,
	(
		CASE
			WHEN t_n <> 0 THEN CAST(
				(p_240_n*1.00000) / t_n AS DECIMAL(
					14,
					5
				)
			)
			ELSE 0
		END
	) s_240_p,
	(
		CASE
			WHEN t_n <> 0 THEN CAST(
				(p_241_n*1.00000) / t_n AS DECIMAL(
					14,
					5
				)
			)
			ELSE 0
		END
	) s_241_p
FROM
	(
		SELECT
			dt_str,
			SUM( 1 ) t_n,
			SUM( DECODE( status, 'REMIT_SUCCESS', CASE WHEN mint <= 30 THEN 1 ELSE 0 END, 0 ) ) p_30_n,
			SUM( DECODE( status, 'REMIT_SUCCESS', CASE WHEN mint > 30 AND mint <= 60 THEN 1 ELSE 0 END, 0 ) ) p_60_n,
			SUM( DECODE( status, 'REMIT_SUCCESS', CASE WHEN mint > 60 AND mint <= 120 THEN 1 ELSE 0 END, 0 ) ) p_120_n,
			SUM( DECODE( status, 'REMIT_SUCCESS', CASE WHEN mint > 120 AND mint <= 240 THEN 1 ELSE 0 END, 0 ) ) p_240_n,
			SUM( DECODE( status, 'REMIT_SUCCESS', CASE WHEN mint > 240 THEN 1 ELSE 0 END, 0 ) ) p_241_n
		FROM
			(
				SELECT
					DATE(
						DECODE(
							req0.remit_appointment_date,
							NULL,
							req0.create_date,
							req0.remit_appointment_date
						)
					) dt_str,
					req0.id,
					req0.status,
					TIMESTAMPDIFF( 4, CHAR( DECODE( req0.process_date, NULL, CURRENT TIMESTAMP, req0.process_date ) - DECODE( req0.remit_appointment_date, NULL, req0.create_date, req0.remit_appointment_date ) ) ) mint
				FROM
					remit.tbl_remit_request req0
				WHERE
					req0.id IN(
						SELECT
							req.id
						FROM
							remit.tbl_remit_request req
						LEFT JOIN remit.tbl_remit_process pro ON
							req.remit_request_no = pro.remit_request_no
						LEFT JOIN remit.tbl_remit_batch bat ON
							pro.remit_batch_no = bat.remit_batch_no
						WHERE
							1 = 1
							AND req.create_date >= ${START}
							AND req.create_date < ${STOP}
							AND req.status <> 'CANCEL'
							AND bat.batch_remit_type = 'AUTO_REAL_TIME'
							AND instr(
								bat.remit_channel_no,
								'CROSSBORDER'
							) < 1
							AND bat.remit_channel_no NOT IN(
								'BCCB_KH_YBT_PRI',
								'BCCB_KH_YBT_PUB',
								'NXY',
								'CMBCHINA_YBT_BJ_PUB',
								'BCCB_KRKH_PUB',
								'BCCB_KRKH_PRI',
								'GDBIB_PRI'
							)
					)
			)
		GROUP BY
			dt_str
	) WITH ur",fundtx
remitnonrealtime,remitnonrealtimetotal,"SELECT	COALESCE(act,date('2029-09-09'))||'remitnonrealtimetotal' as IDNOUSE,
    act as act_str,
    act,	
    t_n,	
    s_n,	
    f_n,	
    (case when t_n <>0 then CAST((s_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) s_p,
    (case when t_n <>0 then CAST((f_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) f_p	
FROM	
    (	
        SELECT	
            act,	
            SUM(1)                                  t_n,	
            SUM(DECODE(status,'REMIT_SUCCESS',1,0)) s_n,	
            SUM(DECODE(status,'REMIT_FAILURE',1,0)) f_n	
        FROM	
            (	
                SELECT	
                    DATE(a.accept_date) act,	
                    a.id,	
                    a.status	
                FROM	
                    (	
                        SELECT	
                            ROW_NUMBER() OVER(PARTITION BY req.id ORDER BY bat.accept_date ASC) rid	
                            ,	
                            req.id,	
                            req.create_date,	
                            req.remit_appointment_date,	
                            req.status,	
                            req.process_date,	
                            bat.accept_date	
                        FROM	
                            remit.tbl_remit_request req	
                        LEFT JOIN	
                            remit.tbl_remit_process pro	
                        ON	
                            req.remit_request_no = pro.remit_request_no	
                        LEFT JOIN	
                            remit.tbl_remit_batch bat	
                        ON	
                            pro.remit_batch_no = bat.remit_batch_no	
                        WHERE 1=1	
                         AND bat.accept_date >=${START}
                        AND bat.accept_date < ${STOP}	
                        AND req.status <> 'CANCEL'	
                        AND bat.batch_remit_type <> 'AUTO_REAL_TIME'	
                        AND instr(bat.remit_channel_no,'CROSSBORDER') < 1	
                        AND bat.remit_channel_no not in ('BCCB_KH_YBT_PRI','BCCB_KH_YBT_PUB','NXY','CMBCHINA_YBT_BJ_PUB','BCCB_KRKH_PUB','BCCB_KRKH_PRI','GDBIB_PRI')) a	
                WHERE	
                    a.rid = 1)	
        GROUP BY	
            act)	
 with ur",fundtx
remitnonrealtime,remitnonrealtimetoday,"SELECT 
    act_str,		
    tp_s_n,	
    tp_f_n,	
    ntp_n,	
   (case when t_n<>0 then CAST((tp_s_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) tp_s_p,	
   (case when t_n<>0 then CAST((tp_f_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) tp_f_p	
FROM	
    (	
        SELECT	
            act_str,	
            SUM(1) t_n,	
            SUM(DECODE(status,'REMIT_SUCCESS',	
            CASE	
                WHEN act_str = dp	
                THEN 1	
                ELSE 0	
            END,0)) tp_s_n,	
            SUM(DECODE(status,'REMIT_FAILURE',	
            CASE	
                WHEN act_str = dp	
                THEN 1	
                ELSE 0	
            END,0)) tp_f_n,	
            SUM(	
                CASE	
                    WHEN act_str <> dp	
                    AND dp IS NOT NULL	
                    THEN 1	
                    ELSE 0	
                END) ntp_n	
        FROM	
            (	
                SELECT	
                    DATE(a.accept_date) act_str,	
                    a.id,	
                    a.status,	
                    DATE(a.process_date) dp	
                FROM	
                    (	
                        SELECT	
                            ROW_NUMBER() OVER(PARTITION BY req.id ORDER BY bat.accept_date ASC) rid	
                            ,	
                            req.id,	
                            req.create_date,	
                            req.remit_appointment_date,	
                            req.status,	
                            req.process_date,	
                            bat.accept_date	
                        FROM	
                            remit.tbl_remit_request req	
                        LEFT JOIN	
                            remit.tbl_remit_process pro	
                        ON	
                            req.remit_request_no = pro.remit_request_no	
                        LEFT JOIN	
                            remit.tbl_remit_batch bat	
                        ON	
                            pro.remit_batch_no = bat.remit_batch_no	
                        WHERE 1=1	
                         AND bat.accept_date >=${START}	
                        AND bat.accept_date < ${STOP}	
                        AND req.status <> 'CANCEL'	
                        AND bat.batch_remit_type <> 'AUTO_REAL_TIME'	
                        AND instr(bat.remit_channel_no,'CROSSBORDER') < 1	
                        AND bat.remit_channel_no not in ('BCCB_KH_YBT_PRI','BCCB_KH_YBT_PUB','NXY','CMBCHINA_YBT_BJ_PUB','BCCB_KRKH_PUB','BCCB_KRKH_PRI','GDBIB_PRI')) a	
                WHERE	
                    a.rid = 1)	
        GROUP BY	
            act_str)	
 with ur",fundtx
remitnonrealtime,remitnonrealtimehour,"SELECT	
    act_str,		
    p_30_n,	
    p_60_n,	
    p_120_n,	
    p_240_n,	
    p_241_n,	
    (case when t_n<>0 then CAST((p_30_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) s_30_p,	
    (case when t_n<>0 then CAST((p_60_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end)  s_60_p,	
    (case when t_n<>0 then CAST((p_120_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) s_120_p,	
    (case when t_n<>0 then CAST((p_240_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) s_240_p,	
    (case when t_n<>0 then CAST((p_241_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end) s_241_p	
FROM	
    (	
        SELECT	
            act_str,	
            SUM(1) t_n,	
            SUM(DECODE(status,'REMIT_SUCCESS',	
            CASE	
                WHEN mint <= 30	
                THEN 1	
                ELSE 0	
            END,0)) p_30_n,	
            SUM(DECODE(status,'REMIT_SUCCESS',	
            CASE	
                WHEN mint > 30	
                AND mint <= 60	
                THEN 1	
                ELSE 0	
            END,0)) p_60_n,	
            SUM(DECODE(status,'REMIT_SUCCESS',	
            CASE	
                WHEN mint > 60	
                AND mint <= 120	
                THEN 1	
                ELSE 0	
            END,0)) p_120_n,	
            SUM(DECODE(status,'REMIT_SUCCESS',	
            CASE	
                WHEN mint > 120	
                AND mint <= 240	
                THEN 1	
                ELSE 0	
            END,0)) p_240_n,	
            SUM(DECODE(status,'REMIT_SUCCESS',	
            CASE	
                WHEN mint > 240	
                THEN 1	
                ELSE 0	
            END,0)) p_241_n	
        FROM	
            (	
                SELECT	
                    DATE(a.accept_date) act_str,	
                    a.id,	
                    a.status,	
                    timestampdiff(4,CHAR(DECODE(a.process_date,NULL,CURRENT TIMESTAMP,	
                    a.process_date) - a.accept_date)) mint	
                FROM	
                    (	
                        SELECT	
                            ROW_NUMBER() OVER(PARTITION BY req.id ORDER BY bat.accept_date ASC) rid	
                            ,	
                            req.id,	
                            req.create_date,	
                            req.remit_appointment_date,	
                            req.status,	
                            req.process_date,	
                            bat.accept_date	
                        FROM	
                            remit.tbl_remit_request req	
                        LEFT JOIN	
                            remit.tbl_remit_process pro	
                        ON	
                            req.remit_request_no = pro.remit_request_no	
                        LEFT JOIN	
                            remit.tbl_remit_batch bat	
                        ON	
                            pro.remit_batch_no = bat.remit_batch_no	
                        WHERE 1=1	
                        AND bat.accept_date >=${START}	
                        AND bat.accept_date < ${STOP}	
                        AND req.status <> 'CANCEL'	
                        AND bat.batch_remit_type <> 'AUTO_REAL_TIME'	
                        AND instr(bat.remit_channel_no,'CROSSBORDER') < 1	
                        AND bat.remit_channel_no not in ('BCCB_KH_YBT_PRI','BCCB_KH_YBT_PUB','NXY','CMBCHINA_YBT_BJ_PUB','BCCB_KRKH_PUB','BCCB_KRKH_PRI','GDBIB_PRI')) a	
                WHERE	
                    a.rid = 1)	
        GROUP BY	
            act_str)	
 with ur",fundtx
remitchannel2hours,remitchannel2hours,"SELECT  COALESCE(act,date('2029-09-09'))||COALESCE(remit_channel_name,'null')||COALESCE(remit_type,'null')||'remitchannel2hours' as IDNOUSE,
    act,	
    remit_channel_name,	
    remit_type,	
    t_n,	
    t_a,	
    s_n,	
    s_a,	
    p_120_n,	
    p_120_a,	
 (case when t_n<>0 then CAST((s_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end)  s_p,
 (case when t_n<>0 then CAST((p_120_n*1.00000)/t_n AS DECIMAL(14,5)) else 0 end)  s_120_p
FROM	
    (	
        SELECT	
            act,	
            remit_channel_no,	
            decode(batch_remit_type,'AUTO_REAL_TIME','REAL','NOREAL') remit_type,	
            SUM(1)                                       t_n,	
            SUM(amount)                                  t_a,	
            SUM(DECODE(status,'REMIT_SUCCESS',1,0))      s_n,	
            SUM(DECODE(status,'REMIT_SUCCESS',amount,0)) s_a,	
            SUM(DECODE(status,'REMIT_SUCCESS',	
            CASE	
                WHEN mint <= 120	
                THEN 1	
                ELSE 0	
            END,0)) p_120_n,	
            SUM(DECODE(status,'REMIT_SUCCESS',	
            CASE	
                WHEN mint <= 120	
                THEN amount	
                ELSE 0	
            END,0)) p_120_a	
        FROM	
            (	
                SELECT	
                    DATE(accept_date) act,	
                    remit_channel_no,	
                    batch_remit_type,	
                    id,	
                    amount,	
                    status,	
                    timestampdiff(4,CHAR(process_date - accept_date)) mint	
                FROM	
                    (	
                        SELECT	
                            id,	
                            create_date,	
                            remit_appointment_date,	
                            status,	
                            process_date,	
                            accept_date,	
                            batch_remit_type,	
                            remit_channel_no,	
                            amount	
                        FROM	
                            (	
                                SELECT	
                                    ROW_NUMBER() OVER(PARTITION BY req.id ORDER BY bat.accept_date	
                                    ASC) rid ,	
                                    req.id,	
                                    req.create_date,	
                                    req.remit_appointment_date,	
                                    req.status,	
                                    req.process_date,	
                                    bat.accept_date,	
                                    bat.batch_remit_type,	
                                    bat.remit_channel_no,	
                                    req.amount	
                                FROM	
                                    remit.tbl_remit_request req	
                                LEFT JOIN	
                                    remit.tbl_remit_process pro	
                                ON	
                                    req.remit_request_no = pro.remit_request_no	
                                LEFT JOIN	
                                    remit.tbl_remit_batch bat	
                                ON	
                                    pro.remit_batch_no = bat.remit_batch_no	
                                WHERE 1=1	
                                 AND bat.accept_date >=${START}	
                                AND bat.accept_date < ${STOP}
                                AND req.status <> 'CANCEL'	
                                AND instr(bat.remit_channel_no,'CROSSBORDER') < 1) a	
                        WHERE	
                            a.rid = 1))	
        GROUP BY	
            act,	
            remit_channel_no,	
            decode(batch_remit_type,'AUTO_REAL_TIME','REAL','NOREAL')) x	
LEFT JOIN	
    remit.tbl_remit_channel c	
ON	
    x.remit_channel_no = c.remit_channel_no	
 with ur",fundtx
testT,asdfsad,sdafsdafdsa,COPY2
testT1,sdafsdafsadf,asdfsdaf,billdb
qianbaodailyrisk,qianbaodailyrisk,"select ID,
RECEIVE_DATE,
TRADE_DATE,
CUSTOMER_NO,
BANK_NAME,
CARD_NO,
TRADE_COUNT,
TOTAL_AMOUNT
from member.TBL_RISK_STATISTIC
where UPDATE_TIME>= ${START} and UPDATE_TIME< ${STOP}
with ur",member
tztpayqualityAnalysis,tzt_total,"select TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) TRADE_COUNT,'TZT_ZF' PRODUCT_TYPE
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and payo.PRODUCT_CATALOG in ('18','30')
and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174') 
group by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur
",INNO_STANBY
tztpayqualityAnalysis,tzt_succ,"select TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*)  SUCCESS_COUNT
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME <  ${STOP}
and apio.API_TYPE in (4,7,11) and payo.PRODUCT_CATALOG in ('18','30')
and payo. ORDER_STATE = 1
and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174')
group by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",INNO_STANBY
tztpayqualityAnalysis,excep_tzt_zf,"select TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) CARDHOLDER_COUNT
from EWALLET.payapi_transaction_order apio,EWALLET.pay_biz_order payo,EWALLET.payapi_payment_order apip
where apio.YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio.CREATE_TIME >= ${START} and apio.CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and payo.PRODUCT_CATALOG in ('18','30')
and apip.ERROR_CODE in ('100048','100057','100228','100234','100235','100236','100248','411138','411151','411152','411155')
and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174')
group by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",INNO_STANBY
nonbankagentfr01,nonbankagentfr01,select * from agentfr.TBL_AGENCY_BIZ where BIZ_TYPE = 'noBankCard' with ur,agentfr
nonbankagentfr02,nonbankagentfr02,select * from agentfr.TBL_AGENCY_RELATION where BIZ_TYPE = 'noBankCard' with ur,agentfr
nonbankagentfr03,nonbankagentfr03,select distinct de.* from agentfr.TBL_AGENT AS de inner join agentfr.TBL_AGENCY_BIZ AS co on de.ID = co.AGENT_ID where co.BIZ_TYPE = 'noBankCard' with ur,agentfr
nonbankagentfr04,nonbankagentfr04,select inf.* from agentfr.TBL_AGENT_LOGIN_INF AS inf where inf.AGENT_ID in (select distinct de.id from agentfr.TBL_AGENT AS de inner join agentfr.TBL_AGENCY_BIZ AS co on de.ID = co.AGENT_ID where co.BIZ_TYPE = 'noBankCard') with ur,agentfr
nonbankagentfr05,nonbankagentfr05,select inf.* from agentfr.TBL_COLLECT_BANKCARD AS inf where inf.AGENT_ID in (select distinct de.id from agentfr.TBL_AGENT AS de inner join agentfr.TBL_AGENCY_BIZ  AS co on de.ID = co.AGENT_ID where co.BIZ_TYPE = 'noBankCard') with ur,agentfr
nonbankagentfr06,nonbankagentfr06,select * from agentfr.TBL_PROFIT_RULE where BIZ_TYPE = 'noBankCard' with ur,agentfr
shoukuanbaoverify,skbrealnameauth,"select COALESCE(CHAR(date(CREATE_TIME)),'null')||COALESCE(CHAR(AGENT_CUSTOMER_NUMBER),'null')||'skbrealnameauth' as IDNOUSE,
date(CREATE_TIME) AS TRXDATE,
year(date(CREATE_TIME))*100+month(date(CREATE_TIME)) AS MONTH,
AGENT_CUSTOMER_NUMBER AS RECEIVERID,
'3011004003001' AS PRODUCT_CODE,
'3011004001004A' AS SALES_PRODUCT_CODE,
'REALNAMEAUTH' AS ORDERTYPE,
'SKB_REALNAMEAUTH' AS PAYPRODUCT,
226  AS BIZTYPEID,
'RealNameAuth' AS TYPE,
1  AS ISCOMPUTEPROFIT,
1  AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'SKB' AS DATAORIGIN,
count(*) AS TRXCOUNT,
sum(cost) AS FRPCOST,
sum(cost) AS ACCOUNTINGCOST 
from SKB.TBL_SKB_AUTH_COST 
where STATUS='SUCCESS' and AUTH_TYPE='REALNAME_AUTH' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP} 
group by date(CREATE_TIME),AGENT_CUSTOMER_NUMBER
with ur",accnt
shoukuanbaoverify,skbcardjianquan,"select COALESCE(CHAR(date(CREATE_TIME)),'null')||COALESCE(CHAR(AGENT_CUSTOMER_NUMBER),'null')||'skbcardjianquan' as IDNOUSE,
date(CREATE_TIME) AS TRXDATE,
year(date(CREATE_TIME))*100+month(date(CREATE_TIME))  AS MONTH,
AGENT_CUSTOMER_NUMBER AS RECEIVERID,
'3011004003002' AS PRODUCT_CODE,
'3011004001004A' AS SALES_PRODUCT_CODE,
'CARDJIANQUAN' AS ORDERTYPE,
'SKB_CARDJIANQUAN' AS PAYPRODUCT,
226  AS BIZTYPEID,
'CARDJIANQUAN' AS TYPE,
1  AS ISCOMPUTEPROFIT,
1  AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'SKB' AS DATAORIGIN,
count(*) AS TRXCOUNT,
sum(cost) AS FRPCOST,
sum(cost) AS ACCOUNTINGCOST
from SKB.TBL_SKB_AUTH_COST 
where STATUS='SUCCESS' and AUTH_TYPE='BANKCARD' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP} 
group by date(CREATE_TIME),AGENT_CUSTOMER_NUMBER
with ur",accnt
shoukuanbaoverify,shoukuanbaoverifynum,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
tztpayqualityAnalysisTop3Error,tzt_top3_total_orders,"select TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,min(payo.order_id) id,'TZT_ZF' PRODUCT_TYPE, 'cnt_total' data_type,count(*) data_value 
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and payo.PRODUCT_CATALOG in ('18','30')
and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5
order by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 with ur",INNO_STANBY
tztpayqualityAnalysisTop3Error,tzt_top3_err_bank_prp_zong,"select min(payo.order_id) id,'TZT_ZF' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'1' ANALYSIS_TYPE,apip.ERROR_CODE error, apip.BANK bank, payo.FRP_CODE INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and payo.PRODUCT_CATALOG in ('18','30')
and apip.ERROR_CODE not in ('411138','411151','411152','411155')
and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apip.BANK, payo.FRP_CODE with ur",INNO_STANBY
tztpayqualityAnalysisTop3Error,tzt_top3_err_bank_prp_acc,"select min(payo.order_id) id,'TZT_ZF' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct apip.phone) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'1' ANALYSIS_TYPE,apip.ERROR_CODE error, apip.BANK bank, payo.FRP_CODE INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and payo.PRODUCT_CATALOG in ('18','30')
and apip.ERROR_CODE not in ('411138','411151','411152','411155')
and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apip.BANK, payo.FRP_CODE with ur
",INNO_STANBY
tztpayqualityAnalysisTop3Error,tzt_top3_err_mercht_zong,"select min(payo.order_id) id,'TZT_ZF' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'2' ANALYSIS_TYPE,apip.ERROR_CODE error, apio. MERCHANT_ACCOUNT INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and payo.PRODUCT_CATALOG in ('18','30')
and apip.ERROR_CODE not in ('411138','411151','411152','411155')
and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apio. MERCHANT_ACCOUNT with ur",INNO_STANBY
tztpayqualityAnalysisTop3Error,err_mercht_acc_tzt_zf,"select min(payo.order_id) id,'TZT_ZF' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct apip.phone) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'2' ANALYSIS_TYPE,apip.ERROR_CODE error, apio. MERCHANT_ACCOUNT INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and payo.PRODUCT_CATALOG in ('18','30')
and apip.ERROR_CODE not in ('411138','411151','411152','411155')
and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apio. MERCHANT_ACCOUNT with ur
",INNO_STANBY
tztbkQualityAnalysis,tztbk_total,"select TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,COUNT(*) TRADE_COUNT,'TZT_BK' PRODUCT_TYPE
from EWALLET.PAYAPI_BINDCARD_REQUEST_RECORD d
where
d.CREATE_TIME >=${START}
and d.CREATE_TIME <${STOP}
and d.PRODUCT_CATALOG ='30'
and d.AUTH_VERIFY_TYPE ='AUTH'
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",INNO_STANBY
tztbkQualityAnalysis,tztbk_succ,"select TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,COUNT(*) SUCCESS_COUNT
from EWALLET.PAYAPI_BINDCARD_REQUEST_RECORD d
where
d.CREATE_TIME >=${START}
and d.CREATE_TIME <${STOP}
and d.STATUS in (1,4)
and d.PRODUCT_CATALOG ='30'
and d.AUTH_VERIFY_TYPE ='AUTH'
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",INNO_STANBY
tztbkQualityAnalysis,excep_tzt_bk,"select TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT
from EWALLET.PAYAPI_BINDCARD_REQUEST_RECORD d
where
d.CREATE_TIME >=${START}
and d.CREATE_TIME < ${STOP}
and d.PRODUCT_CATALOG ='30'
and d.AUTH_VERIFY_TYPE ='AUTH'
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur
",INNO_STANBY
zgtwapQualityAnalysis,zgtwap_total,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')  HAPPEN_DATE,count(distinct TRADE_SYS_ORDER_ID) TRADE_COUNT,'ZGT_WAP' PRODUCT_TYPE from  nccashier.TBL_NCCA_PAY_REC WHERE ID IN (select MAX(ID) FROM nccashier.TBL_NCCA_PAY_REC where  CREATE_TIME >=${START} and CREATE_TIME<${STOP} and ORDER_SYS_NO='2'  GROUP BY TRADE_SYS_ORDER_ID) group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')  with ur",wldb
zgtwapQualityAnalysis,zgtwap_succ,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(distinct TRADE_SYS_ORDER_ID) SUCCESS_COUNT from  nccashier.TBL_NCCA_PAY_REC WHERE ID IN (select MAX(ID) FROM nccashier.TBL_NCCA_PAY_REC where  CREATE_TIME >=${START} and CREATE_TIME<${STOP} and ORDER_SYS_NO='2'  GROUP BY TRADE_SYS_ORDER_ID) and state = 'SUCCESS' group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')  with ur",wldb
zgtwapQualityAnalysis,excep_zgt_wap,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(distinct TRADE_SYS_ORDER_ID) CARDHOLDER_COUNT  from  nccashier.TBL_NCCA_PAY_REC WHERE ID IN (select MAX(ID) FROM nccashier.TBL_NCCA_PAY_REC where  CREATE_TIME >${START} and CREATE_TIME<${STOP} and ORDER_SYS_NO='2'  GROUP BY TRADE_SYS_ORDER_ID) and state <> 'SUCCESS' AND ERROR_CODE IN ('411138','411151','411152','411155')  group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')   with ur",wldb
zgtnczlQualityAnalysis,zgtnczl_total,"select TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(*) TRADE_COUNT,'ZGT_NCZL' PRODUCT_TYPE
from ZGT.TBL_TRXORDER d
where d.PAY_PRODUCT_TYPE = 'DIRECT'
and d.CREATE_DATE >=${START}
and d.CREATE_DATE < ${STOP}
group by TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI')
with ur",zxdb_standby
zgtnczlQualityAnalysis,zgtnczl_succ,"select TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(*) SUCCESS_COUNT from ZGT.TBL_TRXORDER d
where d.PAY_PRODUCT_TYPE = 'DIRECT'
and d.CREATE_DATE >=${START}
and d.CREATE_DATE < ${STOP}
and STATUS in ('SUCCESS','SETTLECONFIRM')
group by TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI')
with ur",zxdb_standby
zgtnczlQualityAnalysis,excep_zgt_nczl,"select TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(*) CARDHOLDER_COUNT from ZGT.TBL_TRXORDER d 
where d.PAY_PRODUCT_TYPE = 'DIRECT' 
and d.CREATE_DATE >=${START} 
and d.CREATE_DATE < ${STOP} 
and STATUS not in ('SUCCESS','SETTLECONFIRM') 
and ERROR_CODE in ('411151','411152','411154','411155') 
group by TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI') 
order by TO_CHAR(CREATE_DATE,'YYYY-MM-DD HH24:MI') with ur",zxdb_standby
tztbkqualityAnalysisTop3Error,tzt_bk_top3_total_orders,"select min(d.ID) ID,TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_TIME)/5 rtime, 'TZT_BK' PRODUCT_TYPE, 'cnt_total' as data_type,count(*) data_value from (select t.*
from ewallet.PAYAPI_BINDCARD_REQUEST_RECORD t
left join  ewallet.PAY_TMP_CARD tmp on tmp.TMP_CARD_ID = t.TMP_CARD_ID
left join ewallet.PAY_CARD_SPECIES spe on spe.CARD_SPECIES_ID = tmp.CARD_SPECIES_ID
left join ewallet.PAY_BANK k on k.BANK_ID = spe.BANK_ID
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP} and t.PRODUCT_CATALOG ='30') d
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(CREATE_TIME)/5
order by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(CREATE_TIME)/5",INNO_STANBY
tztbkqualityAnalysisTop3Error,tzt_bk_top3_err_bank_prp_zong,"select min(d.id) id,'TZT_BK' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_TIME)/5 rtime, '1' ANALYSIS_TYPE,d.AUTH_VERIFY_CODE error, d.CODE bank,
rownumber() over (partition by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5 order by count(*) desc) orders
from (select t.*,k.code
from ewallet.PAYAPI_BINDCARD_REQUEST_RECORD t
left join  ewallet.PAY_TMP_CARD tmp on tmp.TMP_CARD_ID = t.TMP_CARD_ID
left join ewallet.PAY_CARD_SPECIES spe on spe.CARD_SPECIES_ID = tmp.CARD_SPECIES_ID
left join ewallet.PAY_BANK k on k.BANK_ID = spe.BANK_ID
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}
and t.STATUS = 0 and t.PRODUCT_CATALOG ='30') d
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5, d.AUTH_VERIFY_CODE, d.CODE
",INNO_STANBY
tztbkqualityAnalysisTop3Error,tzt_bk_top3_err_bank_prp_acc,"select min(d.id) id,'TZT_BK' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct d.phone_num) data_value,TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_TIME)/5 rtime, '1' ANALYSIS_TYPE,d.AUTH_VERIFY_CODE error, d.CODE bank,
rownumber() over (partition by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5 order by count(*) desc) orders
from (select t.*,k.code,tmp.phone_num
from ewallet.PAYAPI_BINDCARD_REQUEST_RECORD t
left join  ewallet.PAY_TMP_CARD tmp on tmp.TMP_CARD_ID = t.TMP_CARD_ID
left join ewallet.PAY_CARD_SPECIES spe on spe.CARD_SPECIES_ID = tmp.CARD_SPECIES_ID
left join ewallet.PAY_BANK k on k.BANK_ID = spe.BANK_ID
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}
and t.STATUS = 0 and t.PRODUCT_CATALOG ='30') d
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5, d.AUTH_VERIFY_CODE, d.CODE",INNO_STANBY
tztbkqualityAnalysisTop3Error,txt_bk_top3_err_mercht_zong,"select min(d.id) id,'TZT_BK' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_TIME)/5 rtime, '2' ANALYSIS_TYPE,d.AUTH_VERIFY_CODE error, d.MERCHANT_ACCOUNT INTER_OR_MER,
rownumber() over (partition by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5 order by count(*) desc) orders
from (select t.*,k.code
from ewallet.PAYAPI_BINDCARD_REQUEST_RECORD t
left join  ewallet.PAY_TMP_CARD tmp on tmp.TMP_CARD_ID = t.TMP_CARD_ID
left join ewallet.PAY_CARD_SPECIES spe on spe.CARD_SPECIES_ID = tmp.CARD_SPECIES_ID
left join ewallet.PAY_BANK k on k.BANK_ID = spe.BANK_ID
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}
and t.STATUS = 0 and t.PRODUCT_CATALOG ='30') d
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5, d.AUTH_VERIFY_CODE, d.MERCHANT_ACCOUNT",INNO_STANBY
tztbkqualityAnalysisTop3Error,err_mercht_acc_tzt_bk,"select min(d.id) id,'TZT_BK' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct d.phone_num) data_value,TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_TIME)/5 rtime, '2' ANALYSIS_TYPE,d.AUTH_VERIFY_CODE error, d.MERCHANT_ACCOUNT INTER_OR_MER,
rownumber() over (partition by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5 order by count(*) desc) orders
from (select t.*,k.code,tmp.phone_num
from ewallet.PAYAPI_BINDCARD_REQUEST_RECORD t
left join  ewallet.PAY_TMP_CARD tmp on tmp.TMP_CARD_ID = t.TMP_CARD_ID
left join ewallet.PAY_CARD_SPECIES spe on spe.CARD_SPECIES_ID = tmp.CARD_SPECIES_ID
left join ewallet.PAY_BANK k on k.BANK_ID = spe.BANK_ID
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}
and t.STATUS = 0 and t.PRODUCT_CATALOG ='30') d
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5, d.AUTH_VERIFY_CODE, d.MERCHANT_ACCOUNT
",INNO_STANBY
remitunknownbatch,remitunknownbatch,"SELECT COALESCE(char(date(B.CREATE_DATE)),'null')||COALESCE(C.REMIT_CHANNEL_NAME,'null')||COALESCE(B.REMIT_CHANNEL_NO,'null') as IDNOUSE,
DATE(B.CREATE_DATE) AS  CREATE_DATE,
C.REMIT_CHANNEL_NAME AS CHANNEL_NAME,
B.REMIT_CHANNEL_NO AS CHANNEL_NO,
COUNT(B.ID) AS AC_BATCH_COUNT,
SUM(B. ACCEPT_SUC_NUM) AS AC_TOTOL_COUNT,
COUNT(A.ID) AS UK_BATCH_COUNT,
SUM(A.AUDITED_NUM) AS SUC_COUNT,
SUM(A.AUDITED_AMOUNT) AS SUC_AMOUNT
FROM
REMIT.TBL_REMIT_BATCH B
LEFT JOIN REMIT.TBL_REMIT_TEARBATCH_AUDIT A ON B.REMIT_BATCH_NO = A. REMIT_BATCH_NO
LEFT JOIN REMIT.TBL_REMIT_CHANNEL C ON B.REMIT_CHANNEL_NO=C.REMIT_CHANNEL_NO
WHERE instr(b.REMIT_CHANNEL_NO,'CROSSBORDER') <= 0 and  B.CREATE_DATE >= ${START}  and B.CREATE_DATE < ${STOP} 
GROUP BY DATE(B.CREATE_DATE),C.REMIT_CHANNEL_NAME,B.REMIT_CHANNEL_NO 
with ur",fundtx
zgtwapqualityAnalysisTop3Error,zgt_wap_top3_total_orders,"select min(biz.order_id) id,TO_CHAR(biz.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(biz.CREATE_TIME)/5 rtime, 'ZGT_WAP' PRODUCT_TYPE, 'cnt_total' as data_type,count(*) data_value
from ewallet.paymobile_payment_info payment, ewallet.pay_biz_order biz, ewallet.paymobile_transaction_info info
where biz.create_time >= ${START} and biz.create_time < ${STOP}
and biz.order_id =info.YB_TRANS_ORDER_ID and payment.TRANS_INFO_ID = info.id and biz.ORDER_ORIGIN=11
group by TO_CHAR(biz.CREATE_TIME,'YYYY-MM-DD HH24'),minute(biz.CREATE_TIME)/5
order by TO_CHAR(biz.CREATE_TIME,'YYYY-MM-DD HH24'),minute(biz.CREATE_TIME)/5",INNO_STANBY
zgtwapqualityAnalysisTop3Error,zgt_wap_top3_err_bank_prp_acc,"select min(d.order_id) id,'ZGT_WAP' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct d.phone) data_value,TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_TIME)/5 rtime, '1' ANALYSIS_TYPE,ERROR_CODE error, BANK bank,FRP_CODE INTER_OR_MER,
rownumber() over (partition by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5 order by count(distinct d.phone) desc) orders from
(select biz.order_id,payment.error_code,payment.bank,biz.frp_code,biz.create_time,info.merchant_account,biz.phone
from ewallet.paymobile_payment_info payment, ewallet.pay_biz_order biz, ewallet.paymobile_transaction_info info
where biz.create_time >= ${START} and biz.create_time < ${STOP}
and biz.order_id =info.YB_TRANS_ORDER_ID and payment.TRANS_INFO_ID = info.id and biz.ORDER_ORIGIN=11
and payment.ERROR_CODE not in ('100234','100235','100248','411151','100048','100057','100236') and biz.ORDER_STATE <> 1) d
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5, d.ERROR_CODE, d.BANK,d.FRP_CODE",INNO_STANBY
zgtwapqualityAnalysisTop3Error,zgt_wap_top3_err_mercht_zong,"select min(d.order_id) id,'ZGT_WAP' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_TIME)/5 rtime, '2' ANALYSIS_TYPE,ERROR_CODE error, d.merchant_account INTER_OR_MER,
rownumber() over (partition by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5 order by count(*) desc) orders from
(select biz.order_id,payment.error_code,payment.bank,biz.frp_code,biz.create_time,info.merchant_account,biz.phone
from ewallet.paymobile_payment_info payment, ewallet.pay_biz_order biz, ewallet.paymobile_transaction_info info
where biz.create_time >= ${START} and biz.create_time < ${STOP}
and biz.order_id =info.YB_TRANS_ORDER_ID and payment.TRANS_INFO_ID = info.id and biz.ORDER_ORIGIN=11
and payment.ERROR_CODE not in ('100234','100235','100248','411151','100048','100057','100236') and biz.ORDER_STATE <> 1) d
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5, d.ERROR_CODE, d.merchant_account",INNO_STANBY
zgtwapqualityAnalysisTop3Error,err_mercht_acc_zgt_wap,"select min(d.order_id) id,'ZGT_WAP' PRODUCT_TYPE, 'cnt_order1' data_type,count(distinct d.phone) data_value,TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_TIME)/5 rtime, '2' ANALYSIS_TYPE,ERROR_CODE error, d.merchant_account INTER_OR_MER,
rownumber() over (partition by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5 order by count(distinct d.phone) desc) orders from
(select biz.order_id,payment.error_code,payment.bank,biz.frp_code,biz.create_time,info.merchant_account,biz.phone
from ewallet.paymobile_payment_info payment, ewallet.pay_biz_order biz, ewallet.paymobile_transaction_info info
where biz.create_time >= ${START} and biz.create_time < ${STOP}
and biz.order_id =info.YB_TRANS_ORDER_ID and payment.TRANS_INFO_ID = info.id and biz.ORDER_ORIGIN=11
and payment.ERROR_CODE not in ('100234','100235','100248','411151','100048','100057','100236') and biz.ORDER_STATE <> 1) d
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5, d.ERROR_CODE, d.merchant_account with ur
",INNO_STANBY
zgtwapqualityAnalysisTop3Error,zgt_wap_top3_err_bank_prp_zong,"select min(d.order_id) id,'ZGT_WAP' PRODUCT_TYPE, 'cnt_1' data_type,count(distinct d.phone) data_value,TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_TIME)/5 rtime, '1' ANALYSIS_TYPE,ERROR_CODE error, d.merchant_account INTER_OR_MER,
rownumber() over (partition by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5 order by count(distinct d.phone) desc) orders from
(select biz.order_id,payment.error_code,payment.bank,biz.frp_code,biz.create_time,info.merchant_account,biz.phone
from ewallet.paymobile_payment_info payment, ewallet.pay_biz_order biz, ewallet.paymobile_transaction_info info
where biz.create_time >= ${START} and biz.create_time < ${STOP}
and biz.order_id =info.YB_TRANS_ORDER_ID and payment.TRANS_INFO_ID = info.id and biz.ORDER_ORIGIN=11
and payment.ERROR_CODE not in ('100234','100235','100248','411151','100048','100057','100236') and biz.ORDER_STATE <> 1) d
group by TO_CHAR(d.CREATE_TIME,'YYYY-MM-DD HH24'),minute(d.CREATE_TIME)/5, d.ERROR_CODE, d.merchant_account with ur
",INNO_STANBY
zgtnczlqualityAnalysisTop3Error,zgt_nczl_top3_total_orders,"select min(d.id) id,TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_DATE)/5 rtime, 'ZGT_NCZL' PRODUCT_TYPE, 'cnt_total' as data_type,count(*) data_value
from ZGT.tbl_trxorder d 
LEFT JOIN ZGT.TBL_MERCHANT_HISTORY h ON d. EXTERNAL_ID = h. EXTERNALID 
where d.pay_product_type in ('DIRECT','DIRECT_FIRST','DIRECT_BIND')
and d.CREATE_DATE >=${START} and d.CREATE_DATE < ${STOP}
group by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5
order by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5 with ur
",zxdb_standby
zgtnczlqualityAnalysisTop3Error,zgt_nczl_top3_err_bank_prp_acc,"select min(d.ID) id,'ZGT_NCZL' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct mobile_phone) data_value,TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_DATE)/5 rtime, '1' ANALYSIS_TYPE,d.error_code error,d.bank_id bank,
rownumber() over (partition by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5 order by count(distinct mobile_phone) desc) orders
from ZGT.tbl_trxorder d 
LEFT JOIN ZGT.TBL_MERCHANT_HISTORY h ON d. EXTERNAL_ID = h. EXTERNALID 
where d.CREATE_DATE >= ${START} and d.CREATE_DATE < ${STOP} and d.STATUS='INIT' and d.status is not null
and ERROR_CODE not in ('411051','411041','411042','411052','411073','411003','400121','400086','411138','411155','400094','400118','400093'
,'400091','411054','400117','411114','400082','411103','411104','411121','411057','411154','411152','400122','411151')
group by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5,d.error_code,d.bank_id
order by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5 with ur",zxdb_standby
zgtnczlqualityAnalysisTop3Error,zgt_nczl_top3_err_bank_prp_zong,"select min(d.ID) id,'ZGT_NCZL' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_DATE)/5 rtime, '1' ANALYSIS_TYPE,d.error_code error,d.bank_id bank,
rownumber() over (partition by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5 order by count(*) desc) orders
from ZGT.tbl_trxorder d 
LEFT JOIN ZGT.TBL_MERCHANT_HISTORY h ON d. EXTERNAL_ID = h. EXTERNALID 
where d.CREATE_DATE >= ${START} and d.CREATE_DATE < ${STOP}
and d.STATUS='INIT' and d.status is not null
and ERROR_CODE not in ('411051','411041','411042','411052','411073','411003','400121','400086','411138','411155','400094','400118','400093'
,'400091','411054','400117','411114','400082','411103','411104','411121','411057','411154','411152','400122','411151')
group by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5,d.error_code,d.bank_id
order by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5 with ur",zxdb_standby
zgtnczlqualityAnalysisTop3Error,zgt_nczl_top3_err_mercht_zong,"select min(d.ID) id,'ZGT_NCZL' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_DATE)/5 rtime, '2' ANALYSIS_TYPE,d.error_code error,d.customer_no inter_or_mer,
rownumber() over (partition by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5 order by count(*) desc) orders
from ZGT.tbl_trxorder d 
LEFT JOIN ZGT.TBL_MERCHANT_HISTORY h ON d. EXTERNAL_ID = h. EXTERNALID 
where d.CREATE_DATE >= ${START} and d.CREATE_DATE < ${STOP} and d.STATUS='INIT' and d.status is not null
and ERROR_CODE not in ('411051','411041','411042','411052','411073','411003','400121','400086','411138','411155','400094','400118','400093'
,'400091','411054','400117','411114','400082','411103','411104','411121','411057','411154','411152','400122','411151')
group by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5,d.error_code, d.customer_no
order by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5 with ur",zxdb_standby
zgtnczlqualityAnalysisTop3Error,err_mercht_acc_zgt_nczl,"select min(d.ID) id,'ZGT_NCZL' PRODUCT_TYPE,'cnt_order' data_type,count(mobile_phone) data_value,TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24') ltime,minute(d.CREATE_DATE)/5 rtime,'2' ANALYSIS_TYPE,d.error_code error,d.customer_no inter_or_mer,rownumber() over (partition by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5 order by count(mobile_phone) desc) orders from ZGT.tbl_trxorder d LEFT JOIN ZGT.TBL_MERCHANT_HISTORY h ON d.EXTERNAL_ID = h.EXTERNALID 
where d.CREATE_DATE >= ${START} and d.CREATE_DATE < ${STOP} and d.STATUS='INIT' and d.status is not null and ERROR_CODE not in ('411051','411041','411042','411052','411073','411003','400121','400086','411138','411155','400094','400118','400093','400091','411054','400117','411114','400082','411103','411104','411121','411057','411154','411152','400122','411151')  group by TO_CHAR(d.CREATE_DATE,'YYYY-MM-DD HH24'),minute(d.CREATE_DATE)/5,d.error_code,d.customer_no with ur",zxdb_standby
onekeySecQualityAnalysis,sec_total,"select TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) TRADE_COUNT,'YJZF_API_SECOND' PRODUCT_TYPE
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174','10000419568','10012441718') group by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur
",INNO_STANBY
onekeySecQualityAnalysis,sec_succ,"select TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*)  SUCCESS_COUNT
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME <  ${STOP}
and apio.API_TYPE in (4,7,11) and payo.ORDER_STATE = 1 and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174','10000419568','10012441718')
group by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",INNO_STANBY
onekeySecQualityAnalysis,excep_sec,"select TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) CARDHOLDER_COUNT
from EWALLET.payapi_transaction_order apio,EWALLET.pay_biz_order payo,EWALLET.payapi_payment_order apip
where apio.YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio.CREATE_TIME >=${START} and apio.CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174','10000419568','10012441718')
and apip.ERROR_CODE in ('100048','100057','100228','100234','100235','100236','100248','411138','411151','411152','411155')
group by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(payo.CREATE_TIME,'YYYY-MM-DD HH24:MI')",INNO_STANBY
onekeySecQualityTop3error,sec_total_orders,"select TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,min(payo.order_id) id,'YJZF_API_SECOND' PRODUCT_TYPE, 'cnt_total' data_type,count(*) data_value 
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174','10000419568','10012441718')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5
",INNO_STANBY
onekeySecQualityTop3error,sec_err_bank_prp_zong,"select min(payo.order_id) id,'YJZF_API_SECOND' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'1' ANALYSIS_TYPE,apip.ERROR_CODE error, apip.BANK bank, payo.FRP_CODE INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174','10000419568','10012441718')
and apip.ERROR_CODE not in ('411138','411151','411152','411155')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apip.BANK, payo.FRP_CODE with ur",INNO_STANBY
onekeySecQualityTop3error,sec_err_mercht_zong,"select min(payo.order_id) id,'YJZF_API_SECOND' PRODUCT_TYPE, 'cnt' data_type,count(*) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'2' ANALYSIS_TYPE,apip.ERROR_CODE error, apio. MERCHANT_ACCOUNT INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174','10000419568','10012441718')
and apip.ERROR_CODE not in ('411138','411151','411152','411155')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apio. MERCHANT_ACCOUNT with ur
",INNO_STANBY
onekeySecQualityTop3error,err_mercht_acc_sec,"select min(payo.order_id) id, 'YJZF_API_SECOND' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct apip.phone) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'2' ANALYSIS_TYPE,apip.ERROR_CODE error, apio. MERCHANT_ACCOUNT INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174','10000419568','10012441718')
and apip.ERROR_CODE not in ('411138','411151','411152','411155')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apio. MERCHANT_ACCOUNT with ur
",INNO_STANBY
onekeySecQualityTop3error,sec_err_bank_prp_acc,"select min(payo.order_id) id, 'YJZF_API_SECOND' PRODUCT_TYPE, 'cnt_order' data_type,count(distinct apip.phone) data_value,
TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24') ltime, minute(apio.CREATE_TIME)/5 rtime,
'1' ANALYSIS_TYPE,apip.ERROR_CODE error, apip.BANK bank, payo.FRP_CODE INTER_OR_MER,
rownumber() over (partition by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5 order by count(*) desc) orders
from EWALLET.payapi_transaction_order apio, EWALLET.pay_biz_order payo, EWALLET.payapi_payment_order apip
where payo. ORDER_STATE <> 1
and apio. YB_ORDER_ID = payo.order_id and apip.PAYAPI_TRANSACTION_ORDER_ID=apio.ID 
and apio. CREATE_TIME >= ${START} and apio. CREATE_TIME < ${STOP}
and apio.API_TYPE in (4,7,11) and apio. MERCHANT_ACCOUNT not in ('10012448854','10012471228','10012475635','10012498173','10012505448','10012509413','10012520683','10012544569','10012571557','10012637092','10012688108','10012698256','10012706388','10012713616','10012715826','10012715844','10012718466','10012740985','10012771724','10012806440','10012831082','10012951854','10012996445','10013084717','10013112250','10013146262','10013184743','10013199382','10013201786','10013204118','10013262195','10013270743','10013270932','10013285408','10013320725','10013347536','10013362342','10013364178','10013364192','10013364205','10013364224','10013364267','10013364276','10013366767','10013370452','10013376705','10013391219','10013400788','10013409970','10013441711','10013441987','10013442838','10013464297','10013478608','10013490635','10013492145','10013537450','10013560896','10013572454','10013581475','10013612267','10013635263','10013642751','10013666671','10012636904','10013787172','10013687590','10013513422','10012424261','10012426057','10012441718','10012470020','10012436280','10012469117','10012427154','10012429767','10013510174','10000419568','10012441718')
and apip.ERROR_CODE not in ('411138','411151','411152','411155')
group by TO_CHAR(apio.CREATE_TIME,'YYYY-MM-DD HH24'),minute(apio.CREATE_TIME)/5, apip.ERROR_CODE, apip.BANK, payo.FRP_CODE with ur",INNO_STANBY
tztnewcardjianquanxieyi,tztnewcardjianquan,"select 
COALESCE(CHAR(date(t1.FEE_DEAL_TIME)),'null')||COALESCE(CHAR(t1.MERCHANT_NO),'null')||COALESCE(CHAR(t1.BANK_CODE),'null')||'tztnewcardjianquan' AS IDNOUSE,
date(t1.FEE_DEAL_TIME) AS TRXDATE,
year(date(t1.FEE_DEAL_TIME))*100+month(date(t1.FEE_DEAL_TIME)) AS MONTH,
t1.MERCHANT_NO AS RECEIVERID,
t1.BANK_CODE AS BANK_CODE,
'DEBITCARD' AS CARDTYPE,
'3011004003002' AS PRODUCT_CODE,
'3011004001005B' AS SALES_PRODUCT_CODE,
'CARDJIANQUAN' AS ORDERTYPE,
'TZT_NEW_CARDJIANQUAN' AS PAYPRODUCT,
226 AS BIZTYPEID,
'CARDJIANQUAN' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'TZT_NEW' AS DATAORIGIN,
SUM(CASE WHEN t1.CS_FEE IS NOT NULL THEN 1 ELSE 0 END) AS TRXCOUNT,
SUM(t1.CS_FEE) AS TRXFEE,
SUM(t2.NCAUTH_COST) AS FRPCOST,
SUM(t2.NCAUTH_COST) AS ACCOUNTINGCOST
FROM TZT.TZT_BINDCARD_ORDER t1,PAPERTRADE.PAPERTRADE_BINDCARD_ORDER AS t2
where t1.YB_ORDER_ID = t2.ORDER_SYSTEM_ORDER_ID AND t1.CARD_TYPE = 'DEBIT' 
AND t1.FEE_DEAL_TIME >=${START} AND t1.FEE_DEAL_TIME < ${STOP}
GROUP BY date(t1.FEE_DEAL_TIME),t1.MERCHANT_NO,t1.BANK_CODE
with ur
",tztDB
tztnewcardjianquanxieyi,tztnewxieyipay,"select 
COALESCE(CHAR(date(t1.FEE_DEAL_TIME)),'null')||COALESCE(CHAR(t1.MERCHANT_NO),'null')||COALESCE(CHAR(t1.BANK_CODE),'null')||COALESCE(CHAR(t2.FRP_CODE),'null')||'tztnewxieyipay' AS IDNOUSE,
date(t1.FEE_DEAL_TIME) AS TRXDATE,
year(date(t1.FEE_DEAL_TIME))*100+month(date(t1.FEE_DEAL_TIME)) AS MONTH,
t1.MERCHANT_NO AS RECEIVERID,
t1.BANK_CODE AS BANK_CODE,
t2.FRP_CODE AS TRXCHANNELID,
'DEBITCARD' AS CARDTYPE,
'3011001005002' AS PRODUCT_CODE,
'3011004001005B' AS SALES_PRODUCT_CODE,
'SALES' AS ORDERTYPE,
'TZT_NEW_XIEYIPAY' AS PAYPRODUCT,
287 AS BIZTYPEID,
'Sales' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'TZT_NEW' AS DATAORIGIN,
SUM(CASE WHEN t1.STATUS = 'PAY_SUCCESS' THEN 1 ELSE 0 END) AS TRXCOUNT,
SUM(CASE WHEN t1.STATUS = 'PAY_SUCCESS' THEN t1.AMOUNT ELSE 0 END)  AS TRXAMOUNT,
SUM(t1.CS_FEE) AS TRXFEE,
SUM(t2.NCPAY_COST) AS FRPCOST,
SUM(t2.NCPAY_COST) AS ACCOUNTINGCOST
FROM TZT.TZT_PAYMENT_ORDER t1,PAPERTRADE.PAPERTRADE_PAYMENT_ORDER AS t2
where t1.YB_ORDER_ID = t2.ORDER_SYSTEM_ORDER_ID AND t1.CARD_TYPE = 'DEBIT' 
AND t1.FEE_DEAL_TIME >=${START} AND t1.FEE_DEAL_TIME < ${STOP}
GROUP BY date(t1.FEE_DEAL_TIME),t1.MERCHANT_NO,t1.BANK_CODE,t2.FRP_CODE
with ur",tztDB
tztnewcardjianquanxieyi,tztnewcustomeridnum,"select CUSTOMERNUMBER as RECEIVERID,ID AS CUSTOMERID from db2inst1.customerinfo with ur",reportdb
tztnewfinancegroupdailytrx,tztnewfinancegroupdailytrx,"select  COALESCE(CHAR(date(t.CREATE_TIME)),'null')||COALESCE(CHAR(s.SYSTEM_NAME),'null')||COALESCE(CHAR(t.MERCHANT_NO),'null')||COALESCE(CHAR((CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END)),'null')||COALESCE(CHAR((CASE WHEN t.PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE  t.PAY_TOOL_TYPE END)),'null')||COALESCE(CHAR((CASE WHEN t.TRADE_MODE='NEWTZTENHANCE' THEN 'å¼ºå__´æ_' WHEN t.TRADE_MODE='NEWTZTFASTPAY' THEN 'å¿___' WHEN t.TRADE_MODE='NEWTZTAUTOPY' THEN '___£æ' WHEN t.TRADE_MODE='NEWTZTAUTH' THEN '____' ELSE t.TRADE_MODE END)),'null')||COALESCE(CHAR((CASE WHEN c.CHARGE_MODE='realTimeDue' THEN 'å®__' WHEN c.CHARGE_MODE='afterDue' THEN '___' WHEN c.CHARGE_MODE='preDue' THEN 'é¢__å®__' ELSE c.CHARGE_MODE END)),'null')||COALESCE(CHAR(t.BANK_CODE),'null')||'tztnewfinancegroupdailytrx' as IDNOUSE,
   'TZT_NEW' as BIZ_GROUP,
   date(t.CREATE_TIME) as TRXDATE,
   s.SYSTEM_NAME as BIZ_SYSTEM_NAME,
   t.MERCHANT_NO as CUSTOMERNUMBER,
   (CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END)as CARDTYPE,
   (CASE WHEN t.PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE  t.PAY_TOOL_TYPE END) as PAYTYPE,
   (CASE WHEN t.TRADE_MODE='NEWTZTENHANCE' THEN 'å¼ºå__´æ_' WHEN t.TRADE_MODE='NEWTZTFASTPAY' THEN 'å¿___' WHEN t.TRADE_MODE='NEWTZTAUTOPY' THEN '___£æ' WHEN t.TRADE_MODE='NEWTZTAUTH' THEN '____' ELSE t.TRADE_MODE END) as PAYSCENE,
   (CASE WHEN c.CHARGE_MODE='realTimeDue' THEN 'å®__' WHEN c.CHARGE_MODE='afterDue' THEN '___' WHEN c.CHARGE_MODE='preDue' THEN 'é¢__å®__' ELSE c.CHARGE_MODE END) as FEETYPE,
   t.BANK_CODE as BANK_CODE,
   COUNT(t.ID) as TOTAL_COUNT,
   SUM(t.AMOUNT) as TOTAL_AMOUNT,
   SUM(CASE WHEN t.STATUS = 'PAY_SUCCESS' THEN 1 ELSE 0 END) as SUCC_COUNT,
   SUM(CASE WHEN t.STATUS = 'PAY_SUCCESS' THEN t.AMOUNT ELSE 0 END) as SUCC_AMOUNT,
   SUM(CASE WHEN t.STATUS = 'PAY_FAIL' 
             OR t.STATUS = 'TIME_OUT'
             OR(t.STATUS = 'ACCEPT' AND (f.STATUS = 'PAY_FAIL' OR f.STATUS = 'TIME_OUT'))
         THEN 1 ELSE 0 END) as FAIL_COUNT,
   SUM(CASE WHEN t.STATUS = 'PAY_FAIL' 
             OR t.STATUS = 'TIME_OUT'
             OR(t.STATUS = 'ACCEPT' AND (f.STATUS = 'PAY_FAIL' OR f.STATUS = 'TIME_OUT'))
         THEN t.AMOUNT ELSE 0 END) as FAIL_AMOUNT,
   SUM(t.CS_FEE) as TOTAL_INCOME,
   SUM(p.NCPAY_COST) as NCPAY_COST
from TZT.TZT_PAYMENT_ORDER as t
   left join TZT.TZT_BIZ_SYSTEM s on s.SYSTEM_CODE=t.BIZ_SYSTEM_CODE
   left join JMC.MC_MERCHANT_CONFIG c on c.MERCHANT_NO=t.MERCHANT_NO and c.DELETE_FLAG=0
   left join PAPERTRADE.PAPERTRADE_PAYMENT_ORDER p on p.MERCHANT_NO=t.MERCHANT_NO and p.CUSTOMER_ORDER_ID=t.REQUEST_NO
   left join TZT.TZT_PAYMENT_FIRST_ORDER f ON t.ID = f.PAYMENT_ORDER_ID
where t.CREATE_TIME >= ${START} 
    AND t.CREATE_TIME < ${STOP}
group by date(t.CREATE_TIME),s.SYSTEM_NAME,t.MERCHANT_NO,
(CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END),
(CASE WHEN t.PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE  t.PAY_TOOL_TYPE END),
(CASE WHEN t.TRADE_MODE='NEWTZTENHANCE' THEN 'å¼ºå__´æ_' WHEN t.TRADE_MODE='NEWTZTFASTPAY' THEN 'å¿___' WHEN t.TRADE_MODE='NEWTZTAUTOPY' THEN '___£æ' WHEN t.TRADE_MODE='NEWTZTAUTH' THEN '____' ELSE t.TRADE_MODE END),
(CASE WHEN c.CHARGE_MODE='realTimeDue' THEN 'å®__' WHEN c.CHARGE_MODE='afterDue' THEN '___' WHEN c.CHARGE_MODE='preDue' THEN 'é¢__å®__' ELSE c.CHARGE_MODE END),
t.BANK_CODE
with ur",INNO_STANBY
tztnewfinancegroupbinddailytrx,tztnewfinancegroupbinddailytrx,"select COALESCE(CHAR(date(t.CREATE_TIME)),'null')||COALESCE(CHAR(s.SYSTEM_NAME),'null')||COALESCE(CHAR(t.MERCHANT_NO),'null')||COALESCE(CHAR((CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END)),'null')||COALESCE(CHAR(t.BANK_CODE),'null')||COALESCE(CHAR((CASE WHEN t.AUTH_MODE='COMMON_AUTH' THEN '____' WHEN t.AUTH_MODE='ENHANCED_AUTH' THEN 'å¼ºå__´æ_' ELSE t.AUTH_MODE END)),'null')||'tztnewfinancegroupbinddailytrx' as IDNOUSE,
  'TZT_NEW' as BIZ_GROUP,
  date(t.CREATE_TIME) as TRXDATE,
  s.SYSTEM_NAME as BIZ_SYSTEM_NAME,
  t.MERCHANT_NO as CUSTOMERNUMBER,
  (CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END) as CARDTYPE,
  t.BANK_CODE as BANK_CODE,
  (CASE WHEN t.AUTH_MODE='COMMON_AUTH' THEN '____' WHEN t.AUTH_MODE='ENHANCED_AUTH' THEN 'å¼ºå__´æ_' ELSE t.AUTH_MODE END) as AUTH_MODE,
  COUNT(t.ID) as TOTAL_COUNT,
  SUM(CASE WHEN t.STATUS = 'BIND_SUCCESS' THEN 1 ELSE 0 END) as SUCC_COUNT,
  SUM(CASE WHEN  t.STATUS = 'BIND_FAIL' OR t.STATUS = 'TIME_OUT' OR t.STATUS = 'BIND_ERROR' THEN 1 ELSE 0 END) as FAIL_COUNT,
  SUM(b.NCAUTH_COST) as AUTH_COST,
  SUM(t.CS_FEE) as TOTAL_INCOME
from  TZT.TZT_BINDCARD_ORDER t
  left join TZT.TZT_BIZ_SYSTEM s on s.SYSTEM_CODE=t.BIZ_SYSTEM_CODE
  left join PAPERTRADE.PAPERTRADE_BINDCARD_ORDER b on b.MERCHANT_NO=t.MERCHANT_NO and b.CUSTOMER_ORDER_ID=t.REQUEST_NO
where  t.CREATE_TIME >= ${START} AND t.CREATE_TIME <${STOP}
group by date(t.CREATE_TIME),s.SYSTEM_NAME,t.MERCHANT_NO,
(CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END),
t.BANK_CODE,
(CASE WHEN t.AUTH_MODE='COMMON_AUTH' THEN '____' WHEN t.AUTH_MODE='ENHANCED_AUTH' THEN 'å¼ºå__´æ_' ELSE t.AUTH_MODE END)
with ur",tztDB
tztnewfgfaildailytrx,tztnewfgfaildailytrxbind,"select COALESCE(CHAR(date(t.CREATE_TIME)),'null')||COALESCE(CHAR(s.SYSTEM_NAME),'null')||COALESCE(CHAR(t.MERCHANT_NO),'null')||COALESCE(CHAR((CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END)),'null')||COALESCE(CHAR(t.BANK_CODE),'null')||COALESCE(CHAR(t.ERROR_CODE),'null')||COALESCE(CHAR(t.ERROR_MSG),'null')||'tztnewfgfaildailytrxbind' as IDNOUSE,
    'TZT_NEW' as BIZ_GROUP,
    'ç»__' as FAIL_TYPE,
    date(t.CREATE_TIME) as TRXDATE,
    s.SYSTEM_NAME as BIZ_SYSTEM_NAME,
    t.MERCHANT_NO as CUSTOMERNUMBER,
    (CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END)as CARDTYPE,
    t.BANK_CODE as BANK_CODE,
    t.ERROR_CODE as ERROR_CODE,
    t.ERROR_MSG as ERROR_MSG,
    SUM(CASE WHEN  t.STATUS = 'BIND_FAIL' OR t.STATUS = 'TIME_OUT' OR t.STATUS = 'BIND_ERROR' THEN 1 ELSE 0 END) as FAIL_COUNT
from TZT.TZT_BINDCARD_ORDER t
    left join TZT.TZT_BIZ_SYSTEM s on s.SYSTEM_CODE=t.BIZ_SYSTEM_CODE
where  t.CREATE_TIME>= ${START}  AND t.CREATE_TIME < ${STOP}
group by date(t.CREATE_TIME),s.SYSTEM_NAME,t.MERCHANT_NO,
(CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END),
t.BANK_CODE,t.ERROR_CODE,t.ERROR_MSG
with ur",tztDB
tztnewfgfaildailytrx,tztnewfgfaildailytrxpay,"select COALESCE(CHAR(date(t.CREATE_TIME)),'null')||COALESCE(CHAR(s.SYSTEM_NAME),'null')||COALESCE(CHAR(t.MERCHANT_NO),'null')||COALESCE(CHAR((CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END)),'null')||COALESCE(CHAR(t.BANK_CODE),'null')||COALESCE(CHAR(t.ERROR_CODE),'null')||COALESCE(CHAR(t.ERROR_MSG),'null')||'tztnewfgfaildailytrxpay' as IDNOUSE,
    'TZT_NEW' as BIZ_GROUP,
    '__' as FAIL_TYPE,
    date(t.CREATE_TIME) as TRXDATE,
    s.SYSTEM_NAME as BIZ_SYSTEM_NAME,
    t.MERCHANT_NO as CUSTOMERNUMBER,
    (CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END) as CARDTYPE,
    t.BANK_CODE as BANK_CODE,
    t.ERROR_CODE as ERROR_CODE,
    t.ERROR_MSG as ERROR_MSG,
    SUM(CASE WHEN t.STATUS = 'PAY_FAIL' 
             OR t.STATUS = 'TIME_OUT'
             OR(t.STATUS = 'ACCEPT' AND (f.STATUS = 'PAY_FAIL' OR f.STATUS = 'TIME_OUT'))
         THEN 1 ELSE 0 END) as FAIL_COUNT
from TZT.TZT_PAYMENT_ORDER t 
left join TZT.TZT_BIZ_SYSTEM s on s.SYSTEM_CODE=t.BIZ_SYSTEM_CODE
left join TZT.TZT_PAYMENT_FIRST_ORDER f ON t.ID = f.PAYMENT_ORDER_ID
where  t.CREATE_TIME>= ${START} AND t.CREATE_TIME < ${STOP}
group by date(t.CREATE_TIME),s.SYSTEM_NAME,t.MERCHANT_NO,
(CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END),
t.BANK_CODE,t.ERROR_CODE,t.ERROR_MSG
with ur",tztDB
customerinfo,customercredentiallevel,"select  CUSTOMER_NUMBER as CUSTOMERNUMBER , CUSTOMER_LABEL_VALUE as CUSTOMER_CREDENTIAL_LEVEL 
from SIGNING.TBL_CUSTOMER_LABEL_ATTRIBUTE 
where CUSTOMER_LABEL='customer_credential_level'   
with ur",BOSS
dlbagent,dlbagent,"select id,version,agent_num,full_name,short_name,city_code,province_code,district_code,address,salesman,secret_key,status,gmt_create,gmt_modify,have_child,parent_num 
from duolabao.agent_info;",duolabao
dlbcustomerinfo,dlbcustomerinfo,"select c.id,c.version,c.customer_num,c.agent_num,c.freeze_status,c.type,c.full_name,c.short_name,c.cus_key,c.city,c.province,c.district,c.address,i.name as industry,c.gmt_create,
c.gmt_modify,c.customer_type,c.certificate_type,c.certificate_code,cd.user_num,cd.declare_status as declare_status,cd.auditor as auditor,cd.audit_opinion as audit_opinion,cd.gmt_create as bd_create
from duolabao.customer_info c  
left join duolabao.customer_declare cd on c.customer_num=cd.customer_num 
left join duolabao.industry_info i on c.industry_num=i.num 
where c.freeze_status <> 'INIT';",duolabao
dlbuserrole,dlbuserrole,"select u.id as id,u.num as user_num,u.name as user_name,u.status as user_status,u.type as user_type 
from duolabao.user u ",duolabao
dlbshopinfo,dlbshopinfo,"select s.id,s.version,s.shop_num,s.agent_num,s.customer_num,s.shop_name,s.city,s.province,s.district,s.status,s.address,s.picture,s.one_industry,
s.two_industry,s.business_hours,s.map_lng,s.map_lat,s.remark,s.tel_phone,s.mobile_phone,s.gmt_create,s.gmt_modify,date(s.gmt_create) as createdate 
from duolabao.shop_info s",duolabao
dlbdailytrx,dlbdailytrx,"select concat(COALESCE(CHAR(date(f.complete_time)),'null'),COALESCE(CHAR(f.pay_way),'null'),COALESCE(CHAR(f.customer_num),'null'),COALESCE(CHAR(f.shop_num),'null'),COALESCE(CHAR(f.source),'null'),COALESCE(CHAR(f.bussiness_type),'null'),COALESCE(CHAR(f.type),'null'),'dlbdailytrx') as idnouse,
date(f.complete_time) as trxdate,
f.pay_way as pay_way,
f.customer_num as customer_num,
f.shop_num as shop_num,
f.source as source,
f.bussiness_type as bussiness_type,
f.type as type,
sum(case when f.status in ('SUCCESS','REFUND') then 1 else 0 end) as suc_count, 
sum(case when f.status in ('SUCCESS','REFUND')  then f.amount else 0 end) as suc_amount,
sum(case when (f.amount>=5 and f.status in ('SUCCESS','REFUND') ) then 1 else 0 end) as suc5_count,
sum(case when (f.amount>=10 and f.status in ('SUCCESS','REFUND')) then 1 else 0 end) as suc10_count,
sum(case when (f.amount>=5 and f.status in ('SUCCESS','REFUND') ) then f.amount else 0 end) as suc5_amount,
sum(case when (f.amount>=10 and f.status in ('SUCCESS','REFUND') ) then f.amount else 0 end) as suc10_amount
from duolabao.order_info f 
where f.complete_time>= ${START} and  f.complete_time < ${STOP}  and  f.status in ('SUCCESS','REFUND')
group by date(f.complete_time),
f.pay_way,
f.customer_num,
f.shop_num,
f.source,
f.bussiness_type,
f.type",duolabao
dlbshopinfoprofile,reportdlbshopinfoprofile,"select shop_num as IDNOUSE ,shop_num from dlb_shop_info where gmt_create  >= ${START} and gmt_create  < ${STOP} with ur",reportdb
dlbshopprofile1,dlbshopprofile1,"select shop_num
 from dlb_shop_info 
where gmt_create  >= ${START} and gmt_create  < ${STOP}  
with ur",reportdb
customerinfo,customerinfomanage1,"select c.customernumber as CUSTOMERNUMBER,cd5.DOCUMENTNUMBER as business_licence,cd5.AVAILABDATA as business_licence_AVAILABDATE,cd4.DOCUMENTNUMBER as Unified_credit_no,cd4.AVAILABDATA as  Unified_credit_no_AVAILABDATE,cd7.DOCUMENTNUMBER as organization_no,cd7.AVAILABDATA as organization_no_AVAILABDATE,cd8.DOCUMENTNUMBER as tax_regist_no,ca.auditPassTime as audit_date,c.email as email
from mobilebe.CUSTOMER c 
left join mobilebe.customerdocinfo cd4 on cd4.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd4.DOCUMENTNAME='ç»__ç¤¾ä_ä¿¡ç_ä»£ç_' 
left join mobilebe.customerdocinfo cd5 on cd5.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd5.DOCUMENTNAME='_¥ä__§ç_' 
left join mobilebe.customerdocinfo cd7 on cd7.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd7.DOCUMENTNAME='ç»___ºæ_ä»£ç_è¯' 
left join mobilebe.customerdocinfo cd8 on cd8.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd8.DOCUMENTNAME='ç¨___»èè¯' 
left join mobilebe.CustomerAptitudeAduit ca on c.id=ca.customerid
with ur",COPY2
customerinfo,signeddate1,"select  customernumber as CUSTOMERNUMBER, min(STARTDATE) as SIGNED_DATE
from mobilebe.CONTRACTMANAGER 
group by customernumber
with ur",COPY2
customerinfo,customersalesname,"select  e.cust_id as ID,em.name as SALESNAME,em.id as SALESID 
from db2inst1.employee2customer e 
left join db2inst1.employeeinfo em on e.emp_id=em.id 
with ur",reportdb
testT2,test01,"select id,name,age,cusnum from xc_test01",bigdata_test
testT2,test02,"select cusnum,cusname from xc_test02",bigdata_test
testT2,test03,"select pid id,mcc from xc_test03",bigdata_test
COMMISSIONNOBANKCARD,comnobankcardnohk,"SELECT concat(coalesce(CHAR(d.CUSTOMER_NUM),'null'),'201804','comnobankcardnohk',coalesce(char(d.BIZ_TYPE),'null'),
coalesce(CHAR(d.BANK_CODE),'null'))  as IDNOUSE,
     '201804' as month, date('2018-04-30')  as trxdate,
   d.CUSTOMER_NUM AS receiverid,
   (case when d.BIZ_TYPE='netPay' then 4
      when d.BIZ_TYPE='memberPay' then 18
      when d.BIZ_TYPE='creditPay' then 5
      when d.BIZ_TYPE='epos' then 6
      when d.BIZ_TYPE='noBankCard' then
      (case
        when d.BANK_CODE='JIUYOU' then 7
        when d.BANK_CODE='JUNNET' then 8
        when d.BANK_CODE='LIANHUAOKCARD' then 9
        when d.BANK_CODE='NETEASE' then 10
        when d.BANK_CODE='QQCARD' then 12
        when d.BANK_CODE='SHTEL' then 14
        when d.BANK_CODE='SHTELCARD' then 15
        when d.BANK_CODE='SNDACARD' then 16
        when d.BANK_CODE='SOHU' then 17
        when d.BANK_CODE='SZX' then 19
        when d.BANK_CODE='TELECOM' then 20
        when d.BANK_CODE='UNICOM' then 22
        when d.BANK_CODE='WANMEI' then 23
        when d.BANK_CODE='YPCARD' then 24
        when d.BANK_CODE='ZHENGTU' then 25
        when d.BANK_CODE='ZHIFUKA' then 26
        when d.BANK_CODE='TIANXIA' then 41
        when d.BANK_CODE='ZONGYOU' then 81
        when d.BANK_CODE='TIANHONG' then 101
        when d.BANK_CODE='THIRTYTWOCARD' then 242
        when d.BANK_CODE='YICHONGCARD' then 243
        when d.BANK_CODE='YICHONGTIANHONGCARD' then 281
        when d.BANK_CODE='YICHONGZONGYOUCARD' then 282
        when d.BANK_CODE='YICHONGTHIRTYTWOCARD' then 283
        when d.BANK_CODE='ZYZC' then 285
        when d.BANK_CODE='ZYFK' then 286
        else 19 end)
      when d.BIZ_TYPE='entrusted' then 13
      when d.BIZ_TYPE='pos' then 29
      when d.BIZ_TYPE='transferinday' then 13
      when d.BIZ_TYPE='yjzf' then 222
ELSE 4 END) as biztypeid,
  d.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION' as TYPE, 
'YP3G_COMMISSION' as dataorigin,
  SUM(-d.PROFIT_AMOUNT) AS trxfee
FROM yeeyk_agentfr.TBL_PROFIT_DETAIL d
LEFT JOIN yeeyk_agentfr.TBL_PROFIT_RECORD r ON d.PROFIT_RECORD_ID = r.id
LEFT JOIN yeeyk_agentfr.TBL_AGENT a ON a.id = d.AGENT_ID AND a.id = r.AGENT_ID
WHERE r.PROFIT_CONFIRM_STATE='CALCULATED'
AND d.STATUS='ACTIVE' 
AND r.PROFIT_DATE='2018-04' 
AND d.BIZ_TYPE='noBankCard' 
GROUP BY d.CUSTOMER_NUM,d.BANK_CODE,d.BIZ_TYPE",agentfr_mysql
COMMISSIONNOBANKCARD,comnobankcardadnohk,"SELECT concat(COALESCE(CHAR(CUSTOMER_NUM),'null'),char(date(${START})),'comnobankcardadnohk',coalesce(char(C.BIZ_TYPE),'null')) as IDNOUSE,
    year(${START})*100+month(${START}) as month, date_sub(date(${STOP}),interval 1 day) as trxdate,
    CUSTOMER_NUM AS receiverid,
    (case when C.BIZ_TYPE='netPay' then 4
      when C.BIZ_TYPE='memberPay' then 18
      when C.BIZ_TYPE='creditPay' then 5
      when C.BIZ_TYPE='epos' then 6
      when C.BIZ_TYPE='noBankCard' then 19
      when C.BIZ_TYPE='entrusted' then 13
      when C.BIZ_TYPE='pos' then 29
      when C.BIZ_TYPE='transferinday' then 13
      when C.BIZ_TYPE='yjzf' then 222
 ELSE 4 END) as biztypeid,
 C.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION' as TYPE,
'YP3G_COMMISSION' as dataorigin,
 SUM(-ADJUST_AMOUNT) AS trxfee   
FROM agentfr.TBL_ADJUST_DETAIL_CUS C 
LEFT JOIN agentfr.TBL_AGENT A ON C.AGENT_ID = A.ID
WHERE C.CREATE_TIME >=${START} AND C.CREATE_TIME < ${STOP} AND C.BIZ_TYPE='noBankCard'  
GROUP BY CUSTOMER_NUM,C.BIZ_TYPE",agentfr_mysql
COMMISSIONNOBANKCARD,COMMISSIONNOBANKCARDt1,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
COMMISSIONNOBANKCARD,COMMISSIONNOBANKCARDt2,"select PAYPRODUCT,salesproductcode as SALES_PRODUCT_CODE from payproduct2productcode",reportdb
COMMISSIONNOBANKCARD,COMMISSIONNOBANKCARDt3,"select PAYPRODUCT,productcode as PRODUCT_CODE from payproduct2productcode",reportdb
COMMISSIONNOBANKCARD,COMMISSIONNOBANKCARDt4,"select PAYPRODUCT,ORDERTYPE from payproduct2productcode",reportdb
cupdailytrx,cupdailytrx,"select  concat(COALESCE(CHAR(date(clock)),'null'),COALESCE(CHAR(ip),'null')) as IDNOUSE,
date(clock) as trxdate,ip,
min(value_min) as min_value,
sum(value_avg)/count(*) as avg_value,
max(value_max) as max_value 
from zabbix.trendslist_all 
where date(clock) >= ${START} and  date(clock)<${STOP}  and ip!='127.0.0.1'
group by date(clock),ip
",zabbix
cpulast7days,cpulast7days,"select concat(COALESCE(CHAR(a.intervalcpu),'null'),COALESCE(CHAR(a.key_),'null'),'cpulast7days') as idnouse,
a.intervalcpu as INTERVALCPU,a.key_ as key_,
count(*) as IPCOUNT,
(case when a.key_='system.cpu.util[,system]' then count(*)/(select count(distinct ip) from zabbix.trendslist_all where date(clock) >= DATE_SUB(CURRENT_DATE(),INTERVAL 30 DAY)
and  date(clock)<CURRENT_DATE() and ip!='127.0.0.1' and key_='system.cpu.util[,system]')  
when a.key_='system.cpu.util[,user]' then count(*)/(select count(distinct ip) from zabbix.trendslist_all where date(clock) >= DATE_SUB(CURRENT_DATE(),INTERVAL 30 DAY)
and  date(clock)<CURRENT_DATE() and ip!='127.0.0.1' and key_='system.cpu.util[,user]') else 0 end) as IPPERCENT 
from (select ip,key_,
(case when avg(value_avg)>=0 and avg(value_avg)<=2.5 then '0%-2.5%' 
when avg(value_avg)>2.5 and avg(value_avg)<=5 then '2.5%-5%' 
when avg(value_avg)>5 and avg(value_avg)<=10 then '5%-10%' 
when avg(value_avg)>10 and avg(value_avg)<=20 then '10%-20%' 
when avg(value_avg)>20 and avg(value_avg)<=30 then '20%-30%' 
when avg(value_avg)>30 and avg(value_avg)<=40 then '30%-40%' 
when avg(value_avg)>40 and avg(value_avg)<=50 then '40%-50%' 
when avg(value_avg)>50 and avg(value_avg)<=60 then '50%-60%' 
when avg(value_avg)>60 and avg(value_avg)<=70 then '60%-70%' 
when avg(value_avg)>70 and avg(value_avg)<=80 then '70%-80%' 
when avg(value_avg)>80 and avg(value_avg)<=90 then '80%-90%' 
when avg(value_avg)>90 and avg(value_avg)<=100 then '90%-100%' else 'null' end) as intervalcpu
from zabbix.trendslist_all  
where date(clock) >= DATE_SUB(CURRENT_DATE(),INTERVAL 30 DAY)
and  date(clock)<CURRENT_DATE() and ip!='127.0.0.1' 
group by ip,key_) a 
group by  a.intervalcpu,a.key_",zabbix
customer2salesproductcode,salesproductcode_online,"select  customernumber||'3011001002001A' as IDNOUSE,customernumber,'3011001002001A' as salesproductcode,case when locate('SALES',ORDERTYPEFILTER)>0 then 'OPEN' when ORDERTYPEFILTER is null then 'OPEN' when ORDERTYPEFILTER ='' then 'OPEN' else 'CLOSE' end as status from customer with ur",COPY2
customer2salesproductcode,salesproductcode_epos,"select  customernumber||'3011001003002A' as IDNOUSE,customernumber,'3011001003002A' as salesproductcode,case when locate('AUTHANDCONFIRM',ORDERTYPEFILTER)>0 then 'OPEN' when ORDERTYPEFILTER is null then 'OPEN' when ORDERTYPEFILTER ='' then 'OPEN' else 'CLOSE' end as status from customer with ur",COPY2
customer2salesproductcode,salesproductcode_transferinday,"select  c.customernumber||'3011101001001A' as IDNOUSE,c.customernumber,'3011101001001A' as salesproductcode,case when si.workdayDelay=1 then 'OPEN' when  si.workdayUrgency=1 then 'OPEN' when  si.weekendDelay=1 then 'OPEN' when si.weekendUrgency=1 then 'OPEN' else 'CLOSE' end as status from SettleIndayInfo si left join customer c on si.customerid=c.id with ur",COPY2
customer2salesproductcode,salesproductcode_transfer,"select  c.customernumber||'3011002001001A' as IDNOUSE,c.customernumber,'3011002001001A' as salesproductcode,case when si.active=1 then 'OPEN' else 'CLOSE' end as status from customertransferInfo si left join customer c on si.customerid=c.id with ur",COPY2
cpulast7daysip,cpulast7daysip,"select concat(COALESCE(CHAR(a.intervalcpu),'null'),COALESCE(CHAR(a.ip),'null'),COALESCE(CHAR(a.key_),'null')) as IDNOUSE,
a.ip as ip,a.intervalcpu as intervalcpu,a.key_ as key_,a.avg_value as avg_value from 
(select ip,key_,
(case when avg(value_avg)>=0 and avg(value_avg)<=2.5 then '0%-2.5%' 
when avg(value_avg)>2.5 and avg(value_avg)<=5 then '2.5%-5%' 
when avg(value_avg)>5 and avg(value_avg)<=10 then '5%-10%' 
when avg(value_avg)>10 and avg(value_avg)<=20 then '10%-20%' 
when avg(value_avg)>20 and avg(value_avg)<=30 then '20%-30%' 
when avg(value_avg)>30 and avg(value_avg)<=40 then '30%-40%' 
when avg(value_avg)>40 and avg(value_avg)<=50 then '40%-50%' 
when avg(value_avg)>50 and avg(value_avg)<=60 then '50%-60%' 
when avg(value_avg)>60 and avg(value_avg)<=70 then '60%-70%' 
when avg(value_avg )>70 and avg(value_avg)<=80 then '70%-80%' 
when avg(value_avg)>80 and avg(value_avg)<=90 then '80%-90%' 
when avg(value_avg)>90 and avg(value_avg)<=100 then '90%-100%' else 'null' end) as intervalcpu,
avg(value_avg) as avg_value 
from zabbix.trendslist_all 
where date(clock) >= DATE_SUB(CURRENT_DATE(),INTERVAL 30 DAY)
and  date(clock)<CURRENT_DATE() and ip!='127.0.0.1'
group by ip,key_) a 
group by a.ip,a.key_ ,a.intervalcpu",zabbix
dlbshopfirst30damount,dlbshopfirst30damount,"select S.SHOP_NUM AS SHOP_NUM,sum(D.SUC_AMOUNT)  AS F_30DAY_TRXAMOUNT
from db2inst1.DLB_SHOP_INFO S 
left join db2inst1.DLB_DAILYTRX D on S.SHOP_NUM=D.SHOP_NUM  and S.CREATEDATE<=D.TRXDATE and S.CREATEDATE + 30 DAYS>D.TRXDATE 
group by S.SHOP_NUM 
with ur",reportdb
customer2salesproductcode,salesproductcode_onekey,"select 
 f.merchant_account_code||'3011001003001A' as IDNOUSE, f.merchant_account_code as customernumber,'3011001003001A' as salesproductcode
from ewallet.merchant_to_from f left join ewallet.merchant_to_goods g on f.merchant_account_code=g.merchant_account_code
where  f.merchant_account_code is not null and g.goods_id not in (18,30,56)
and g.goods_id not in (55)
and f.from_id <> 11
group by f.merchant_account_code with ur",INNO
messagearrivemonthlytrx,messagearrivemonthlytrx,"SELECT COALESCE(CHAR(year(A.STAT_DATE)),'null')||COALESCE(CHAR(month(A.STAT_DATE)),'null')||COALESCE(CHAR(A.NOTIFIER_ID),'null')||COALESCE(CHAR(A.APP_NAME),'null') as IDNOUSE,
year(A.STAT_DATE)*100+month(A.STAT_DATE) as YM,
date(${START}) as STAT_DATE,
A.NOTIFIER_ID as NOTIFIER_ID,
A.APP_NAME as APP_NAME,
SUM(A.TOTAL_COUNT)   AS TOTAL_COUNT,
SUM(A.SUCCESS_COUNT) AS SUCCESS_COUNT,
SUM(A.FAIL_COUNT)    AS FAIL_COUNT,
SUM(A.IN_8S)  AS IN_8S,
SUM(A.IN_12S)  AS IN_12S,
SUM(A.IN_18S)  AS IN_18S,
SUM(A.IN_30S)  AS IN_30S,
SUM(A.IN_60S)  AS IN_60S,
SUM(A.IN_300S)  AS IN_300S
FROM
  NOTIFY.TBL_QUALITY_DAILY_STAT2 A
  WHERE A.STAT_DATE >=${START} AND A.STAT_DATE < ${STOP} AND A.MESSAGE_TYPE IS NOT NULL
GROUP BY  year(A.STAT_DATE),month(A.STAT_DATE),A.NOTIFIER_ID, A.APP_NAME
WITH UR",basic
ehremployeeinfo,ehr_share,"select GONGHAO,XINGMING, youxiang, zaizhizhuangtai, zhiji, xulie, zhiwei, ruzhiri, case when lizhiri='' then null else lizhiri end as lizhiri, yibaoxi, zhongxin, bumen, sijizu, zhijiezhuguangonghao, zhijiezhuguanqianzhui, zhijiezhuguan, gejizhuguangonghao, gejizhuguanqianzhui, gejizhuguan, HRBP, HRBPzongjian, fenguanVP, gengxinshijian,youxiangqianzhui from EHR_Share
",EHR_SHARE
dlbcustomerinfo,dlbcustomerinfophone,"select owner_num as CUSTOMER_NUM,contacts_num as PHONE from customer_contact_info where contacts_way='PHONE'",duolabao
customerinfo,customervipmark,"select  CUSTOMER_NUMBER as CUSTOMERNUMBER , case when CUSTOMER_LABEL_VALUE='SVIP' then 2 else 1 end as vipmark 
from SIGNING.TBL_CUSTOMER_LABEL_ATTRIBUTE 
where CUSTOMER_LABEL='customer_vip_level' and status=1 
with ur",BOSS
dlbdailytrxtrxfee,dlbdailytrxtrxfee,"select  concat(COALESCE(CHAR(date(gmt_modify)),'null'),COALESCE(CHAR(owner_num),'null'),COALESCE(CHAR(source_num),'null'),'dlbdailytrxtrxfee')  as idnouse,
date(gmt_modify) as trxdate,owner_num as customer_num,source_num as shop_num, sum(amount) as trxfee
from account_change 
where business_type='SALES_FEE' and has_settle=1 
and gmt_modify >= ${START} and gmt_modify < ${STOP} 
group by date(gmt_modify),owner_num,source_num",duolabao
dlbdailytrx,dlbdiscount,"select concat(COALESCE(CHAR(date(gmt_modify)),'null'),COALESCE(CHAR(pay_way),'null'),COALESCE(CHAR(customer_num),'null'),COALESCE(CHAR(shop_num),'null'),'dlbdiscount') as idnouse,
date(gmt_modify) as trxdate,pay_way as pay_way,customer_num as customer_num,shop_num as shop_num,
sum(case when can_accounted<>1 then amount else 0 end) as cust_discount_amount,
sum(case when can_accounted=1 then amount else 0 end) as dlb_subsidy_amount 
from duolabao.pay_info 
where bank_mark='RED_PACKET' 
and gmt_modify>= ${START} and gmt_modify < ${STOP}  and status in ('SUCCESS','REFUND') 
group by date(gmt_modify),pay_way,customer_num,shop_num",duolabao
customer2salesproductcode,salesproductcode_nobankcard,"select  s.customernumber||'4011001006001A' as IDNOUSE,s.customernumber,'4011001006001A' as salesproductcode from chargecardserviceprice a,customer s where a.customerID=s.ID group by s.customernumber with ur",COPY2
customer2salesproductcode,salesproductcode_weixin,"select 
 a.CUSTOMER_CODE||'3011001006001A' as IDNOUSE,a.CUSTOMER_CODE as customernumber,'3011001006001A' as salesproductcode,case when a.STATUS='NORMAL' then 'OPEN' else 'CLOSE' end as status
		from POSWRITE.TBL_POS_PRODUCTONCUSTOMER a 
		where a.PRODUCT_CODE = 'WECHAT'  with ur",opendb
customer2salesproductcode,salesproductcode_skbagent,"SELECT CUSTOMER_NUMBER||'3011004001004A'||'salesproductcode_skbagent' as IDNOUSE,CUSTOMER_NUMBER as customernumber,'3011004001004A' as salesproductcode,case when ACTIVE=1 then 'OPEN' else 'CLOSE' end as status FROM SKB.TBL_SKB_AGENTCUSTOMER with ur",accnt
customer2salesproductcode,salesproductcode_skbledge,"SELECT LEDGECUSTMERNUMBER ||'3011004001004A'||'salesproductcode_skbledge' as IDNOUSE, LEDGECUSTMERNUMBER as customernumber,'3011004001004A' as salesproductcode,case when AUDITSTATUS =4 then 'OPEN' else 'CLOSE' end as status FROM  SKB.TBL_SKB_AUDIT_STATUS with ur",accnt
customer2salesproductcode,salesproductcode_tztnew,"SELECT
MERCHANT_NO ||'3011004001005B' as IDNOUSE, MERCHANT_NO as customernumber,'3011004001005B' as salesproductcode,case when BIZ_ENABLED =1 then 'OPEN'  end as status
FROM JMC.MC_MERCHANT_CONFIG 
__with_ur",INNO
customer2salesproductcode,salesproductcode_tztold,"SELECT S.MERCHANT_ACCOUNT_CODE||'3011004001005A' AS IDNOUSE, S.MERCHANT_ACCOUNT_CODE AS CUSTOMERNUMBER,'3011004001005A' AS SALESPRODUCTCODE FROM EWALLET.MERCHANT_TO_GOODS S WHERE S.GOODS_ID in (18,30) WITH UR
 ",INNO
customer2salesproductcode,salesproductcode_zgt,"SELECT C.CUSTOMERNUMBER||'3011004001003A' AS IDNOUSE,C.CUSTOMERNUMBER,'3011004001003A'  AS SALESPRODUCTCODE FROM CUSTOMEREXT E LEFT JOIN CUSTOMER C ON C.ID=E.ID WHERE E.ZGT=1 WITH UR",COPY2
customerinfo,productgroupewallet,"select customer_identity_no as customernumber,'EWALLET' as productgroup from zgt.TBL_CUSTOMER_CONFIG where BELONG = 'WALLET' with ur",zxdb
instantpay,instantpay_jianquancost,"SELECT
 COALESCE(CHAR(T1.MERCHANT_NO),'null')||COALESCE(CHAR(t1.tool),'null')||COALESCE(CHAR(t1.biz),'null')||COALESCE(CHAR(date(T1.CREATE_TIME)),'null')||'instantpay_jianquancost' as IDNOUSE,
date(T1.CREATE_TIME) as trxdate,
'NCPAY' as dataorigin,
'3011001003001' as PRODUCT_CODE,
(case when T1.BIZ =2 then '3011004001003A' when T1.TOOL='NCCASHIER' then '3011001003001A' else  '3011001003001B' end) as SALES_PRODUCT_CODE,
T1.MERCHANT_NO as RECEIVERID,SUM(T2.COST) as accountingcost,SUM(T2.COST) as frpcost ,
year(T1.CREATE_TIME)*100+month(T1.CREATE_TIME) as month 
FROM NCC.TBL_NC_PAY_ORDER T1,NCC.TBL_NC_PAY_COST T2 
WHERE T1.PAYMENT_NO=T2.PAYMENT_NO AND T2.COST_TYPE='AUTH_COST' AND T1.CREATE_TIME >=${START}  and T1.CREATE_TIME<${STOP}  AND T1.BIZ  in (2,5)  
GROUP BY date(T1.CREATE_TIME),month(T1.CREATE_TIME),year(T1.CREATE_TIME),T1.TOOL,T1.BIZ,T1.MERCHANT_NO 
with ur",INNO_STANBY
instantpay,instantpay_jianquanzhongxin,"SELECT COALESCE(CHAR(a.CUSTOMER_NUMBER),'null')||COALESCE(CHAR(date(CREATE_DATE)),'null')||'instantpay_jianquanzhongxin' as IDNOUSE, date(CREATE_DATE) as trxdate, 'JIANQUANZHONGXIN' as dataorigin, '3011001003001' as PRODUCT_CODE, '3011001003001A' as SALES_PRODUCT_CODE, a.CUSTOMER_NUMBER as RECEIVERID, SUM(AUTH_TOTAL_COST+ REMIT_TOTAL_COST) as accountingcost, SUM(AUTH_TOTAL_COST+ REMIT_TOTAL_COST) as frpcost, year(CREATE_DATE)*100+month(CREATE_DATE) as month  FROM ncauth.tbl_nc_auth_order a  WHERE a.request_system = 'YIJIANZHIFU' AND CREATE_DATE >= ${START}  AND CREATE_DATE <${STOP}    group by a.CUSTOMER_NUMBER, date(CREATE_DATE),month(CREATE_DATE),year(CREATE_DATE)  with ur ",INNO_STANBY
messagearrivefailmonthlytrx,messagearrivefailmonthlytrx,"SELECT COALESCE(CHAR(year(CREATE_TIME)),'null')||COALESCE(CHAR(month(CREATE_TIME)),'null')||COALESCE(CHAR(REASON),'null') as IDNOUSE,
date(${START}) as STAT_DATE,
year(CREATE_TIME)*100+month(CREATE_TIME) as YM,
REASON AS REASON,
count(*) AS FAILCOUNT 
FROM NOTIFY.TBL_RECIPIENT 
WHERE CREATE_TIME  >=${START} AND CREATE_TIME < ${STOP}  
AND NOTIFIER_ID!='mailNotifier' 
AND (SEND_RESULT NOT IN('BlackList','Forbidden','Success') or SEND_RESULT IS NULL) 
GROUP BY year(CREATE_TIME),month(CREATE_TIME),REASON  
 with UR",basic
COMMISSIONNOBANKCARD,comnobankcardhk,"SELECT concat(COALESCE(CHAR(a.NUM),'null'),'201804','comnobankcardhk',coalesce(char(d.BIZ_TYPE),'null'),
    coalesce(CHAR(d.BANK_CODE),'null'))   as IDNOUSE,
     '201804' as month, date('2018-04-30')  as trxdate,
    a.NUM AS receiverid ,
   (case when d.BIZ_TYPE='netPay' then 4
      when d.BIZ_TYPE='memberPay' then 18
      when d.BIZ_TYPE='creditPay' then 5
      when d.BIZ_TYPE='epos' then 6
      when d.BIZ_TYPE='noBankCard' then
      (case
        when d.BANK_CODE='JIUYOU' then 7
        when d.BANK_CODE='JUNNET' then 8
        when d.BANK_CODE='LIANHUAOKCARD' then 9
        when d.BANK_CODE='NETEASE' then 10
        when d.BANK_CODE='QQCARD' then 12
        when d.BANK_CODE='SHTEL' then 14
        when d.BANK_CODE='SHTELCARD' then 15
        when d.BANK_CODE='SNDACARD' then 16
        when d.BANK_CODE='SOHU' then 17
        when d.BANK_CODE='SZX' then 19
        when d.BANK_CODE='TELECOM' then 20
        when d.BANK_CODE='UNICOM' then 22
        when d.BANK_CODE='WANMEI' then 23
        when d.BANK_CODE='YPCARD' then 24
        when d.BANK_CODE='ZHENGTU' then 25
        when d.BANK_CODE='ZHIFUKA' then 26
        when d.BANK_CODE='TIANXIA' then 41
        when d.BANK_CODE='ZONGYOU' then 81
        when d.BANK_CODE='TIANHONG' then 101
        when d.BANK_CODE='THIRTYTWOCARD' then 242
        when d.BANK_CODE='YICHONGCARD' then 243
        when d.BANK_CODE='YICHONGTIANHONGCARD' then 281
        when d.BANK_CODE='YICHONGZONGYOUCARD' then 282
        when d.BANK_CODE='YICHONGTHIRTYTWOCARD' then 283
        when d.BANK_CODE='ZYZC' then 285
        when d.BANK_CODE='ZYFK' then 286
        else 19 end)
      when d.BIZ_TYPE='entrusted' then 13
      when d.BIZ_TYPE='pos' then 29
      when d.BIZ_TYPE='transferinday' then 13
      when d.BIZ_TYPE='yjzf' then 222
ELSE 4 END) as biztypeid,
d.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION_HK' as TYPE, 
'YP3G_COMMISSION' as dataorigin,
  SUM(-d.PROFIT_AMOUNT) AS trxfee
FROM
    agentfr.TBL_PROFIT_DETAIL d
LEFT JOIN
    agentfr.TBL_PROFIT_RECORD r
ON
    d.PROFIT_RECORD_ID = r.id
LEFT JOIN
    agentfr.TBL_AGENT a
ON
    a.id = d.AGENT_ID
AND a.id = r.AGENT_ID
WHERE
    r.PROFIT_CONFIRM_STATE='CALCULATED'
AND d.STATUS='ACTIVE'
AND r.PROFIT_YEAR='2018'
AND r.PROFIT_MONTH='4'
AND a.PRODUCTION_LINE = 'airTravel' 
AND d.BIZ_TYPE='noBankCard'
GROUP BY
   a.num,
d.BANK_CODE,
    d.BIZ_TYPE",agentfr_mysql
COMMISSIONNOBANKCARD,comnobankcardadhk,"SELECT 
    concat(COALESCE(CHAR(A.NUM),'null'),char(date(${START})),'comnobankcardadhk',coalesce(char(C.BIZ_TYPE),'null')) as IDNOUSE,
   year(${START})*100+month(${START}) as month, date_sub(date(${STOP}),interval 1 day) as trxdate,
    A.NUM  AS receiverid,
    (case when C.BIZ_TYPE='netPay' then 4
      when C.BIZ_TYPE='memberPay' then 18
      when C.BIZ_TYPE='creditPay' then 5
      when C.BIZ_TYPE='epos' then 6
      when C.BIZ_TYPE='noBankCard' then 19
      when C.BIZ_TYPE='entrusted' then 13
      when C.BIZ_TYPE='pos' then 29
      when C.BIZ_TYPE='transferinday' then 13
      when C.BIZ_TYPE='yjzf' then 222
ELSE 4 END) as biztypeid,
C.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION_HK' as TYPE,
'YP3G_COMMISSION' as dataorigin,
    SUM(-ADJUST_AMOUNT) AS trxfee
FROM
    AGENTFR.TBL_ADJUST_DETAIL_CUS C
LEFT JOIN
    AGENTFR.TBL_AGENT A
ON
    C.AGENT_ID = A.ID
WHERE
    C.CREATE_TIME >=${START}
AND C.CREATE_TIME < ${STOP}
AND A.PRODUCTION_LINE = 'airTravel'  
AND C.BIZ_TYPE='noBankCard'  
GROUP BY
    A.NUM,
    C.BIZ_TYPE",agentfr_mysql
qianbaozhifu,qianbaozhifuTrade,"SELECT COALESCE(
    CHAR(merchant_account_code) ,
    'null'
) || COALESCE(
    CHAR(a.product_catalog) ,
    'null'
) || COALESCE(
    CHAR(a.pay_type) ,
    'null'
) || COALESCE(
    CHAR(a.order_origin) ,
    'null'
) || COALESCE(
    CHAR(a.fee_type) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(a.PAY_TIME)
    ) ,
    'null'
) || COALESCE(
    a.CARD_TYPE_ID ,
    'null'
) || COALESCE(
    a.bank_code ,
    'null'
) || COALESCE(
    b.frp_code ,
    'null'
) || 'qianbaozhifuTrade' as IDNOUSE ,
'QBZF' as dataorigin ,
case when a.pay_type in(
    19 ,
    20 ,
    21 ,
    22 ,
    28 ,
    29 ,
    30 ,
    31
) then '3011004004001' 
when a.pay_type in(
   33
) then '3011102002001' else '3011001003001' end as product_code ,
'3011004004001C' as SALES_PRODUCT_CODE,
merchant_account_code as RECEIVERID ,
SUM(
    a.ORDER_AMOUNT / 100.00
) AS trxamount ,
SUM(
    a.SELLER_FEE / 100.00
) AS trxfee ,
COUNT(*) AS trxcount ,
SUM(
    a.BANK_COST / 100.00
) AS accountingcost ,
SUM(
    a.BANK_COST / 100.00
) AS frpcost ,
a.product_catalog as goodscate ,
case when a.pay_type in(
    19 ,
    20 ,
    21 ,
    22 ,
    30 ,
    31
) then 'WECHAT_SALES' 
when a.pay_type in(
    28 ,
    29 
) then 'ALIPAY_SALES' 
when a.pay_type in(
    33
) then 'CFL_SALES' else char(a.pay_type) end as ordertype ,
case a.fee_type when 1 then 'POSTPAID' else 'PAID' end as feetype ,
DATE(a.PAY_TIME) AS trxdate ,
case a.CARD_TYPE_ID when 1 then 'CREDITCARD' when '2' then 'DEBITCARD' else 'UNKNOWN' end as cardtype ,
a.bank_code ,
b.frp_code as trxchannelid ,
year(a.PAY_TIME) * 100 + month(a.PAY_TIME) as month 
FROM EWALLET.DATA_PAY_SUCCESS a 
left join ewallet.pay_biz_order b on a.order_id = b.order_id 
WHERE a.PAY_TIME >= ${START} AND a.PAY_TIME < ${STOP}
and a.order_origin in(25) 
and (b.PAY_TOOL is null or b.PAY_TOOL <>'SCCANPAY')
and a.merchant_account_code not like 'YB%' 
GROUP BY merchant_account_code ,
a.product_catalog ,
a.pay_type,
a.order_origin ,
a.fee_type ,
DATE(a.PAY_TIME) ,
a.CARD_TYPE_ID ,
a.bank_code ,
b.frp_code ,
month(a.PAY_TIME) ,
year(a.PAY_TIME) 
with ur",INNO
qianbaozhifu,qianbaozhifutotal,"SELECT COALESCE(
    CHAR(PB.TRADER_ID) ,
    'null'
) || COALESCE(
    CHAR(pb.ORDER_ORIGIN) ,
    'null'
) || COALESCE(
    CHAR(pb.PRODUCT_CATALOG) ,
    'null'
) || COALESCE(
    CHAR(pb.pay_type) ,
    'null'
) ||COALESCE(
    CHAR(
        DATE(pb.ORDER_TIME)
    ) ,
    'null'
) || COALESCE(
    PB.frp_code ,
    'null'
) || COALESCE(
    s.bank_code ,
    'null'
) || 'qianbaozhifutotal' as IDNOUSE ,
'QBZF' as dataorigin ,
case when pb.pay_type in(
    19 ,
    20 ,
    21 ,
    22 ,
    28 ,
    29 ,
    30 ,
    31
) then '3011004004001'
when pb.pay_type in(
   33
) then '3011102002001' else '3011001003001' end as product_code ,
'3011004004001C' as SALES_PRODUCT_CODE ,
PB.TRADER_ID as RECEIVERID ,
COUNT(*) as wholeordercount ,
SUM(
    PB.ORDER_AMOUNT / 100.00
) as wholeorderamount ,
case when pb.pay_type in(
    19 ,
    20 ,
    21 ,
    22 ,
    30 ,
    31
) then 'WECHAT_SALES' 
when pb.pay_type in(
    28 ,
    29 
) then 'ALIPAY_SALES' 
when pb.pay_type in(
    33
) then 'CFL_SALES' else char(pb.pay_type) end as ordertype ,
pb.PRODUCT_CATALOG as goodscate ,
DATE(pb.ORDER_TIME) as trxdate ,
PB.frp_code as trxchannelid ,
s.bank_code,
year(pb.ORDER_TIME)*100+month(pb.ORDER_TIME) as month 
 FROM EWALLET.PAY_BIZ_ORDER AS PB 
left join ewallet.data_pay_success s on PB.order_id = s.order_id 
WHERE PB.CREATE_TIME >= ${START} AND PB.CREATE_TIME < ${STOP}
and pb.ORDER_ORIGIN in(25) 
and (pb.PAY_TOOL is null or pb.PAY_TOOL <> 'SCCANPAY')
and PB.TRADER_ID not like 'YB%' 
GROUP BY PB.TRADER_ID ,
pb.ORDER_ORIGIN ,
pb.PRODUCT_CATALOG ,
pb.pay_type,
DATE(pb.ORDER_TIME) ,
PB.frp_code ,
s.bank_code,month(pb.ORDER_TIME),year(pb.ORDER_TIME) 
with ur",INNO
qianbaozhifu,qianbaozhifurefund,"SELECT COALESCE(
    CHAR(a.merchant_account_code) ,
    'null'
) || COALESCE(
    CHAR(a.product_catalog) ,
    'null'
) ||COALESCE(
    CHAR(a.pay_type) ,
    'null'
) ||  COALESCE(
    CHAR(a.order_origin) ,
    'null'
) || COALESCE(
    CHAR(a.fee_type) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(b.REFUND_ACCOUNT_TIME)
    ) ,
    'null'
) || COALESCE(
    CHAR(pb.frp_code) ,
    'null'
) || COALESCE(
    CHAR(a.bank_code) ,
    'null'
) || 'qianbaozhifurefund' as IDNOUSE ,
'QBZF' as dataorigin ,
case when a.pay_type in(
    19 ,
    20 ,
    21 ,
    22 ,
    28 ,
    29 ,
    30 ,
    31
) then '3011004004001' 
when a.pay_type in(
   33
) then '3011102002001' else '3011001003001' end as product_code ,
'3011004004001C'  as SALES_PRODUCT_CODE ,
a.merchant_account_code as RECEIVERID ,
a.product_catalog as goodscate ,
case when a.pay_type in(
    19 ,
    20 ,
    21 ,
    22 ,
    30 ,
    31
) then 'WECHAT_SALES' 
when a.pay_type in(
    28 ,
    29 
) then 'ALIPAY_SALES' 
when a.pay_type in(
    33
) then 'CFL_SALES' else char(a.pay_type) end as ordertype ,
case a.fee_type when 1 then 'POSTPAID' else 'PAID' end as feetype ,
DATE(b.REFUND_ACCOUNT_TIME) as trxdate ,
SUM(
    b.refund_money / 100.00
) as refundamount ,
SUM(
    b.return_refund_fee / 100.00
) as refundfee ,
COUNT(b.id) as refundcount ,
pb.frp_code as trxchannelid ,
a.bank_code,
year(b.REFUND_ACCOUNT_TIME)*100+month(b.REFUND_ACCOUNT_TIME) as month 
FROM EWALLET.DATA_PAY_SUCCESS a 
LEFT JOIN EWALLET.PAY_REFUND_REQUEST b ON a.order_id = b.customer_order_id 
left join ewallet.pay_biz_order pb on a.order_id = pb.order_id 
WHERE b.REFUND_ACCOUNT_TIME >= ${START} AND b.REFUND_ACCOUNT_TIME < ${STOP} 
AND b.STATUS = 5 and a.order_origin in(25) 
and (pb.PAY_TOOL is null or pb.PAY_TOOL <> 'SCCANPAY')
and a.merchant_account_code not like 'YB%' 
GROUP BY a.merchant_account_code ,
a.product_catalog ,
a.pay_type,
a.order_origin ,
a.fee_type ,
DATE(b.REFUND_ACCOUNT_TIME) ,
pb.frp_code ,
a.bank_code,month(b.REFUND_ACCOUNT_TIME),year(b.REFUND_ACCOUNT_TIME) 
with ur",INNO
qianbaozhifu,qianbaozhifutransform,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
vipcustomerdailytrx,vipcustomerdailytrx,"select 
COALESCE(CHAR(DAILYTRXSTAT.TRXDATE),'null')||
COALESCE(CHAR(PRODUCTGROUPTYPE.NAME),'null')||
COALESCE(CHAR(E2C.SHARESCALE),'null')||
COALESCE(CHAR(EMP.NAME),'null')||
COALESCE(CHAR(RECEIVER.CUSTOMERNUMBER),'null')||
COALESCE(CHAR(TRXSTATBIZTYPE.DISPLAYNAME),'null')||
COALESCE(CHAR(TRXSTATTRXTYPE.NAME),'null')||
COALESCE(CHAR(TB.NAME),'null')||
COALESCE(CHAR(BRA.BRANCHNAME),'null')||
COALESCE(case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end,'null')||
COALESCE(CHAR(acc.NAME),'null')||
COALESCE(CHAR(P.PRODUCTNAME),'null')||
COALESCE(CHAR(P1.PRODUCTNAME),'null') as IDNOUSE,
sum(DAILYTRXSTAT.TRXFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.ACCOUNTINGCOST*E2C.SHARESCALE*c2a.PERCENT+DAILYTRXSTAT.REFUNDFRPCOST*E2C.SHARESCALE*c2a.PERCENT) as profit,
sum(DAILYTRXSTAT.REFUNDFEE*E2C.SHARESCALE*c2a.PERCENT) as refundfee,
sum(DAILYTRXSTAT.TRXFEE*E2C.SHARESCALE*c2a.PERCENT) as trxfee,
sum(DAILYTRXSTAT.TRXCOUNT*E2C.SHARESCALE*c2a.PERCENT) as trxcount,
sum(DAILYTRXSTAT.TRXTARGETFEE*E2C.SHARESCALE*c2a.PERCENT) as targetfee,
sum(DAILYTRXSTAT.TRXAMOUNT*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDAMOUNT*E2C.SHARESCALE*c2a.PERCENT) as net_trxamount,
sum(DAILYTRXSTAT.TRXAMOUNT*E2C.SHARESCALE*c2a.PERCENT) as trxamount,
sum(DAILYTRXSTAT.REFUNDCOUNT*E2C.SHARESCALE*c2a.PERCENT) as refundcount,
sum(DAILYTRXSTAT.REFUNDAMOUNT*E2C.SHARESCALE*c2a.PERCENT) as refundamount,
sum(CASE WHEN DAILYTRXSTAT.BIZTYPEID IN (29,129) THEN (DAILYTRXSTAT.TRXFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.ACCOUNTINGCOST*E2C.SHARESCALE*c2a.PERCENT+DAILYTRXSTAT.REFUNDFRPCOST*E2C.SHARESCALE*c2a.PERCENT) ELSE (DAILYTRXSTAT.TRXFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDFEE*E2C.SHARESCALE*c2a.PERCENT) END) as net_trxfee,
sum(DAILYTRXSTAT.TRXSOURCEFEE*E2C.SHARESCALE*c2a.PERCENT) as trxsourcefee,
sum(DAILYTRXSTAT.TRXCOUNT*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDCOUNT*E2C.SHARESCALE*c2a.PERCENT) as net_trxcount,
DAILYTRXSTAT.TRXDATE as trxdate,
PRODUCTGROUPTYPE.NAME as bizdetail,
RECEIVER.FULLNAME as custname,
E2C.SHARESCALE as sharescale,
EMP.NAME as empname,
RECEIVER.CUSTOMERNUMBER as customernumber,
TRXSTATBIZTYPE.DISPLAYNAME as biztype,
TRXSTATTRXTYPE.NAME as trxtype,
DAILYTRXSTAT.MONTH as trxmonth,
RECEIVER.CUSTOMERTYPE as customertype,
RECEIVER.RESERVEDAYS as reservedays,
RECEIVER.GRADELEVEL as gradelevel,
RECEIVER.CYCLETYPE as CYCLETYPE,
RECEIVER.LEVEL custlevel,
RECEIVER.AGENTCODE agentcode,
RECEIVER.PROVINCE as province,
RECEIVER.AGENTNAME as agentname,
TB.NAME as catname,
RECEIVER.SIGNEDNAME as signedname,
BRA.BRANCHNAME as branchname,
RECEIVER.CITY as city,
RECEIVER.VMARK as vmark,
(case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end) as accounttype,
acc.NAME as acctype,
P.PRODUCTNAME as productname,
P1.PRODUCTNAME as salesproductname,
RECEIVER.CREATEDATE createdate,
(CASE WHEN RECEIVER.VIPMARK=1 THEN 'VIP' WHEN RECEIVER.VIPMARK=2 THEN 'SVIP' ELSE '_' END) as vipmark 
from DAILYTRXSTAT
left join TRXSTATBIZTYPE on 1=1 and DAILYTRXSTAT.BIZTYPEID=TRXSTATBIZTYPE.ID 
left join CUSTOMERINFO AS RECEIVER on 1=1 and DAILYTRXSTAT.RECEIVERID=RECEIVER.ID 
left join TRXSTATCUSTOMERAREA AS AREA on 1=1 and RECEIVER.AREAID=AREA.ID 
left join TRXSTATCUSTOMERPRODUCTLINE AS PRODUCTLINE on 1=1 and RECEIVER.PRODUCTLINEID=PRODUCTLINE.ID 
left join CUSTOMERRELATIONSHIP AS E2C on 1=1 and RECEIVER.ID=E2C.CUSTOMERID 
left join EMPLOYEEINFO AS EMP on 1=1 and E2C.EMPLOYEEID=EMP.ID 
left join PRODUCTGROUPTYPE on 1=1 and RECEIVER.PRODUCTGROUP=PRODUCTGROUPTYPE.ID 
left join TRXSTATTRXTYPE on 1=1 and DAILYTRXSTAT.TYPE=TRXSTATTRXTYPE.ID 
left join TRXSTATBUSINESSCATEGORIE AS TB on 1=1 and RECEIVER.BUSSINESSCATID=TB.ID 
left join TRXSTATCUSTOMERAREA AS BRA on 1=1 and EMP.BRANCHCOMPANY=BRA.AREAID 
left join TRXSTATACCMARK AS acc on 1=1 and RECEIVER.ACCMARK=acc.CODE 
left join PRODUCTCODE AS P on 1=1 and DAILYTRXSTAT.PRODUCT_CODE=P.PRODUCTCODE and P.PRODUCTTYPE=2 
left join PRODUCTCODE AS P1 on 1=1 and DAILYTRXSTAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE and P1.PRODUCTTYPE=1 
left join TRXSTATBIZTYPE_PROFILE AS BP on 1=1 and DAILYTRXSTAT.BIZTYPEID=BP.BIZTYPEID 
left join productcode_profile AS PP on 1=1 and DAILYTRXSTAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE and DAILYTRXSTAT.PRODUCT_CODE=PP.PRODUCT_CODE 
left join frpchannel AS fc on 1=1 and DAILYTRXSTAT.trxchannelid=fc.trxchannelid 
left join customer2achievement AS c2a on 1=1 and RECEIVER.customernumber=c2a.customer_number 
left join EXISTENCE AS ex on 1=1 and c2a.ACHIEVEMENT_ID=ex.ID and ex.CLASSTYPE='Department' 
left join TRXSTATSUBBUSINESSCATEGORIE AS tsg on 1=1 and RECEIVER.SUBBUSINESSCAT=tsg.CODE 
left join PRODUCTCODE2PRODUCTGROUP AS p2pg on 1=1 and DAILYTRXSTAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE and DAILYTRXSTAT.PRODUCT_CODE=p2pg.PRODUCT_CODE 
left join cfg_bank_info AS cbi on 1=1 and DAILYTRXSTAT.BANK_CODE=cbi.CODE 
where 1=1
and DAILYTRXSTAT.TRXDATE>=${START} and DAILYTRXSTAT.TRXDATE<${STOP} 
and CASE WHEN RECEIVER.VIPMARK=1 THEN 'VIP' WHEN RECEIVER.VIPMARK=2 THEN 'SVIP' ELSE '_' END in ('VIP','SVIP')
group by
DAILYTRXSTAT.TRXDATE,
PRODUCTGROUPTYPE.NAME,
RECEIVER.FULLNAME,
E2C.SHARESCALE,
EMP.NAME,
RECEIVER.CUSTOMERNUMBER,
TRXSTATBIZTYPE.DISPLAYNAME,
TRXSTATTRXTYPE.NAME,
DAILYTRXSTAT.MONTH,
RECEIVER.CUSTOMERTYPE,
RECEIVER.RESERVEDAYS,
RECEIVER.GRADELEVEL,
RECEIVER.CYCLETYPE,
RECEIVER.LEVEL,
RECEIVER.AGENTCODE,
RECEIVER.PROVINCE,
RECEIVER.AGENTNAME,
TB.NAME,
RECEIVER.SIGNEDNAME,
BRA.BRANCHNAME,
RECEIVER.CITY,
RECEIVER.VMARK,
case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end,
acc.NAME,
P.PRODUCTNAME,
P1.PRODUCTNAME,
RECEIVER.CREATEDATE,
CASE WHEN RECEIVER.VIPMARK=1 THEN 'VIP' WHEN RECEIVER.VIPMARK=2 THEN 'SVIP' ELSE '_' END 
with ur",reportdb
jiexindataonce,jiexindatadailytrx,"SELECT B.CARD_NO||B.TRADER_ID||CHAR(DATE(B.ORDER_TIME))||'JIEXINDATADAILYTRX' AS IDNOUSE,B.CARD_NO,B.TRADER_ID,DATE(B.ORDER_TIME) AS TRXDATE,SUM(B.ORDER_AMOUNT)/100.00 AS TRXAMOUNT,COUNT(*) AS TRXCOUNT,MAX(B.ORDER_AMOUNT)/100.00 AS MAXAMOUNT,MIN(B.ORDER_AMOUNT)/100.00 AS MINAMOUNT,MAX(B.ORDER_TIME) AS LASTTIME FROM EWALLET.PAY_BIZ_ORDER B WHERE B.ORDER_STATE=1 AND B.ORDER_TIME >= ${START} AND B.ORDER_TIME < ${STOP} GROUP BY B.CARD_NO,B.TRADER_ID,DATE(B.ORDER_TIME) WITH UR",INNO_STANBY
jiexindataonce,jiexincardstr,"select card_no as CARD_NO,card_str as CARD_STR from temp_jiexin_card with ur",reportdb
zgtverifywechatxieyi,zgtwechatcost,"select coalesce(char(DATE(p.COMPLETE_TIME)),'null')||coalesce(char(o.CUSTOMER_NO),'null')||'zgtwechatcost' as IDNOUSE,
DATE(p.COMPLETE_TIME) AS TRXDATE,
year(DATE(p.COMPLETE_TIME))*100+ month(DATE(p.COMPLETE_TIME)) AS MONTH,
o.CUSTOMER_NO AS RECEIVERID,
'3011001006001' AS PRODUCT_CODE,
'3011004001003A' AS SALES_PRODUCT_CODE,
'SALES' AS ORDERTYPE,
'ZGT_WECHAT' AS PAYPRODUCT,
260  AS BIZTYPEID,
'Sales' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'POSP' AS DATAORIGIN,
SUM(p.BANK_COST) AS FRPCOST,
SUM(p.BANK_COST) AS ACCOUNTINGCOST 
FROM 
poswrite.tbl_mpay_order o 
LEFT JOIN poswrite.tbl_mpay_payment p ON o.EFFECTIVE_PID = p.ID 
WHERE p.COMPLETE_TIME >= ${START} AND p.COMPLETE_TIME < ${STOP} 
AND o.SOURCE in ('ZGT') AND o.STATUS = 'SUCCESS' 
GROUP BY o.CUSTOMER_NO, DATE(p.COMPLETE_TIME) 
WITH UR",opendb
shoukuanbao,skbwechatcost,"SELECT coalesce(char(DATE(p.COMPLETE_TIME)),'null')||coalesce(char(o.CUSTOMER_NO),'null')||'skbwechatcost' as IDNOUSE,
'POSP' as dataorigin,
year(DATE(p.COMPLETE_TIME))*100+month(DATE(p.COMPLETE_TIME)) as month,
o.CUSTOMER_NO as RECEIVERID,
260 as biztypeid,
'3011001006001' as PRODUCT_CODE,
DATE(p.COMPLETE_TIME) as trxdate,
'3011004001004A' as SALES_PRODUCT_CODE,
SUM(p.BANK_COST) as FRPCOST,
SUM(p.BANK_COST) as ACCOUNTINGCOST 
FROM  poswrite.tbl_mpay_order o 
LEFT JOIN poswrite.tbl_mpay_payment p  ON o.EFFECTIVE_PID = p.ID 
WHERE p.COMPLETE_TIME >= ${START} AND p.COMPLETE_TIME < ${STOP} 
AND o.SOURCE in ('SKB') AND o.STATUS = 'SUCCESS' 
GROUP BY o.CUSTOMER_NO, DATE(p.COMPLETE_TIME) 
WITH UR",opendb
jiexindataoncehis,jiexindatadailytrxhis,"SELECT B.CARD_NO||B.TRADER_ID||CHAR(DATE(B.ORDER_TIME))||'JIEXINDATADAILYTRXHIS' AS IDNOUSE,B.CARD_NO,B.TRADER_ID,DATE(B.ORDER_TIME) AS TRXDATE,SUM(B.ORDER_AMOUNT)/100.00 AS TRXAMOUNT,COUNT(*) AS TRXCOUNT FROM EWALLET.PAY_BIZ_ORDER B WHERE B.ORDER_STATE=1 AND B.ORDER_TIME >= ${START} AND B.ORDER_TIME < ${STOP} GROUP BY B.CARD_NO,B.TRADER_ID,DATE(B.ORDER_TIME) WITH UR",dbhis01_bank
jiexindataoncehis,jiexincardstrhis,"select card_no as CARD_NO,card_str as CARD_STR from temp_jiexin_card with ur",reportdb
nobankcarddailytrx,nobankcardsuccess,"select concat(coalesce(char(DATE(t.complete_date)),'null'),
coalesce(char(t.merchant_no),'null'),
coalesce(char(t.order_type),'null'),
coalesce(char(t.card_type),'null'),
'nobankcardsuccess') AS IDNOUSE,
DATE(t.complete_date) AS TRXDATE,
YEAR(t.complete_date)*100+MONTH(t.complete_date) AS MONTH,
t.merchant_no AS RECEIVERID,
'7011001006001' AS PRODUCT_CODE,
'7011001006001A' AS SALES_PRODUCT_CODE,
300 AS BIZTYPEID,
t.order_type AS ORDERTYPE,
t.card_type AS trxchannelid,
'Sales' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'PAID' AS FEETYPE,
'ONLINE' AS RELEGATION,
'SYSTEM' AS USETYPE,
'YEEYK' AS DATAORIGIN,
count(*) AS TRXCOUNT,
sum(t.success_amount) AS TRXAMOUNT,
sum(t.user_fee) AS TRXSOURCEFEE,
sum(t.merchant_fee)  AS TRXTARGETFEE,
sum(t.user_fee + t.merchant_fee) AS TRXFEE,
sum(t.share_costamount) AS FRPCOST,
sum(t.share_costamount) AS ACCOUNTINGCOST 
from TXP.T_TXP_ORDER t 
where t.complete_date>=${START} and t.complete_date < ${STOP} 
and t.order_status = 'SUCCESS' 
group by t.merchant_no ,
DATE(t.complete_date),
t.order_type,
t.card_type",agentfr_mysql
customer2salesproductcode,salesproductcode_pos,"SELECT C.CUSTOMERNUMBER||'3011001001001' AS IDNOUSE,C.CUSTOMERNUMBER,'3011001001001'  AS SALESPRODUCTCODE FROM CUSTOMER C LEFT JOIN PROFILE P ON C.ID=P.CUSTOMER_ID WHERE P.NAME='p_posOpenStatus' AND P.VALUE='1' WITH UR",COPY2
customerinfo,skbagent,"SELECT LEDGECUSTOMERNUMBER as CUSTOMERNUMBER,MAINCUSTOMERNUMBER as AGENTCODE,'SKB' as AGENTTYPE FROM SKB.TBL_SKB_REGISTER WITH UR",accnt
customerinfo,nobankcardcust,"select merchant_no as ID,merchant_no as CUSTOMERNUMBER,merchant_name as FULLNAME,'YEEYK' as PRODUCTGROUP from MERCHANT.T_MERCHANT_REGISTE",agentfr_mysql
yimafu,yimafuTrade,"SELECT
    COALESCE(
        CHAR(merchant_account_code) ,
        'null'
    ) || COALESCE(
        CHAR(a.product_catalog) ,
        'null'
    ) || COALESCE(
        CHAR(a.order_origin) ,
        'null'
    ) || COALESCE(
        CHAR(a.pay_type) ,
        'null'
    ) || COALESCE(
        CHAR(a.fee_type) ,
        'null'
    ) || COALESCE(
        CHAR(
            DATE(a.PAY_TIME)
        ) ,
        'null'
    ) || COALESCE(
        a.CARD_TYPE_ID ,
        'null'
    ) || COALESCE(
        a.bank_code ,
        'null'
    ) || COALESCE(
        b.frp_code ,
        'null'
    ) || 'yimafuTrade' AS IDNOUSE ,
    'YIMAFU' AS dataorigin ,
    CASE
        WHEN a.pay_type IN(
            19 ,
            20 ,
            21 ,
            22 ,
            28 ,
            29
        )
        THEN '3011004004001'  	WHEN a.pay_type IN(
            30
        )
	 THEN '3011001006001'
        ELSE '3011001003001'
    END AS product_code ,
    '3011001006003A' AS SALES_PRODUCT_CODE ,
    merchant_account_code AS RECEIVERID ,
    SUM(
        a.ORDER_AMOUNT / 100.00
    ) AS trxamount ,
    SUM(
        a.SELLER_FEE / 100.00
    ) AS trxfee ,
    COUNT(*) AS trxcount ,
    SUM(
        a.BANK_COST / 100.00
    ) AS accountingcost ,
    SUM(
        a.BANK_COST / 100.00
    ) AS frpcost ,
    a.product_catalog AS goodscate ,
    CASE
        WHEN a.pay_type IN(
            19 ,
            20 ,
            21 ,
            22,
              30
        )
        THEN 'WECHAT_SALES' WHEN a.pay_type IN(
            28 ,
            29
        )
        THEN 'ALIPAY_SALES'
        ELSE CHAR(a.pay_type)
    END AS ordertype ,
    CASE
        a.fee_type WHEN 1
        THEN 'POSTPAID'
        ELSE 'PAID'
    END AS feetype ,
    DATE(a.PAY_TIME) AS trxdate ,
    CASE
        a.CARD_TYPE_ID WHEN 1
        THEN 'CREDITCARD' WHEN '2'
        THEN 'DEBITCARD'
        ELSE 'UNKNOWN'
    END AS cardtype ,
    a.bank_code ,
    b.frp_code AS trxchannelid ,
    YEAR( a.PAY_TIME ) * 100 + MONTH( a.PAY_TIME ) AS MONTH
FROM
    EWALLET.DATA_PAY_SUCCESS a LEFT JOIN ewallet.pay_biz_order b
        ON a.order_id = b.order_id
WHERE
    a.PAY_TIME >= ${START}
    AND a.PAY_TIME < ${STOP}
    AND a.order_origin IN(24)
    AND a.merchant_account_code NOT LIKE 'YB%'
GROUP BY
    merchant_account_code ,
    a.product_catalog ,
    a.order_origin ,
    a.pay_type ,
    a.fee_type ,
    DATE(a.PAY_TIME) ,
    a.CARD_TYPE_ID ,
    a.bank_code ,
    b.frp_code ,
    MONTH( a.PAY_TIME ) ,
    YEAR( a.PAY_TIME ) WITH ur",INNO
yimafu,yimafutotal,"SELECT
    COALESCE(
        CHAR(PB.TRADER_ID) ,
        'null'
    ) || COALESCE(
        CHAR(pb.ORDER_ORIGIN) ,
        'null'
    ) || COALESCE(
        CHAR(pb.pay_type) ,
        'null'
    ) || COALESCE(
        CHAR(pb.PRODUCT_CATALOG) ,
        'null'
    ) || COALESCE(
        CHAR(
            DATE(pb.ORDER_TIME)
        ) ,
        'null'
    ) || COALESCE(
        PB.frp_code ,
        'null'
    ) || COALESCE(
        s.bank_code ,
        'null'
    ) || 'yimafutotal' AS IDNOUSE ,
    'YIMAFU' AS dataorigin ,
    CASE
        WHEN pb.pay_type IN(
            19 ,
            20 ,
            21 ,
            22 ,
            28 ,
            29
        )
        THEN '3011004004001' 	WHEN pb.pay_type IN(
            30
        )
	 THEN '3011001006001'
        ELSE '3011001003001'
    END AS product_code ,
    '3011001006003A' AS SALES_PRODUCT_CODE ,
    PB.TRADER_ID AS RECEIVERID ,
    COUNT(*) AS wholeordercount ,
    SUM(
        PB.ORDER_AMOUNT / 100.00
    ) AS wholeorderamount ,
    CASE
        WHEN pb.pay_type IN(
            19 ,
            20 ,
            21 ,
            22,
               30
        )
        THEN 'WECHAT_SALES' WHEN pb.pay_type IN(
            28 ,
            29
        )
        THEN 'ALIPAY_SALES'
        ELSE CHAR(pb.pay_type)
    END AS ordertype ,
    pb.PRODUCT_CATALOG AS goodscate ,
    DATE(pb.ORDER_TIME) AS trxdate ,
    PB.frp_code AS trxchannelid ,
    s.bank_code ,
    YEAR( pb.ORDER_TIME ) * 100 + MONTH( pb.ORDER_TIME ) AS MONTH
FROM
    EWALLET.PAY_BIZ_ORDER AS PB LEFT JOIN ewallet.data_pay_success s
        ON PB.order_id = s.order_id
WHERE
    PB.CREATE_TIME >= ${START}
    AND PB.CREATE_TIME < ${STOP}
    AND pb.ORDER_ORIGIN IN(24)
    AND PB.TRADER_ID NOT LIKE 'YB%'
GROUP BY
    PB.TRADER_ID ,
    pb.ORDER_ORIGIN ,
    pb.pay_type ,
    pb.PRODUCT_CATALOG ,
    DATE(pb.ORDER_TIME) ,
    PB.frp_code ,
    s.bank_code ,
    MONTH( pb.ORDER_TIME ) ,
    YEAR( pb.ORDER_TIME ) WITH ur",INNO
yimafu,yimafurefund,"SELECT
    COALESCE(
        CHAR(a.merchant_account_code) ,
        'null'
    ) || COALESCE(
        CHAR(a.product_catalog) ,
        'null'
    ) || COALESCE(
        CHAR(a.order_origin) ,
        'null'
    ) || COALESCE(
        CHAR(a.pay_type) ,
        'null'
    ) || COALESCE(
        CHAR(a.fee_type) ,
        'null'
    ) || COALESCE(
        CHAR(
            DATE(b.REFUND_ACCOUNT_TIME)
        ) ,
        'null'
    ) || COALESCE(
        CHAR(pb.frp_code) ,
        'null'
    ) || COALESCE(
        CHAR(a.bank_code) ,
        'null'
    ) || 'yimafurefund' AS IDNOUSE ,
    'YIMAFU' AS dataorigin ,
    CASE
        WHEN a.pay_type IN(
            19 ,
            20 ,
            21 ,
            22 ,
            28 ,
            29
        )
        THEN '3011004004001' 	WHEN a.pay_type IN(
            30
        )
	 THEN '3011001006001' 
        ELSE '3011001003001'
    END AS product_code ,
    '3011001006003A' AS SALES_PRODUCT_CODE ,
    a.merchant_account_code AS RECEIVERID ,
    a.product_catalog AS goodscate ,
    CASE
        WHEN a.pay_type IN(
            19 ,
            20 ,
            21 ,
            22,
	     30
        )
        THEN 'WECHAT_SALES' WHEN a.pay_type IN(
            28 ,
            29
        )
        THEN 'ALIPAY_SALES'
        ELSE CHAR(a.pay_type)
    END AS ordertype ,
    CASE
        a.fee_type WHEN 1
        THEN 'POSTPAID'
        ELSE 'PAID'
    END AS feetype ,
    DATE(b.REFUND_ACCOUNT_TIME) AS trxdate ,
    SUM(
        b.refund_money / 100.00
    ) AS refundamount ,
    SUM(
        b.return_refund_fee / 100.00
    ) AS refundfee ,
    COUNT(b.id) AS refundcount ,
    pb.frp_code AS trxchannelid ,
    a.bank_code ,
    YEAR( b.REFUND_ACCOUNT_TIME ) * 100 + MONTH( b.REFUND_ACCOUNT_TIME ) AS MONTH
FROM
    EWALLET.DATA_PAY_SUCCESS a LEFT JOIN EWALLET.PAY_REFUND_REQUEST b
        ON a.order_id = b.customer_order_id LEFT JOIN ewallet.pay_biz_order pb
        ON a.order_id = pb.order_id
WHERE
    b.REFUND_ACCOUNT_TIME >= ${START}
    AND b.REFUND_ACCOUNT_TIME < ${STOP}
    AND b.STATUS = 5
    AND a.order_origin IN(24)
    AND a.merchant_account_code NOT LIKE 'YB%'
GROUP BY
    a.merchant_account_code ,
    a.product_catalog ,
    a.order_origin ,
    a.pay_type ,
    a.fee_type ,
    DATE(b.REFUND_ACCOUNT_TIME) ,
    pb.frp_code ,
    a.bank_code ,
    MONTH( b.REFUND_ACCOUNT_TIME ) ,
    YEAR( b.REFUND_ACCOUNT_TIME ) WITH ur",INNO
yimafu,yimafutransform,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
unionmini,unionminiTrade,"(select COALESCE(CHAR(date(temp.COMPLETE_TIME)),'null')|| COALESCE(CHAR(temp.payno),'null')|| COALESCE(CHAR(temp.customernumber),'null')|| COALESCE(CHAR(temp.businesstype),'null')||'unionminitrade' as IDNOUSE,
date(temp.COMPLETE_TIME) as trxdate,year(temp.COMPLETE_TIME)*100+month(temp.COMPLETE_TIME) as month,
'3011001004002C' as SALES_PRODUCT_CODE,'3011001004002' as PRODUCT_CODE,280 as BIZTYPEID,'Sales' as type,'POSP' AS DATAORIGIN,'SYSTEM' as USETYPE,1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
temp.payno as PAYERID,temp.customernumber as RECEIVERID,temp.businesstype as ORDERTYPE,temp.businesstype as PAYPRODUCT,count(*) as trxcount,sum(temp.trxamount) as trxamount 
from  ( select  case  when o.POS_CATI='10495285' then '10011879253'  when o.POS_CATI='10912894' then '10012404646' 
when o.POS_CATI='10912801' then '10012411574'  else coalesce(o.bank_trx_id,'') end as payno, o.CUSTOMER_NUMBER as customernumber, 
o.trx_amount as trxamount, case when o.BUSINESS_TYPE='UNION_BILL_PURCHASE_PAY2' 
then 'UNION_MINI' else 'UNION_ZIZHU' end as businesstype,
o.COMPLETE_TIME as COMPLETE_TIME 
from POSWRITE.tbl_pos_order o  where o.BUSINESS_TYPE in ('UNION_BILL_PURCHASE_PAY1','UNION_BILL_PURCHASE_PAY2','UNION_BANKTO_TRANSFER_PURCHASE')  
and o.ORDER_STATUS in ('SUCCESS','SETTLED')  and o.ORDER_TYPE='PURCHASE'  
and o.COMPLETE_TIME >= ${START} AND o.COMPLETE_TIME < ${STOP} 
) temp  group by temp.payno,temp.customernumber,temp.businesstype,
date(temp.COMPLETE_TIME),year(temp.COMPLETE_TIME),month(temp.COMPLETE_TIME)
)

union
(select COALESCE(CHAR(date(o.CREATE_TIME)),'null')|| COALESCE(CHAR(coalesce(o.agent_number,'')),'null')|| COALESCE(CHAR(c.CUSTOMER_NUMBER),'null')||COALESCE(CHAR( o.BUSINESS_TYPE),'null')||'unionminitrade' as IDNOUSE,
date(o.CREATE_TIME) as trxdate,year(o.CREATE_TIME)*100+month(o.CREATE_TIME) as month,
'3011001004002C' as SALES_PRODUCT_CODE,'3011001004002' as PRODUCT_CODE,280 as BIZTYPEID,'Sales' as type,'POSP' AS DATAORIGIN,'SYSTEM' as USETYPE,1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
coalesce(o.agent_number,'') as PAYERID,
c.CUSTOMER_NUMBER  as RECEIVERID,
 (case when o.BUSINESS_TYPE='UNION_BILL_PURCHASE_PAY2' 
then 'UNION_MINI' else 'UNION_ZIZHU' end) as  ORDERTYPE,
 (case when o.BUSINESS_TYPE='UNION_BILL_PURCHASE_PAY2' 
then 'UNION_MINI' else 'UNION_ZIZHU' end) as PAYPRODUCT,
count(*) as trxcount,sum(o.trx_amount) as trxamount
from 
POSWRITE.tbl_transfer_order  o left  join POSWRITE.TBL_POS_CUSTOMER c ON o.CUSTOMER_ID=c.id
where 
    o.BUSINESS_TYPE in ('UNION_BILL_PURCHASE_PAY1','UNION_BILL_PURCHASE_PAY2') 
and 
o.TRX_STATUS  in ('SUCCESS','SETTLED')
and 
o.TRX_TYPE='PURCHASE'
and o.CREATE_TIME >= ${START} AND  o.CREATE_TIME< ${STOP}  
group by o.agent_number, c.CUSTOMER_NUMBER, o.BUSINESS_TYPE,date(o.CREATE_TIME),year(o.CREATE_TIME),month(o.CREATE_TIME)
) with ur",opendb
unionmini,unionminirefund,"(select COALESCE(CHAR(date(t.TRX_TIME)),'null')|| COALESCE(CHAR(o.bank_trx_id),'null')|| COALESCE(CHAR(o.CUSTOMER_NUMBER),'null')||COALESCE(CHAR(o.BUSINESS_TYPE),'null')||'unionminirefund' as IDNOUSE,
date(t.TRX_TIME) as trxdate,year(t.TRX_TIME)*100+month(t.TRX_TIME) as month,
'3011001004002C' as SALES_PRODUCT_CODE,'3011001004002' as PRODUCT_CODE,280 as BIZTYPEID,'Sales' as type,'POSP' AS DATAORIGIN,'SYSTEM' as USETYPE,1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
o.bank_trx_id as PAYERID,o.CUSTOMER_NUMBER as RECEIVERID, sum(o.trx_amount) as refundamount,
count(*) as refundcount, case when o.BUSINESS_TYPE='UNION_BILL_PURCHASE_PAY1' then 'UNION_ZIZHU' else 'UNION_MINI' end as ORDERTYPE,
case when o.BUSINESS_TYPE='UNION_BILL_PURCHASE_PAY1' then 'UNION_ZIZHU' else 'UNION_MINI' end as PAYPRODUCT    
from POSWRITE.tbl_pos_order o,POSWRITE.tbl_pos_payment t  where o.id = t.order_id  and o.BUSINESS_TYPE in ('UNION_BILL_PURCHASE_PAY1','UNION_BILL_PURCHASE_PAY2')  
and o.ORDER_TYPE='PURCHASE'  
and t.TRX_TIME >=${START} AND t.TRX_TIME< ${STOP} 
and t.TRX_TYPE in ('PURCHASE_REFUND' ) 
and t.STATUS = 'SUCCESS'  group by o.bank_trx_id,o.CUSTOMER_NUMBER,o.BUSINESS_TYPE,date(t.TRX_TIME),year(t.TRX_TIME),month(t.TRX_TIME)
)

union
(select COALESCE(CHAR(date(t.LAST_MODIFIED_TIME)),'null')|| COALESCE(CHAR(coalesce(o.agent_number,'')),'null')|| COALESCE(CHAR(c.CUSTOMER_NUMBER),'null')||COALESCE(CHAR(o.BUSINESS_TYPE),'null')||'unionminirefund' as IDNOUSE,
date(t.LAST_MODIFIED_TIME) as trxdate,year(t.LAST_MODIFIED_TIME)*100+month(t.LAST_MODIFIED_TIME) as month,
'3011001004002C' as SALES_PRODUCT_CODE,'3011001004002' as PRODUCT_CODE,280 as BIZTYPEID,'Sales' as type,'POSP' AS DATAORIGIN,'SYSTEM' as USETYPE,1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
coalesce(o.agent_number,'') as PAYERID,c.CUSTOMER_NUMBER as RECEIVERID,sum(o.trx_amount) as refundamount,
count(*) as refundcount, case when o.BUSINESS_TYPE='UNION_BILL_PURCHASE_PAY1' then 'UNION_ZIZHU' else 'UNION_MINI' end as ORDERTYPE ,
case when o.BUSINESS_TYPE='UNION_BILL_PURCHASE_PAY1' then 'UNION_ZIZHU' else 'UNION_MINI' end as PAYPRODUCT 
from POSWRITE.tbl_transfer_order o
left join POSWRITE.tbl_transfer_payment t 
on o.id = t.order_id 
left  join POSWRITE.TBL_POS_CUSTOMER c ON o.CUSTOMER_ID=c.id
where  
o.BUSINESS_TYPE in ('UNION_BILL_PURCHASE_PAY1','UNION_BILL_PURCHASE_PAY2')
and o.trx_TYPE = 'PURCHASE'
and t.LAST_MODIFIED_TIME >=${START} AND t.LAST_MODIFIED_TIME < ${STOP} 
and t.TRX_TYPE = 'PURCHASE_REFUND'
and t.STATUS = 'SUCCESS'
group by o.agent_number,c.CUSTOMER_NUMBER,o.BUSINESS_TYPE,date(t.LAST_MODIFIED_TIME),year(t.LAST_MODIFIED_TIME),month(t.LAST_MODIFIED_TIME) 
) with ur",opendb
unionmini,unionminirectrans,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
unionmini,unionminipaytrans,"select CUSTOMERNUMBER as PAYERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
jsinterfacedailytrx,jsinterfacedailytrx,"SELECT
    COALESCE(CHAR(MAX(check_date)),'null')||COALESCE(CHAR(bank.check_interface_code ),'null')||COALESCE(CHAR(bank.trx_type),'null') AS IDNOUSE,
   (
        CASE
            WHEN MAX(bank.busi_type)='NET'
            THEN '_¨çº¿'
            WHEN MAX(bank.busi_type)='EPOS'
            THEN 'EPOS'
            WHEN MAX(bank.busi_type)='POS'
            THEN 'POS'
            WHEN MAX(bank.busi_type)='DEBITNOCARD'
            THEN 'ä»£æ_'
            WHEN MAX(bank.busi_type)='FASTPAY'
            THEN 'å¿_'
            WHEN MAX(bank.busi_type)='UNIONMP'
            THEN 'ç§»å___'
            WHEN MAX(bank.busi_type)='CBP'
            THEN 'è·¨å'
            WHEN MAX(bank.busi_type)='DUOLABAO'
            THEN '___å®'
            WHEN MAX(bank.busi_type)='FUND'
            THEN '_ºé_'
            ELSE '_¶ä_'
        END) AS biztype,
    (
        CASE
            WHEN bank.trx_type='TRADE'
            THEN '__'
            WHEN bank.trx_type='REFUND'
            THEN '_æ¬'
            WHEN bank.trx_type='EXCHANGEPURCHASING'
            THEN 'è´_'
            WHEN bank.trx_type='EXCHANGESETTLEMENT'
            THEN 'ç»__'
            WHEN bank.trx_type='FUND_TRANSACTION'
            THEN '_¥é_'
            WHEN bank.trx_type='FUND_REFUNDMENT'
            THEN '_ºé_'
            WHEN bank.trx_type='OFFLINE_REFUND'
            THEN 'çº¿ä__æ¬'
            ELSE '_¶ä_'
        END)                         AS trxtype,
    MAX(config.check_interface_name) AS trxchannel,
    MAX(check_date)                  AS trxdate,
    SUM(bank.PAY_AMOUNT)             AS trxamount,
    COUNT(*)                         AS trxcount
FROM
    FCHECK.TBL_FCK_BANK_CLEAR_DATA bank
LEFT JOIN
    FCHECK.TBL_CHECK_INTERFACE_CONFIG config
ON
    config.check_interface_code = bank.check_interface_code
WHERE
    bank.check_date >=${START}
AND bank.check_date < ${STOP}
AND bank.TRX_TYPE = 'TRADE'
AND bank.check_interface_code IN ('CIB_NET_OPEN_BJGC6011',
                                  'XM_CMBC_DAIKOU_J_GM',
                                  'BJ_NXY_KUAIPAY_JD_J001',
                                  'CMBC_UPOP_DEBIT_CMB',
                                  'XM_CMBC_DAIKOU_J_Z002',
                                  'SZ_SZFS_DAIKOU_J_Z001',
                                  'WECHAT_WXZF001',
                                  'OTHER_BANGFUTONG',
                                  'SX_BOC_DAIKOU_J_Z001',
                                  'BEST_KUAIPAY_J_D_BEST',
                                  'BOCO_KUAIPAY_D_JTBZ8013',
                                  'XMMS_NET_B2C_MSXM1010',
                                  'CMBC_NOCARD_MSXM9920',
                                  'SX_NEWBOC_DAIKOU_J_Z001',
                                  'TJ_PAB_PIKOU_PAMH9910',
                                  'ECITIC_NET_OPEN_ZXGC6010',
                                  'CSH_KUAIPAY_JD_BJSJ8015',
                                  'EGB_DEDUCT_DEBIT_HFDZ9910',
                                  'GZ_CMBC_KUAIPAY_D_8015',
                                  'XM_CMBC_DAIKOU_J_QD3',
                                  'CMBC_NOCARD_MSXM9911',
                                  'ICBC_NET_OPEN_GHXJ6010',
                                  'ECITIC_NET_OPEN_BJGC6010',
                                  'NY_GDNY_KUAIPAY_BJJQ8015',
                                  'SZ_TFB_DEDUCT_J_BJGP9910',
                                  'CMBC_NOCARD_MSXM9912',
                                  'SZF_NET_OPEN_GHGC6013',
                                  'GZ_BGZCHINA_KUAIJIE_BJCS8015',
                                  'XMMS_NET_OPEN_MSSC6610' )
GROUP BY
    bank.check_interface_code,
    bank.trx_type WITH ur",fcheck
jsinterfacecanceldailytrx,jsinterfacecanceldailytrx,"SELECT
    COALESCE(CHAR(MAX(check_date)) , 'null') || COALESCE(CHAR(bank.check_interface_code) ,'null')|| COALESCE(CHAR(bank.trx_type) ,'null') AS IDNOUSE ,
   (
        CASE
            WHEN MAX(bank.busi_type)='NET'
            THEN '_¨çº¿'
            WHEN MAX(bank.busi_type)='EPOS'
            THEN 'EPOS'
            WHEN MAX(bank.busi_type)='POS'
            THEN 'POS'
            WHEN MAX(bank.busi_type)='DEBITNOCARD'
            THEN 'ä»£æ_'
            WHEN MAX(bank.busi_type)='FASTPAY'
            THEN 'å¿_'
            WHEN MAX(bank.busi_type)='UNIONMP'
            THEN 'ç§»å___'
            WHEN MAX(bank.busi_type)='CBP'
            THEN 'è·¨å'
            WHEN MAX(bank.busi_type)='DUOLABAO'
            THEN '___å®'
            WHEN MAX(bank.busi_type)='FUND'
            THEN '_ºé_'
            WHEN MAX(bank.busi_type)='WEIXIN'
            THEN 'å¾¿¡'
            ELSE '_¶ä_'
        END) AS biztype,
    (
        CASE
            WHEN bank.trx_type='TRADE'
            THEN '__'
            WHEN bank.trx_type='REFUND'
            THEN '_æ¬'
            WHEN bank.trx_type='EXCHANGEPURCHASING'
            THEN 'è´_'
            WHEN bank.trx_type='EXCHANGESETTLEMENT'
            THEN 'ç»__'
            WHEN bank.trx_type='FUND_TRANSACTION'
            THEN '_¥é_'
            WHEN bank.trx_type='FUND_REFUNDMENT'
            THEN '_ºé_'
            WHEN bank.trx_type='OFFLINE_REFUND'
            THEN 'çº¿ä__æ¬'
            ELSE '_¶ä_'
        END)                         AS trxtype,
    MAX(config.check_interface_name) AS trxchannel ,
    MAX(check_date)                  AS trxdate ,
    SUM(bank.PAY_AMOUNT)             AS trxamount ,
    COUNT(*)                         AS trxcount
FROM
    FCHECK.TBL_FCK_BANK_CLEAR_DATA bank
LEFT JOIN
    FCHECK.TBL_FUNDSCHECK_ERROR_DETAIL detail
ON
    bank.id = detail.bankclear_id
LEFT JOIN
    FCHECK.TBL_FUNDSCHECK_CANCEL_ACC_RECORD cancel
ON
    detail.id = cancel. FUNDSCHECK_ERROR_DETAIL_ID
LEFT JOIN
    FCHECK.TBL_CHECK_INTERFACE_CONFIG config
ON
    config.check_interface_code = bank.check_interface_code
WHERE
    bank.check_date >=${START}
AND bank.check_date < ${STOP}
AND (detail.error_type = 'BANKCLEAR_SINGLE' or detail.error_type is null)
AND (
        cancel.OPERATOR_STATUS != 'ERROR_CANCEL_ORDER'
    OR  cancel.OPERATOR_STATUS IS NULL)
GROUP BY
    bank.check_interface_code,bank.trx_type",fcheck
adjust,adjusttrx,"select COALESCE(CHAR(a.id),'null')||COALESCE(CHAR(d.id),'null')||'ADJUST_SYSTEM' as IDNOUSE,
date(a.last_modify_time) as trxdate,
year(a.last_modify_time)*100+month(a.last_modify_time) as month,
d.merchant_code as receiverid,
d.basic_product_no as product_code,
d.sale_product_no as sales_product_code,
-a.adjust_amount as trxfee,
'ADJUST_OP' as type,
'SYSTEM' as usetype,
'ADJUST_SYSTEM' as dataorigin,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
a.adjust_info as memo 
from ACCTAD.tbl_account_adjust a 
left join ACCTAD.tbl_account_adjust_detail d on d.adjust_id=a.id
where a.check_status='PASS' and a.adjust_type='FEE_ADJUSTMENT' 
and a.last_modify_time>= ${START} and a.last_modify_time < ${STOP} 
with ur",feedb
adjust,adjustproductcode,"select productcode as product_code, biztypeid  from  productcode2biztype with ur",reportdb
adjust,adjustreceive,"select customernumber as receiverid,id as customerid from customerinfo cu  with ur",reportdb
lmfinancecost,lmfinanceB2C,"select coalesce(char(date(p.PAY_SUCCESS_DATE)),'null')||coalesce(char(p.RECEIVER_NO),'null')||coalesce(char(cost.PAY_INTERFACE),'null')||'lmfinanceB2C' AS IDNOUSE,
date(p.PAY_SUCCESS_DATE) as trxdate,
year(p.PAY_SUCCESS_DATE)*100+month(p.PAY_SUCCESS_DATE) as month, 
p.RECEIVER_NO as RECEIVERID,
cost.PAY_INTERFACE as trxchannelid,
sum(cost.TRADE_FEE) as accountingcost,
sum(cost.TRADE_FEE) as frpcost,
4 as biztypeid,'Sales' as type,'7011001001001A' as sales_product_code,'3011001002001' as product_code,
'LMFINANCE_COST' AS DATAORIGIN,
'SYSTEM' as USETYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS 
from payment.TBL_PAYMENT_ORDER p
left join payment.TBL_TRADE_COST cost on cost.PAYMENT_ORDER_NO = p.PAYMENT_ORDER_NO
where p.INITIATOR  in('ZHCZ0002','BHAZHCZB2B')  and
cost.CALC_TYPE='SALES'
 and p.PAY_SUCCESS_DATE >= ${START} 
 and p.PAY_SUCCESS_DATE < ${STOP}
group by p.RECEIVER_NO,cost.PAY_INTERFACE,date(p.PAY_SUCCESS_DATE),year(p.PAY_SUCCESS_DATE),month(p.PAY_SUCCESS_DATE)
with ur",cashier_bank
lmfinancecost,lmfinanceyjzf,"select  coalesce(char(date(po.PAY_SUCCESS_DATE)),'null')||coalesce(char(po.RECEIVER_NO),'null')||coalesce(char(po.RECEIVER_NAME),'null')||coalesce(char(p.pay_interface),'null')||'lmfinanceyjzf' as idnouse,
po.RECEIVER_NO as receiverid,year(po.PAY_SUCCESS_DATE)*100+month(po.PAY_SUCCESS_DATE) as month,
date(po.PAY_SUCCESS_DATE) as trxdate,p.pay_interface as trxchannelid,
sum(p.BANK_COST) as accountingcost,sum(p.BANK_COST) as frpcost,
220 as biztypeid,'Sales' as type,'7011001001001A' as sales_product_code,'3011001003001' as product_code,
'LMFINANCE_COST' AS DATAORIGIN,
'SYSTEM' as USETYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS 
from payment.tbl_payment_order as po
left join payment.tbl_payment as p on po.PAYMENT_ORDER_NO=p.PAYMENT_ORDER_NO
where p.PAY_WAY_TYPE='NOCARD_PAY' and p.STATUS='PAY' and po.INITIATOR='p2p_bha'
and po.trade_type = 'p2p_nocard_recharge'
and po.receiver_no <>'123456789'
 and p.PAY_SUCCESS_DATE >= ${START}
 and p.PAY_SUCCESS_DATE < ${STOP} 
 group by po.RECEIVER_NO,po.RECEIVER_NAME,date(po.PAY_SUCCESS_DATE ),year(po.PAY_SUCCESS_DATE),month(po.PAY_SUCCESS_DATE),p.pay_interface 
with ur",cashier_bank
lmfinancecost,lmfinancereceiveid,"select customernumber as receiverid,id as customerid from customerinfo  with ur",reportdb
EPOSREVOCATION,EPOS_REVOCATION,"SELECT COALESCE(CHAR(A.CUSTOMER_ID),'null')||COALESCE(CHAR(DATE(AH.CREATEDATE)),'null')||'EPOS_REVOCATION' as IDNOUSE,'YP2G' AS DATAORIGIN,YEAR(DATE(AH.CREATEDATE))*100+MONTH(DATE(AH.CREATEDATE)) AS MONTH,DATE(AH.CREATEDATE) AS TRXDATE,
'EPOS_REVOCATION' AS PAYPRODUCT,'3011001003002' AS PRODUCT_CODE,'3011001003002A' AS SALES_PRODUCT_CODE,
A.CUSTOMER_ID AS RECEIVERID,COUNT(*) AS REFUNDCOUNT,sum(ah.TRXAMOUNT) as REFUNDAMOUNT,sum(ah.FEE) AS TRXFEE,'EPOS_REVOCATION' AS ORDERTYPE,'Sales' AS TYPE,6 AS BIZTYPEID 
FROM ACCOUNTHISTORY AH LEFT JOIN ACCOUNT A ON AH.ACCOUNT_ID=A.ID 
WHERE AH.CREATEDATE >= ${START} AND AH.CREATEDATE < ${STOP} AND AH.HISTORYTYPE in ('EPOS_REVOCATIONDEBIT','EPOS_REVOCATIONBACK') 
GROUP BY A.CUSTOMER_ID,DATE(AH.CREATEDATE) WITH UR",COPY2
productcenterdailytrx,productcenterdailytrx,"select coalesce(char(DAILYTRXSTAT.TRXDATE),'null')||
coalesce(char(DAILYTRXSTAT.PRODUCT_CODE),'null')||
coalesce(char(DAILYTRXSTAT.SALES_PRODUCT_CODE),'null')||
coalesce(char(RECEIVER.PRODUCTLINE),'null')||
coalesce(char(cbi.name),'null')||
coalesce(char(fc.bankcode),'null')||
coalesce(char(RECEIVER.FULLNAME),'null')||
coalesce(char(EMP.NAME),'null')||
coalesce(char(P1.PRODUCTNAME),'null')||
coalesce(char(P.PRODUCTNAME),'null')||
coalesce(char((case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end)),'null')||
coalesce(char((case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end)),'null')||
coalesce(char(p2pg.PRODUCT_GROUP),'null')||
coalesce(char(RECEIVER.VMARK),'null')||
coalesce(char(RECEIVER.CUSTOMERNUMBER),'null')||
coalesce(char(RECEIVER.SIGNEDNAME),'null')||
coalesce(char(TB.NAME),'null')||
coalesce(char(tsg.NAME),'null')||
coalesce(char(TRXSTATTRXTYPE.NAME),'null')||
coalesce(char(BRA.BRANCHNAME),'null')||
coalesce(char(case when RECEIVER.CUSTOMER_CREDENTIAL_LEVEL in ('A','A-') then '_' when RECEIVER.CUSTOMER_CREDENTIAL_LEVEL ='B' then 'ä¹'  when RECEIVER.CUSTOMER_CREDENTIAL_LEVEL='C' then 'ä¸'  else RECEIVER.CUSTOMER_CREDENTIAL_LEVEL end),'null')||'productcenterdailytrx' as IDNOUSE,
DAILYTRXSTAT.TRXDATE as trxdate,
DAILYTRXSTAT.PRODUCT_CODE as product_code,
DAILYTRXSTAT.SALES_PRODUCT_CODE as sales_product_code,
RECEIVER.PRODUCTLINE as PRODUCTLINE,
cbi.name as bankname,
fc.bankcode as bankcode,
RECEIVER.FULLNAME as FULLNAME,
EMP.NAME as salesname,
P1.PRODUCTNAME as salesproductname,
P.PRODUCTNAME as productname,
(case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end) as accounttype,
(case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) as accountclass,
p2pg.PRODUCT_GROUP as productgroup,
RECEIVER.VMARK as vmark,
RECEIVER.CUSTOMERNUMBER as customernumber,
RECEIVER.SIGNEDNAME as signedname,
TB.NAME AS BUSINESSCAT,
tsg.NAME AS SUBBUSINESSCAT,
TRXSTATTRXTYPE.NAME as TRXTYPE,
BRA.BRANCHNAME AS BRANCHCOMPANY,
case when RECEIVER.CUSTOMER_CREDENTIAL_LEVEL in ('A','A-') then '_' when RECEIVER.CUSTOMER_CREDENTIAL_LEVEL ='B' then 'ä¹'  when RECEIVER.CUSTOMER_CREDENTIAL_LEVEL='C' then 'ä¸'  else RECEIVER.CUSTOMER_CREDENTIAL_LEVEL end AS CUSTLEVEL,
sum(CASE WHEN DAILYTRXSTAT.BIZTYPEID IN (29,129) THEN 0 ELSE (DAILYTRXSTAT.ACCOUNTINGCOST*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDFRPCOST*E2C.SHARESCALE*c2a.PERCENT) END ) AS ACCOUNTINGCOST, 
sum(DAILYTRXSTAT.TRXCOUNT*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDCOUNT*E2C.SHARESCALE*c2a.PERCENT) as netcount,
sum(DAILYTRXSTAT.TRXAMOUNT*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDAMOUNT*E2C.SHARESCALE*c2a.PERCENT) as netamount,
sum(CASE WHEN DAILYTRXSTAT.BIZTYPEID IN (29,129) THEN (DAILYTRXSTAT.TRXFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.ACCOUNTINGCOST*E2C.SHARESCALE*c2a.PERCENT+DAILYTRXSTAT.REFUNDFRPCOST*E2C.SHARESCALE*c2a.PERCENT) ELSE (DAILYTRXSTAT.TRXFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDFEE*E2C.SHARESCALE*c2a.PERCENT) END) as netfee,
sum(DAILYTRXSTAT.TRXFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.REFUNDFEE*E2C.SHARESCALE*c2a.PERCENT-DAILYTRXSTAT.ACCOUNTINGCOST*E2C.SHARESCALE*c2a.PERCENT+DAILYTRXSTAT.REFUNDFRPCOST*E2C.SHARESCALE*c2a.PERCENT) as netprofit 
from DAILYTRXSTAT
left join TRXSTATBIZTYPE on DAILYTRXSTAT.BIZTYPEID=TRXSTATBIZTYPE.ID 
left join CUSTOMERINFO AS RECEIVER on DAILYTRXSTAT.RECEIVERID=RECEIVER.ID 
left join TRXSTATCUSTOMERAREA AS AREA on RECEIVER.AREAID=AREA.ID 
left join TRXSTATCUSTOMERPRODUCTLINE AS PRODUCTLINE on RECEIVER.PRODUCTLINEID=PRODUCTLINE.ID 
left join CUSTOMERRELATIONSHIP AS E2C on RECEIVER.ID=E2C.CUSTOMERID 
left join EMPLOYEEINFO AS EMP on E2C.EMPLOYEEID=EMP.ID 
left join PRODUCTGROUPTYPE on RECEIVER.PRODUCTGROUP=PRODUCTGROUPTYPE.ID 
left join TRXSTATTRXTYPE on DAILYTRXSTAT.TYPE=TRXSTATTRXTYPE.ID 
left join TRXSTATBUSINESSCATEGORIE AS TB on RECEIVER.BUSSINESSCATID=TB.ID 
left join TRXSTATCUSTOMERAREA AS BRA on EMP.BRANCHCOMPANY=BRA.AREAID 
left join TRXSTATACCMARK AS acc on RECEIVER.ACCMARK=acc.CODE 
left join PRODUCTCODE AS P on DAILYTRXSTAT.PRODUCT_CODE=P.PRODUCTCODE and P.PRODUCTTYPE=2 
left join PRODUCTCODE AS P1 on DAILYTRXSTAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE and P1.PRODUCTTYPE=1 
left join TRXSTATBIZTYPE_PROFILE AS BP on DAILYTRXSTAT.BIZTYPEID=BP.BIZTYPEID 
left join productcode_profile AS PP on DAILYTRXSTAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE and DAILYTRXSTAT.PRODUCT_CODE=PP.PRODUCT_CODE 
left join frpchannel AS fc on DAILYTRXSTAT.trxchannelid=fc.trxchannelid 
left join customer2achievement AS c2a on RECEIVER.customernumber=c2a.customer_number 
left join EXISTENCE AS ex on c2a.ACHIEVEMENT_ID=ex.ID and ex.CLASSTYPE='Department' 
left join TRXSTATSUBBUSINESSCATEGORIE AS tsg on RECEIVER.SUBBUSINESSCAT=tsg.CODE 
left join PRODUCTCODE2PRODUCTGROUP AS p2pg on DAILYTRXSTAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE and DAILYTRXSTAT.PRODUCT_CODE=p2pg.PRODUCT_CODE 
left join cfg_bank_info AS cbi on DAILYTRXSTAT.BANK_CODE=cbi.CODE 
left join CUSTOMERINFO AS payer on DAILYTRXSTAT.PAYERID=payer.ID
left join EMPLOYEEINFO AS pe on payer.SALESID=pe.ID   
where DAILYTRXSTAT.TRXDATE>=${START} and DAILYTRXSTAT.TRXDATE<${STOP}  
group by
DAILYTRXSTAT.TRXDATE,
DAILYTRXSTAT.PRODUCT_CODE,
DAILYTRXSTAT.SALES_PRODUCT_CODE,
RECEIVER.PRODUCTLINE,
cbi.name,
fc.bankcode,
RECEIVER.FULLNAME,
EMP.NAME,
P1.PRODUCTNAME,
P.PRODUCTNAME,
case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end,
case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end,
p2pg.PRODUCT_GROUP,
RECEIVER.VMARK,
RECEIVER.CUSTOMERNUMBER,
RECEIVER.SIGNEDNAME,
TB.NAME,
tsg.NAME,
TRXSTATTRXTYPE.NAME,
BRA.BRANCHNAME,
case when RECEIVER.CUSTOMER_CREDENTIAL_LEVEL in ('A','A-') then '_' when RECEIVER.CUSTOMER_CREDENTIAL_LEVEL ='B' then 'ä¹'  when RECEIVER.CUSTOMER_CREDENTIAL_LEVEL='C' then 'ä¸'  else RECEIVER.CUSTOMER_CREDENTIAL_LEVEL end 
with ur",reportdb
copDataAnalysis,ncpay,"select date(BIZ_ORDER_TIME) as DATETIME,count(*) as ERROR_COUNT, BANK_CODE as BANK,  MERCHANT_NO as CUSTOMER_NUMBER,error_code as ERROR_CODE, error_msg  as ERROR_MESSAGE from NCC.TBL_NC_PAY_ORDER  where BIZ_ORDER_TIME >=  ${START} and  BIZ_ORDER_TIME <=  ${STOP}  group by MERCHANT_NO, BANK_CODE,error_code,error_msg,date(BIZ_ORDER_TIME) with ur",INNO
copDataAnalysisError,ncpay1,"select
MERCHANT_NO || BANK_CODE || error_code as ID,
 date(min(BIZ_ORDER_TIME)) as DATETIME,count(*) as ERROR_COUNT, BANK_CODE as BANK,  MERCHANT_NO as CUSTOMER_NUMBER,error_code as ERROR_CODE, error_msg  as ERROR_MESSAGE 
  from NCC.TBL_NC_PAY_ORDER  
  where BIZ_ORDER_TIME >= ${START} and  BIZ_ORDER_TIME <= ${STOP}  group by MERCHANT_NO, BANK_CODE,error_code,error_msg order by ERROR_COUNT desc with ur",INNO_STANBY
nobankcarddailytrx,nobankcarddailytrxreceive,"select cu.customernumber as receiverid,cu.id as customerid from db2inst1.customerinfo cu with ur",reportdb
copDataCount,ncpay2,"SELECT 
MERCHANT_NO || BANK_CODE as ID,
MERCHANT_NO as CUSTOMER_NUMBER,BANK_CODE as BANK,
 count(1) as TOTAL_COUNT,
 sum(decode(STATE,'SUCCESS',ORDER_AMOUNT,0)) as SUCCESS_AMOUNT,
 sum(decode(STATE,'SUCCESS',1,0)) as SUCCESS_COUNT,
 date(min(BIZ_ORDER_TIME)) as DATETIME
 FROM NCC.TBL_NC_PAY_ORDER 
where BIZ_ORDER_TIME >=  ${START} and  BIZ_ORDER_TIME <=  ${STOP} group by MERCHANT_NO, BANK_CODE with ur",INNO_STANBY
weixin,wxgatewaycost," SELECT o.CUSTOMER_NO||char(DATE(p.COMPLETE_TIME))||'wxgatewaycost' as IDNOUSE,
 year(DATE(p.COMPLETE_TIME))*100+month(DATE(p.COMPLETE_TIME)) as month,
 DATE(p.COMPLETE_TIME) AS TRXDATE,
'POSP' as dataorigin,
 o.CUSTOMER_NO AS RECEIVERID,
 260 AS biztypeid,
'Sales' as type,
'SALES' as ordertype,
 '3011001006001' AS product_code,
 '3011001006001A' AS sales_product_code,
 SUM(p.BANK_COST) AS frpcost, 
 SUM(p.BANK_COST) AS accountingcost 
 FROM     poswrite.tbl_mpay_order o 
 LEFT JOIN poswrite.tbl_mpay_payment p   ON o.EFFECTIVE_PID = p.ID 
 WHERE p.COMPLETE_TIME >= ${START} AND p.COMPLETE_TIME < ${STOP} AND o.SOURCE in ('GATEWAY') AND o.STATUS = 'SUCCESS' 
 GROUP BY o.CUSTOMER_NO, 
 DATE(p.COMPLETE_TIME) WITH UR",opendb
nobankcarddailytrx,nobankcarddailytrxbiztype,"select FRPCHANNELID as TRXCHANNELID, BIZTYPE_ID as biztypeid from db2inst1.biztypecomposite with ur",reportdb
test1,POSCOPY2,"select o.COREPLATFORM_EXTERNAL_ID AS COREPLATFORM_EXTERNAL_ID,o.PAN_SUFFIX  AS PAN_SUFFIX,b.short_name AS short_name
from tbl_pos_order o left join tbl_pos_cardinfo c on o.cardinfo_id=c.id
left join TBL_POS_BANK b on c.issuer=b.bank_code
where o.ORDER_STATUS in ('SUCCESS','SETTLED')
and o.CREATE_TIME between '2016-09-01 00:00:00' and '2016-09-30 23:59:59' 
and o.CUSTOMER_NUMBER='10012408639'
with ur",opendb
test1,COPY2,"select 
c.id as splitid, p.trxDate, p.requestId, p.orderAmount, p.externalId,
p.confirmorcancel, p.productName, c.splitStatus, c.billdetails, t.tempinfo, p.bankOrderId,
f.bank_id ||'-'||f.channel as externalfrp, p.frpid, t.closedate, f.channel, f.bank_id as bankId,
t.orderoper, t.amount as trxOrderAmount, pm.sourceamount as amount, ABS(COALESCE(p.target_fee, 0)) as targetFee, ABS(COALESCE(p.source_fee, 0)) as sourceFee, t.status, 0 as rtargetFee, 'SALES' as orderType,
t.productName, t.productDesc, t.productCat, t.extendInfo, t.orderType as trxordertype, p.trxType,
CASE WHEN rp.id is not null THEN 'SUCCESS' END as revocationStatus, rp.trxStatus as rpStatus, a.trxDate as ahTrxDate,
cci.customerTerminalCode as customerTerminalCode
, text.pnr as pnr, text.ticketNumberStart as ticketNumberStart, text.ticketNumberEnd as ticketNumberEnd, a.postBalance as postBalance
, cus.fullname, cus.customerNumber
from accountHistory a
left join PublishedTrx p  on a.trxId = p.id 
left join payment pm on pm.id = p.id 
left join trxorder t on p.orderid=t.id
left join trxorderext text on text.id=t.id
  left join complexorder c on p.externalid=c.externalid 
left join frp f on p.frpid=f.id 
left join RevocationPayment rp on rp.originalTrx_id = pm.id and rp.revocation_flg <> rp.id 
left join creditcardinfo cci on cci.charid = pm.extinfo 
left join customer cus on cus.id = t.receiver_id 
left join TrxOrderExt te on te.id = t.id
where  a.account_id = 12894137 
and a.TRXDATE>='2016-06-27 14:20:00' and a.TRXDATE<='2016-06-27 23:59:59' 
and p.SOURCE_CUSTID= 12434097 
and t.payer_id = 12434097 
and pm.sourceAccountId=12894137 
and p.CONFIRMORCANCEL >= char(timestamp('2016-06-27 00:00:00') ) and p.CONFIRMORCANCEL <= '2016-06-27 23:59:59' 
and t.closeDate>=char(timestamp('2016-06-27 00:00:00') ) and t.closeDate<='2016-06-27 23:59:59' 
and pm.confirmOrCancel>=char(timestamp('2016-06-27 00:00:00') ) and pm.confirmOrCancel <='2016-06-27 23:59:59' 
and p.TrxType in ('SALES', 'AUTHORIZE', 'DEBITNOCARDPAY')  
and p.orderType<>'MERCHANT_SETTLE' 
and pm.TrxType in ('SALES', 'AUTHORIZE')
and pm.trxStatus = 'SUCCESS' 
with ur",COPY2
test1,POSCOPY2WX,"SELECT  
				 a.ORDER_NO as externalId,
				 a.out_trade_no as  requestId, 
				 a.TRANSACTION_ID as weno, 
				 a.CUSTOMER_NO as customerNumber, 
				 c.SHORT_NAME  as shortName, 
				 p.TRX_AMOUNT as trxAmount, 
				 a.CREATE_TIME as createTime, 
				 a.STATUS as orderStatus, 
				 p.STATUS as payStatus, 
				 case when  a.TRADE_TYPE  is null then '____' 
				 when a.TRADE_TYPE='JSAPI'	then '_¨æ___' 
				 when a.TRADE_TYPE='NATIVE'	then '_¨æ___' 
				 end as businessType, 
				 p.TOTAL_FEE as refee
				 from TBL_MPAY_ORDER a
				 left join TBL_POS_CUSTOMER c on c.CUSTOMER_NUMBER=a.CUSTOMER_NO 
				  LEFT JOIN TBL_MPAY_PAYMENT p ON p.ORDER_NO=a.ORDER_NO 
				  WHERE AND a.STATUS='SUCCESS'
				  AND a.CUSTOMER_NO=''
				  AND a.CREATE_TIME >='' 
				  AND a.CREATE_TIME <=''
				  with ur",opendb
zgtverifywechatxieyi,zgtqianbao,"select
COALESCE(CHAR(date(p.CALLBACK_DATE)),'null')||COALESCE(CHAR(p.CUSTOMERNUMBER),'null')||'zgtqianbao'||coalesce(t.BANK_ID,'')||coalesce(p.CARD_TYPE,'') as IDNOUSE,
date(p.CALLBACK_DATE) AS TRXDATE,t.BANK_ID as bank_code,p.CARD_TYPE as cardtype,
year(date(p.CALLBACK_DATE))*100+month(date(p.CALLBACK_DATE)) AS MONTH,
p.CUSTOMERNUMBER AS RECEIVERID,
'3011004004001' AS PRODUCT_CODE,
'3011004001003A' AS SALES_PRODUCT_CODE,
'SALES' AS ORDERTYPE,
'ZGT_QIANBAO' AS PAYPRODUCT,
260  AS BIZTYPEID,
'Sales' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'ZGT' AS DATAORIGIN,
count(p.id) AS TRXCOUNT,
sum(p.amount) AS TRXAMOUNT,
sum(p.amount)-sum(p.real_amount) AS TRXFEE 
from zgt.tbl_payment p
left join zgt.tbl_trxorder t on t.external_id = p.externalid
left join zgt.tbl_merchant m  on m.IDENTITY_NO=t.customer_no
where 1 = 1
and p.CALLBACK_DATE >= ${START}
and p.CALLBACK_DATE < ${STOP}
and p.PAY_PRODUCT in ('WECHAT_APP','WAP_WECHATAPP') 
group by date(p.CALLBACK_DATE),p.CUSTOMERNUMBER,t.BANK_ID,p.CARD_TYPE
with ur",zgt_standby
memberFree,å®__ä¼___¥è,"SELECT
	M1.MEMBER_NO as MEMBER_NO,
	M1.STATUS,
	M1.CA_STATUS
			FROM
	MEMBER.TBL_MEMBER M1
	RIGHT JOIN MEMBER.TBL_MEMBER_IDENTIFICATION I ON M1.MEMBER_NO = I.MEMBER_NO
			WHERE
	M1.STATUS = 'AVAILABLY'
	AND M1.CA_STATUS IN ('HIGH_VERIFIED', 'VERIFIED')
	AND I.CA_STATUS = 'VERIFIED'
	AND I.CA_DATE < CURRENT_TIMESTAMP -6 MONTHS",member
memberFree,äº¤æ__¥è,"SELECT
	DISTINCT(INITIATOR) AS MEMBER_NO,
        'Y' AS JUDGE_TRX 
	FROM
	FUNDTX.TBL_FUND_TRANS_INFO
			WHERE
	TRANS_TYPE IN (
        'RECHARGE', 'RECHARGE_REFUND', 'TRANSFER',
				'PAYMENT_REFUND', 'PAYMENT', 'WITHDRAW'
	)
	AND STATUS_DESC IN (
        'DEBITED', 'REMIT_SUCCESS', 'CREDITED'
	)
	AND INITIATOR_DATE > CURRENT_TIMESTAMP -6 MONTHS",fundtx
memberFreeStatus,queryMemberInfo,"SELECT
	M1.MEMBER_NO as MEMBER_NO,
	M1.STATUS,
	M1.CA_STATUS
			FROM
	MEMBER.TBL_MEMBER M1
	RIGHT JOIN MEMBER.TBL_MEMBER_IDENTIFICATION I ON M1.MEMBER_NO = I.MEMBER_NO
			WHERE
	M1.STATUS = 'AVAILABLY'
	AND M1.CA_STATUS IN ('HIGH_VERIFIED', 'VERIFIED')
	AND I.CA_STATUS = 'VERIFIED'
	AND I.CA_DATE < CURRENT_TIMESTAMP -6 MONTHS
with ur",member_standby
memberFreeStatus,queryFundInfo,"SELECT
	DISTINCT(INITIATOR) AS MEMBER_NO,
        'Y' AS JUDGE_TRX 
	FROM
	FUNDTX.TBL_FUND_TRANS_INFO
			WHERE
	TRANS_TYPE IN (
        'RECHARGE', 'RECHARGE_REFUND', 'TRANSFER',
				'PAYMENT_REFUND', 'PAYMENT', 'WITHDRAW'
	)
	AND STATUS_DESC IN (
        'DEBITED', 'REMIT_SUCCESS', 'CREDITED'
	)
	AND INITIATOR_DATE > CURRENT_TIMESTAMP -6 MONTHS
with ur",fundtx
bankpisas,bankpisasFirst,"select  pp.ID,
	   year(${START})*100+month(${START}) as month,pp.BANK_CUSTOMER_NUMBER,
       pp.POS_CUSTOMER_NUMBER,
       c.FULL_NAME,
       date(c.CREATE_TIME) AS CREATE_TIME,
       o.CUSTOMER_NUMBER,
       o.CUSTOMER_CN_NAME,
       o.COMM_ADDR,
       cc.LINKMAN,
       nvl(cc.MOBILE,cc.PHONE) PHONE,
       case when m.MAiN_MODULE like '%___%' then 'ç»______' else 'ä¸______' end as MODULE,
       a.POS_MANUFACTURER,
       di.DICT_NAME,
       pp.TRX_AMOUNTCount, 
       pp.TRX_AMOUNT,
       pp.POS_CATI,
       substr(pp.BANK_CUSTOMER_NUMBER,8,4) as MCC,
       substr(pp.BANK_CUSTOMER_NUMBER,4,4) as REGION_CODE,
       a.TYPE,
       a.SOFT_VERSION,
       b.BASICFUNCTION,
       m.POS_CATEGORY,
       date(t.STOCKIN_CRETAE_TIME) as STOCKIN_CRETAE_TIME,
       date(t.BIND_CRETAE_TIME) as BIND_CRETAE_TIME
from (select p.BANK_CUSTOMER_NUMBER,p.POS_CUSTOMER_NUMBER,p.POS_CATI, min(p.ID) as ID,count(p.TRX_AMOUNT) as TRX_AMOUNTCount,sum(p.TRX_AMOUNT) as TRX_AMOUNT 
from POSWRITE.TBL_POS_PAYMENT P
where p.frp_code is NOT NULL
and  p.FRP_CODE <> '9002031'
and  p.STATUS='SUCCESS'
and  p.TRX_Type='PURCHASE'
and  LEFT(p.BANK_CUSTOMER_NUMBER,3) = '825'
and  TRX_TIME>= ${START}
and  TRX_TIME< ${STOP}
group by p. POS_CUSTOMER_NUMBER,p.BANK_CUSTOMER_NUMBER,p.POS_CATI 
) pp
left join POSWRITE.TBL_POS_CUSTOMER c on c.CUSTOMER_NUMBER = pp.POS_CUSTOMER_NUMBER
left join POSWRITE.TBL_POS_POS a  on pp.POS_CATI = a.POS_CATI
left join POSWRITE.TBL_TMS_POSSTOCKINFO t on t.POS_CATI=a.POS_CATI
left join POSREAD.TBL_POS_POSMODELDETAIL m on m.POS_TYPE = a.type and m.STATUS = 'ACTIVE'
LEFT JOIN (SELECT DISTINCT SOFT_VERSION,POS_MANUFACTURER,POS_MODEL,BASICFUNCTION from POSWRITE.TBL_TMS_SOFTWARE s) b 
     ON a.SOFT_VERSION = b.SOFT_VERSION and a.TYPE = b.POS_MODEL and a.POS_MANUFACTURER = b.POS_MANUFACTURER
left join POSWRITE.TBL_POS_OA_CUSTOMER_INFO o on o.CUSTOMER_CODE = pp.BANK_CUSTOMER_NUMBER
left join POSWRITE.TBL_POS_CUSTOMER cc on cc.CUSTOMER_NUMBER = o.CUSTOMER_NUMBER 
left join POSREAD.TBL_POS_DICTIONARY di on di.DICT_ID = a.POS_MANUFACTURER and di.DICT_ID = 'PosModel'
with ur
",opendb
merchantInfoReportToBank,merchantInfoReportFirst,"select bc.ID,
 bc.bank_customer_number,
 bc.POS_CUSTOMER_NUMBER,
 bc.STATUS,
 o.customer_number,
 o.CUSTOMER_CN_NAME,
 o.COMM_ADDR,
 o.CORP_NAME,
 o.LIC_NO,
 o.region_CODE,
 substr(o.region_code,1,2) AREA_CODE,
 bc.FRP_CODE,
 c.LINKMAN,
 c.phone,
 c2.CUSTOMER_STATUS,
 c2.STATUS as YEEPAY_STATUS,
 c.CUSTOMER_STATUS as UNIONPAY_STATUS,
 c.STATUS as REPORT_STATUS
 from POSREAD.TBL_POS_BANKCHANNELCUSTOMER bc
left  join POSREAD.TBL_POS_OA_CUSTOMER_INFO o on bc.BANK_CUSTOMER_NUMBER=o.CUSTOMER_CODE 
 left join POSREAD.TBL_POS_CUSTOMER c on c.customer_number = o.customer_number
left join TBL_POS_CUSTOMER c2 on bc.POS_CUSTOMER_NUMBER = c2.customer_number
with ur
",opendb
silenceMerchantList,silenceMerchantListFirst,"select c.ID,
c.customer_number,
    c.FULL_NAME,
    a.CODE,
    a.NAME AS AGENTNAME,
    c.SALES_AREA,
    c.SALES_NAME,
    year(${STOP})*100+month(${STOP}) as MONTH,
    c.TYPE,
    info.NAME,
    pc.PRODUCT_CODE
from POSREAD.TBL_POS_CUSTOMER c
left join POSREAD.TBL_DAILI_AGENTRELATION ar on ar.customer_number = c.customer_number and ar.STATUS = 'ACTIVE'
left join POSREAD.TBL_DAILI_AGENT a on a.id  = ar.agent_id
left join POSREAD.TBL_POS_PRODUCTONCUSTOMER pc on pc.CUSTOMER_CODE = c.CUSTOMER_NUMBER and pc.STATUS='NORMAL' 
left join POSREAD.TBL_POS_PRODUCTINFO info on info.CODE = pc.PRODUCT_CODE
where NOT EXISTS (
 select 1 from POSREAD.TBL_POS_ORDER o  
 where o.CUSTOMER_NUMBER = c.CUSTOMER_NUMBER 
 and o.CREATE_TIME >=TO_DATE(${STOP} ,'YYYY-MM-DD HH24:MI:SS')- 3 MONTH
 and o.CREATE_TIME < ${STOP}
) 
and c.TYPE <> 'AGENT' 
and c.status ='ACTIVE'
with ur",opendb
offlinepos111,offlinepossuccesstest,"select  pp.ID,
	   year(${START})*100+month(${START}) as month,pp.BANK_CUSTOMER_NUMBER,
       pp.POS_CUSTOMER_NUMBER,
       c.FULL_NAME,
       date(c.CREATE_TIME) AS CREATE_TIME,
       o.CUSTOMER_NUMBER,
       o.CUSTOMER_CN_NAME,
       o.COMM_ADDR,
       cc.LINKMAN,
       nvl(cc.MOBILE,cc.PHONE) PHONE,
       case when m.MAiN_MODULE like '%___%' then 'ç»______' else 'ä¸______' end as MODULE,
       a.POS_MANUFACTURER,
       di.DICT_NAME,
       pp.TRX_AMOUNTCount, 
       pp.TRX_AMOUNT,
       pp.POS_CATI,
       substr(pp.BANK_CUSTOMER_NUMBER,8,4) as MCC,
       substr(pp.BANK_CUSTOMER_NUMBER,4,4) as REGION_CODE,
       a.TYPE,
       a.SOFT_VERSION,
       b.BASICFUNCTION,
       m.POS_CATEGORY,
       date(t.STOCKIN_CRETAE_TIME) as STOCKIN_CRETAE_TIME,
       date(t.BIND_CRETAE_TIME) as BIND_CRETAE_TIME
from (select p.BANK_CUSTOMER_NUMBER,p.POS_CUSTOMER_NUMBER,p.POS_CATI, min(p.ID) as ID,count(p.TRX_AMOUNT) as TRX_AMOUNTCount,sum(p.TRX_AMOUNT) as TRX_AMOUNT 
from POSREAD.TBL_POS_PAYMENT P
where p.frp_code is NOT NULL
and  p.FRP_CODE <> '9002031'
and  p.STATUS='SUCCESS'
and  p.TRX_Type='PURCHASE'
and  LEFT(p.BANK_CUSTOMER_NUMBER,3) = '825'
and  TRX_TIME>= ${START}
and  TRX_TIME< ${STOP}
group by p. POS_CUSTOMER_NUMBER,p.BANK_CUSTOMER_NUMBER,p.POS_CATI 
) pp
left join POSREAD.TBL_POS_CUSTOMER c on c.CUSTOMER_NUMBER = pp.POS_CUSTOMER_NUMBER
left join POSREAD.TBL_POS_POS a  on pp.POS_CATI = a.POS_CATI
left join POSREAD.TBL_TMS_POSSTOCKINFO t on t.POS_CATI=a.POS_CATI
left join POSREAD.TBL_POS_POSMODELDETAIL m on m.POS_TYPE = a.type and m.STATUS = 'ACTIVE'
LEFT JOIN (SELECT DISTINCT SOFT_VERSION,POS_MANUFACTURER,POS_MODEL,BASICFUNCTION from POSREAD.TBL_TMS_SOFTWARE s) b 
     ON a.SOFT_VERSION = b.SOFT_VERSION and a.TYPE = b.POS_MODEL and a.POS_MANUFACTURER = b.POS_MANUFACTURER
left join POSREAD.TBL_POS_OA_CUSTOMER_INFO o on o.CUSTOMER_CODE = pp.BANK_CUSTOMER_NUMBER
left join POSREAD.TBL_POS_CUSTOMER cc on cc.CUSTOMER_NUMBER = o.CUSTOMER_NUMBER 
left join POSREAD.TBL_POS_DICTIONARY di on di.DICT_ID = a.POS_MANUFACTURER and di.DICT_ID = 'PosModel'
with ur ___äº__è¯",opendb
aaaaa,a1,"SELECT COALESCE(CHAR(date(A.LAST_MODIFY_TIME)),'null')||COALESCE(CHAR(A.customer_no),'null')||COALESCE(CHAR(A.accounting_product),'null')||COALESCE(CHAR(A.product_code),'null')||'tfjfyufutuikuan' AS IDNOUSE,'tfjfyufu' as DATAORIGIN,
    date(A.LAST_MODIFY_TIME) as TRXDATE,
    A.customer_no as RECEIVERID, 
    A.customer_no as CUSTOMERNUMBER,
    A.accounting_product as SALES_PRODUCT_CODE,
    A.product_code as PRODUCT_CODE,
    'Sales' as type,
    SUM(A.TRX_AMOUNT) AS refundfee 
FROM
    ACCTG.TBL_ACC_REQUEST_1802 A
LEFT JOIN
    ACCTG.TBL_ACC_REQUEST_DETAIL_1802 B
ON
    A.ID = B.ACC_REQUEST_ID
WHERE
    A.ACC_TYPE='CREDIT'
AND A.STATUS='SUCCESS' 
    and A.LAST_MODIFY_TIME>= ${START} and A.LAST_MODIFY_TIME< ${STOP} 
AND B.ACC_DIRECTION='DEBIT'
GROUP BY
    date(A.LAST_MODIFY_TIME),
    A.customer_no,
    A.accounting_product,
    A.product_code WITH ur",billdb_standby
TONGCHENGTRX,AIREPOSPOSTRX,"select 
   p.externalId AS notes,p.trxDate AS trx_time,'CASH' AS account_type,'SALES' AS business_type,p.requestId AS merchant_orderid,t.amount AS income, 0 AS expenditure,
   ABS(COALESCE(p.target_fee, 0)) AS fee,
   a.postBalance AS balance,t.extendInfo AS extended_info,t.tempinfo AS order_number,'' AS refund_id,f.channel AS card_type,p.productName AS trx_type,
   cci.last4Place AS card_four,f.description AS bank,t.receiver_id  AS customer_no,'HK' as BUSINESS_OWN
from 
   MOBILEBE.accountHistory a
   left join MOBILEBE.PublishedTrx p  on a.trxId = p.id 
   left join MOBILEBE.payment pm on pm.id = p.id
   left join MOBILEBE.trxorder t on p.orderid=t.id 
   left join MOBILEBE.complexorder c on p.externalid=c.externalid
   left join MOBILEBE.frp f on p.frpid=f.id
   left join MOBILEBE.RevocationPayment rp on rp.originalTrx_id = pm.id and rp.revocation_flg <> rp.id
   left join MOBILEBE.creditcardinfo cci on cci.charid = pm.extinfo
   left join MOBILEBE.customer cus on cus.id = t.payer_id
where 
   a.account_id in (12533583, 15024855 ,14371428, 14371469, 14382357, 14778198, 14787719, 12857763, 15340417)
   and a.TRXDATE>= ${START} and a.TRXDATE < ${STOP} 
   and p.TARGET_CUSTID in (12233889,13518017,13187696,13187725,13193318,13393051,13397709,12408639,13675715)
   and p.CONFIRMORCANCEL >= char(timestamp(${START})) and p.CONFIRMORCANCEL < ${STOP}
   and p.TrxType in ('SALES', 'AUTHORIZE', 'DEBITNOCARDPAY')    
   and p.orderType<>'MERCHANT_SETTLE'
   and t.receiver_id in (12233889,13518017,13187696,13187725,13193318,13393051,13397709,12408639,13675715)
   and t.closeDate>=char(timestamp(${START})) and t.closeDate< ${STOP}
   and pm.targetAccountId in (12533583, 15024855 ,14371428, 14371469, 14382357, 14778198, 14787719, 12857763, 15340417)
   and pm.confirmOrCancel>=char(timestamp(${START})) and pm.confirmOrCancel < ${STOP}
   and pm.TrxType in ('SALES', 'AUTHORIZE')
   and pm.trxStatus = 'SUCCESS'
with ur",COPY2
TONGCHENGTRX,AIRPOSFIX,"select 
    o.COREPLATFORM_EXTERNAL_ID AS notes,o.PAN_SUFFIX AS card_four,b.short_name AS bank,ci.CARD_TYPE AS card_type
from 
    POSWRITE.tbl_pos_order o 
    left join POSWRITE.tbl_pos_cardinfo c on o.cardinfo_id=c.id
    left join POSWRITE.TBL_POS_BANK b on c.issuer=b.bank_code
    LEFT JOIN POSWRITE.TBL_POS_CARDINFO ci ON ci.ID = o.CARDINFO_ID
where 
    o.ORDER_STATUS in ('SUCCESS','SETTLED')
    and o.CREATE_TIME >= ${START} and o.CREATE_TIME < ${STOP}  
    and o.CUSTOMER_NUMBER in ('10012233889','10013518017','10013187696','10013187725','10013193318','10013393051','10013397709','10012408639','10013675715')
with ur",opendb
TONGCHENGTRX,AIRWEIXINTRX,"SELECT  
    a.ORDER_NO AS notes,
    a.CREATE_TIME AS trx_time, 
    'WEIXIN' AS account_type,
    'SALES' AS business_type,
    a.out_trade_no AS  merchant_orderid, 
    p.TRX_AMOUNT AS income,
    0 AS expenditure,
    p.TOTAL_FEE AS fee,
    0 AS balance,
    a.TRANSACTION_ID AS extended_info, 
    '' AS order_number,
    '' AS refund_id,
    'WEIXIN' AS card_type,
    'WEIXIN' AS trx_type,
    '' AS card_four,
    '' AS bank,
    SUBSTR (a.CUSTOMER_NO, 4)  AS customer_no,
    'HK' as BUSINESS_OWN
from 
    POSWRITE.TBL_MPAY_ORDER a
    left join POSWRITE.TBL_POS_CUSTOMER c on c.CUSTOMER_NUMBER=a.CUSTOMER_NO 
    LEFT JOIN POSWRITE.TBL_MPAY_PAYMENT p ON p.ORDER_NO=a.ORDER_NO 
    AND p.STATUS='SUCCESS'
WHERE  
    a.STATUS = 'SUCCESS'
    AND a.CUSTOMER_NO in ('10012233889','10013518017','10013187696','10013187725','10013193318','10013393051','10013397709','10012408639','10013675715')
    AND a.CREATE_TIME >= ${START} 
    AND a.CREATE_TIME < ${STOP}
with ur",opendb
weixin,weixintrx,"SELECT o.CUSTOMER_NO||char(DATE(p.COMPLETE_TIME))||'wxremit' as IDNOUSE, year(DATE(p.COMPLETE_TIME))*100+month(DATE(p.COMPLETE_TIME)) as month, DATE(p.COMPLETE_TIME) AS TRXDATE,'POSP' as dataorigin, o.CUSTOMER_NO AS RECEIVERID, 260 AS biztypeid,'Sales' as type,'SALES' as ordertype, '3011001006001' AS product_code, '3011001006001A' AS sales_product_code, COUNT(*) AS trxcount ,SUM(o.TOTAL_AMOUNT) AS trxamount ,SUM(p.TOTAL_FEE) AS trxfee ,SUM(p.BANK_COST) AS frpcost,SUM(p.BANK_COST) AS accountingcost FROM     poswrite.tbl_mpay_order o LEFT JOIN poswrite.tbl_mpay_payment p        ON o.EFFECTIVE_PID = p.ID WHERE p.COMPLETE_TIME >= ${START} AND p.COMPLETE_TIME < ${STOP} AND o.SOURCE in ('POS','ONLINE','GENERAL')  and o.PLATFORM_TYPE != 'NCTRADE' AND o.STATUS = 'SUCCESS' GROUP BY o.CUSTOMER_NO, DATE(p.COMPLETE_TIME) WITH UR",opendb
TONGCHENGREFUND,AIREPOSPOSREFUND,"select  
    COALESCE(CHAR(r.externalId),'null')||COALESCE(CHAR(a.trxDate),'null') AS pkey,r.externalId AS NOTES,a.trxDate AS trx_time,'CASH' AS account_type,'REFUND' AS business_type,r.requestId AS merchant_orderid,
    0 AS income,req.amount AS expenditure,ABS(COALESCE(p.target_fee, 0)) AS fee
    ,a.postBalance AS balance,t.extendInfo AS extended_info,t.tempinfo AS order_number,req.requestId AS refund_id,
    f.channel AS card_type,t.productname AS trx_type,f.description AS bank,t.receiver_id  AS customer_no, concat(r.externalId,char(cast(req.amount as numeric(18, 2))) )as refundKey
from 
    MOBILEBE.RefundRequest req  
	left join MOBILEBE.RefundRecord r on req. refundRecord_id=r.id  
	left join MOBILEBE.ComplexOrder o on r.externalId=o.externalId  
	left join MOBILEBE.PublishedTrx p on Bigint(req.extendId)=p.id  
	left join MOBILEBE.Payment pm on p.originalTrxId = pm.id
	left join MOBILEBE.trxorder t on p.orderid=t.id  
	left join MOBILEBE.accountHistory a on a.trxId = p.id  
	left join MOBILEBE.creditcardinfo cci on cci.charid = pm.extinfo  
	left join MOBILEBE.frp f on p.frpid=f.id   
	left join MOBILEBE.customer  cus on cus.id = t.payer_id  
where 
    r.receiverId in (12233889,13518017,13187696,13187725,13193318,13393051,13397709,12408639,13675715)
	and a.account_id in (12533583, 15024855 ,14371428, 14371469, 14382357, 14778198, 14787719, 12857763, 15340417)
	and req.requestDate>=${START}  
	and req.requestDate<${STOP}  
	and a.createDate>=${START}  
	and a.createDate<${STOP}  
	and p.CONFIRMORCANCEL>=${START}  
	and p.CONFIRMORCANCEL<${STOP}  
	and p.TARGET_CUSTID in (12233889,13518017,13187696,13187725,13193318,13393051,13397709,12408639,13675715)
	and t.receiver_id in (12233889,13518017,13187696,13187725,13193318,13393051,13397709,12408639,13675715)
	and req.refundStatus='REFUND'  
	and r.frpId!= 160010012 
	and r.requestid = t.requestid
with ur
",COPY2
TONGCHENGREFUND,AIRPOSFIXREFUND,"select 
 d.COREPLATFORM_EXTERNAL_ID AS notes,
 d.PAN_SUFFIX AS card_four,
 d.BANK_SHORT_NAME AS bank,
 d.CARD_TYPE AS card_type,
 d.CUSTOMER_REFUND_NUMBER AS refund_id,
 concat(d.COREPLATFORM_EXTERNAL_ID,char(cast(d.REFUND_AMOUNT as numeric(18, 2)))) as refund_key
        
from  
	TBL_POS_REFRECORD d
where 
	CUSTOMER_NUMBER in ('10012233889','10013518017','10013187696','10013187725','10013193318','10013393051','10013397709','10012408639','10013675715')
	and REFUND_TIME >= ${START} and REFUND_TIME < ${STOP}
	and RECORD_STATUS='SUCCESS'",opendb
TONGCHENGREFUND,AIRWEIXINREFUND,"SELECT
    a.ORDER_NO AS notes,
    a.CREATE_TIME AS trx_time, 
    'WEIXIN' AS account_type,
    'SALES' AS business_type,
    a.out_trade_no AS  merchant_orderid, 
    p.TRX_AMOUNT AS income,
    0 AS expenditure,
    p.TOTAL_FEE AS fee,
    0 AS balance,
    a.TRANSACTION_ID AS extended_info, 
    '' AS order_number,
    '' AS refund_id,
    'WEIXIN' AS card_type,
    'WEIXIN' AS trx_type,
    '' AS card_four,
    '' AS bank,
    a.ORDER_NO  || '0' as refund_key
from
    TBL_MPAY_ORDER a
    left join TBL_POS_CUSTOMER c on c.CUSTOMER_NUMBER=a.CUSTOMER_NO
    LEFT JOIN TBL_MPAY_PAYMENT p ON p.ORDER_NO=a.ORDER_NO
    AND p.STATUS='SUCCESS'
WHERE
    a.STATUS = 'REFUND'
   AND a.CUSTOMER_NO in ('10012233889','10013518017','10013187696','10013187725','10013193318','10013393051','10013397709','10012408639','10013675715')
   AND p.CREATE_TIME >= ${START}
   AND p.CREATE_TIME <= ${STOP}
with ur",opendb
channelInfo,channelInfoFirst,"select channel.ID,channel.BANK_CHANNEL_CODE, channel.BANK_CHANNEL_NAME,param.PARAM_NAME as channel_type, param1.PARAM_NAME as access_bank_type,channel.BANK_CHANNEL_STATUS,param2.PARAM_NAME as BANK_CHANNEL_ACCOUNT_TYPE
from BANK.TBL_BANK_CHANNEL as channel 
left join BANK.TBL_BANK_MANAGER_PARAM param on param.PARAM_KEY = 'BANKCHANNELTYPE' and channel.BANK_CHANNEL_TYPE = param.PARAM_CODE
left join BANK. TBL_BANK_MANAGER_PARAM param1 on param1.PARAM_KEY = 'ACCESSBANKTYPE' and channel.ACCESS_BANK_TYPE = param1.PARAM_CODE
left join BANK. TBL_BANK_MANAGER_PARAM param2 on param2.PARAM_KEY = 'ACCOUNTTYPE' and channel.BANK_CHANNEL_ACCOUNT_TYPE = param2.PARAM_CODE
with ur",cashier_bank
silenceMerchantOld,silenceMerchantOldFirst,"select c.ID,
c.customer_number,
    c.FULL_NAME,
    a.CODE,
    a.NAME AS AGENTNAME,
    c.SALES_AREA,
    c.SALES_NAME,
    year(${STOP})*100+month(${STOP}) as MONTH,
    c.TYPE,
    info.NAME,
    pc.PRODUCT_CODE
from POSWRITE.TBL_POS_CUSTOMER c
left join POSWRITE.TBL_DAILI_AGENTRELATION ar on ar.customer_number = c.customer_number and ar.STATUS = 'ACTIVE'
left join POSWRITE.TBL_DAILI_AGENT a on a.id  = ar.agent_id
left join POSWRITE.TBL_POS_PRODUCTONCUSTOMER pc on pc.CUSTOMER_CODE = c.CUSTOMER_NUMBER and pc.STATUS='NORMAL' 
left join POSWRITE.TBL_POS_PRODUCTINFO info on info.CODE = pc.PRODUCT_CODE
where NOT EXISTS (
 select 1 from db2inst1.TBL_POS_ORDER o  
 where o.CUSTOMER_NUMBER = c.CUSTOMER_NUMBER 
 and o.CREATE_TIME >=TO_DATE(${STOP} ,'YYYY-MM-DD HH24:MI:SS')- 3 MONTH
 and o.CREATE_TIME < ${STOP}
) 
and c.TYPE <> 'AGENT' 
and c.status ='ACTIVE'
with ur",poshis
PCcashier,pcscanpayTrade,"SELECT COALESCE(
    CHAR(merchant_account_code) ,
    'null'
) || COALESCE(
    CHAR(a.product_catalog) ,
    'null'
) || COALESCE(
    CHAR(a.pay_type) ,
    'null'
) || COALESCE(
    CHAR(a.order_origin) ,
    'null'
) || COALESCE(
    CHAR(a.fee_type) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(a.PAY_TIME)
    ) ,
    'null'
) || COALESCE(
    a.CARD_TYPE_ID ,
    'null'
) || COALESCE(
    a.bank_code ,
    'null'
) || COALESCE(
    b.frp_code ,
    'null'
) || 'pcscanpayTrade' as IDNOUSE ,
'PCSM' as dataorigin ,
'3011001006001' as product_code ,
'3011001002001F' as SALES_PRODUCT_CODE,
merchant_account_code as RECEIVERID ,
SUM(
    a.ORDER_AMOUNT / 100.00
) AS trxamount ,
SUM(
    a.SELLER_FEE / 100.00
) AS trxfee ,
COUNT(*) AS trxcount ,
SUM(
    a.BANK_COST / 100.00
) AS accountingcost ,
SUM(
    a.BANK_COST / 100.00
) AS frpcost ,
a.product_catalog as goodscate ,
case when a.pay_type in(
    19 ,
    20 ,
    21 ,
    22 ,
    30 ,
    31
) then 'SM_WECHAT_SALES' 
when a.pay_type in(
    28 ,
    29 
) then 'SM_ALIPAY_SALES' else char(a.pay_type) end as ordertype ,
case a.fee_type when 1 then 'POSTPAID' else 'PAID' end as feetype ,
DATE(a.PAY_TIME) AS trxdate ,
case a.CARD_TYPE_ID when 1 then 'CREDITCARD' when '2' then 'DEBITCARD' else 'UNKNOWN' end as cardtype ,
a.bank_code ,
b.frp_code as trxchannelid ,
year(a.PAY_TIME) * 100 + month(a.PAY_TIME) as month 
FROM EWALLET.DATA_PAY_SUCCESS a 
left join ewallet.pay_biz_order b on a.order_id = b.order_id 
WHERE a.PAY_TIME >= ${START} AND a.PAY_TIME < ${STOP} 
and a.order_origin in(25) 
and b.PAY_TOOL ='SCCANPAY' and a.PAY_TYPE in (19,20,21,22,28,29,30,31) 
and a.merchant_account_code not like 'YB%' 
GROUP BY merchant_account_code ,
a.product_catalog ,
a.pay_type,
a.order_origin ,
a.fee_type ,
DATE(a.PAY_TIME) ,
a.CARD_TYPE_ID ,
a.bank_code ,
b.frp_code ,
month(a.PAY_TIME) ,
year(a.PAY_TIME) 
with ur",INNO
PCcashier,pcscanpaytotal,"SELECT COALESCE(
    CHAR(PB.TRADER_ID) ,
    'null'
) || COALESCE(
    CHAR(pb.ORDER_ORIGIN) ,
    'null'
) || COALESCE(
    CHAR(pb.PRODUCT_CATALOG) ,
    'null'
) || COALESCE(
    CHAR(pb.pay_type) ,
    'null'
) ||COALESCE(
    CHAR(
        DATE(pb.ORDER_TIME)
    ) ,
    'null'
) || COALESCE(
    PB.frp_code ,
    'null'
) || COALESCE(
    s.bank_code ,
    'null'
) || 'pcscanpaytotal' as IDNOUSE ,
'PCSM' as dataorigin ,
'3011001006001' as product_code ,
'3011001002001F' as SALES_PRODUCT_CODE ,
PB.TRADER_ID as RECEIVERID ,
COUNT(*) as wholeordercount ,
SUM(
    PB.ORDER_AMOUNT / 100.00
) as wholeorderamount ,
case when pb.pay_type in(
    19 ,
    20 ,
    21 ,
    22 ,
    30 ,
    31
) then 'SM_WECHAT_SALES' 
when pb.pay_type in(
    28 ,
    29 
) then 'SM_ALIPAY_SALES' else char(pb.pay_type) end as ordertype ,
pb.PRODUCT_CATALOG as goodscate ,
DATE(pb.ORDER_TIME) as trxdate ,
PB.frp_code as trxchannelid ,
s.bank_code,
year(pb.ORDER_TIME)*100+month(pb.ORDER_TIME) as month 
 FROM EWALLET.PAY_BIZ_ORDER AS PB 
left join ewallet.data_pay_success s on PB.order_id = s.order_id 
WHERE PB.CREATE_TIME >= ${START} AND PB.CREATE_TIME < ${STOP} 
and pb.ORDER_ORIGIN in(25) 
and PB.PAY_TOOL ='SCCANPAY' and pb.PAY_TYPE in (19,20,21,22,28,29,30,31) 
and PB.TRADER_ID not like 'YB%' 
GROUP BY PB.TRADER_ID ,
pb.ORDER_ORIGIN ,
pb.PRODUCT_CATALOG ,
pb.pay_type,
DATE(pb.ORDER_TIME) ,
PB.frp_code ,
s.bank_code,month(pb.ORDER_TIME),year(pb.ORDER_TIME) 
with ur",INNO
PCcashier,pcscanpayrefund,"SELECT COALESCE(
    CHAR(a.merchant_account_code) ,
    'null'
) || COALESCE(
    CHAR(a.product_catalog) ,
    'null'
) ||COALESCE(
    CHAR(a.pay_type) ,
    'null'
) ||  COALESCE(
    CHAR(a.order_origin) ,
    'null'
) || COALESCE(
    CHAR(a.fee_type) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(b.REFUND_ACCOUNT_TIME)
    ) ,
    'null'
) || COALESCE(
    CHAR(pb.frp_code) ,
    'null'
) || COALESCE(
    CHAR(a.bank_code) ,
    'null'
) || 'pcscanpayrefund' as IDNOUSE ,
'PCSM' as dataorigin ,
'3011001006001' as product_code ,
'3011001002001F'  as SALES_PRODUCT_CODE ,
a.merchant_account_code as RECEIVERID ,
a.product_catalog as goodscate ,
case when a.pay_type in(
    19 ,
    20 ,
    21 ,
    22 ,
    30 ,
    31
) then 'SM_WECHAT_SALES' 
when a.pay_type in(
    28 ,
    29 
) then 'SM_ALIPAY_SALES' else char(a.pay_type) end as ordertype ,
case a.fee_type when 1 then 'POSTPAID' else 'PAID' end as feetype ,
DATE(b.REFUND_ACCOUNT_TIME) as trxdate ,
SUM(
    b.refund_money / 100.00
) as refundamount ,
SUM(
    b.return_refund_fee / 100.00
) as refundfee ,
COUNT(b.id) as refundcount ,
pb.frp_code as trxchannelid ,
a.bank_code,
year(b.REFUND_ACCOUNT_TIME)*100+month(b.REFUND_ACCOUNT_TIME) as month 
FROM EWALLET.DATA_PAY_SUCCESS a 
LEFT JOIN EWALLET.PAY_REFUND_REQUEST b ON a.order_id = b.customer_order_id 
left join ewallet.pay_biz_order pb on a.order_id = pb.order_id 
WHERE b.REFUND_ACCOUNT_TIME >= ${START} AND b.REFUND_ACCOUNT_TIME < ${STOP} 
AND b.STATUS = 5 and a.order_origin in(25) 
and pb.PAY_TOOL ='SCCANPAY' and a.PAY_TYPE in (19,20,21,22,28,29,30,31)
and a.merchant_account_code not like 'YB%' 
GROUP BY a.merchant_account_code ,
a.product_catalog ,
a.pay_type,
a.order_origin ,
a.fee_type ,
DATE(b.REFUND_ACCOUNT_TIME) ,
pb.frp_code ,
a.bank_code,month(b.REFUND_ACCOUNT_TIME),year(b.REFUND_ACCOUNT_TIME) 
with ur",INNO
PCcashier,pcscanpaytransform,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
yykdailyfourth,sucess_summary,"SELECT
concat('success',m.MERCHANT_NO, c.CHANNEL_FLAG, c.CHANNEL_NAME, o.PAY_TYPE, DATE(o.complete_date)) as IDNOUSE,
  m.merchant_no,
  date(o.complete_date)                                     AS trx_create_date,
  c.channel_flag,
  c.channel_name,
  o.pay_type,
  count(*)                                                AS succ_count,
  sum(o.request_amount)                                   AS succ_amount,
  sum(o.merchant_fee)                                     AS succ_fee,
  sum(round(o.request_amount * c.rate,2))                          AS succ_cost,
  sum(o.merchant_fee - o.request_amount * c.rate) AS succ_profit,
c.contract_subject,c.channel_address,c.back_subject
FROM T_TXP_ORDER o
  LEFT JOIN T_TXP_MERCHANT m ON o.merchant_no = m.merchant_no
  LEFT JOIN T_TXP_PAY p ON o.PAY_NO = p.PAY_NO
  LEFT JOIN T_TXP_CHANNEL c ON c.channel_flag = p.channel_flag
WHERE o.complete_date>= ${START} AND o.complete_date < ${STOP} AND o.order_status = 'SUCCESS'
GROUP BY m.merchant_no, c.channel_flag, c.channel_name, o.pay_type, date(o.complete_date),c.contract_subject,c.channel_address,c.back_subject
",FOURTH_TXP
yykdailyfourth,all_summary,"SELECT
concat('all',M.MERCHANT_NO,  CASE WHEN C.CHANNEL_FLAG IS NOT NULL THEN C.CHANNEL_FLAG  ELSE 'CHANNEL_FLAG' END , CASE WHEN C.CHANNEL_NAME IS NOT NULL THEN C.CHANNEL_NAME ELSE 'CHANNEL_NAME' END , O.PAY_TYPE, DATE(O.CREATE_DATE)) as IDNOUSE,
  M.MERCHANT_NO,
  DATE(O.CREATE_DATE)   AS TRX_CREATE_DATE,
  C.CHANNEL_FLAG,
  C.CHANNEL_NAME,
  O.PAY_TYPE,
  COUNT(*)              AS WHOLE_COUNT,
  SUM(O.REQUEST_AMOUNT) AS WHOLE_AMOUNT,
c.contract_subject,c.channel_address,c.back_subject
FROM T_TXP_ORDER O
  LEFT JOIN T_TXP_MERCHANT M ON O.MERCHANT_NO = M.MERCHANT_NO
  LEFT JOIN T_TXP_PAY P ON O.PAY_NO = P.PAY_NO
  LEFT JOIN T_TXP_CHANNEL C ON C.CHANNEL_FLAG = P.CHANNEL_FLAG
WHERE O.CREATE_DATE >= ${START} AND O.CREATE_DATE < ${STOP}
GROUP BY M.MERCHANT_NO, C.CHANNEL_FLAG, C.CHANNEL_NAME, O.PAY_TYPE, DATE(O.CREATE_DATE),c.contract_subject,c.channel_address,c.back_subject
",FOURTH_TXP
yykdailyfourth,fail_summary,"  SELECT
concat('fail',M.MERCHANT_NO, CASE WHEN C.CHANNEL_FLAG IS NOT NULL THEN C.CHANNEL_FLAG  ELSE 'CHANNEL_FLAG' END , CASE WHEN C.CHANNEL_NAME IS NOT NULL THEN C.CHANNEL_NAME ELSE 'CHANNEL_NAME' END , O.PAY_TYPE, DATE(O.CREATE_DATE)) as IDNOUSE,
  M.MERCHANT_NO,
  DATE(O.CREATE_DATE)   AS TRX_CREATE_DATE,
  C.CHANNEL_FLAG,
  C.CHANNEL_NAME,
  O.PAY_TYPE,
  COUNT(*)              AS FAIL_COUNT,
  SUM(O.REQUEST_AMOUNT) AS FAIL_AMOUNT,
c.contract_subject,c.channel_address,c.back_subject
FROM T_TXP_ORDER O
  LEFT JOIN T_TXP_MERCHANT M ON O.MERCHANT_NO = M.MERCHANT_NO
  LEFT JOIN T_TXP_PAY P ON O.PAY_NO = P.PAY_NO
  LEFT JOIN T_TXP_CHANNEL C ON C.CHANNEL_FLAG = P.CHANNEL_FLAG
WHERE O.CREATE_DATE >= ${START} AND O.CREATE_DATE < ${STOP} AND O.ORDER_STATUS = 'FAIL'
GROUP BY M.MERCHANT_NO, C.CHANNEL_FLAG, C.CHANNEL_NAME, O.PAY_TYPE, DATE(O.CREATE_DATE),c.contract_subject,c.channel_address,c.back_subject
",FOURTH_TXP
yykdailyfourth,init_summary,"SELECT
concat('init',M.MERCHANT_NO, CASE WHEN C.CHANNEL_FLAG IS NOT NULL THEN C.CHANNEL_FLAG  ELSE 'CHANNEL_FLAG' END , CASE WHEN C.CHANNEL_NAME IS NOT NULL THEN C.CHANNEL_NAME ELSE 'CHANNEL_NAME' END , O.PAY_TYPE, DATE(O.CREATE_DATE)) as IDNOUSE,
  M.MERCHANT_NO,
  DATE(O.CREATE_DATE)   AS TRX_CREATE_DATE,
  C.CHANNEL_FLAG,
  C.CHANNEL_NAME,
  O.PAY_TYPE,
  COUNT(*)              AS INIT_COUNT,
  SUM(O.REQUEST_AMOUNT) AS INIT_AMOUNT,c.contract_subject,c.channel_address,c.back_subject
FROM T_TXP_ORDER O
  LEFT JOIN T_TXP_MERCHANT M ON O.MERCHANT_NO = M.MERCHANT_NO
  LEFT JOIN T_TXP_PAY P ON O.PAY_NO = P.PAY_NO
  LEFT JOIN T_TXP_CHANNEL C ON C.CHANNEL_FLAG = P.CHANNEL_FLAG
WHERE O.CREATE_DATE >=${START}  AND O.CREATE_DATE < ${STOP}
      AND O.ORDER_STATUS IN ('DEAL','INIT')
GROUP BY M.MERCHANT_NO, C.CHANNEL_FLAG, C.CHANNEL_NAME, O.PAY_TYPE, DATE(O.CREATE_DATE),c.contract_subject,c.channel_address,c.back_subject",FOURTH_TXP
NccashierQualityAnalysis,nccashier_total,"select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) TRADE_COUNT,'NCCASHIER' PRODUCT_TYPE
from NCCASHIER.TBL_NCCA_PAY_REC t
where t. CREATE_TIME >=  ${START} and t. CREATE_TIME < ${STOP}
and t.PAYMENT_SYS_NO='NCPAY'
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
WITH UR
",wldb_standby
NccashierQualityAnalysis,nccashier_succ,"select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) SUCCESS_COUNT,'NCCASHIER' PRODUCT_TYPE
from NCCASHIER.TBL_NCCA_PAY_REC t
where t. CREATE_TIME >=  ${START} and t. CREATE_TIME < ${STOP} and t.STATE='SUCCESS'
and t.PAYMENT_SYS_NO='NCPAY'
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
WITH UR
",wldb_standby
NccashierQualityAnalysis,excep_nccashier,"select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,
count(*) CARDHOLDER_COUNT
from NCCASHIER.TBL_NCCA_PAY_REC t
where t. CREATE_TIME >=  ${START} and t. CREATE_TIME < ${STOP}
and t.PAYMENT_SYS_NO='NCPAY'
and t.ERROR_CODE in ('411138','411151','411152','411155')
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur
",wldb_standby
day20161216,dataInput,"select a.PASSENGER_NAME,a.CERTIFICATE_NUMBER,a.PASSENGER_TYPE,a.TICKET_NUMBER,b.FLIGHT_NO,b.DEPT_CITY,b.ARR_CITY,b.DEPT_TIME,b.ARR_TIME,b.FLIGHT_TYPE,b.ADULT_PRICE,b.FLIGHT_TYPE,b.DISCOUNT,b.CREATE_TIME from AIRTICKET.TBL_AIR_FLIGHT_B2B_FLIGHTINFO b left join AIRTICKET.TBL_AIR_FLIGHT_PASSENGER a on a.order_id=b.order_id where a.PASSENGER_NAME is not null and a.CERTIFICATE_NUMBER is not null  and b.CREATE_TIME>=${START} and b.CREATE_TIME<=${STOP} with ur",accnt
romantic24,romanticprimate,"select AGE,AREA,BIRTHDAY1,CERTIFICATE_NUMBER,PASSENGER_NAME,PASSENGER_TYPE,SEX,STARSIGN,ZODIAC from db2inst1.hk_passenger_info h 
 with ur",reportdb
yykMerchantInfoJob,merchant_yyk,"select merchant_no as IDNOUSE,merchant_no,merchant_name,sales_name from T_TXP_MERCHANT",FOURTH_TXP
romantic24order,orderjoin,"select a.id,a.ADULT_PRICE,a.AHEAD_DAYS,a.ARR_AIRPORT_NAME AS ARR_CITY,a.ARR_TIME,a.CERTIFICATE_NUMBER,a.CREATE_TIME AS ORDER_TIME,a.DEPT_AIRPORT_NAME AS DEPT_CITY,a.DEPT_TIME,left(a.DISCOUNT,1) as seatps_code,left(a.FLIGHT_NO,2) as aircomp_code,a.LEAVE_TIMERANGE,a.ARR_CITY_NAME,a.DEPT_CITY_NAME,b1.aircomp_name,b.seatps_name,b.distcount
from db2inst1.hk_passenger_info a 
left join db2inst1.hk_cmp_code b1 on  b1.aircomp_code=left(a.FLIGHT_NO,2) 
left join db2inst1.hk_seatposition_discount b on  b.seatps_code=left(a.DISCOUNT,1)  and b.aircomp_code=left(a.FLIGHT_NO,2) 
where a.CREATE_TIME>=${START} and a.CREATE_TIME<${STOP} with ur",reportdb
dlbdailytrx,dlbrefund,"select concat(COALESCE(CHAR(date(gmt_modify)),'null'),COALESCE(CHAR(pay_way),'null'),COALESCE(CHAR(customer_num),'null'),COALESCE(CHAR(shop_num),'null'),'dlbrefund') as idnouse,
date(gmt_modify) as trxdate,pay_way as pay_way,customer_num as customer_num,shop_num as shop_num,
sum(case when type='REFUND' then 1 else 0 end) as ref_count,
sum(case when type='REFUND' then amount else 0 end) as ref_amount 
from duolabao.pay_info 
where bank_mark<>'RED_PACKET' 
and gmt_modify>= ${START} and gmt_modify < ${STOP}  and status='SUCCESS' 
group by date(gmt_modify),pay_way,customer_num,shop_num",duolabao
jiesuanTime,mainTable,"select
    COALESCE(CHAR(date(p.finish_time)),'null')||
COALESCE(CHAR(date(d.CREATE_TIME)),'null')||                                          
   COALESCE(CHAR(p.REFUND_WAY),'null') as IDNOUSE, 
	date(p.finish_time) as confirm_date,date(d.CREATE_TIME) as create_date,p.REFUND_WAY as refund_way,
	sum(d.REFUND_AMOUNT) as refund_amount,count(*) as refund_count
from refund.tbl_refund_process_record p
left join refund.tbl_refund_detail d on d.id = p.refund_request_detail_id
left join refund.tbl_refund_order o on o.id = d.refund_order_id
where 1=1
and p.finish_time >= ${START}
and p.finish_time <=  ${STOP}
group by date(p.finish_time),date(d.CREATE_TIME),p.REFUND_WAY
with ur",cashier_bank_standby
jiesuanTime,matchDay,"select ID,DATE(BEGINDATE) as BEGINDATE,DATE(ENDDATE) as ENDDATE,TYPE from MOBILEBE.HolidayAdjustment",COPY2
channeldailytrxnew,channeldailytrxnewquery,"select 
      COALESCE(CHAR(date(a.create_time)),'null')||
      COALESCE(CHAR(a.trade_interface),'null')||
      COALESCE(CHAR(a.yeepay_merchant_no),'null')||
      COALESCE(CHAR(a.bankid),'null')||
      COALESCE(CHAR(a.card_type),'null')||
      COALESCE(CHAR(a.mcc),'null')||
      COALESCE(CHAR(a.product_identifier),'null')||
      COALESCE(CHAR(a.request_type),'null') as IDNOUSE,
      date(a.create_time) as createdate,
      'nocard' as biztype,
      a.trade_interface as channel_code,
      a.yeepay_merchant_no as customer_number,
      a.bankid as bank_code,
      a.card_type as cardtype,
      a.mcc as mcc_code,
      a.product_identifier as product_code,
      a.request_type as trxtype,
      count(1) as sum_trxcount,
      sum(nvl(a.trade_amount,0)) as sum_trxamount,
      sum(decode(a.deal_status,'SUCCESS',1,0)) as succ_trxcount,
      sum(decode(a.deal_status,'SUCCESS',nvl(a.trade_amount,0),0)) as succ_trxamount,
      sum(decode(a.deal_status,'FAILED',1,0)) as fail_trxcount,
      sum(decode(a.deal_status,'FAILED',nvl(a.trade_amount,0),0)) as fail_trxamount,
      sum(decode(a.deal_status,'SUCCESS',nvl(a.order_cost,0),0)) as cost,
      b.name,
      b.status,
      b.account_type, 
      b.channel_type,
      b.access_bank_type
      from bank.tbl_bank_nocard_order a
      left join router.tbl_bank_channel b on a.router_interface_code = b.code
      where a.create_time >= ${START} and a.create_time < ${STOP}
      group by
       date(a.create_time),
       a.trade_interface,
       a.yeepay_merchant_no,
       a.bankid,
       a.card_type,
       a.mcc,
       a.product_identifier,
       a.request_type,
       b.name,
       b.status,
       b.account_type, 
       b.channel_type,
       b.access_bank_type
      with ur
",cashier_bank
COMMISSIONadjust,COMMISSIONadjust,"select  COALESCE(CHAR(date(SHARE_TIME)),'null')||COALESCE(CHAR(CUSTOMER_NUMBER),'null')||
COALESCE(CHAR(SHARE_TYPE_S),'null')||COALESCE(CHAR(PRODUCT_CODE_S),'null')||COALESCE(CHAR(PRODUCT_TYPE_S),'null')||
COALESCE(CHAR(REMARK),'null')||'POS_COM_adjust' as IDNOUSE,
date(${STOP}) - 1 days as trxdate,
year(${START})*100+month(${START}) as month,
date(SHARE_TIME) as true_trxdate,
year(SHARE_TIME)*100+month(SHARE_TIME) as true_month,
CUSTOMER_NUMBER as receiverid,
SHARE_TYPE_S as biztypeid,
PRODUCT_CODE_S as sales_product_code,
PRODUCT_TYPE_S as product_code,
1 as iscomputebonus,
1 as iscomputeprofit,
REMARK as memo,
'POSSHARECOST' AS TYPE,
'SYSTEM' AS USETYPE,
'POSP' AS DATAORIGIN,
sum(FEE_AMOUNT) as trxfee 
FROM posread.TBL_EBS_ADJUST 
WHERE SHARE_TYPE IN ('RJT','WECHAT','TRX') and CREATE_TIME - 1 months >=${START} 
and CREATE_TIME - 1 months< ${STOP} 
group by  date(SHARE_TIME),month(SHARE_TIME),year(SHARE_TIME),
CUSTOMER_NUMBER,
SHARE_TYPE_S,
PRODUCT_CODE_S,
PRODUCT_TYPE_S,
REMARK 
with ur",opendb
COMMISSIONadjust,COMCUST,"select id as customerid,customernumber as receiverid from db2inst1.customerinfo with ur",reportdb
dlbagentsparktest,dlbagentsparktest,"select id,version,agent_num,full_name,short_name,city_code,province_code,district_code,address,salesman,secret_key,status,gmt_create,gmt_modify,have_child,parent_num 
from duolabao.agent_info;",duolabao
dlbcustomerinfosparktest,dlbcustomerinfosparktest,"select c.id,c.version,c.customer_num,c.agent_num,c.freeze_status,c.type,c.full_name,c.short_name,c.cus_key,c.city,c.province,c.district,c.address,i.name as industry,c.gmt_create,
c.gmt_modify,c.customer_type,c.certificate_type,c.certificate_code,cd.user_num
from duolabao.customer_info c 
left join duolabao.customer_declare cd on c.customer_num=cd.customer_num 
left join duolabao.industry_info i on c.industry_num=i.num 
where c.freeze_status <> 'INIT';",duolabao
dlbcustomerinfosparktest,dlbcustomerinfophonesparktest,"select owner_num as CUSTOMER_NUM,contacts_num as PHONE from customer_contact_info where contacts_way='PHONE'",duolabao
dlbdailytrxsparktest,dlbdailytrxsparktest,"select concat(COALESCE(CHAR(date(f.complete_time)),'null'),COALESCE(CHAR(f.pay_way),'null'),COALESCE(CHAR(f.customer_num),'null'),COALESCE(CHAR(f.shop_num),'null'),COALESCE(CHAR(f.source),'null'),COALESCE(CHAR(f.bussiness_type),'null'),COALESCE(CHAR(f.type),'null'),'dlbdailytrx') as idnouse,
date(f.complete_time) as trxdate,
f.pay_way as pay_way,
f.customer_num as customer_num,
f.shop_num as shop_num,
f.source as source,
f.bussiness_type as bussiness_type,
f.type as type,
sum(case when f.status in ('SUCCESS','REFUND') then 1 else 0 end) as suc_count, 
sum(case when f.status in ('SUCCESS','REFUND')  then f.amount else 0 end) as suc_amount,
sum(case when (f.amount>=5 and f.status in ('SUCCESS','REFUND') ) then 1 else 0 end) as suc5_count,
sum(case when (f.amount>=10 and f.status in ('SUCCESS','REFUND')) then 1 else 0 end) as suc10_count,
sum(case when (f.amount>=5 and f.status in ('SUCCESS','REFUND') ) then f.amount else 0 end) as suc5_amount 
from duolabao.order_info f 
where f.complete_time>= ${START} and  f.complete_time < ${STOP}  and  f.status in ('SUCCESS','REFUND')
group by date(f.complete_time),
f.pay_way,
f.customer_num,
f.shop_num,
f.source,
f.bussiness_type,
f.type",duolabao
dlbdailytrxsparktest,dlbdiscountsparktest,"select concat(COALESCE(CHAR(date(gmt_modify)),'null'),COALESCE(CHAR(pay_way),'null'),COALESCE(CHAR(customer_num),'null'),COALESCE(CHAR(shop_num),'null'),'dlbdiscount') as idnouse,
date(gmt_modify) as trxdate,pay_way as pay_way,customer_num as customer_num,shop_num as shop_num,
sum(case when can_accounted<>1 then amount else 0 end) as cust_discount_amount,
sum(case when can_accounted=1 then amount else 0 end) as dlb_subsidy_amount 
from duolabao.pay_info 
where bank_mark='RED_PACKET' 
and gmt_modify>= ${START} and gmt_modify < ${STOP}  and status in ('SUCCESS','REFUND') 
group by date(gmt_modify),pay_way,customer_num,shop_num",duolabao
dlbdailytrxsparktest,dlbrefundsparktest,"select concat(COALESCE(CHAR(date(gmt_modify)),'null'),COALESCE(CHAR(pay_way),'null'),COALESCE(CHAR(customer_num),'null'),COALESCE(CHAR(shop_num),'null'),'dlbrefund') as idnouse,
date(gmt_modify) as trxdate,pay_way as pay_way,customer_num as customer_num,shop_num as shop_num,
sum(case when type='REFUND' then 1 else 0 end) as ref_count,
sum(case when type='REFUND' then amount else 0 end) as ref_amount 
from duolabao.pay_info 
where bank_mark<>'RED_PACKET' 
and gmt_modify>= ${START} and gmt_modify < ${STOP}  and status='SUCCESS' 
group by date(gmt_modify),pay_way,customer_num,shop_num",duolabao
Daifudaifaquery,daifudaifaE,"select a.Id,
a.customerNumber,
b.active,
b.autoRemitValid,
b.autoRemitBank,
b.reverseControl,
d.value,
case
        when (c.workdayurgency=1 or c.weekendurgency=1 ) then 1
        else 0
end as workdayurgency,
c.autoRemitBank as autoRemitBank2,
c.remitRate,
e.value as value2
 from MOBILEBE.customer a 
left join MOBILEBE.customerTransferInfo b on b.customerid=a.id 
left join MOBILEBE.settleindayinfo c on c.customerid=a.id 
left join MOBILEBE.transferProfile d on d.customerid=a.id and d.name='Wtjs_payeeLimit' and d.isvalid='1'
left join MOBILEBE.transferProfile e on e.customerid=a.id and e.name='Inday_PayeeLimit' and e.isvalid='1'
where  b.id is not null or c.id is not null 
with ur
",COPY2
agentprofit,agentfr_profit,"SELECT 
	concat(d.CUSTOMER_NUM,d.BIZ_TYPE,d.BANK_CODE,r.PROFIT_DATE) AS IDNOUSE,
	sum(d.PROFIT_AMOUNT) AS PROFIT_AMOUNT,
       d.CUSTOMER_NUM AS CUSTOMER_NUM,
       d.BIZ_TYPE AS BIZ_TYPE,
       d.BANK_CODE AS BANK_CODE,
        year(concat(r.PROFIT_DATE,'-01'))*100+month(concat(r.PROFIT_DATE,'-01'))  AS PROFIT_DATE
FROM TBL_PROFIT_DETAIL d
LEFT JOIN TBL_PROFIT_RECORD r ON r.ID=d.PROFIT_RECORD_ID
WHERE d.status = 'ACTIVE' and date(concat(r.PROFIT_DATE,'-01'))>=${START} and 
date(concat(r.PROFIT_DATE,'-01'))< ${STOP} 
GROUP BY d.CUSTOMER_NUM,
         d.BIZ_TYPE,
         d.BANK_CODE,
         r.PROFIT_DATE",FOURTH_TXP
newrzsxf,newrzsxf,"select COALESCE(
    CHAR(a.CUSTOMER_ID) ,
    'null'
) || COALESCE(
    CHAR(a.FROM_PRODUCT) ,
    'null'
) || COALESCE(
    CHAR(
        date(a.PAY_TIME)
    ) ,
    'null'
) || 'new_rzsxf' as IDNOUSE ,
'ZXDB' AS DATAORIGIN ,
YEAR( DATE(a.PAY_TIME)) * 100 + MONTH(DATE(a.PAY_TIME)) AS MONTH ,
DATE(a.PAY_TIME) AS TRXDATE ,
CUSTOMER_ID as RECEIVERID ,
226 as BIZTYPEID ,
case a.FROM_PRODUCT 
when 'FastRealIdName' then '3011004003001'  
when 'FastRealNameAuth' then '3011004003002'  
when 'FastRealNameVerify' then '3011004003002' else '3011004003002' end as PRODUCT_CODE ,
case a.FROM_PRODUCT 
when 'FastRealIdName' then '3011004003001A' 
when 'FastRealNameAuth' then '3011004003002B' 
when 'FastRealNameVerify' then '3011004003002A' else '3011004003002B' end as SALES_PRODUCT_CODE ,
case a.FROM_PRODUCT when 'FastRealIdName' then 'RealNameAuth' else 'CARDJIANQUAN' end as TYPE ,
case a.FROM_PRODUCT when 'FastRealIdName' then 'REALNAMEAUTH' else 'CARDJIANQUAN' end as PAYPRODUCT ,
case a.FROM_PRODUCT when 'FastRealIdName' then 'REALNAMEAUTH' else 'CARDJIANQUAN' end as ORDERTYPE ,
cast(sum(PAY_AMOUNT) as decimal(10 ,2)) as TRXFEE ,
count(*) as TRXCOUNT 
from CERTIFY.TBL_AUTH_ORDER a 
where a.PAY_TIME >= ${START} and a.PAY_TIME < ${STOP} 
and a.STATUS = 'SUCCESS' 
group by a.CUSTOMER_ID ,
a.FROM_PRODUCT ,
date(a.PAY_TIME) 
with ur ",dzh_standby
newrzsxf,newrzsxfcustid,"select customernumber as receiverid,id as customerid from db2inst1.customerinfo with ur",reportdb
testsales,reportDB,"SELECT CU.ID AS CUSTOMER_ID
        , CU.MERCHANTNO AS CUSTOMER_NO
        , CU.CUSTOMERNUMBER AS RECEIVERID
        , CU.FULLNAME AS FULLNAME
        , CU.VMARK AS CUSTOMER_LEVEL
        , D.TRXDATE AS TRXDATE
        , PP.ACCOUNTINGTYPE AS ACCOUNTINGTYPE
        , D.PRODUCT_CODE AS PRODUCT_CODE
        , P.PRODUCTNAME AS PRODUCTNAME
        , D.SALES_PRODUCT_CODE AS SALES_PRODUCT_CODE
        , SP.PRODUCTNAME AS RETAIL_PRODUCT_NAME
        , D.BIZTYPEID AS BIZTYPEID
        , TB.DISPLAYNAME AS DISPLAYNAME
        , D.TYPE AS TRADE_TYPE
        , TT.NAME AS TRADE_NAME
        , CS.EMPLOYEE_ID AS EMPLOYEE_ID
        , EM.EMPLOYEE_NAME AS EMPLOYEE_NAME
        , EM.SALES_LEVEL AS EMPLOYEE_LEVEL
        , CU.AGENTCODE AS AGENTCODE
        , CU.AGENTNAME AS AGENTNAME
        , CU.BUSSINESSCATID AS BUSSINESSCATID
        , TG.NAME AS BUSSINESSCATNAME
        , CASE WHEN CS.ISSELF=0 THEN 'è½' ELSE '_' END AS ISSELF
        , DEC(CS.SHARESCALE*100,10,0)||'%' AS SHARESCALE
        , D.FEETYPE AS FEETYPE
        , D.TRXCHANNELID AS TRXCHANNELID
        , CU.BRANCHCOMPANY AS BRANCHCOMPANY
        , TA.BRANCHNAME AS BRANCHNAME
        , EMU.EMPLOYEE_NAME AS SUPER
        , DEC(SUM(D.TRXCOUNT*CS.SHARESCALE),18,4) AS TRADE_NUM
        , DEC(SUM(D.TRXAMOUNT*CS.SHARESCALE),18,4) AS TRADE_AMOUNT
        , DEC(SUM(D.REFUNDCOUNT*CS.SHARESCALE),18,4) AS REFUND_NUM
        , DEC(SUM(D.REFUNDAMOUNT*CS.SHARESCALE),18,4) AS REFUND_AMOUNT
        , DEC(SUM(D.TRXFEE*CS.SHARESCALE),18,4)  AS TRADE_FEE
        , DEC(SUM(D.REFUNDFEE*CS.SHARESCALE),18,4) AS REFUND_FEE
        , DEC((CASE WHEN SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)*(CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END))<=0 THEN 0 ELSE CASE WHEN SUM(D.TRXAMOUNT*CS.SHARESCALE)<=0 THEN 0 ELSE SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)*(CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END))/SUM(D.TRXAMOUNT*CS.SHARESCALE) END END)*100,18,4) AS CONTRACT_RATE
        , DEC(SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)),18,4) AS INCOME
        , DEC(SUM(D.ACCOUNTINGCOST*CS.SHARESCALE),18,4) AS COST
        , D.ACCOUNTINGCOST AS ACCOUNTINGCOST
        , DEC(SUM(D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE-D.ACCOUNTINGCOST*CS.SHARESCALE),18,4) AS GROSS_PROFIT
        , CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END AS SALESRATIO
        , D.ID AS DAILY_ID
        , D.PAYERID AS PAYERID
        , D.ORDERTYPE AS ORDERTYPE
        , CU.AGENTTYPE AS AGENTTYPE
        , PCS.EMPLOYEE_ID AS P_EMPLOYEE_ID
        , PEM.EMPLOYEE_NAME AS P_EMPLOYEE_NAME
        , PCU.FULLNAME AS P_FULLNAME
        , CURRENT TIMESTAMP AS CREATE_TIME
        FROM DB2INST1.DAILYTRXSTAT D
        LEFT JOIN DB2INST1.CUSTOMERINFO CU ON D.RECEIVERID=CU.ID
        LEFT JOIN DB2INST1.CUSTOMERINFO PCU ON D.PAYERID=PCU.ID
        LEFT JOIN DB2INST1.TRXSTATBIZTYPE TB ON D.BIZTYPEID=TB.ID 
        LEFT JOIN DB2INST1.TRXSTATTRXTYPE TT ON D.TYPE=TT.ID 
        LEFT JOIN DB2INST1.PRODUCTCODE P ON D.PRODUCT_CODE=P.PRODUCTCODE AND P.PRODUCTTYPE=2 
        LEFT JOIN DB2INST1.PRODUCTCODE SP ON D.SALES_PRODUCT_CODE=SP.PRODUCTCODE AND SP.PRODUCTTYPE=1
        LEFT JOIN DB2INST1.PRODUCTCODE_PROFILE PP ON D.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE AND D.PRODUCT_CODE=PP.PRODUCT_CODE
        LEFT JOIN YJKH.TBL_CUSTOMER_RELATIONSHIP CS ON CU.ID=CS.CUSTOMER_ID AND CS.MONTH='2017-1_'
        LEFT JOIN YJKH.TBL_CUSTOMER_RELATIONSHIP PCS ON D.PAYERID=PCS.CUSTOMER_ID AND PCS.MONTH='2017-1_'
        LEFT JOIN YJKH.TBL_EMPLOYEEINFO PEM ON PCS.EMPLOYEE_ID=PEM.ID
        LEFT JOIN YJKH.TBL_EMPLOYEEINFO EM ON CS.EMPLOYEE_ID=EM.ID 
        LEFT JOIN DB2INST1.TRXSTATBUSINESSCATEGORIE TG ON CU.BUSSINESSCATID=TG.ID 
        LEFT JOIN DB2INST1.TRXSTATCUSTOMERAREA TA ON CU.BRANCHCOMPANY=TA.AREAID
        LEFT JOIN YJKH.TBL_EMPLOYEEINFO EMU ON EM.SUPER_ID=EMU.ID 
        LEFT JOIN DB2INST1.MONTHLYT_CUSTOMER_SALESRATIO MCS ON D.PRODUCT_CODE = MCS.SALES_PRODUCT_CODE AND CU.ID = MCS.CUSTOMER_ID AND MCS.MONTH='201701'  
        WHERE 1=1 AND D.ISCOMPUTEBONUS=1 
        AND D.TRXDATE BETWEEN '2017-01-01' AND '2017-01-31' 
        GROUP BY D.ID,D.PAYERID,D.ORDERTYPE,CU.AGENTTYPE,EM.SALES_LEVEL,CU.VMARK,CU.MERCHANTNO,MCS.SALESRATIO,CU.ID
       ,CU.CUSTOMERNUMBER,D.TRXDATE,PP.ACCOUNTINGTYPE,D.PRODUCT_CODE,P.PRODUCTNAME,D.SALES_PRODUCT_CODE,SP.PRODUCTNAME
       ,D.BIZTYPEID,TB.DISPLAYNAME,D.TYPE,TT.NAME,CS.EMPLOYEE_ID,EM.EMPLOYEE_NAME,CU.AGENTCODE,CU.AGENTNAME,CU.BUSSINESSCATID,TG.NAME
       ,CS.ISSELF,CS.SHARESCALE,D.FEETYPE,D.TRXCHANNELID,CU.BRANCHCOMPANY,TA.BRANCHNAME,EMU.EMPLOYEE_NAME
       , D.ID, D.PAYERID, D.ORDERTYPE, CU.AGENTTYPE, D.ACCOUNTINGCOST, CU.FULLNAME, PCS.EMPLOYEE_ID, PEM.EMPLOYEE_NAME, PCU.FULLNAME
        WITH UR",reportdb_yjkh
monthlytrxstat2017,monthlytrxstat2017,"select COALESCE(CHAR(d.product_code),'null')||
COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(d.receiverid),'null')||
COALESCE(CHAR(d.bizTypeId),'null')||
COALESCE(CHAR(d.type),'null')||
COALESCE(CHAR(r.employeeid),'null')||
COALESCE(CHAR(c.productlineid),'null')||
COALESCE(CHAR(c.areaid),'null')||
COALESCE(CHAR(r.isSelf),'null')||
COALESCE(CHAR(r.isShare),'null')||
COALESCE(CHAR(r.shareScale),'null')||
COALESCE(CHAR(r.transfDate),'null')||
COALESCE(CHAR(c.productGroup),'null')||
COALESCE(CHAR(c.bussinessCatId),'null')||
COALESCE(CHAR(c.level),'null')||
COALESCE(CHAR(em.BRANCHCOMPANY),'null')||
COALESCE(CHAR(d.feetype),'null')||
COALESCE(CHAR(month(trxdate)),'null')||
COALESCE(CHAR(year(trxdate)),'null')||
COALESCE(CHAR(month(true_trxdate)),'null')||
COALESCE(CHAR(year(true_trxdate)),'null')||
COALESCE(CHAR(d.PAYERID),'null')||
COALESCE(CHAR(d.TRXCHANNELID),'null')||
COALESCE(CHAR(d.ORDERTYPE),'null')||
COALESCE(CHAR(d.ISCOMPUTEPROFIT),'null')||
COALESCE(CHAR(d.ISCOMPUTEBONUS),'null')||
COALESCE(CHAR(d.USETYPE),'null')||
COALESCE(CHAR(d.PAYPRODUCT),'null') as IDNOUSE,month(trxdate)+year(trxdate)*100 as month,month(true_trxdate)+year(true_trxdate)*100 as true_month,d.product_code,d.sales_product_code,d.receiverid as customerid,d.bizTypeId,d.type,coalesce(r.employeeid,25) as salesid,c.productlineid,c.areaid,c.productGroup,r.isSelf,r.isShare as issharecustomer,coalesce(r.shareScale,1) as salesscale,
r.transfDate,sum(trxCount)-sum(refundCount) as trxCount,sum(trxAmount)-sum(refundAmount) as trxAmount,sum(trxFee)-sum(refundFee) as trxFee,
sum(frpCost) as innerCost,sum(externalCost) as externalCost,sum(shareFrpCost) as shareFrpCost,sum(accountingCost) as accountingcost
,c.bussinessCatId as businessCatId,c.level as customerlevel,em.BRANCHCOMPANY,d.feetype,sum(refundCount) as refundcount,sum(refundAmount) as refundamount,'RECEIVER' as customertype,d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT,sum(refundFee) as refundfee,sum(REFUNDFRPCOST) as REFUNDFRPCOST,sum(WHOLEPAYCOUNT) as WHOLEPAYCOUNT,sum(WHOLEORDERCOUNT) as WHOLEORDERCOUNT,sum(WHOLEORDERAMOUNT) as WHOLEORDERAMOUNT
  from DailyTrxStat d left join CustomerInfo c on d.receiverid=c.id
  left join CustomerRelationship r on r.customerid=d.receiverid
  left join employeeinfo em on r.EMPLOYEEID=em.ID
  where  d.ISCOMPUTEPROFIT=1 and d.type not in ('SettleTransf') and trxdate>=${START} and trxdate<${STOP}  
  group by d.product_code,d.sales_product_code,d.receiverid,d.bizTypeId,d.type,r.employeeid,c.productlineid,c.areaid,r.isSelf,r.isShare,r.shareScale,r.transfDate,c.productGroup,c.bussinessCatId,c.level,em.BRANCHCOMPANY,d.feetype,month(trxdate),year(trxdate),month(true_trxdate),year(true_trxdate),d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT with ur",reportdb
PublishedMonthlyTrxStat2017,publishedmonthlytrxstat,"select 
char(COALESCE(m.CUSTOMERID,0))||COALESCE(c.CUSTOMERNUMBER,'null')||COALESCE(c.FULLNAME,'null')||char(COALESCE(m.SALESID,0))||char(COALESCE(m.AREAID,0))||char(COALESCE(m.biztypeid,0))||COALESCE(m.TYPE,'null') ||char(COALESCE(m.salesscale,1))||char(COALESCE(m.isShareCustomer,0))||char(COALESCE(m.isself,1))||COALESCE(m.productgroup,'null')||COALESCE(m.businesscatid,'null')||COALESCE(m.branchcompany,'null')||COALESCE(m.product_code,'null')||COALESCE(m.sales_product_code,'null')||COALESCE(m.managemark,'null')||char(COALESCE(c2a.ACHIEVEMENT_ID,0))||'RECEIVER'||char(COALESCE(m.true_month,0))||char(COALESCE(m.payerid,0))||char(coalesce(c.productline,'')) as IDNOUSE,
1601 as timeLatitudeId,201804 as MONTH,m.true_month,m.CUSTOMERID,m.payerid,c.CUSTOMERNUMBER,c.FULLNAME as customerName,m.SALESID as saleid,0 as teamId,m.AREAID,0 as productLineId,c.productline as hangyeyejishuxing,
m.biztypeid, m.TYPE as trxTypeId,sum(m.trxcount*m.salesscale*coalesce(c2a.PERCENT,1)) as trxcount,sum(m.trxamount*m.salesscale*coalesce(c2a.PERCENT,1)) as trxamount,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)) as innerincome,
sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as innerCost,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as innerprofit,'RECEIVER' as grouptype,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as accountingCost,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as accountingProfit,
m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT
from monthlytrxstat m left join customerinfo c on m.CUSTOMERID=c.ID left join customer2achievement c2a on c. customernumber=c2a.customer_number
where m.month=201804 and m.customertype='RECEIVER'   group by m.CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME,m.SALESID,m.AREAID,m.biztypeid, m.TYPE,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT,m.true_month,m.payerid,c.productline with ur",reportdb
PublishedMonthlyTrxStat2017,publishedtrxstatadditonalstatfee,"select char(coalesce(salesid,0))||char(coalesce(bizTypeId,0))||char(coalesce(salesid,0))||char(coalesce(productlineid,0))||char(coalesce(t.areaid,0))||coalesce(type,'')||coalesce(productGroup,'')||coalesce(businessCatId,'')||coalesce(a.AREAID,'')||coalesce(product_code,'')||coalesce(sales_product_code,'')||char(coalesce(t.yejishuxing,0))||'RECEIVER'||char(COALESCE(t.memomonth,0))||char(coalesce(t.hangyeyejishuxing,'')) as IDNOUSE,1601 as timeLatitudeId,201804 as MONTH,t.memomonth as true_month,salesid,bizTypeId,salesid as saleid,0 as teamId,productlineid,t.areaid,type as trxTypeId,productGroup,businessCatId,a.AREAID as branchcompany,product_code,sales_product_code,'RECEIVER' as grouptype,t.hangyeyejishuxing,sum(income) as innerincome,sum(cost) as innerCost,sum(income-cost) as INNERPROFIT,sum(accountingcost) as accountingCost,sum(income-accountingcost) as ACCOUNTINGPROFIT, sum(trxcount) as trxcount, sum(trxamount) as trxamount,t.yejishuxing as ACHIEVEMENT_ID,1 as PERCENT from TrxStatAdditionalStatFee t left join trxstatcustomerarea a on t.branchid=a.id where  month=201804 and iscomputeprofit=1 group by salesid,bizTypeId,salesid,productlineid,t.areaid,type,productGroup,businessCatId,a.AREAID,product_code,sales_product_code,t.yejishuxing,t.memomonth,t.hangyeyejishuxing  with ur
",reportdb
customerTradeToHistory,reportDB2,"SELECT
    cast(rand()*1000000000 as int) AS IDS,
    t.CUSTOMER_ID,
    t.CUSTOMER_NO,
    t.RECEIVERID,
    t.FULLNAME,
    t.CUSTOMER_LEVEL,
    t.TRXDATE,
    t.ACCOUNTINGTYPE,
    t.PRODUCT_CODE,
    t.PRODUCTNAME,
    t.SALES_PRODUCT_CODE,
    t.RETAIL_PRODUCT_NAME,
    t.BIZTYPEID,
    t.DISPLAYNAME,
    t.TRADE_TYPE,
    t.TRADE_NAME,
    t.EMPLOYEE_ID,
    t.EMPLOYEE_NAME,
    t.EMPLOYEE_LEVEL,
    t.AGENTCODE,
    t.AGENTNAME,
    t.PERFORMANCE_ATTRIBUTE,
    t.PERFROMANCE_FACTOR,
    t.BUSSINESSCATID,
    t.BUSSINESSCATNAME,
    t.ISSELF,
    t.SHARESCALE,
    t.FEETYPE,
    t.TRXCHANNELID,
    t.BRANCHCOMPANY,
    t.BRANCHNAME,
    t.SUPER,
    t.TRADE_NUM,
    t.TRADE_AMOUNT,
    t.REFUND_NUM,
    t.REFUND_AMOUNT,
    t.TRADE_FEE,
    t.REFUND_FEE,
    t.CONTRACT_RATE,
    t.INCOME,
    t.COST,
    t.ACCOUNTINGCOST,
    t.GROSS_PROFIT,
    t.SALESRATIO,
    t.PAY_FROM,
    t.AREA,
    t.RAKE_BACK,
    t.AGENT_PROFIT,
    t.DAILY_ID,
    t.PAYERID,
    t.ORDERTYPE,
    t.AGENTTYPE,
    t.P_FULLNAME,
    t.P_EMPLOYEE_ID,
    t.P_EMPLOYEE_NAME,
    t.CREATE_TIME,
    t.MODIFY_TIME,
    t.CREATE_USER,
    t.MODIFY_USER,
    t.BILLMONTH,
    t.PRODUCTLINE,
    t.POSTPAID_PERIOD,
    t.REAL_PROFIT
FROM
    YJKH.TBL_CUSTOMER_TRADE t",reportdb_yjkh
POSRENTSALES,posrentreceiveid,"select coalesce(char(d.receiverid),'null')||coalesce(char(d.memo),'null')||char(date(${START}))||'POSRENTCOST' as idnouse, 
d.receiverid,d.memo,
year(${START})*100+month(${START}) as month, 
date(${STOP}) - 1 days as trxdate,
date(${STOP}) - 1 days as true_trxdate,
29 AS BIZTYPEID,
'POSRENT' AS TYPE,
'3011401001001' AS PRODUCT_CODE ,
'3011401001001A' AS SALES_PRODUCT_CODE,
0 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'SYSTEM' as usetype,
'POSRENTCOST' as dataorigin 
from db2inst1.dailytrxstat d 
where  d.trxdate>= ${START}   and d.trxdate< ${STOP} 
and d.biztypeid=29 and d.type='POSRENT' and d.usetype='MANUAL'  
and d.product_code='3011401001001' and d.sales_product_code='3011401001001A'  
with ur",reportdb
POSRENTSALES,posrentcost1,"select c.serial_number as memo,
sum(c.deprn_amount)*1.17 as accountingcost 
from cux_fa_pos_deprn_v  c 
where to_date((c.period_name||'-1'),'yyyy-mm-dd')>= to_date(to_char(${START}),'yyyy-mm-dd')  
AND to_date((c.period_name||'-1'),'yyyy-mm-dd') < to_date(to_char(${STOP}),'yyyy-mm-dd') 
group by c.serial_number",oracle_finance
POSRENTSALES,posrentcost2,"select c.serial_number as memo,
sum(c.deprn_amount)*1.17 as frpcost 
from cux_fa_pos_deprn_v  c 
where to_date((c.period_name||'-1'),'yyyy-mm-dd')>= to_date(to_char(${START}),'yyyy-mm-dd')  
AND to_date((c.period_name||'-1'),'yyyy-mm-dd') < to_date(to_char(${STOP}),'yyyy-mm-dd') 
group by c.serial_number",oracle_finance
POSSALES,possalesinput,"select coalesce(char(b.SERIAL_NUMBER),'null')||coalesce(char(a.CUSTOMER_NUMBER),'null')||char(date(${START}))||'POSSALESIN' as idnouse,
a.CUSTOMER_NUMBER as RECEIVERID,
b.SERIAL_NUMBER as memo,
DATE(${STOP})-1 days as trxdate,
year(${START})*100+month(${START}) as month,
DATE(${STOP})-1 days as true_trxdate,
29 AS BIZTYPEID,
'POSSALES' AS TYPE,
'3011401001001' AS PRODUCT_CODE ,
'3011401001001A' AS SALES_PRODUCT_CODE,
0 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'SYSTEM' as usetype,
'POSSALESIN' as dataorigin,
sum(b.PURCHASE_PRICETAX) as trxfee,
sum(b.PURCHASE_COST)*1.17 as accountingcost,
sum(b.PURCHASE_COST)*1.17 as frpcost 
from posread.TBL_POS_INANDOUTSTOREINFO as a 
left join posread.TBL_POS_MATERIALSTOCK_HIS as b on a.inorout_number=b.inandoutstock_code
where a.business_type='___åº'  and a.SYNORACLE_STATUS='SUCCESS' 
and a.INOROUT_DATE>=${START} and a.INOROUT_DATE< ${STOP} 
and a.CUSTOMER_NUMBER not in ('POSJS','selloff001','POSPD') 
group by a.CUSTOMER_NUMBER,b.SERIAL_NUMBER 
with ur",opendb
POSSALES,possalesoutput,"select coalesce(char(b.SERIAL_NUMBER),'null')||coalesce(char(a.CUSTOMER_NUMBER),'null')||char(date(${START}))||'POSSALESOUT' as idnouse,
a.CUSTOMER_NUMBER as RECEIVERID,
b.SERIAL_NUMBER as memo,
DATE(${STOP})-1 days as trxdate,
year(${START})*100+month(${START}) as month,
DATE(${STOP})-1 days as true_trxdate,
29 AS BIZTYPEID,
'POSSALES' AS TYPE,
'3011401001001' AS PRODUCT_CODE ,
'3011401001001A' AS SALES_PRODUCT_CODE,
0 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'SYSTEM' as usetype,
'POSSALESOUT' as dataorigin,
-sum(b.RETURNED_DEPOSIT) as trxfee,
-sum(b.PURCHASE_COST)*1.17 as accountingcost,
-sum(b.PURCHASE_COST)*1.17 as frpcost 
from posread.TBL_POS_INANDOUTSTOREINFO as a 
left join posread.TBL_POS_MATERIALSTOCK_HIS as b on a.inorout_number=b.inandoutstock_code
where a.business_type='__åº'  and a.SYNORACLE_STATUS='SUCCESS' 
and a.INOROUT_DATE>=${START} and a.INOROUT_DATE< ${STOP}  
and a.CUSTOMER_NUMBER not in ('POSJS','selloff001','POSPD') 
group by a.CUSTOMER_NUMBER,b.SERIAL_NUMBER 
with ur",opendb
POSSALES,possalestrans1,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
bigcalculate,bigcalculatesucc,"SELECT  coalesce(char(date(P.PAY_SUCCESS_DATE)),'null')||coalesce(char(I.MERCHANT_NO),'null')
||coalesce(char(P.CASHIER_TYPE),'null')||coalesce(char(P.FEE_WAY),'null')
||coalesce(char(P.CHANNEL_ID),'null')
||coalesce(char(P.CARD_TYPE),'null')
||coalesce(char(I.BIZ_SYSTEM_NO),'null')
||coalesce(char(P.INST_NUMBER),'null')
||coalesce(char(P.ACCOUNT_PRODUCT_CODE),'null')||coalesce(char(I.SALES_PRODUCT_CODE),'null')
||coalesce(char(P.FEE_VERSION),'null')||coalesce(char(P.BANK_ID),'null')||'bigcalculatesucc' as IDNOUSE,
date(P.PAY_SUCCESS_DATE) as trxdate,
date(P.PAY_SUCCESS_DATE) as true_trxdate,
year(P.PAY_SUCCESS_DATE)*100+month(P.PAY_SUCCESS_DATE) as month,
'Sales' as type,
303 AS BIZTYPEID ,
1 as iscomputeprofit,
1 as iscomputebonus,
'SYSTEM' as usetype,
I.MERCHANT_NO as receiverid,
P.CASHIER_TYPE as payscene,
P.CHANNEL_ID as trxchannelid,
CASE P.CARD_TYPE when 'DEBIT' then 'DEBITCARD' when 'CREDIT' then 'CREDITCARD' else P.CARD_TYPE end as cardtype,
'DS' as dataorigin,
P.INST_NUMBER as goodscate,
P.BANK_ID as bank_code,
(CASE WHEN P.ACCOUNT_PRODUCT_CODE ='ZF_QB_H5' and P.FEE_VERSION='LOW' THEN I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY||'.'||P.FEE_VERSION
ELSE I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY END) as payproduct,
COUNT(*) AS trxcount,
COALESCE(SUM(I.ORDER_AMOUNT),0) AS trxamount,
COALESCE(SUM(COALESCE(P.MERCHANT_FEE,P.CUSTOMER_FEE,0)),0)as trxfee,
COALESCE(SUM(P.COST),0) AS accountingcost,
COALESCE(SUM(P.COST),0) AS frpcost    
FROM OPR.TBL_ORDER_INFO I ,OPR.TBL_ORDER_PAYMENT P  
WHERE I.BIZ_SYSTEM_NO='DS' and P.UNIQUE_ORDER_NO = I.UNIQUE_ORDER_NO 
and P.PAY_SUCCESS_DATE>= ${START} and P.PAY_SUCCESS_DATE< ${STOP} 
AND I.STATUS IN ('FULLY_PAY','CS_ACCEPT','SUCCESS','REFUND','CS_SUCCESS') 
group by 
date(P.PAY_SUCCESS_DATE),
month(P.PAY_SUCCESS_DATE),
year(P.PAY_SUCCESS_DATE),
I.MERCHANT_NO,
P.CASHIER_TYPE,
P.CHANNEL_ID,
P.CARD_TYPE,
I.BIZ_SYSTEM_NO,
P.INST_NUMBER,
P.ACCOUNT_PRODUCT_CODE,
I.SALES_PRODUCT_CODE,
P.FEE_WAY,
P.BANK_ID,
P.FEE_VERSION 
with ur",zgt_standby
bigcalculate,bigcalculaterefund,"SELECT 
coalesce(char(date(R.REFUND_CENTER_FINISH_DATE)),'null')
||coalesce(char(I.MERCHANT_NO),'null')
||coalesce(char(P.CASHIER_TYPE),'null')||coalesce(char(P.FEE_WAY),'null')
||coalesce(char(P.CHANNEL_ID),'null')
||coalesce(char(P.CARD_TYPE),'null')
||coalesce(char(I.BIZ_SYSTEM_NO),'null')
||coalesce(char(P.INST_NUMBER),'null')
||coalesce(char(P.ACCOUNT_PRODUCT_CODE),'null')||coalesce(char(I.SALES_PRODUCT_CODE),'null')
||coalesce(char(P.FEE_VERSION),'null')||coalesce(char(P.BANK_ID),'null')||'bigcalculaterefund' as IDNOUSE,
date(R.REFUND_CENTER_FINISH_DATE) as trxdate,
date(R.REFUND_CENTER_FINISH_DATE) as true_trxdate,
year(R.REFUND_CENTER_FINISH_DATE)*100+month(R.REFUND_CENTER_FINISH_DATE) as month,
'Sales' as type,
303 AS BIZTYPEID ,
1 as iscomputeprofit,
1 as iscomputebonus,
'SYSTEM' as usetype,
I.MERCHANT_NO as receiverid,
P.CASHIER_TYPE as payscene,
P.CHANNEL_ID as trxchannelid,
CASE P.CARD_TYPE when 'DEBIT' then 'DEBITCARD' when 'CREDIT' then 'CREDITCARD' else P.CARD_TYPE end as cardtype,
'DS' as dataorigin,
P.INST_NUMBER as goodscate,
P.BANK_ID as bank_code,
(CASE WHEN P.ACCOUNT_PRODUCT_CODE ='ZF_QB_H5' and P.FEE_VERSION='LOW' THEN I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY||'.'||P.FEE_VERSION
ELSE I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY END) as payproduct,
COUNT(*) AS refundcount,
COALESCE(SUM(R.REFUND_AMOUNT),0) AS refundamount,
COALESCE(SUM(R.RETURN_MERCHANT_FEE),0) AS refundfee 
FROM OPR.TBL_REFUND_INFO R ,OPR.TBL_ORDER_INFO I ,OPR.TBL_ORDER_PAYMENT P 
WHERE I.BIZ_SYSTEM_NO='DS' and  I.UNIQUE_ORDER_NO = R.UNIQUE_ORDER_NO 
AND P.UNIQUE_ORDER_NO = R.UNIQUE_ORDER_NO 
AND R.STATUS IN ('SUCCESS') 
AND R.REFUND_CENTER_FINISH_DATE>= ${START} and R.REFUND_CENTER_FINISH_DATE< ${STOP}  
group by 
date(R.REFUND_CENTER_FINISH_DATE),
month(R.REFUND_CENTER_FINISH_DATE),
year(R.REFUND_CENTER_FINISH_DATE),
I.MERCHANT_NO,
P.CASHIER_TYPE,
P.CHANNEL_ID,
P.CARD_TYPE,
I.BIZ_SYSTEM_NO,
P.INST_NUMBER,
P.ACCOUNT_PRODUCT_CODE,I.SALES_PRODUCT_CODE, P.FEE_WAY,
P.BANK_ID,
P.FEE_VERSION 
with ur",zgt_standby
bigcalculate,bigcalculatetotal,"SELECT 
coalesce(char(date(I.REQUEST_DATE)),'null')
||coalesce(char(I.MERCHANT_NO),'null')
||coalesce(char(P.CASHIER_TYPE),'null')||coalesce(char(P.FEE_WAY),'null')
||coalesce(char(P.CHANNEL_ID),'null')
||coalesce(char(P.CARD_TYPE),'null')
||coalesce(char(I.BIZ_SYSTEM_NO),'null')
||coalesce(char(P.INST_NUMBER),'null')
||coalesce(char(P.ACCOUNT_PRODUCT_CODE),'null')||coalesce(char(I.SALES_PRODUCT_CODE),'null')
||coalesce(char(P.FEE_VERSION),'null')||coalesce(char(P.BANK_ID),'null')||'bigcalculatetotal' as IDNOUSE,
date(I.REQUEST_DATE) as trxdate,
date(I.REQUEST_DATE) as true_trxdate,
year(I.REQUEST_DATE)*100+month(I.REQUEST_DATE) as month,
'Sales' as type,
303 AS BIZTYPEID ,
1 as iscomputeprofit,
1 as iscomputebonus,
'SYSTEM' as usetype,
I.MERCHANT_NO as receiverid,
P.CASHIER_TYPE as payscene,
P.CHANNEL_ID as trxchannelid,
CASE P.CARD_TYPE when 'DEBIT' then 'DEBITCARD' when 'CREDIT' then 'CREDITCARD' else P.CARD_TYPE end as cardtype,
'DS' as dataorigin,
P.INST_NUMBER as goodscate,
P.BANK_ID as bank_code,
(CASE WHEN P.ACCOUNT_PRODUCT_CODE ='ZF_QB_H5' and P.FEE_VERSION='LOW' THEN I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY||'.'||P.FEE_VERSION
ELSE I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY END) as payproduct,
COALESCE(SUM(I.ORDER_AMOUNT),0) AS wholeorderamount 
FROM OPR.TBL_ORDER_INFO I ,OPR.TBL_ORDER_PAYMENT P 
WHERE I.BIZ_SYSTEM_NO='DS' and P.UNIQUE_ORDER_NO = I.UNIQUE_ORDER_NO 
AND I.REQUEST_DATE>= ${START} and I.REQUEST_DATE< ${STOP}  
group by 
date(I.REQUEST_DATE),
month(I.REQUEST_DATE),
year(I.REQUEST_DATE),
I.MERCHANT_NO,
P.CASHIER_TYPE,
P.CHANNEL_ID,
P.CARD_TYPE,
I.BIZ_SYSTEM_NO,
P.INST_NUMBER,
P.ACCOUNT_PRODUCT_CODE,I.SALES_PRODUCT_CODE,P.FEE_WAY,P.BANK_ID,
P.FEE_VERSION   
with ur",zgt_standby
bigcalculate,bigcalcsalesproduct,"select payproduct,salesproductcode as sales_product_code from db2inst1.payproduct2productcode  with ur",reportdb
bigcalculate,bigcalcproduct,"select payproduct,productcode as product_code from db2inst1.payproduct2productcode  with ur",reportdb
bigcalculate,bigcalcordertype,"select payproduct,ordertype  from db2inst1.payproduct2productcode  with ur",reportdb
TBLCWHBANKCARDINFO,tbl_cwh_data,"select c.id as IDNOUSE,c.* from member.TBL_CWH_BANK_CARD_INFO c where c.create_time  >= ${START} and c.create_time < ${STOP}  with ur",member_standby
hssxfadjust,hsadjust,"SELECT COALESCE(BIGINT(balance.ID),'null')||'-'||COALESCE(CHAR(bill.CUSTOMER_NUMBER),'null')||COALESCE(CHAR(date(balance.PAYMENT_PERIOD)),'null')||COALESCE(CHAR(bill.ACTUAL_MONTH),'null')||COALESCE(CHAR(bill.CAL_FEE_CATEGORY),'null')||'hssxfadjust' as idnouse,
bill.CUSTOMER_NUMBER AS receiverid,
balance.BALANCE_AMOUNT as trxfee,
balance.BALANCE_AMOUNT as newtrxfee,
date(balance.PAYMENT_PERIOD) as trxdate,
year(balance.PAYMENT_PERIOD)*100+month(balance.PAYMENT_PERIOD) as month,
date(bill.ACTUAL_MONTH||'-1') +1 month - 1 day as true_trxdate,
bill.ACTUAL_MONTH as memo,
bill.CAL_FEE_CATEGORY as payproduct,
CASE bill.CAL_FEE_CATEGORY WHEN 'DEBIT_ACQUIRING' THEN 182 WHEN 'EPOS_ACQUIRING' THEN 6 WHEN 'FP_ACQUIRING' THEN 6 WHEN 'PAYMENTS_BEHALF' THEN 13 WHEN 'POS_ACQUIRING' THEN 29 WHEN 'OL_ONEPAY' THEN 222 WHEN 'WECHAT' then 260 WHEN 'ONLINE_MINIPOS' then 18 ELSE 4 END as biztypeid,
'POSTPAID' as type,
1 as iscomputebonus,
1 as iscomputeprofit,
'SYSTEM' as usetype,
'feeddb' as dataorigion 
FROM FEE.TBL_FRONT_FEE_BALANCE_AMOUNT balance left join
	(select t1.BILLS_NUMBER, MAX(t1.PAYEE_FEE) PAYEE_FEE, MAX(t1.CAL_FEE_CATEGORY) CAL_FEE_CATEGORY, MAX(t1.CUSTOMER_NUMBER) CUSTOMER_NUMBER, TO_CHAR(MAX(t1.SUM_START), 'YYYY-MM') ACTUAL_MONTH from FEE.TBL_FRONT_FEE_BILL t1 
inner join (select MAX(PAYEE_FEE) MF, BILLS_NUMBER FROM FEE.TBL_FRONT_FEE_BILL GROUP BY BILLS_NUMBER) t2
on t1.BILLS_NUMBER = t2.BILLS_NUMBER AND t1.PAYEE_FEE = t2.MF GROUP BY t1.BILLS_NUMBER
) bill on balance.BILLS_NUMBER = bill.BILLS_NUMBER
WHERE balance.PAYMENT_PERIOD >=${START} AND balance.PAYMENT_PERIOD<${STOP} 
with ur",feedb
hssxfadjust,hsadproduct,"select payproduct,productcode as product_code from  db2inst1.payproduct2productcode  with ur",reportdb
hssxfadjust,hsadsalesproduct,"select payproduct,salesproductcode as sales_product_code from  db2inst1.payproduct2productcode  with ur",reportdb
hssxfadjust,hsadordertype,"select payproduct,ordertype from  db2inst1.payproduct2productcode  with ur",reportdb
hssxfadjust,hsadcustid,"select cu.customernumber as receiverid,cu.id as customerid from db2inst1.customerinfo cu with ur",reportdb
testetl,tzt,"SELECT merchant_NO, request_no, create_time, tzt_state,time FROM ATable",bigdata_test
testetl,paper,"SELECT MERCHANT_NO, CUSTOMER_ORDER_ID, CREATION_TIME, PAPERTRADE_STATUS, ORDER_SYSTEM_CODE,COUNT FROM BTable",bigdata_test
publisheddailytrxstat,publisheddailytrxstat,"select COALESCE(CHAR(d.trxdate),'null')||COALESCE(CHAR(i.transfdate),'null')||COALESCE(CHAR(d.trxdate),'null')||
COALESCE(CHAR(d.receiverid),'null')||COALESCE(CHAR(d.payerid),'null')||COALESCE(CHAR(d.biztypeid),'null')||
COALESCE(CHAR(d.type),'null')||COALESCE(CHAR(d.product_code),'null')||COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(i.custnum),'null')||COALESCE(CHAR(i.custname),'null')||COALESCE(CHAR(i.salesid),'null')||
COALESCE(CHAR(i.salesname),'null')||COALESCE(CHAR(i.isself),'null')||COALESCE(CHAR(i.isshare),'null')||
COALESCE(CHAR(i.salesscale),'null')||COALESCE(CHAR(i.yejishuxing),'null')||COALESCE(CHAR(i.yejiscale),'null')||
COALESCE(CHAR(i.vmark),'null')||COALESCE(CHAR(i.vipmark),'null')||COALESCE(CHAR(i.branchcompany),'null')||
COALESCE(CHAR(i.businesscatid),'null')||COALESCE(CHAR(i.subbusinesscat),'null')||'publisheddailytrxstat' as IDNOUSE,
d.trxdate as trxdate,
i.transfdate as transfdate,
d.trxdate as true_date,
d.receiverid as receiverid,
d.payerid as payerid,
d.biztypeid as biztypeid,
d.type as trxtypeid,
d.product_code as product_code,
d.sales_product_code as sales_product_code,
i.custnum as custnum,
i.custname as custname,
i.salesid as salesid,
i.salesname as salesname,
i.isself as isself,
i.isshare as isshare,
i.salesscale as salesscale,
i.yejishuxing as yejishuxing,
i.yejiscale as yejiscale,
i.vmark as vmark,
i.vipmark as vipmark,
i.branchcompany as branchcompany,
i.businesscatid as businesscatid,
i.subbusinesscat as subbusinesscat,
SUM(d.accountingcost * i.salesscale * i.yejiscale) as accountingcost,
SUM(d.trxfee * i.salesscale* i.yejiscale - d.refundfee * i.salesscale * i.yejiscale - d.accountingcost * i.salesscale * i.yejiscale + d.refundfrpcost * i.salesscale * i.yejiscale) as accountingprofit,
SUM(d.accountingcost * i.salesscale * i.yejiscale) as innercost,
SUM(d.trxfee * i.salesscale * i.yejiscale- d.refundfee * i.salesscale * i.yejiscale) as innerincome,
SUM(d.trxfee * i.salesscale* i.yejiscale - d.refundfee * i.salesscale * i.yejiscale - d.accountingcost * i.salesscale * i.yejiscale + d.refundfrpcost * i.salesscale * i.yejiscale) as innerprofit,
SUM(d.trxamount * i.salesscale * i.yejiscale- d.refundamount * i.salesscale * i.yejiscale) as trxamount,
SUM(d.trxcount * i.salesscale * i.yejiscale- d.refundcount * i.salesscale * i.yejiscale) as trxcount ,
SUM(case when d.trxchannelid in ('UPOP_POS_YLBMZ9010','UPOP_POS_YLBM9010(DH)','ICBC_POS_GHXY9010N') then (d.newtrxfee * i.salesscale * i.yejiscale- d.newrefundfee * i.salesscale * i.yejiscale-d.newcost * i.salesscale * i.yejiscale) else (d.newtrxfee * i.salesscale * i.yejiscale- d.newrefundfee * i.salesscale * i.yejiscale) end) as newincome,
SUM(case when d.trxchannelid in ('UPOP_POS_YLBMZ9010','UPOP_POS_YLBM9010(DH)','ICBC_POS_GHXY9010N') then 0 else (d.newcostpredict * i.salesscale * i.yejiscale) end) as newcost,
SUM(d.managefeepredict * i.salesscale * i.yejiscale) as managefeepredict,
SUM(d.externalcostpredict * i.salesscale * i.yejiscale) as externalcostpredict
from db2inst1.dailytrxstat d 
left join db2inst1.publisheddailyinfo i on (d.receiverid=i.custid and i.trxdate=d.trxdate) 
where d.receiverid is not null 
and d.receiverid not in (524857,980067,11219567) 
AND d.ISCOMPUTEPROFIT = 1 
AND d.type NOT IN('SettleTransf','COMMISSION','COMMISSION_HK','POSSHARECOST') 
AND d.trxdate >= ${START} AND d.trxdate < ${STOP} 
group by 
d.trxdate,
i.transfdate,
d.trxdate,
d.receiverid,
d.payerid,
d.biztypeid,
d.type,
d.product_code,
d.sales_product_code,
i.custnum,
i.custname,
i.salesid,
i.salesname,
i.isself,
i.isshare,
i.salesscale,
i.yejishuxing,
i.yejiscale,
i.vmark,
i.vipmark,
i.branchcompany,
i.businesscatid,
i.subbusinesscat 
with ur",reportdb
publisheddailyinfo,publisheddailyinfo,"select 
COALESCE(CHAR(date(${START})),'null')||COALESCE(CHAR(date(r.transfdate)),'null')||COALESCE(CHAR(c.id),'null')||COALESCE(CHAR(c.customernumber),'null')||COALESCE(CHAR(c.fullname),'null')||COALESCE(CHAR(COALESCE(r.employeeid,25)),'null')||COALESCE(CHAR(em.name),'null')||COALESCE(CHAR(r.isself),'null')||COALESCE(CHAR(r.isself),'null')||COALESCE(CHAR(COALESCE(r.shareScale,1)),'null')||COALESCE(CHAR(a.ACHIEVEMENT_ID),'null')||COALESCE(CHAR(a.percent),'null')||COALESCE(CHAR(c.vmark),'null')||COALESCE(CHAR(c.vipmark),'null')||COALESCE(CHAR(em.branchcompany),'null')||COALESCE(CHAR(c.bussinesscatid),'null')||COALESCE(CHAR(c.subbusinesscat),'null')||'publisheddailyinfo' as IDNOUSE,
date(${START}) as trxdate,
date(r.transfdate) as transfdate,
c.id as custid,
c.customernumber as custnum,
c.fullname as custname,
COALESCE(r.employeeid,25) as salesid,
em.name as salesname,
r.isself as isself,
r.isself as isshare,
COALESCE(r.shareScale,1) as salesscale,
a.ACHIEVEMENT_ID as yejishuxing,
a.percent as yejiscale,
c.vmark as vmark,
c.vipmark as vipmark,
em.branchcompany as branchcompany,
c.bussinesscatid as businesscatid,
c.subbusinesscat as subbusinesscat 
from db2inst1.customerinfo c 
left join db2inst1.customerrelationship r on c.id=r.customerid 
left join db2inst1.employeeinfo em on r.employeeid=em.id 
LEFT JOIN (select customer_number,ACHIEVEMENT_ID,sum(percent) as percent from db2inst1.customer2achievement 
           group by customer_number,ACHIEVEMENT_ID) as a on c.customernumber=a.customer_number 
where c.createtime < ${STOP}   with ur",reportdb
interAvailable,ava_total,"select A.*,NVL(B.errcnt,0) AS SPECIAL_ERROR_CNT,NVL(C.ERR10017,0) AS MATCH_ERROR_CNT FROM
(select  max(t.id) as ID,TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,TRADE_INTERFACE,BANKID,count(*) as TOTAL_CNT from BANK.TBL_BANK_NOCARD_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP} and REQUEST_TYPE in ('PAY','AUTH')
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),TRADE_INTERFACE,BANKID) AS A
left join
(select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,TRADE_INTERFACE,BANKID,count(*) as errcnt from BANK.TBL_BANK_NOCARD_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}  and REQUEST_TYPE in ('PAY','AUTH') and 
exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('700001','700002','700004','700005','700006','700007','700008','700009','700010','700011','700012','700013','700014','700015',
'701005','701019','701020','701024','702000','702001','702002','702003','702004','702005','702006','702007','702008','703001','703002',
'703003','705048','705053','705054','705055','705056','705057','705058','706002','706003','706004','706005','706006','706007','706008',
'706012','706013','706014','706015','706016','707001','707002','707003','707004','707005','707006','707008','707009','708004','709001',
'709004','709008','709009','709010','709012','7070010','7070011','7090041','7090042','700003','100017')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),TRADE_INTERFACE,BANKID) AS B
ON A.DATES=B.DATES AND A.TRADE_INTERFACE=B.TRADE_INTERFACE AND A.BANKID=B.BANKID
left join
(select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,TRADE_INTERFACE,BANKID,count(*) as err10017 from BANK.TBL_BANK_NOCARD_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}   and DEAL_STATUS<>'SUCCESS' and REQUEST_TYPE in ('PAY','AUTH') AND
NOT exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('700001','700002','700004','700005','700006','700007','700008','700009','700010','700011','700012','700013','700014','700015',
'701005','701019','701020','701024','702000','702001','702002','702003','702004','702005','702006','702007','702008','703001','703002',
'703003','705048','705053','705054','705055','705056','705057','705058','706002','706003','706004','706005','706006','706007','706008',
'706012','706013','706014','706015','706016','707001','707002','707003','707004','707005','707006','707008','707009','708004','709001',
'709004','709008','709009','709010','709012','7070010','7070011','7090041','7090042','700003','100017','701021','701004','701003','701002','701009','701008','701007','701006','701015','701014','701013','701012','701011','701010','701018',
'701017','706001','705047','705046','705045','705044','705043','705042','705041','705040','705039','705038','705037','705036','705035',
'705034','705033','705032','705031','705029','705030','705028','705027','705026','705025','705024','705012','705011','705010','705009','705008',
'705007','705006','705005','705004','705003','705002','705001','704016','704015','704014','704013','704012','704011','704010','704009','704008',
'704007','704006','704005','704004','704003','704002','704001','705023','705022','709011','708022','701031','708021','709007','709006','709005',
'709003','709002','705021','705015','705016','705049','705018','705051','705050','701023','701022','704017','705017','705014','708003',
'708002','708001','707007','706010','706009','705052','707020','706019','701030','701029','701028','701026','701025','705013','701001','701016','706011')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),TRADE_INTERFACE,BANKID) AS C
ON A.DATES=C.DATES AND A.TRADE_INTERFACE=C.TRADE_INTERFACE AND A.BANKID=C.BANKID
order by A.dates
with ur",cashier_bank_standby
interOrderLost,orderlost_total,"select a.*,nvl(b.order_lost,0) as LOSTORDER_CNT  from 
(select max(t.id) AS ID,TO_CHAR(CONFIRM_TIME,'YYYY-MM-DD') dates,trade_interface,t.BANKID,count(ID) as total_cnt from BANK.TBL_BANK_NOCARD_ORDER t where t.CONFIRM_TIME >= ${START} and t.CONFIRM_TIME < ${STOP} and request_type='PAY' and DEAL_STATUS='SUCCESS' 
group by TO_CHAR(CONFIRM_TIME,'YYYY-MM-DD'),trade_interface,t.BANKID
) as a
left join
(select TO_CHAR(CONFIRM_TIME,'YYYY-MM-DD') dates,trade_interface,t.BANKID,count(ID) as order_lost from BANK.TBL_BANK_NOCARD_ORDER t where t.CONFIRM_TIME >= ${START} and t.CONFIRM_TIME < ${STOP} and request_type='PAY' and DEAL_STATUS='SUCCESS' AND DRIVE_TYPE in ('REPAIR_QUERY', 'REPAIR_CHECK','REPAIR_COMPULSORY','REPAIR_MANUAL')
group by TO_CHAR(CONFIRM_TIME,'YYYY-MM-DD'),trade_interface,t.BANKID
) as B
on a.dates=b.dates and a.trade_interface=b.trade_interface and a.BANKID=b.BANKID
with ur
",cashier_bank_standby
interAvaMonitor,avamonitor,"select A.*,nvl(B.errcnt,0) as SPECIAL_ERROR_CNT,nvl(C.ERR10017,0) as MATCH_ERROR_CNT,1-ROUND((cast(nvl(b.errcnt,0) as double)+cast(nvl(c.ERR10017,0) as double))/a.total_CNT,4) as ava_rate FROM
(select max(t.id) as ID,TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,HOUR(t.CREATE_TIME) AS HOURS,TRADE_INTERFACE,BANKID,count(*) as TOTAL_CNT from BANK.TBL_BANK_NOCARD_ORDER as t
where  t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP} and REQUEST_TYPE in ('PAY','AUTH')
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),HOUR(t.CREATE_TIME),TRADE_INTERFACE,BANKID) AS A
left join
(select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,HOUR(t.CREATE_TIME) AS HOURS,TRADE_INTERFACE,BANKID,count(*) as errcnt from BANK.TBL_BANK_NOCARD_ORDER as t
where  t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP} and REQUEST_TYPE in ('PAY','AUTH') and 
exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('700001', '700002', '700005', '700006', '700007', '700008', '701020', '701024', '702000', '702001', '702003', '702005', '702006', '702007', '706001', '706002', '706003', '706004', '706005', '706006', '706007', '706010', '707001', '707002', '707003', '707004', '707005', '707006', '100017')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),HOUR(t.CREATE_TIME),TRADE_INTERFACE,BANKID) AS B
ON A.DATES=B.DATES  AND A.HOURS=B.HOURS AND A.TRADE_INTERFACE=B.TRADE_INTERFACE AND A.BANKID=B.BANKID
left join
(select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,HOUR(t.CREATE_TIME) AS HOURS,TRADE_INTERFACE,BANKID,count(*) as err10017 from BANK.TBL_BANK_NOCARD_ORDER as t
where  t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}   and DEAL_STATUS<>'SUCCESS' and REQUEST_TYPE in ('PAY','AUTH') AND
NOT exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('700001','700002','700003','700004','700005','700006','700007','700008','700009','700010','701001','701002','701003','701004','701005','701006','701007','701008','701009','701010','701011','701012','701013','701014','701015','701016','701017','701018','701019','701020','701021','701022','701023','701024','701025','701026','701027','701028','701029','701030','702000','702001','702002','702003','702004','702005','702006','702007','703001','703002','703003','704001','704002','704003','704004','704005','704006','704007','704008','704009','704010','704011','704012','704013','704014','704015','704016','704017','705018','706019','707020','708021','705001','705002','705003','705004','705005','705006','705007','705008','705009','705010','705011','705012','705013','705014','705015','705016','705017','705019','705020','705021','705022','705023','705024','705025','705026','705027','705028','705029','705030','705031','705032','705033','705034','705035','705036','705037','705038','705039','705040','705041','705042','705043','705044','705045','705046','705047','705048','705049','705050','705051','705052','706001','706002','706003','706004','706005','706006','706007','706008','706009','706010','707001','707002','707003','707004','707005','707006','707007','708001','708002','708003','709001','709002','709003','709004','709005','709006','709007')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),HOUR(t.CREATE_TIME),TRADE_INTERFACE,BANKID) AS C
ON A.DATES=C.DATES AND A.HOURS=B.HOURS  AND A.TRADE_INTERFACE=C.TRADE_INTERFACE AND A.BANKID=C.BANKID
order by A.dates
with ur",cashier_bank
interLostMonitor,LostMonitor,"select a.*,NVL(b.order_lost,0) AS LOSTORDER_CNT,ROUND(cast(nvl(b.ORDER_LOST,0) as double)/a.total_CNT,4) as lostrate from 
(select max(t.id) as ID,TO_CHAR(CONFIRM_TIME,'YYYY-MM-DD') dates,HOUR(t.CONFIRM_TIME) AS HOURS,trade_interface,t.BANKID,count(ID) as total_CNT from BANK.TBL_BANK_NOCARD_ORDER t where t.CONFIRM_TIME >= ${START} and t.CONFIRM_TIME < ${STOP} and request_type='PAY' and DEAL_STATUS='SUCCESS' 
group by TO_CHAR(CONFIRM_TIME,'YYYY-MM-DD'),HOUR(t.CONFIRM_TIME),trade_interface,t.BANKID
) as a
left join
(select TO_CHAR(CONFIRM_TIME,'YYYY-MM-DD') dates,HOUR(t.CONFIRM_TIME) AS HOURS,trade_interface,t.BANKID,count(ID) as order_lost from BANK.TBL_BANK_NOCARD_ORDER t where t.CONFIRM_TIME >= ${START} and t.CONFIRM_TIME < ${STOP} and request_type='PAY' and DEAL_STATUS='SUCCESS' AND DRIVE_TYPE in ('REPAIR_QUERY', 'REPAIR_CHECK','REPAIR_COMPULSORY','REPAIR_MANUAL')
group by TO_CHAR(CONFIRM_TIME,'YYYY-MM-DD'),HOUR(t.CONFIRM_TIME),trade_interface,t.BANKID
) as B
on a.dates=b.dates AND A.HOURS=B.HOURS and a.trade_interface=b.trade_interface and a.BANKID=b.BANKID
ORDER BY DATES,HOURS
with ur

",cashier_bank_standby
interMultiCode,multiCode_total,"select A.*,${STOP}  AS DATES,B.BIZ_CODE,C.BIZ_MSG from (Select max(id) as ID,TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG,count(*) over(partition by TRADE_INTERFACE,BANKID,BANK_RETURN_CODE) as MULTICNT from BANK.TBL_BANK_NOCARD_ORDER 
WHERE CREATE_TIME >=${START} AND CREATE_TIME <${STOP} AND BANK_RETURN_CODE IS NOT NULL AND BANK_RETURN_MSG IS NOT NULL
group by TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG) AS A
LEFT JOIN
BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR AS B 
ON A.TRADE_INTERFACE=B.GROUP_ID AND A.BANK_RETURN_CODE=B.BANK_CODE
LEFT JOIN 
BANK.TBL_BANK_BUSINESSCODE AS C 
ON B.BIZ_CODE=C.BIZ_CODE
 where MULTICNT>1 AND MULTICNT<100
with ur
",cashier_bank
ehremployeeinfo,td_oa_mb,"select GONGHAO,MOBIL_NO from user where NOT_LOGIN = 0",td_oa
ehremployeeinfo,td_oa_qq,"select GONGHAO,OICQ_NO from user where NOT_LOGIN = 0",td_oa
ehremployeeinfo,td_oa_user,"select GONGHAO,USER_NAME from user where NOT_LOGIN = 0",td_oa
proqualityNoticeAvarate,NoticeAvarate_total,"select A.ID,'NOTICE' AS PRODUCT_TYPE,TO_CHAR(A.DATES,'YYYY-MM-DD HH24:MI:SS') AS HAPPEN_DATE,A.TOTAL_CNT AS TRADE_COUNT,nvl(B.errcnt,0) +nvl(C.ERR10017,0) as CARDHOLDER_COUNT,1-ROUND((cast(nvl(b.errcnt,0) as double)+cast(nvl(c.ERR10017,0) as double))/a.total_CNT,4) as SERVICE_SUCCESS_RATE FROM
(select max(t.id) as ID,TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,count(*) as TOTAL_CNT from BANK.TBL_BANK_NOCARD_ORDER as t
where t.CREATE_TIME >=${START} and t.CREATE_TIME < ${STOP} and REQUEST_TYPE in ('PAY','AUTH')
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD')) AS A
left join
(select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,count(*) as errcnt from BANK.TBL_BANK_NOCARD_ORDER as t
where t.CREATE_TIME >=${START} and t.CREATE_TIME < ${STOP} and REQUEST_TYPE in ('PAY','AUTH') and 
exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('700001', '700002', '700005', '700006', '700007', '700008', '701020', '701024', '702000', '702001', '702003', '702005', '702006', '702007', '706001', '706002', '706003', '706004', '706005', '706006', '706007', '706010', '707001', '707002', '707003', '707004', '707005', '707006', '100017')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD')) AS B
ON A.DATES=B.DATES 
left join
(select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,count(*) as err10017 from BANK.TBL_BANK_NOCARD_ORDER as t
where  t.CREATE_TIME >=${START} and t.CREATE_TIME < ${STOP}  and DEAL_STATUS<>'SUCCESS' and REQUEST_TYPE in ('PAY','AUTH') AND
NOT exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('700001','700002','700003','700004','700005','700006','700007','700008','700009','700010','701001','701002','701003','701004','701005','701006','701007','701008','701009','701010','701011','701012','701013','701014','701015','701016','701017','701018','701019','701020','701021','701022','701023','701024','701025','701026','701027','701028','701029','701030','702000','702001','702002','702003','702004','702005','702006','702007','703001','703002','703003','704001','704002','704003','704004','704005','704006','704007','704008','704009','704010','704011','704012','704013','704014','704015','704016','704017','705018','706019','707020','708021','705001','705002','705003','705004','705005','705006','705007','705008','705009','705010','705011','705012','705013','705014','705015','705016','705017','705019','705020','705021','705022','705023','705024','705025','705026','705027','705028','705029','705030','705031','705032','705033','705034','705035','705036','705037','705038','705039','705040','705041','705042','705043','705044','705045','705046','705047','705048','705049','705050','705051','705052','706001','706002','706003','706004','706005','706006','706007','706008','706009','706010','707001','707002','707003','707004','707005','707006','707007','708001','708002','708003','709001','709002','709003','709004','709005','709006','709007')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD')) AS C
ON A.DATES=C.DATES 
left join
(select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,count(*) as FAILCNT from BANK.TBL_BANK_NOCARD_ORDER as t
where  t.CREATE_TIME >=${START} and t.CREATE_TIME < ${STOP}  and REQUEST_TYPE in ('PAY','AUTH') and DEAL_STATUS<>'SUCCESS'
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD')) AS D
ON A.DATES=D.DATES 
order by A.dates
with ur",cashier_bank_standby
proqualityRefundAvarate,RefundAvarate_E,"select a.*,'REFUND' AS PRODUCT_TYPE,b.SUCCESS_COUNT,ROUND(cast(nvl(b.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from 
(select MAX(record.ID) AS ID,to_char(date(detail.CREATE_TIME),'yyyy-mm-dd hh24:mi:ss') as happen_date,count(1) as TRADE_COUNT
		from 
			REFUND.TBL_REFUND_PROCESS_RECORD record
		left join
			REFUND.TBL_REFUND_DETAIL detail
		on
			detail.ID = record.REFUND_REQUEST_DETAIL_ID
		where 
		detail.CREATE_TIME >= ${START}  and detail.CREATE_TIME < ${STOP}
                group by to_char(date(detail.CREATE_TIME),'yyyy-mm-dd hh24:mi:ss')) as  a
 join
(select to_char(date(detail.CREATE_TIME) ,'yyyy-mm-dd hh24:mi:ss') as happen_date,count(1) as SUCCESS_COUNT from 
			REFUND.TBL_REFUND_PROCESS_RECORD record
		left join
			REFUND.TBL_REFUND_DETAIL detail
		on
			detail.ID = record.REFUND_REQUEST_DETAIL_ID
		where 
			record.finish_time is not NULL
			and detail.CREATE_TIME >= ${START}  and detail.CREATE_TIME < ${STOP}
    	                and days(record.finish_time) - days(detail.create_time) between 0 and 3 
                        group by to_char(date(detail.CREATE_TIME),'yyyy-mm-dd hh24:mi:ss')) as b
on a.happen_date=b.happen_date
		with ur
",cashier_bank_standby
proqualityPosAvarate,PosAvarate_total,"select TO_CHAR(t.ORDER_RECEIVE_TIME,'YYYY-MM-DD HH24:MI') AS HAPPEN_DATE,'POS' AS  PRODUCT_TYPE,count(*) TRADE_COUNT from POSWRITE.TBL_POS_POSTRXREQUEST as t
where t.ORDER_RECEIVE_TIME >= ${START} and t.ORDER_RECEIVE_TIME < ${STOP}
and TRX_TYPE in ('PURCHASE','PRE_AUTHORIZATION_COMPLETION')
group by TO_CHAR(t.ORDER_RECEIVE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(t.ORDER_RECEIVE_TIME,'YYYY-MM-DD HH24:MI')
with ur",opendb
proqualityPosAvarate,PosAvarate_succ,"select TO_CHAR(t.ORDER_RECEIVE_TIME,'YYYY-MM-DD HH24:MI') AS HAPPEN_DATE,count(*) SUCCESS_COUNT from POSWRITE.TBL_POS_POSTRXREQUEST as t
where t.ORDER_RECEIVE_TIME >=${START} and t.ORDER_RECEIVE_TIME< ${STOP}
   and t.TRX_TYPE in ('PURCHASE','PRE_AUTHORIZATION_COMPLETION')
   and t.TRX_PROCESS_STATUS='SUCCESS'
group by TO_CHAR(t.ORDER_RECEIVE_TIME,'YYYY-MM-DD HH24:MI')
order by TO_CHAR(t.ORDER_RECEIVE_TIME,'YYYY-MM-DD HH24:MI')
with ur",opendb
proqualityPayprocessAvarate,PayprocessAvarate_E,"select a.ID,to_char(a.DATES,'YYYY-MM-DD HH24:MI:SS') AS HAPPEN_DATE,'PAYPROCESS' AS PRODUCT_TYPE,a.SUCCESS_COUNT,a.TRADE_COUNT,ROUND(cast(nvl(a.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from 
(select to_char(CREATE_TIME,'YYYY-MM-DD') AS DATES, max(id) as ID,SUM(case when PAY_STATUS = 'SUCCESS' then 1 else 0 end) AS SUCCESS_COUNT, COUNT(ID) AS TRADE_COUNT
from PP.TBL_PAYMENT_REQUEST t
where t.CREATE_TIME >=${START} and t.CREATE_TIME < ${STOP}
group by to_char(CREATE_TIME,'YYYY-MM-DD')) as a 
with ur
",dzh_standby
proqualityOlbankSuccrate,OlbankSuccrate_E,"select a.ID,to_char(a.DATES,'YYYY-MM-DD HH24:MI:SS') AS HAPPEN_DATE,'NETSUCCRATE' AS PRODUCT_TYPE,a.SUCCESS_COUNT,a.TRADE_COUNT,ROUND(cast(nvl(a.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from 
(select to_char(CREATE_TIME,'YYYY-MM-DD') AS DATES, min(RECORD_NO) as ID,SUM(case when STATUS = 'SUCCESS' then 1 else 0 end) AS SUCCESS_COUNT, COUNT(*) AS TRADE_COUNT
from PP.TBL_PAYMENT_PAY_RECORD 
where CREATE_TIME >= ${START} AND  CREATE_TIME < ${STOP}
and PLATFORM_TYPE = 'NET'
group by to_char(CREATE_TIME,'YYYY-MM-DD')) as a 
with ur",dzh_standby
proqualityWalletAvarate,WalletAvarate_total,"SELECT r.HAPPEN_DATE, SUM(TRADE_COUNT) AS TRADE_COUNT FROM
(SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS TRADE_COUNT FROM frontend.TBL_FRONTEND_PAY_RECORD AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
UNION ALL
SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS TRADE_COUNT FROM frontend.TBL_FRONTEND_PAY_RECORD_ZFB AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')) AS r 
GROUP BY r.HAPPEN_DATE
WITH ur",dzh_standby
proqualityWalletAvarate,WalletAvarate_succ,"SELECT r.HAPPEN_DATE, SUM(SUCCESS_COUNT) AS SUCCESS_COUNT FROM
(SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS SUCCESS_COUNT FROM frontend.TBL_FRONTEND_PAY_ORDER AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
AND PAY_STATUS='SUCCESS'
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
UNION ALL
SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS SUCCESS_COUNT FROM frontend.TBL_FRONTEND_PAY_ORDER_ZFB AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
AND PAY_STATUS='SUCCESS'
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')) AS r 
GROUP BY r.HAPPEN_DATE
WITH ur",dzh_standby
proqualityOnekeySuccrate,OnekeySuccrate_total,"select a.ID,to_char(a.DATES,'YYYY-MM-DD HH24:MI:SS') AS HAPPEN_DATE,'ONEKEYSUCCRATE' AS PRODUCT_TYPE,a.SUCCESS_COUNT,a.TRADE_COUNT,ROUND(cast(nvl(a.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from 
(select to_char(CREATE_TIME,'YYYY-MM-DD') AS DATES, min(RECORD_NO) as ID,SUM(case when STATUS = 'SUCCESS' then 1 else 0 end) AS SUCCESS_COUNT, COUNT(*) AS TRADE_COUNT
from PP.TBL_PAYMENT_PAY_RECORD 
where CREATE_TIME >= ${START} AND  CREATE_TIME < ${STOP}
and PLATFORM_TYPE = 'NCPAY'
group by to_char(CREATE_TIME,'YYYY-MM-DD')) as a 
with ur",dzh_standby
proqualityWalletSuccrate,WalletSuccrate_total,"select a.ID,to_char(a.DATES,'YYYY-MM-DD HH24:MI:SS') AS HAPPEN_DATE,'WALLETSUCCRATE' AS PRODUCT_TYPE,a.SUCCESS_COUNT,a.TRADE_COUNT,ROUND(cast(nvl(a.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from 
(select to_char(CREATE_TIME,'YYYY-MM-DD') AS DATES, min(RECORD_NO) as ID,SUM(case when STATUS = 'SUCCESS' then 1 else 0 end) AS SUCCESS_COUNT, COUNT(*) AS TRADE_COUNT
from PP.TBL_PAYMENT_PAY_RECORD 
where CREATE_TIME >= ${START} AND  CREATE_TIME < ${STOP}
and PLATFORM_TYPE IN ('ALIPAY','OPEN_UPOP','WECHAT')
group by to_char(CREATE_TIME,'YYYY-MM-DD')) as a 
with ur",dzh_standby
proqualityArrivalAvarate,ArrivalAvarate_total,"select TO_CHAR(aa.day1,'YYYY-MM-DD HH24:MI:SS') AS ID,TO_CHAR(aa.day1,'YYYY-MM-DD HH24:MI:SS') AS HAPPEN_DATE,'ARRIVAL' AS PRODUCT_TYPE,(aa.TOTALSUCCESS+aa.TOTALFAIL+aa.TOTALDOING+aa.TOTALUNKNOW) AS TRADE_COUNT,(aa.TOTAL1HSUCCESS+aa. TOTAL1HFAIL) as SUCCESS_COUNT,double(aa. TOTAL1HSUCCESS+aa. TOTAL1HFAIL)/double(aa. TOTALSUCCESS+aa. TOTALFAIL+aa. TOTALDOING+aa. TOTALUNKNOW) as SERVICE_SUCCESS_RATE from (
select 
	to_char(t.mctCreateDate,'yyyy-MM-dd') as day1,
	sum(case
		when  t.bankTrxStatus='SUCCESS' then 1 else 0 end) totalsuccess,
	sum(case 
		when  t.bankTrxStatus='FAIL' then 1 else 0 end) totalfail,
	sum(case 
		when t.bankTrxStatus='DOING' then 1 else 0 end) totaldoing,
	sum(case 
		when  t.bankTrxStatus='UNKNOW' then 1 else 0 end) totalunknow,
	sum(case 
		when  timestampdiff(4,char(ti.createDate-t.mctCreateDate))<=60 and t.bankTrxStatus='SUCCESS' then 1 else 0 end) as total1hsuccess,
	sum(case 
		when  timestampdiff(4,char(tr.failDate-t.mctCreateDate))<=60 and t.bankTrxStatus='FAIL' then 1 else 0 end) as total1hfail
from 
	mobilebe.transfer t
left join 
	mobilebe.tbl_balance_request tr on t.id=tr.id
left join 
	mobilebe.transferExtInfo ti on t.id=ti.transfer_id and ti.extSource='REMITTIME_3G' 
left join 
        mobilebe.transferExtInfo ti2 on t.id=ti2.transfer_id and ti2.extSource = 'CHANNELID3G22G' 
where 
        t.mctCreateDate>=${START}
 	and t.mctCreateDate< ${STOP}
       and t.busitype='TRANSFEXT_INDAY' and t.urgency=1 
 	group by to_char(t.mctCreateDate,'yyyy-MM-dd')
 	) aa
with ur",COPY2
proqualityDAIFUDAIFA1,DAIFUDAIFA1_total,"select TO_CHAR(aa.day1,'YYYY-MM-DD HH24:MI:SS') AS ID,TO_CHAR(aa.day1,'YYYY-MM-DD HH24:MI:SS') AS HAPPEN_DATE,'DFDF1' AS PRODUCT_TYPE,(aa.TOTALSUCCESS+aa.TOTALFAIL+aa.TOTALDOING+aa.TOTALUNKNOW) AS TRADE_COUNT,(aa.TOTAL1HSUCCESS+aa. TOTAL1HFAIL) as SUCCESS_COUNT,double(aa. TOTAL1HSUCCESS+aa. TOTAL1HFAIL)/double(aa. TOTALSUCCESS+aa. TOTALFAIL+aa. TOTALDOING+aa. TOTALUNKNOW) as SERVICE_SUCCESS_RATE from (
select 
	to_char(t.mctCreateDate,'yyyy-MM-dd') as day1,
	sum(case
		when  t.bankTrxStatus='SUCCESS' then 1 else 0 end) totalsuccess,
	sum(case 
		when  t.bankTrxStatus='FAIL' then 1 else 0 end) totalfail,
	sum(case 
		when t.bankTrxStatus='DOING' then 1 else 0 end) totaldoing,
	sum(case 
		when  t.bankTrxStatus='UNKNOW' then 1 else 0 end) totalunknow,
	sum(case 
		when  timestampdiff(4,char(ti.createDate-t.mctCreateDate))<=60 and t.bankTrxStatus='SUCCESS' then 1 else 0 end) as total1hsuccess,
	sum(case 
		when  timestampdiff(4,char(tr.failDate-t.mctCreateDate))<=60 and t.bankTrxStatus='FAIL' then 1 else 0 end) as total1hfail
from 
	mobilebe.transfer t
left join 
	mobilebe.tbl_balance_request tr on t.id=tr.id
left join 
	mobilebe.transferExtInfo ti on t.id=ti.transfer_id and ti.extSource='REMITTIME_3G' 
left join 
        mobilebe.transferExtInfo ti2 on t.id=ti2.transfer_id and ti2.extSource = 'CHANNELID3G22G' 
where        t.mctCreateDate>= ${START}
 	and t.mctCreateDate< ${STOP}
       and t.busitype='TRANSFEXT' and t.urgency=1 and hour(t.mctCreateDate)>=9 and hour(t.mctCreateDate)<=17        
 	group by to_char(t.mctCreateDate,'yyyy-MM-dd')
 	) aa with ur",COPY2
risktest,rk_syn,"SELECT
COALESCE(MEC_NO, 'null')||COALESCE(PAY_ID, 'null') ||COALESCE(to_char(OCC_TM,'YYYYMMDDHH24MISS'),'null') AS IDNOUSE,
BIZ,MEC_NO,PAY_ID,USE_TOOL,PROD,PAYWAY,DOORGOD_RETCODE,SUB_SYS,DOORGOD_TM,AMT, GOODS_IF,OCC_TM,REQ_ID
FROM
TL.TBL_RRS_SYNREQ
WHERE
OCC_TM >= ${START} and OCC_TM < ${STOP}
AND biz != 'EPOS' and (prod = 'NOCARDPAY' or prod = 'FE' or prod = 'CFL')
WITH UR",tldb
risktest,rk_asy,"SELECT 
COALESCE(MEC_NO, 'null')||COALESCE(PAY_TID ,'null')||COALESCE(to_char(OCC_TM,'YYYYMMDDHH24MISS'),'null')||COALESCE(PAY_RESULT, 'null') as IDNOUSE,
REQ_IF
FROM 
TL.TBL_RRS_ASYNREQ
WHERE 
OCC_TM >= ${START} and OCC_TM < ${STOP}
AND biz != 'EPOS' and (prod = 'NOCARDPAY' or prod = 'FE' or prod = 'CFL')
WITH UR",tldb
riskTst,rk_sync,"SELECT
COALESCE(MEC_NO, 'null')||COALESCE(PAY_ID, 'null') ||COALESCE(to_char(OCC_TM,'YYYYMMDDHH24MISS'),'null') AS IDNOUSE,
BIZ,MEC_NO,PAY_ID,USE_TOOL,PROD,PAYWAY,DOORGOD_RETCODE,SUB_SYS,DOORGOD_TM,AMT, GOODS_IF,OCC_TM
FROM
TL.TBL_RRS_SYNREQ
WHERE
OCC_TM >= ${START} and OCC_TM < ${STOP}
AND biz != 'EPOS' and (prod = 'NOCARDPAY' or prod = 'FE' or prod = 'CFL')
WITH UR",tldb
customerinfo,zxdb_standby,"select NUMBER as CUSTOMERNUMBER,TAG as PRODUCTLINE from CUSCENTER.TBL_TAG",dzh_standby
proqualityWalletAvarate,excep_WalletAvarate,"select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT from frontend.TBL_FRONTEND_PAY_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
proqualityOlbankAvarate,Olbank_total,"select TO_CHAR(t.ORDERDATE,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,count(t.ID) TRADE_COUNT
from mobilebe.trxorder t
where  t.ORDERDATE >= ${START}
and t.ORDERDATE <  ${STOP}
group by TO_CHAR(t.ORDERDATE,'YYYY-MM-DD HH24:MI')
with ur",COPY2
proqualityOlbankAvarate,Olbank_succ,"select TO_CHAR(CONFIRMORCANCEL,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,count(t.ID) SUCCESS_COUNT
from MOBILEBE.trxorder t
left join MOBILEBE.payment p on p.TRXORDER_ID = t.ID
where p.trxtype = 'SALES'
and t.status = 'SUCCESS' and p.trxstatus = 'SUCCESS'
and p.PAYPRODUCT in ('NET_B2C','NET_B2B','B2B_STANDARD','B2C_STANDARD','B2C_HAPPY_A','B2C_HAPPY_A_PLUS','B2C_HAPPY_B','B2C_HAPPY_B_PLUS','B2C_HAPPY_D')
and p.CONFIRMORCANCEL >= ${START}
and p.CONFIRMORCANCEL <  ${STOP}
group by TO_CHAR(CONFIRMORCANCEL ,'YYYY-MM-DD HH24:MI')
with ur",COPY2
proqualityOlbankAvarate,excep_Olbank,"select TO_CHAR(t.TRXDATE,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT from MOBILEBE.payment as t
where t.TRXDATE>=${START} and t.TRXDATE< ${STOP}
and t.PAYPRODUCT IN ('B2B_STANDARD','B2C_STANDARD','B2C_HAPPY_A','B2C_HAPPY_A_PLUS','B2C_HAPPY_B','B2C_HAPPY_B_PLUS','B2C_HAPPY_C','B2C_HAPPY_D','NET_B2B','NET_B2C')
group by TO_CHAR(t.TRXDATE,'YYYY-MM-DD HH24:MI')
with ur
",COPY2
proqualityPosAvarate,excep_PosAvarate,"select TO_CHAR(t.ORDER_RECEIVE_TIME,'YYYY-MM-DD HH24:MI') AS HAPPEN_DATE,count(*) as CARDHOLDER_COUNT from POSWRITE.TBL_POS_POSTRXREQUEST as t 
where t.ORDER_RECEIVE_TIME >= ${START} and t.ORDER_RECEIVE_TIME< ${STOP} 
and t.TRX_TYPE in ('PURCHASE','PRE_AUTHORIZATION_COMPLETION') 
and t.RESPONSE_CODE in ('#51','#55','55','51','000001','000002','000003','000004','000005',
'000006','000007','000008','000009','000011','000012','000019','000020','000021','000022',
'000031','000032','000033','000034','000037','000038','000062','000070') 
and t.TRX_PROCESS_STATUS in ('FAIL','INIT') 
group by TO_CHAR(t.ORDER_RECEIVE_TIME,'YYYY-MM-DD HH24:MI') 
order by TO_CHAR(t.ORDER_RECEIVE_TIME,'YYYY-MM-DD HH24:MI') 
with ur",opendb
proqualityDAIFUDAIFA2,DAIFUDAIFA2_total,"--____¥å_è´¦ç_
 select mctdate AS HAPPEN_DATE,sum(totalcount) as TRADE_count,sum(inTimecount) as SUCCESS_count,ROUND(cast(nvl(sum(inTimecount),0) as double)/sum(totalcount),4) as SERVICE_SUCCESS_RATE,'DAIFUDAIFA2' AS PRODUCT_TYPE from ( 
select
date(mctcreat",COPY2
proqualityDFRJAvarate,DFRJAvarate_total,"select 
date AS HAPPEN_DATE,'DFRJRATE' AS PRODUCT_TYPE,1-
double(sum(
case
   when rate<=0.5 then 1
   else 0
end
))/1440 as SERVICE_SUCCESS_RATE ,sum(
case
   when rate<=0.5 then 1
   else 0
end
) as TRADE_COUNT

 from (
select 
date(${START}) as date,
hour(${START}) as hours,
minute(${START}) as minutes,
count(*) as count,
sum(
case
        when (error_code is null or error_code='') then 1
        else 0
end
) as successcount,

double(sum(
case
        when (error_code is null or error_code='') then 1
        else 0
end
))/double(count(*)) as rate
 from BAC.TBL_BALANCE_REQUEST_ACCESS a group by date(${START}) ,hour(${START}) ,minute(${START}) having count(*)>10 ) group by date order by date desc",zxdb_standby
CHANGANBAOXIANDZ,YMFTRX,"select 
a.ID AS ID,a.CUSTOMER_NUMBER AS CUSTOMER_NUMBER,a.CREATE_TIME AS CREATE_TIME,
case p.TRX_TYPE when 'PURCHASE' then 'æ¶_´¹' when 'REFUND' then '_æ¬' end AS TRX_TYPE,q.SHOP_NAME AS SHOP_NAME,a.SAN_CODE AS SCAN_CODE,
a.CUSTOMER_ORDER_ID AS CUSTOMER_ORDER_ID,a.REAL_AMT AS REAL_AMOUNT,a.FEE AS FEE,
a.PAY_CONFIRM AS PAY_CONFIRM,case p.PAY_SOURCE when 'NCPAY' then '___' 
when 'ALIPAY' then '__å®' when 'WECHAT' then 'å¾¿¡__' when 'CFL' then '_____' 
when 'NET' then 'ç½____' when 'UPOP' then '_¶è_' else p.PAY_SOURCE end as PAY_SOURCE
from YMF.YMF_ORDER a 
left join YMF.YMF_PAYMENT p on p.ORDER_ID=a.ID
left join YMF.YMF_QRCODE q on q.QR_ID=a.SAN_CODE
where  a.CUSTOMER_NUMBER ='10013398920' 
and a.ORDER_STATUS='SUCCESS'
and p.TRX_TYPE='PURCHASE'
and a.CREATE_TIME>=${START}  
and a.CREATE_TIME<${STOP}
with ur",zxdb_standby
TONGCHENGTRX,CHANGANBAOXIANTRX,"SELECT  
    a.EXTERNAL_ID AS notes,
    p.PAY_TIME AS trx_time,
    '' AS account_type,
    '' AS business_type,
    a.CUSTOMER_ORDER_ID AS  merchant_orderid, 
    a.REAL_AMT AS income,
    0 AS expenditure,
    a.FEE AS fee,
    0 AS balance,
    'CHANGANBAOXIAN' AS extended_info, 
    '' AS order_number,
    a.PAY_CONFIRM AS refund_id,
    case p.PAY_SOURCE when 'NCPAY' then '___' 
    when 'ALIPAY' then '__å®' when 'WECHAT' then 'å¾¿¡__' when 'CFL' then '_____' 
    when 'NET' then 'ç½____' when 'UPOP' then '_¶è_' else p.PAY_SOURCE end  AS card_type,
    case p.TRX_TYPE when 'PURCHASE' then 'æ¶_´¹' when 'REFUND' then '_æ¬' end AS trx_type,
    a.SAN_CODE AS card_four,
    q.SHOP_NAME AS bank,
    p.PAY_TIME AS COPY_TIME,
SUBSTR (a.CUSTOMER_NUMBER, 4)  AS customer_no,
    'YMF' as BUSINESS_OWN
from YMF.YMF_ORDER a 
left join YMF.YMF_PAYMENT p on p.ORDER_ID=a.ID
left join YMF.YMF_QRCODE q on q.QR_ID=a.SAN_CODE
where  a.CUSTOMER_NUMBER ='10013398920' 
and a.ORDER_STATUS='SUCCESS'
and p.TRX_TYPE='PURCHASE'
and a.CREATE_TIME>=${START}  
and a.CREATE_TIME<${STOP}
with ur",dzh_standby
proqualityRecordedAvarate,RecordedAvarate_total,"select 'RZRATE' AS PRODUCT_TYPE,a.HAPPEN_DATE,a.TRADE_COUNT,b.SUCCESS_COUNT,ROUND(cast(nvl(b.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from 
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS TRADE_COUNT FROM cs.tbl_process_trxorder_1804 WHERE create_date >=${START} AND create_date < ${STOP} AND order_status='SUCCESS' AND BIZ_SYSTEM IN( 'ZGT', '2GTRADE', 'YJZF' ) GROUP BY  date(create_date)) AS a left join 
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS SUCCESS_COUNT FROM cs.tbl_process_trxorder_1804 WHERE (update_date-create_date) < 300 AND BIZ_SYSTEM IN( 'ZGT', '2GTRADE', 'YJZF' ) and create_date >=${START} AND create_date <  ${STOP} AND order_status='SUCCESS' GROUP BY  date(create_date) )as b  on a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR",zxdb_standby
TONGCHENGREFUND,AIRPOSFIXREFUND2,"select 
 concat(d.COREPLATFORM_EXTERNAL_ID,char(cast(d.REFUND_AMOUNT as numeric(18, 2)))) as refund_key,
d.CUSTOMER_REFUND_NUMBER AS refund_id
 
        
from  
    TBL_POS_REFRECORD d
where 
    CUSTOMER_NUMBER in ('10012233889','10013518017','10013187696','10013187725','10013193318','10013393051','10013397709','10012408639','10013675715')
    and REFUND_TIME >= ${START} and REFUND_TIME < ${STOP}
    and RECORD_STATUS='SUCCESS'",opendb
accnttransf,accnttransf1,"select coalesce(char(DATE(CREATEDATE)),'null')||coalesce(char(TARGETCUSTOMERID),'null')||coalesce(char(TRANSFERTYPE),'null')||'transf' as IDNOUSE,
year(DATE(CREATEDATE))*100+month(DATE(CREATEDATE)) as MONTH,
DATE(CREATEDATE) AS TRXDATE ,
DATE(CREATEDATE) AS TRUE_TRXDATE ,
TARGETCUSTOMERID AS RECEIVERID ,
TRANSFERTYPE AS ORDERTYPE ,
11 AS BIZTYPEID ,
'ACCN' AS DATAORIGIN ,
case when TRANSFERTYPE='TRANSFER' then 'EXTERNAL_TRANSF' when TRANSFERTYPE='TOGATHER' then 'Togather' when TRANSFERTYPE='ALLOCATE' then 'Allocate'   end AS TYPE ,
'MERCHANT_ACCOUNT_PAY' AS PAYPRODUCT ,
'3011001004002A' AS SALES_PRODUCT_CODE ,
'3011001004002' AS PRODUCT_CODE ,
COALESCE(COUNT(*) ,0) AS TRANSF_COUNT ,
COALESCE(SUM(TRANSFERAMOUNT) ,0) AS TRANSF_AMOUNT ,
SUM(SRCFEE + TARGETFEE) as TRXFEE ,
0 AS ACCOUNTINGCOST ,
0 AS FRPCOST 
from MOBILEBE.TBL_TRANSFER_VOUCHER 
where TRANSFERSTATUS = 'SUCCESS' and TRANSFERTYPE in('TRANSFER','TOGATHER','ALLOCATE') 
and CREATEDATE>= ${START} AND CREATEDATE < ${STOP} 
GROUP BY year(DATE(CREATEDATE)),month(DATE(CREATEDATE)),
DATE(CREATEDATE),TARGETCUSTOMERID,TRANSFERTYPE 
WITH UR",accnt
accnttransf,accnttransfcust,"select customernumber as receiverid,id as custid from db2inst1.customerinfo  with ur",reportdb
proqualityPCOlbankSuccrate,PCOlbankSuccrate_E,"select t1.d as HAPPEN_DATE,'PCNETSUCCRATE' AS PRODUCT_TYPE,
t1.successCount as SUCCESS_COUNT, 
t2.totalCount as TRADE_COUNT,
ROUND(cast(nvl(t1.successCount,0) as double)/t2.totalCount,4) as SERVICE_SUCCESS_RATE
from (select date(p.CONFIRMORCANCEL) d, count(distinct p.ID) successCount
from MOBILEBE.payment p
where p.CONFIRMORCANCEL >= ${START}
and p.CONFIRMORCANCEL < ${STOP}
and p.TRXSTATUS = 'SUCCESS'
and p.TRXTYPE != 'REFUND'
and p.PAYPRODUCT in ('NET_B2C','NET_B2B','B2B_STANDARD','B2C_STANDARD','B2C_HAPPY_A','B2C_HAPPY_A_PLUS','B2C_HAPPY_B','B2C_HAPPY_B_PLUS','B2C_HAPPY_D')
group by date(p.CONFIRMORCANCEL)) t1
inner join (select date(p.CONFIRMORCANCEL) d, count(distinct p.ID) totalCount
from MOBILEBE.payment p
where p.CONFIRMORCANCEL >= ${START}
and p.CONFIRMORCANCEL < ${STOP}
and p.TRXTYPE != 'REFUND'
and p.PAYPRODUCT in ('NET_B2C','NET_B2B','B2B_STANDARD','B2C_STANDARD','B2C_HAPPY_A','B2C_HAPPY_A_PLUS','B2C_HAPPY_B','B2C_HAPPY_B_PLUS','B2C_HAPPY_D')
group by date(p.CONFIRMORCANCEL)) t2 on t1.d = t2.d
with ur",COPY2
proqualityPCOnekeySuccrate,PCOnekeySuccrate_E,"select t1.d AS HAPPEN_DATE, 'PCOKSUCCRATE' AS PRODUCT_TYPE,
t1.successCount AS SUCCESS_COUNT, 
t2.totalCount AS TRADE_COUNT,
ROUND(cast(nvl(t1.successCount,0) as double)/t2.totalCount,4) AS SERVICE_SUCCESS_RATE
from (select date(p.CONFIRMORCANCEL) d, count(distinct p.ID) successCount
from MOBILEBE.payment p
where p.CONFIRMORCANCEL >= ${START}
and p.CONFIRMORCANCEL < ${STOP}
and p.TRXSTATUS = 'SUCCESS'
and p.TRXTYPE != 'REFUND'
and p.FRP_ID = 1008001
group by date(p.CONFIRMORCANCEL)) t1
inner join (select date(p.CONFIRMORCANCEL) d, count(distinct p.ID) totalCount
from MOBILEBE.payment p
where p.CONFIRMORCANCEL >= ${START}
and p.CONFIRMORCANCEL < ${STOP}
and p.TRXTYPE != 'REFUND'
and p.FRP_ID = 1008001
group by date(p.CONFIRMORCANCEL)) t2 on t1.d = t2.d
with ur",COPY2
COMMISSIONLIKER,COMMISSIONLIKER,"SELECT coalesce(char(CUSTOMER_NUMBER),'null') ||coalesce(char(year(SHARE_TIME)),'null')||coalesce(char(month(SHARE_TIME)),'null')||'likersharecosttrx' AS IDNOUSE ,
CUSTOMER_NUMBER AS RECEIVERID ,
date(${STOP}) - 1 days as trxdate,
date(${STOP}) - 1 days as true_trxdate,
'3011001001003A' AS SALES_PRODUCT_CODE ,
'3011001001003' AS PRODUCT_CODE ,
301 AS BIZTYPEID ,
'COMMISSION_LIKER' AS TYPE ,
'POSREAD' as dataorigin ,
year(SHARE_TIME) * 100 + month(SHARE_TIME) as MONTH ,
SUM(FEE_AMOUNT) AS TRXFEE 
FROM posread.TBL_EBS_ADJUST 
WHERE SHARE_TIME >= ${START} and SHARE_TIME < ${STOP}
and SHARE_TYPE_S='301' and PRODUCT_TYPE_S ='3011001001003' and PRODUCT_CODE_S='3011001001003A'
group by CUSTOMER_NUMBER,year(SHARE_TIME),month(SHARE_TIME) 
WITH ur",opendb
interSuccRateMonitor,SuccRateMonitor_E,"SELECT A.*,2 AS TYPES,ROUND((cast(nvl(A.SPECIAL_ERROR_CNT,0) as double))/A.TOTAL_CNT,4) as ava_rate FROM (SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,HOUR(t.CREATE_TIME) AS HOURS,TRADE_INTERFACE,BANKID,MAX(ID) AS ID,count(id) as TOTAL_CNT,SUM(CASE WHEN DEAL_STATUS='SUCCESS' THEN 1 ELSE 0 END) AS SPECIAL_ERROR_CNT FROM BANK.TBL_BANK_NOCARD_ORDER t where REQUEST_TYPE='PAY' AND create_time>= ${START} and  create_time <${STOP}  GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),HOUR(t.CREATE_TIME),TRADE_INTERFACE,BANKID) AS A WITH UR",cashier_bank_standby
interAvailableMsg,AvailableMsg_E,"select P.*,Q.BIZ_CODE from (select A.*,(NVL(B.errcnt,0)+NVL(C.ERR10017,0)) AS ERROR_CNT FROM
(select  max(t.id) as ID,TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG from BANK.TBL_BANK_NOCARD_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME <${STOP} and REQUEST_TYPE in ('PAY','AUTH')
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG) AS A
left join
(select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG,count(*) as errcnt from BANK.TBL_BANK_NOCARD_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}  and REQUEST_TYPE in ('PAY','AUTH') and 
exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('700001', '700002', '700005', '700006', '700007', '700008', '701020', '701024', '702000', '702001', '702003', '702005', '702006', '702007', '706001', '706002', '706003', '706004', '706005', '706006', '706007', '706010', '707001', '707002', '707003', '707004', '707005', '707006', '100017')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG) AS B
ON A.DATES=B.DATES AND A.TRADE_INTERFACE=B.TRADE_INTERFACE AND A.BANKID=B.BANKID AND A.BANK_RETURN_CODE=B.BANK_RETURN_CODE AND A.BANK_RETURN_MSG=B.BANK_RETURN_MSG
left join
(select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD') dates,TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG,count(*) as err10017 from BANK.TBL_BANK_NOCARD_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}   and DEAL_STATUS<>'SUCCESS' and REQUEST_TYPE in ('PAY','AUTH') AND
NOT exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('700001','700002','700003','700004','700005','700006','700007','700008','700009','700010','701001','701002','701003','701004','701005','701006','701007','701008','701009','701010','701011','701012','701013','701014','701015','701016','701017','701018','701019','701020','701021','701022','701023','701024','701025','701026','701027','701028','701029','701030','702000','702001','702002','702003','702004','702005','702006','702007','703001','703002','703003','704001','704002','704003','704004','704005','704006','704007','704008','704009','704010','704011','704012','704013','704014','704015','704016','704017','705018','706019','707020','708021','705001','705002','705003','705004','705005','705006','705007','705008','705009','705010','705011','705012','705013','705014','705015','705016','705017','705019','705020','705021','705022','705023','705024','705025','705026','705027','705028','705029','705030','705031','705032','705033','705034','705035','705036','705037','705038','705039','705040','705041','705042','705043','705044','705045','705046','705047','705048','705049','705050','705051','705052','706001','706002','706003','706004','706005','706006','706007','706008','706009','706010','707001','707002','707003','707004','707005','707006','707007','708001','708002','708003','709001','709002','709003','709004','709005','709006','709007')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD'),TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG) AS C
ON A.DATES=C.DATES AND A.TRADE_INTERFACE=C.TRADE_INTERFACE AND A.BANKID=C.BANKID AND A.BANK_RETURN_CODE=C.BANK_RETURN_CODE AND A.BANK_RETURN_MSG=C.BANK_RETURN_MSG
where (NVL(B.errcnt,0)+NVL(C.ERR10017,0)) > 0) AS P LEFT JOIN BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR  AS Q
ON P.TRADE_INTERFACE  =Q.GROUP_ID AND P.BANK_RETURN_CODE =Q.BANK_CODE
with ur
",cashier_bank_standby
G2NETREMOVE,G2NETREMOVEsucc,"SELECT  coalesce(char(date(P.PAY_SUCCESS_DATE)),'null')||coalesce(char(I.MERCHANT_NO),'null')
||coalesce(char(P.CASHIER_TYPE),'null')||coalesce(char(P.FEE_WAY),'null')
||coalesce(char(P.CHANNEL_ID),'null')
||coalesce(char(P.CARD_TYPE),'null')
||coalesce(char(I.BIZ_SYSTEM_NO),'null')
||coalesce(char(P.INST_NUMBER),'null')
||coalesce(char(P.ACCOUNT_PRODUCT_CODE),'null')||coalesce(char(I.SALES_PRODUCT_CODE),'null')
||coalesce(char(P.FEE_VERSION),'null')||coalesce(char(P.BANK_ID),'null')||'G2NETREMOVEsucc' as IDNOUSE,
date(P.PAY_SUCCESS_DATE) as trxdate,
date(P.PAY_SUCCESS_DATE) as true_trxdate,
year(P.PAY_SUCCESS_DATE)*100+month(P.PAY_SUCCESS_DATE) as month,
'Sales' as type,
302 AS BIZTYPEID ,
1 as iscomputeprofit,
1 as iscomputebonus,
'SYSTEM' as usetype,
I.MERCHANT_NO as receiverid,
P.CASHIER_TYPE as payscene,
P.CHANNEL_ID as trxchannelid,
P.CARD_TYPE as cardtype,
'DS' as dataorigin,
P.INST_NUMBER as goodscate,
P.BANK_ID as bank_code,
(CASE WHEN P.ACCOUNT_PRODUCT_CODE ='ZF_QB_H5' and P.FEE_VERSION='LOW' THEN I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY||'.'||P.FEE_VERSION
ELSE I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY END) as payproduct,
COUNT(*) AS trxcount,
COALESCE(SUM(I.ORDER_AMOUNT),0) AS trxamount,
COALESCE(SUM(COALESCE(P.MERCHANT_FEE,P.CUSTOMER_FEE,0)),0) as trxfee,
COALESCE(SUM(P.COST),0) AS accountingcost,
COALESCE(SUM(P.COST),0) AS frpcost    
FROM OPR.TBL_ORDER_INFO I ,OPR.TBL_ORDER_PAYMENT P  
WHERE I.BIZ_SYSTEM_NO='G2NET' and P.UNIQUE_ORDER_NO = I.UNIQUE_ORDER_NO 
and P.PAY_SUCCESS_DATE>= ${START} and P.PAY_SUCCESS_DATE< ${STOP} 
AND I.STATUS IN ('FULLY_PAY','CS_ACCEPT','SUCCESS','REFUND','CS_SUCCESS') 
AND P.PAYMENT_PRODUCT NOT IN ('EANK')  
group by 
date(P.PAY_SUCCESS_DATE),
month(P.PAY_SUCCESS_DATE),
year(P.PAY_SUCCESS_DATE),
I.MERCHANT_NO,
P.CASHIER_TYPE,
P.CHANNEL_ID,
P.CARD_TYPE,
I.BIZ_SYSTEM_NO,
P.INST_NUMBER,
P.ACCOUNT_PRODUCT_CODE,
I.SALES_PRODUCT_CODE,
P.FEE_WAY,
P.BANK_ID,
P.FEE_VERSION 
with ur",zgt_standby
G2NETREMOVE,G2NETREMOVErefund,"SELECT 
coalesce(char(date(R.REFUND_CENTER_FINISH_DATE)),'null')
||coalesce(char(I.MERCHANT_NO),'null')
||coalesce(char(P.CASHIER_TYPE),'null')||coalesce(char(P.FEE_WAY),'null')
||coalesce(char(P.CHANNEL_ID),'null')
||coalesce(char(P.CARD_TYPE),'null')
||coalesce(char(I.BIZ_SYSTEM_NO),'null')
||coalesce(char(P.INST_NUMBER),'null')
||coalesce(char(P.ACCOUNT_PRODUCT_CODE),'null')||coalesce(char(I.SALES_PRODUCT_CODE),'null')
||coalesce(char(P.FEE_VERSION),'null')||coalesce(char(P.BANK_ID),'null')||'G2NETREMOVErefund' as IDNOUSE,
date(R.REFUND_CENTER_FINISH_DATE) as trxdate,
date(R.REFUND_CENTER_FINISH_DATE) as true_trxdate,
year(R.REFUND_CENTER_FINISH_DATE)*100+month(R.REFUND_CENTER_FINISH_DATE) as month,
'Sales' as type,
302 AS BIZTYPEID ,
1 as iscomputeprofit,
1 as iscomputebonus,
'SYSTEM' as usetype,
I.MERCHANT_NO as receiverid,
P.CASHIER_TYPE as payscene,
P.CHANNEL_ID as trxchannelid,
P.CARD_TYPE as cardtype,
'DS' as dataorigin,
P.INST_NUMBER as goodscate,
P.BANK_ID as bank_code,
(CASE WHEN P.ACCOUNT_PRODUCT_CODE ='ZF_QB_H5' and P.FEE_VERSION='LOW' THEN I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY||'.'||P.FEE_VERSION
ELSE I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY END) as payproduct,
COUNT(*) AS refundcount,
COALESCE(SUM(R.REFUND_AMOUNT),0) AS refundamount,
COALESCE(SUM(R.RETURN_MERCHANT_FEE),0) AS refundfee 
FROM OPR.TBL_REFUND_INFO R ,OPR.TBL_ORDER_INFO I ,OPR.TBL_ORDER_PAYMENT P 
WHERE I.BIZ_SYSTEM_NO='G2NET' and  I.UNIQUE_ORDER_NO = R.UNIQUE_ORDER_NO 
AND P.UNIQUE_ORDER_NO = R.UNIQUE_ORDER_NO 
AND R.STATUS IN ('SUCCESS') 
AND R.REFUND_CENTER_FINISH_DATE>= ${START} and R.REFUND_CENTER_FINISH_DATE< ${STOP}  
AND P.PAYMENT_PRODUCT NOT IN ('EANK') 
group by 
date(R.REFUND_CENTER_FINISH_DATE),
month(R.REFUND_CENTER_FINISH_DATE),
year(R.REFUND_CENTER_FINISH_DATE),
I.MERCHANT_NO,
P.CASHIER_TYPE,
P.CHANNEL_ID,
P.CARD_TYPE,
I.BIZ_SYSTEM_NO,
P.INST_NUMBER,
P.ACCOUNT_PRODUCT_CODE,I.SALES_PRODUCT_CODE, P.FEE_WAY,
P.BANK_ID,
P.FEE_VERSION  
with ur",zgt_standby
G2NETREMOVE,G2NETREMOVEtotal,"SELECT 
coalesce(char(date(I.REQUEST_DATE)),'null')
||coalesce(char(I.MERCHANT_NO),'null')
||coalesce(char(P.CASHIER_TYPE),'null')||coalesce(char(P.FEE_WAY),'null')
||coalesce(char(P.CHANNEL_ID),'null')
||coalesce(char(P.CARD_TYPE),'null')
||coalesce(char(I.BIZ_SYSTEM_NO),'null')
||coalesce(char(P.INST_NUMBER),'null')
||coalesce(char(P.ACCOUNT_PRODUCT_CODE),'null')||coalesce(char(I.SALES_PRODUCT_CODE),'null')
||coalesce(char(P.FEE_VERSION),'null')||coalesce(char(P.BANK_ID),'null')||'G2NETREMOVEtotal' as IDNOUSE,
date(I.REQUEST_DATE) as trxdate,
date(I.REQUEST_DATE) as true_trxdate,
year(I.REQUEST_DATE)*100+month(I.REQUEST_DATE) as month,
'Sales' as type,
302 AS BIZTYPEID ,
1 as iscomputeprofit,
1 as iscomputebonus,
'SYSTEM' as usetype,
I.MERCHANT_NO as receiverid,
P.CASHIER_TYPE as payscene,
P.CHANNEL_ID as trxchannelid,
P.CARD_TYPE as cardtype,
'DS' as dataorigin,
P.INST_NUMBER as goodscate,
P.BANK_ID as bank_code,
(CASE WHEN P.ACCOUNT_PRODUCT_CODE ='ZF_QB_H5' and P.FEE_VERSION='LOW' THEN I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY||'.'||P.FEE_VERSION
ELSE I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY END) as payproduct,
COUNT(*) AS wholeordercount,
COALESCE(SUM(I.ORDER_AMOUNT),0) AS wholeorderamount 
FROM OPR.TBL_ORDER_INFO I ,OPR.TBL_ORDER_PAYMENT P 
WHERE I.BIZ_SYSTEM_NO='G2NET' and P.UNIQUE_ORDER_NO = I.UNIQUE_ORDER_NO 
AND I.REQUEST_DATE>= ${START} and I.REQUEST_DATE< ${STOP} 
AND P.PAYMENT_PRODUCT NOT IN ('EANK') 
group by 
date(I.REQUEST_DATE),
month(I.REQUEST_DATE),
year(I.REQUEST_DATE),
I.MERCHANT_NO,
P.CASHIER_TYPE,
P.CHANNEL_ID,
P.CARD_TYPE,
I.BIZ_SYSTEM_NO,
P.INST_NUMBER,
P.ACCOUNT_PRODUCT_CODE,I.SALES_PRODUCT_CODE,P.FEE_WAY,P.BANK_ID,
P.FEE_VERSION     
with ur",zgt_standby
G2NETREMOVE,G2NETsalesproduct,"select payproduct,salesproductcode as sales_product_code from db2inst1.payproduct2productcode  with ur",reportdb
G2NETREMOVE,G2NETproduct,"select payproduct,productcode as product_code from db2inst1.payproduct2productcode  with ur",reportdb
G2NETREMOVE,G2NETordertype,"select payproduct,ordertype  from db2inst1.payproduct2productcode  with ur",reportdb
LK,LKsucc,"SELECT  coalesce(char(date(P.PAY_SUCCESS_DATE)),'null')||coalesce(char(I.MERCHANT_NO),'null')
||coalesce(char(P.CASHIER_TYPE),'null')||coalesce(char(P.FEE_WAY),'null')
||coalesce(char(P.CHANNEL_ID),'null')
||coalesce(char(P.CARD_TYPE),'null')
||coalesce(char(I.BIZ_SYSTEM_NO),'null')
||coalesce(char(P.INST_NUMBER),'null')
||coalesce(char(P.ACCOUNT_PRODUCT_CODE),'null')||coalesce(char(I.SALES_PRODUCT_CODE),'null')
||coalesce(char(P.FEE_VERSION),'null')||coalesce(char(P.BANK_ID),'null')||'LKsucc' as IDNOUSE,
date(P.PAY_SUCCESS_DATE) as trxdate,
date(P.PAY_SUCCESS_DATE) as true_trxdate,
year(P.PAY_SUCCESS_DATE)*100+month(P.PAY_SUCCESS_DATE) as month,
'Sales' as type,
1 as iscomputeprofit,
1 as iscomputebonus,
'SYSTEM' as usetype,
301 AS BIZTYPEID ,
I.MERCHANT_NO as receiverid,
P.CASHIER_TYPE as payscene,
P.CHANNEL_ID as trxchannelid,
P.CARD_TYPE as cardtype,
'DS' as dataorigin,
P.INST_NUMBER as goodscate,
P.BANK_ID as bank_code,
(CASE WHEN P.ACCOUNT_PRODUCT_CODE ='ZF_QB_H5' and P.FEE_VERSION='LOW' THEN I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY||'.'||P.FEE_VERSION
ELSE I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY END) as payproduct,
COUNT(*) AS trxcount,
COALESCE(SUM(I.ORDER_AMOUNT),0) AS trxamount,
COALESCE(SUM(COALESCE(P.MERCHANT_FEE,P.CUSTOMER_FEE,0)),0) as trxfee,
COALESCE(SUM(P.COST),0) AS accountingcost,
COALESCE(SUM(P.COST),0) AS frpcost    
FROM OPR.TBL_ORDER_INFO I ,OPR.TBL_ORDER_PAYMENT P  
WHERE I.BIZ_SYSTEM_NO='LK' and P.UNIQUE_ORDER_NO = I.UNIQUE_ORDER_NO 
and P.PAY_SUCCESS_DATE>= ${START} and P.PAY_SUCCESS_DATE< ${STOP} 
AND I.STATUS IN ('FULLY_PAY','CS_ACCEPT','SUCCESS','REFUND','CS_SUCCESS')   
group by 
date(P.PAY_SUCCESS_DATE),
month(P.PAY_SUCCESS_DATE),
year(P.PAY_SUCCESS_DATE),
I.MERCHANT_NO,
P.CASHIER_TYPE,
P.CHANNEL_ID,
P.CARD_TYPE,
I.BIZ_SYSTEM_NO,
P.INST_NUMBER,
P.ACCOUNT_PRODUCT_CODE,
I.SALES_PRODUCT_CODE,
P.FEE_WAY,
P.BANK_ID,
P.FEE_VERSION 
with ur",zgt_standby
LK,LKrefund,"SELECT 
coalesce(char(date(R.REFUND_CENTER_FINISH_DATE)),'null')
||coalesce(char(I.MERCHANT_NO),'null')
||coalesce(char(P.CASHIER_TYPE),'null')||coalesce(char(P.FEE_WAY),'null')
||coalesce(char(P.CHANNEL_ID),'null')
||coalesce(char(P.CARD_TYPE),'null')
||coalesce(char(I.BIZ_SYSTEM_NO),'null')
||coalesce(char(P.INST_NUMBER),'null')
||coalesce(char(P.ACCOUNT_PRODUCT_CODE),'null')||coalesce(char(I.SALES_PRODUCT_CODE),'null')
||coalesce(char(P.FEE_VERSION),'null')||coalesce(char(P.BANK_ID),'null')||'LKrefund' as IDNOUSE,
date(R.REFUND_CENTER_FINISH_DATE) as trxdate,
date(R.REFUND_CENTER_FINISH_DATE) as true_trxdate,
year(R.REFUND_CENTER_FINISH_DATE)*100+month(R.REFUND_CENTER_FINISH_DATE) as month,
'Sales' as type,
1 as iscomputeprofit,
1 as iscomputebonus,
301 AS BIZTYPEID ,
'SYSTEM' as usetype,
I.MERCHANT_NO as receiverid,
P.CASHIER_TYPE as payscene,
P.CHANNEL_ID as trxchannelid,
P.CARD_TYPE as cardtype,
'DS' as dataorigin,
P.INST_NUMBER as goodscate,
P.BANK_ID as bank_code,
(CASE WHEN P.ACCOUNT_PRODUCT_CODE ='ZF_QB_H5' and P.FEE_VERSION='LOW' THEN I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY||'.'||P.FEE_VERSION
ELSE I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY END) as payproduct,
COUNT(*) AS refundcount,
COALESCE(SUM(R.REFUND_AMOUNT),0) AS refundamount,
COALESCE(SUM(R.RETURN_MERCHANT_FEE),0) AS refundfee 
FROM OPR.TBL_REFUND_INFO R ,OPR.TBL_ORDER_INFO I ,OPR.TBL_ORDER_PAYMENT P 
WHERE I.BIZ_SYSTEM_NO='LK' and  I.UNIQUE_ORDER_NO = R.UNIQUE_ORDER_NO 
AND P.UNIQUE_ORDER_NO = R.UNIQUE_ORDER_NO 
AND R.STATUS IN ('SUCCESS') 
AND R.REFUND_CENTER_FINISH_DATE>= ${START} and R.REFUND_CENTER_FINISH_DATE< ${STOP}  
group by 
date(R.REFUND_CENTER_FINISH_DATE),
month(R.REFUND_CENTER_FINISH_DATE),
year(R.REFUND_CENTER_FINISH_DATE),
I.MERCHANT_NO,
P.CASHIER_TYPE,
P.CHANNEL_ID,
P.CARD_TYPE,
I.BIZ_SYSTEM_NO,
P.INST_NUMBER,
P.ACCOUNT_PRODUCT_CODE,I.SALES_PRODUCT_CODE, P.FEE_WAY,
P.BANK_ID,
P.FEE_VERSION 
with ur",zgt_standby
LK,LKtotal,"SELECT 
coalesce(char(date(I.REQUEST_DATE)),'null')
||coalesce(char(I.MERCHANT_NO),'null')
||coalesce(char(P.CASHIER_TYPE),'null')||coalesce(char(P.FEE_WAY),'null')
||coalesce(char(P.CHANNEL_ID),'null')
||coalesce(char(P.CARD_TYPE),'null')
||coalesce(char(I.BIZ_SYSTEM_NO),'null')
||coalesce(char(P.INST_NUMBER),'null')
||coalesce(char(P.ACCOUNT_PRODUCT_CODE),'null')||coalesce(char(I.SALES_PRODUCT_CODE),'null')
||coalesce(char(P.FEE_VERSION),'null')||coalesce(char(P.BANK_ID),'null')||'LKtotal' as IDNOUSE,
date(I.REQUEST_DATE) as trxdate,
date(I.REQUEST_DATE) as true_trxdate,
year(I.REQUEST_DATE)*100+month(I.REQUEST_DATE) as month,
'Sales' as type,
301 AS BIZTYPEID ,
1 as iscomputeprofit,
1 as iscomputebonus,
'SYSTEM' as usetype,
I.MERCHANT_NO as receiverid,
P.CASHIER_TYPE as payscene,
P.CHANNEL_ID as trxchannelid,
P.CARD_TYPE as cardtype,
'DS' as dataorigin,
P.INST_NUMBER as goodscate,
P.BANK_ID as bank_code,
(CASE WHEN P.ACCOUNT_PRODUCT_CODE ='ZF_QB_H5' and P.FEE_VERSION='LOW' THEN I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY||'.'||P.FEE_VERSION
ELSE I.BIZ_SYSTEM_NO||'.'||I.SALES_PRODUCT_CODE||'.'||P.ACCOUNT_PRODUCT_CODE||'.'||P.FEE_WAY END) as payproduct,
COUNT(*) AS wholeordercount,
COALESCE(SUM(I.ORDER_AMOUNT),0) AS wholeorderamount 
FROM OPR.TBL_ORDER_INFO I ,OPR.TBL_ORDER_PAYMENT P 
WHERE I.BIZ_SYSTEM_NO='LK' and P.UNIQUE_ORDER_NO = I.UNIQUE_ORDER_NO 
AND I.REQUEST_DATE>= ${START} and I.REQUEST_DATE< ${STOP}  
group by 
date(I.REQUEST_DATE),
month(I.REQUEST_DATE),
year(I.REQUEST_DATE),
I.MERCHANT_NO,
P.CASHIER_TYPE,
P.CHANNEL_ID,
P.CARD_TYPE,
I.BIZ_SYSTEM_NO,
P.INST_NUMBER,
P.ACCOUNT_PRODUCT_CODE,I.SALES_PRODUCT_CODE,P.FEE_WAY,P.BANK_ID,
P.FEE_VERSION   
with ur",zgt_standby
LK,LKsalesproduct,"select payproduct,salesproductcode as sales_product_code from db2inst1.payproduct2productcode  with ur",reportdb
LK,LKproduct,"select payproduct,productcode as product_code from db2inst1.payproduct2productcode  with ur",reportdb
LK,LKordertype,"select payproduct,ordertype  from db2inst1.payproduct2productcode  with ur",reportdb
COMMISSIONLIKER,COMLKcusttransf,"select customernumber as RECEIVERID,id AS CUSTOMERID from db2inst1.customerinfo with ur",reportdb
proqualityWalletWechat,proqualityWalletWechat_E,"SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS TRADE_COUNT FROM frontend.TBL_FRONTEND_PAY_ORDER AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",dzh_standby
proqualityWalletWechat,proqualityWalletWechat_succ,"SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS SUCCESS_COUNT FROM frontend.TBL_FRONTEND_PAY_ORDER AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
AND PAY_STATUS='SUCCESS'
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
proqualityWalletWechat,excep_proqualityWalletWechat,"select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT from frontend.TBL_FRONTEND_PAY_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
proqualityWalletZFB,proqualityWalletZFB_toal,"SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS TRADE_COUNT FROM frontend.TBL_FRONTEND_PAY_RECORD_ZFB AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
proqualityWalletZFB,proqualityWalletZFB_succ,"SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS SUCCESS_COUNT FROM frontend.TBL_FRONTEND_PAY_ORDER_ZFB AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
AND PAY_STATUS='SUCCESS'
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
proqualityWalletZFB,excep_proqualityWalletZFB,"select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT from frontend.TBL_FRONTEND_PAY_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
proqualityOneMinRecord,proqualityOneMinRecord_total,"SELECT COUNT( * ) as TRADE_COUNT, TO_CHAR(TIMESTAMP(CREATE_DATE), 'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,'ONEMINRECORD' AS PRODUCT_TYPE
                   FROM
                    CS.TBL_PROCESS_TRXORDER_1804 t
                   WHERE t.CREATE_DATE>= ${START} and t.CREATE_DATE < ${STOP} AND 
                    BIZ_SYSTEM IN('ZGT', '2GTRADE', 'YJZF')
                   GROUP BY
                    TO_CHAR(TIMESTAMP(CREATE_DATE), 'YYYY-MM-DD HH24:MI') with ur",zxdb_standby
proqualityOneMinRecord,proqualityOneMinRecord_succ," SELECT COUNT( * ) as SUCCESS_COUNT, TO_CHAR(TIMESTAMP(CREATE_DATE), 'YYYY-MM-DD HH24:MI') as HAPPEN_DATE
                   FROM
                    CS.TBL_PROCESS_TRXORDER_1803 t
                   WHERE t.CREATE_DATE>= ${START} and t.CREATE_DATE < ${STOP} AND 
                    ORDER_STATUS = 'SUCCESS'
                    AND UPDATE_DATE - CREATE_DATE < 60
                    AND BIZ_SYSTEM IN('ZGT', '2GTRADE', 'YJZF')
                   GROUP BY
                    TO_CHAR(TIMESTAMP(CREATE_DATE), 'YYYY-MM-DD HH24:MI') WITH UR",zxdb_standby
proqualityOneMinRecord,excep_proqualityOneMinRecord,"select TO_CHAR(t.CREATE_DATE,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT from CS.TBL_PROCESS_TRXORDER_1803 as t
where t.CREATE_DATE>= ${START} and t.CREATE_DATE < ${STOP}
group by TO_CHAR(t.CREATE_DATE,'YYYY-MM-DD HH24:MI')
with ur",zxdb_standby
proqualityRecordedAvarate2,RecordedAvarate2_total,"select 'RZRATE2' AS PRODUCT_TYPE,a.HAPPEN_DATE,a.TRADE_COUNT,b.SUCCESS_COUNT,ROUND(cast(nvl(b.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from 
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS TRADE_COUNT FROM cs.tbl_process_trxorder_1804 WHERE create_date >=${START} AND create_date < ${STOP} AND order_status='SUCCESS' AND BIZ_SYSTEM IN( 'ZGT', '2GTRADE', 'YJZF' )  GROUP BY  date(create_date)) AS a left join 
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS SUCCESS_COUNT FROM cs.tbl_process_trxorder_1804 WHERE (update_date-create_date) < 60 AND BIZ_SYSTEM IN( 'ZGT', '2GTRADE', 'YJZF' ) and create_date >=${START} AND create_date <  ${STOP} AND order_status='SUCCESS' GROUP BY  date(create_date) )as b  on a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR",zxdb_standby
bigcalculate,bigcalculatenum,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
G2NETREMOVE,G2NETREMOVEnum,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
LK,LKnum,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
postpaidreceive,postpaidreceivefee,"SELECT coalesce(char(total.trxdate),'null')||coalesce(char(total.CUSTOMER_NUMBER),'null')||coalesce(char(total.CAL_FEE_CATEGORY),'null')||coalesce(char(total.relegation),'null')||coalesce(char(total.BILL_DATE),'null')||'postpaidreceivefee' as IDNOUSE,
    total.trxdate,
    total.CUSTOMER_NUMBER      AS customernumber,
    SUM(total.RECEIVED_AMOUNT) AS receivefee,
    total.CAL_FEE_CATEGORY ,
    total.relegation ,
    total.BILL_DATE AS billmonth,
  TO_CHAR(total.trxdate, 'yyyyMM') AS month
FROM
    (
        SELECT
            bill.CUSTOMER_NUMBER,
            (
                CASE bill.CAL_FEE_CATEGORY
                    WHEN 'POS_ACQUIRING'
                    THEN 'OFFLINE'
                    ELSE 'ONLINE'
                END)              AS relegation,
            bill.CAL_FEE_CATEGORY AS CAL_FEE_CATEGORY,
            cols.RECEIVED_AMOUNT,
            bill.BILL_NUMBER,
            TO_CHAR(bill.SUM_START, 'yyyyMM') AS BILL_DATE,
            cols.trxdate
        FROM
            (
                SELECT
                    detail.BILL_ID,
                    SUM(detail.SUBTRACT_ARREARS_AMOUNT) AS RECEIVED_AMOUNT,
                    date(detail.RECEIVED_DATE) as trxdate
                FROM
                    fee.TBL_FRONT_FEE_BILL_PAYMENTS_RECEIVED detail
                WHERE
					detail.RECEIVED_DATE >= ${START} and detail.RECEIVED_DATE < ${STOP}
                GROUP BY
                    detail.BILL_ID, date(detail.RECEIVED_DATE) ) AS cols
        LEFT JOIN
            fee.TBL_FRONT_FEE_BILL bill
        ON
            cols.BILL_ID = bill.ID ) AS total
GROUP BY
    total.CUSTOMER_NUMBER ,
    total.relegation,
    total.CAL_FEE_CATEGORY,
    total.BILL_DATE,
    total.trxdate
HAVING
    SUM(total.RECEIVED_AMOUNT)!=0 WITH ur",feedb_standby
MLcustomerinfo,customerinfo,"SELECT 
    CU.CUSTOMERNUMBER AS CU_NUMBER,
    CU.FULLNAME AS CU_NAME,
    CASE
        WHEN CU.BUSSINESSCATID IS NULL THEN '-111'
        WHEN CU.BUSSINESSCATID ='' THEN '-111'
        ELSE CU.BUSSINESSCATID
    END AS CAT_ID,
    CASE
        WHEN CU.SUBBUSINESSCAT IS NULL THEN  '-111'
         WHEN CU.SUBBUSINESSCAT ='' THEN  '-111'
        ELSE CU.SUBBUSINESSCAT
    END AS SUBCAT_ID,
    CASE
        WHEN CU.VMARK = 'V' THEN 1
        WHEN CU.VMARK = 'V' THEN - 1
        ELSE 0
    END AS CU_VMARK,
    CASE
        WHEN CU.CUSTOMER_CREDENTIAL_LEVEL IN ('A' , 'A-') THEN 1
        WHEN CU.CUSTOMER_CREDENTIAL_LEVEL = 'B' THEN 2
        WHEN CU.CUSTOMER_CREDENTIAL_LEVEL = 'C' THEN 3
        ELSE - 1
    END AS CU_LEVEL,
    cu.ACTIVE
FROM
    CUSTOMERINFO CU
WITH UR",reportdb
MLcustomerinfo,cat,"select ID,NAME AS CAT_NAME from TRXSTATBUSINESSCATEGORIE WITH UR",reportdb
MLcustomerinfo,sub,"select CODE AS ID,NAME AS SUB_NAME from TRXSTATSUBBUSINESSCATEGORIE",reportdb
testsalesetl,reportDB3,"SELECT
    CUSTOMER_ID AS A
FROM
    TTT T",reportdb_yjkh
xiaojinxieyipay,xjxieyisucc,"SELECT 
COALESCE(
        CHAR( DATE( t1.FEE_DEAL_TIME ) ) ,
        'null'
    ) || COALESCE(
        CHAR( t1.MERCHANT_NO ) ,
        'null'
    ) || COALESCE(
        CHAR( t1.BANK_CODE ) ,
        'null'
    )|| COALESCE(
        CHAR( t1.PAY_TYPE) ,
        'null'
    )|| 'xjxieyisucc' AS IDNOUSE ,
    DATE(t1.FEE_DEAL_TIME) AS TRXDATE ,
    DATE(t1.FEE_DEAL_TIME) AS TRUE_TRXDATE ,
    YEAR(
        DATE(t1.FEE_DEAL_TIME)
    ) * 100 + MONTH(
        DATE(t1.FEE_DEAL_TIME)
    ) AS MONTH ,
    t1.MERCHANT_NO AS RECEIVERID ,
    t1.BANK_CODE AS BANK_CODE ,
    'DEBITCARD' AS CARDTYPE ,
    (case t1.PAY_TYPE
         when 0 then '3011001005002'
         when 1 then '3011001005002'
         when 2 then '3011001005003'
         when 3 then '3011001005002'
         when 4 then 'ZF_QB_H5'
         else '3011001005002'
     end
    ) as PRODUCT_CODE,
    '3011001005002A' AS SALES_PRODUCT_CODE ,
    'SALES' AS ORDERTYPE ,
    'XJ_XIEYIPAY' AS PAYPRODUCT ,
    287 AS BIZTYPEID ,
    'Sales' AS TYPE ,
    1 AS ISCOMPUTEPROFIT ,
    1 AS ISCOMPUTEBONUS ,
    'ONLINE' AS RELEGATION ,
    'PAID' AS FEETYPE ,
    'SYSTEM' AS USETYPE ,
    'XJ_XIEYIPAY' AS DATAORIGIN ,
    SUM(
        CASE
            WHEN t1.STATUS = 'PAY_SUCCESS'
            THEN 1
            ELSE 0
        END
    ) AS TRXCOUNT ,
    SUM(
        CASE
            WHEN t1.STATUS = 'PAY_SUCCESS'
            THEN t1.AMOUNT
            ELSE 0
        END
    ) AS TRXAMOUNT ,
    SUM(t1.CS_FEE) AS TRXFEE 
FROM
    PAPERORDER.PO_PAYMENT_ORDER t1 
WHERE
    t1.FEE_DEAL_TIME >= ${START} AND t1.FEE_DEAL_TIME < ${STOP}
GROUP BY
    YEAR(t1.FEE_DEAL_TIME) ,MONTH(t1.FEE_DEAL_TIME) ,DATE(t1.FEE_DEAL_TIME) ,
    t1.MERCHANT_NO ,
    t1.BANK_CODE,t1.PAY_TYPE 
WITH ur",dzh_standby
xiaojinxieyipay,xjxieyirefund,"SELECT 
    COALESCE(
        CHAR( DATE( t.LAST_UPDATE_TIME ) ) ,
        'null'
    ) || COALESCE(
        CHAR( t.MERCHANT_NO ) ,
        'null'
    ) || COALESCE(
        CHAR( t.BANK_CODE ) ,
        'null'
    ) || 'xjxieyirefund' AS IDNOUSE ,
    DATE(t.LAST_UPDATE_TIME) AS TRXDATE ,
    DATE(t.LAST_UPDATE_TIME) AS TRUE_TRXDATE ,
    YEAR(
        DATE(t.LAST_UPDATE_TIME)
    ) * 100 + MONTH(
        DATE(t.LAST_UPDATE_TIME)
    ) AS MONTH ,
    t.MERCHANT_NO AS RECEIVERID ,
    t.BANK_CODE AS BANK_CODE ,
    'DEBITCARD' AS CARDTYPE ,
    '3011001005002' AS PRODUCT_CODE ,
    '3011001005002A' AS SALES_PRODUCT_CODE ,
    'SALES' AS ORDERTYPE ,
    'XJ_XIEYIPAY' AS PAYPRODUCT ,
    287 AS BIZTYPEID ,
    'Sales' AS TYPE ,
    1 AS ISCOMPUTEPROFIT ,
    1 AS ISCOMPUTEBONUS ,
    'ONLINE' AS RELEGATION ,
    'PAID' AS FEETYPE ,
    'SYSTEM' AS USETYPE ,
    'XJ_XIEYIPAY' AS DATAORIGIN ,
    SUM(CASE WHEN t.STATUS = 'REFUND_SUCCESS' THEN 1 ELSE 0 END) AS refundcount, 
    SUM(CASE WHEN t.STATUS = 'REFUND_SUCCESS' THEN t.AMOUNT ELSE 0 END) AS refundamount 
FROM
    PAPERORDER.PO_REFUND_ORDER AS t 
WHERE
	 t.LAST_UPDATE_TIME >= ${START} AND t.LAST_UPDATE_TIME < ${STOP} 
GROUP BY
    YEAR(t.LAST_UPDATE_TIME) ,MONTH(t.LAST_UPDATE_TIME) ,DATE(t.LAST_UPDATE_TIME) ,
    t.MERCHANT_NO ,
    t.BANK_CODE 	 
WITH ur",dzh_standby
xiaojinxieyipay,xjxieyitotal,"SELECT 
    COALESCE(
        CHAR( DATE( t.LAST_UPDATE_TIME ) ) ,
        'null'
    ) || COALESCE(
        CHAR( t.MERCHANT_NO ) ,
        'null'
    ) || COALESCE(
        CHAR( t.BANK_CODE ) ,
        'null'
    )|| COALESCE(
        CHAR(t.PAY_TYPE) ,
        'null'
    )|| 'xjxieyitotal' AS IDNOUSE ,
    DATE(t.LAST_UPDATE_TIME) AS TRXDATE ,
    DATE(t.LAST_UPDATE_TIME) AS TRUE_TRXDATE ,
    YEAR(
        DATE(t.LAST_UPDATE_TIME)
    ) * 100 + MONTH(
        DATE(t.LAST_UPDATE_TIME)
    ) AS MONTH ,
    t.MERCHANT_NO AS RECEIVERID ,
    t.BANK_CODE AS BANK_CODE ,
    'DEBITCARD' AS CARDTYPE ,
    (case t.PAY_TYPE
         when 0 then '3011001005002'
         when 1 then '3011001005002'
         when 2 then '3011001005003'
         when 3 then '3011001005002'
         when 4 then 'ZF_QB_H5'
         else '3011001005002'
     end
    ) as PRODUCT_CODE,
    '3011001005002A' AS SALES_PRODUCT_CODE ,
    'SALES' AS ORDERTYPE ,
    'XJ_XIEYIPAY' AS PAYPRODUCT ,
    287 AS BIZTYPEID ,
    'Sales' AS TYPE ,
    1 AS ISCOMPUTEPROFIT ,
    1 AS ISCOMPUTEBONUS ,
    'ONLINE' AS RELEGATION ,
    'PAID' AS FEETYPE ,
    'SYSTEM' AS USETYPE ,
    'XJ_XIEYIPAY' AS DATAORIGIN ,
    COUNT(t.ID) AS WHOLEORDERCOUNT,
    SUM(t.AMOUNT) AS WHOLEORDERAMOUNT 
FROM
    PAPERORDER.PO_PAYMENT_ORDER AS t
WHERE
    t.LAST_UPDATE_TIME >= ${START} AND t.LAST_UPDATE_TIME < ${STOP}  
GROUP BY
    YEAR(t.LAST_UPDATE_TIME) ,MONTH(t.LAST_UPDATE_TIME) ,DATE(t.LAST_UPDATE_TIME) ,
    t.MERCHANT_NO ,
    t.BANK_CODE,t.PAY_TYPE 
WITH ur",dzh_standby
xiaojinxieyipay,xjxieyicost,"SELECT 
    COALESCE(
        CHAR( DATE( t.LAST_UPDATE_TIME ) ) ,
        'null'
    ) || COALESCE(
        CHAR( t.MERCHANT_NO ) ,
        'null'
    ) || COALESCE(
        CHAR( t.BANK_CODE ) ,
        'null'
    ) || COALESCE(
        CHAR(t.TERMINAL_ID) ,
        'null'
    ) || COALESCE(
        CHAR(  t.FRP_CODE ) ,
        'null'
    )|| 'xjxieyicost' AS IDNOUSE ,
    DATE(t.LAST_UPDATE_TIME) AS TRXDATE ,
    DATE(t.LAST_UPDATE_TIME) AS TRUE_TRXDATE ,
    YEAR(
        DATE(t.LAST_UPDATE_TIME)
    ) * 100 + MONTH(
        DATE(t.LAST_UPDATE_TIME)
    ) AS MONTH ,
    t.MERCHANT_NO AS RECEIVERID ,
    t.BANK_CODE AS BANK_CODE ,
    t.FRP_CODE AS TRXCHANNELID,
    'DEBITCARD' AS CARDTYPE ,
    (case 
        t.TERMINAL_ID
        when 'SQKKSCENE10' then '3011001005002' 
        when 'SQKKSCENEPK010' then '3011001005003'
        when 'SQKKSCENEWXBZ001' then 'ZF_QB_H5'
        when 'SQKKSCENEWXZY002' then 'ZF_QB_H5'
        when 'SQKKSCENEZFBBZ003' then 'ZF_QB_H5'
        when 'SQKKSCENEZFBZY004' then 'ZF_QB_H5'
        else '3011001005002' 
    end) as PRODUCT_CODE,
    '3011001005002A' AS SALES_PRODUCT_CODE ,
    'SALES' AS ORDERTYPE ,
    'XJ_XIEYIPAY' AS PAYPRODUCT ,
    287 AS BIZTYPEID ,
    'Sales' AS TYPE ,
    1 AS ISCOMPUTEPROFIT ,
    1 AS ISCOMPUTEBONUS ,
    'ONLINE' AS RELEGATION ,
    'PAID' AS FEETYPE ,
    'SYSTEM' AS USETYPE ,
    'XJ_XIEYIPAY' AS DATAORIGIN ,
    SUM(t.NCPAY_COST) AS ACCOUNTINGCOST,
    SUM(t.NCPAY_COST) AS FRPCOST 
FROM
    PAPERTRADE.PAPERTRADE_PAYMENT_ORDER t
WHERE t.ORDER_SYSTEM_CODE = 'PAPERORDER'  and 
   t.LAST_UPDATE_TIME >= ${START} AND t.LAST_UPDATE_TIME < ${STOP}  and t.TERMINAL_ID in (
   'SQKKSCENE10',
   'SQKKSCENEPK010',
   'SQKKSCENEWXBZ001',
   'SQKKSCENEWXZY002',
   'SQKKSCENEZFBBZ003',
   'SQKKSCENEZFBZY004'
   ) 
GROUP BY
    YEAR(t.LAST_UPDATE_TIME) ,MONTH(t.LAST_UPDATE_TIME) ,DATE(t.LAST_UPDATE_TIME) ,
    t.MERCHANT_NO ,
    t.BANK_CODE,
    t.FRP_CODE,t.TERMINAL_ID 
WITH ur",tztDB
xiaojinxieyipay,xjjianquansucc,"SELECT
    COALESCE(
        CHAR( DATE( t1.FEE_DEAL_TIME ) ) ,
        'null'
    ) || COALESCE(
        CHAR( t1.MERCHANT_NO ) ,
        'null'
    ) || COALESCE(
        CHAR( t1.BANK_CODE ) ,
        'null'
    ) || 'xjjianquansucc' AS IDNOUSE ,
    DATE(t1.FEE_DEAL_TIME) AS TRXDATE ,
    DATE(t1.FEE_DEAL_TIME) AS TRUE_TRXDATE ,
    YEAR(
        DATE(t1.FEE_DEAL_TIME)
    ) * 100 + MONTH(
        DATE(t1.FEE_DEAL_TIME)
    ) AS MONTH ,
    t1.MERCHANT_NO AS RECEIVERID ,
    t1.BANK_CODE AS BANK_CODE ,
    'DEBITCARD' AS CARDTYPE,
    '3011004003002' AS PRODUCT_CODE ,
    '3011001005002A' AS SALES_PRODUCT_CODE ,
    'CARDJIANQUAN' AS ORDERTYPE ,
    'XJ_CARDJIANQUAN' AS PAYPRODUCT ,
    226 AS BIZTYPEID ,
    'CARDJIANQUAN' AS TYPE ,
    1 AS ISCOMPUTEPROFIT ,
    1 AS ISCOMPUTEBONUS ,
    'ONLINE' AS RELEGATION ,
    'PAID' AS FEETYPE ,
    'SYSTEM' AS USETYPE ,
    'XJ_JIANQUAN' AS DATAORIGIN ,
    SUM(
        CASE
            WHEN t1.CS_FEE IS NOT NULL
            THEN 1
            ELSE 0
        END
    ) AS TRXCOUNT ,
    SUM(t1.CS_FEE) AS TRXFEE 
FROM
    PAPERORDER.PO_BINDCARD_ORDER t1 
WHERE
    t1.FEE_DEAL_TIME >= ${START} AND t1.FEE_DEAL_TIME < ${STOP} 
GROUP BY
    YEAR(t1.FEE_DEAL_TIME) ,MONTH(t1.FEE_DEAL_TIME) ,DATE(t1.FEE_DEAL_TIME) ,
    t1.MERCHANT_NO ,
    t1.BANK_CODE 
WITH ur",dzh_standby
xiaojinxieyipay,xjjianquantotal,"SELECT 
    COALESCE(
        CHAR( DATE( t1.LAST_UPDATE_TIME ) ) ,
        'null'
    ) || COALESCE(
        CHAR( t1.MERCHANT_NO ) ,
        'null'
    ) || COALESCE(
        CHAR( t1.BANK_CODE ) ,
        'null'
    ) || 'xjjianquantotal' AS IDNOUSE ,
    DATE(t1.LAST_UPDATE_TIME) AS TRXDATE ,
    DATE(t1.LAST_UPDATE_TIME) AS TRUE_TRXDATE ,
    YEAR(
        DATE(t1.LAST_UPDATE_TIME)
    ) * 100 + MONTH(
        DATE(t1.LAST_UPDATE_TIME)
    ) AS MONTH ,
    t1.MERCHANT_NO AS RECEIVERID ,
    t1.BANK_CODE AS BANK_CODE ,
    'DEBITCARD' AS CARDTYPE,
    '3011004003002' AS PRODUCT_CODE ,
    '3011001005002A' AS SALES_PRODUCT_CODE ,
    'CARDJIANQUAN' AS ORDERTYPE ,
    'XJ_CARDJIANQUAN' AS PAYPRODUCT ,
    226 AS BIZTYPEID ,
    'CARDJIANQUAN' AS TYPE ,
    1 AS ISCOMPUTEPROFIT ,
    1 AS ISCOMPUTEBONUS ,
    'ONLINE' AS RELEGATION ,
    'PAID' AS FEETYPE ,
    'SYSTEM' AS USETYPE ,
    'XJ_JIANQUAN' AS DATAORIGIN ,
    COUNT(t1.ID) AS WHOLEORDERCOUNT 
FROM
    PAPERORDER.PO_BINDCARD_ORDER t1 
WHERE 
    t1.LAST_UPDATE_TIME >= ${START} AND t1.LAST_UPDATE_TIME < ${STOP} 
GROUP BY
    YEAR(t1.LAST_UPDATE_TIME) ,MONTH(t1.LAST_UPDATE_TIME) ,DATE(t1.LAST_UPDATE_TIME) ,
    t1.MERCHANT_NO ,
    t1.BANK_CODE 
WITH ur",dzh_standby
xiaojinxieyipay,xjjianquancost,"SELECT 
    COALESCE(
        CHAR( DATE( t1.LAST_UPDATE_TIME ) ) ,
        'null'
    ) || COALESCE(
        CHAR( t1.MERCHANT_NO ) ,
        'null'
    ) || 'xjjianquancost' AS IDNOUSE ,
    DATE(t1.LAST_UPDATE_TIME) AS TRXDATE ,
    DATE(t1.LAST_UPDATE_TIME) AS TRUE_TRXDATE ,
    YEAR(
        DATE(t1.LAST_UPDATE_TIME)
    ) * 100 + MONTH(
        DATE(t1.LAST_UPDATE_TIME)
    ) AS MONTH ,
    t1.MERCHANT_NO AS RECEIVERID ,
    'DEBITCARD' AS CARDTYPE,
    '3011004003002' AS PRODUCT_CODE ,
    '3011001005002A' AS SALES_PRODUCT_CODE ,
    'CARDJIANQUAN' AS ORDERTYPE ,
    'XJ_CARDJIANQUAN' AS PAYPRODUCT ,
    226 AS BIZTYPEID ,
    'CARDJIANQUAN' AS TYPE ,
    1 AS ISCOMPUTEPROFIT ,
    1 AS ISCOMPUTEBONUS ,
    'ONLINE' AS RELEGATION ,
    'PAID' AS FEETYPE ,
    'SYSTEM' AS USETYPE ,
    'XJ_JIANQUAN' AS DATAORIGIN ,
    SUM(t1.NCAUTH_COST) AS ACCOUNTINGCOST,
    SUM(t1.NCAUTH_COST) AS FRPCOST 
FROM
    PAPERTRADE.PAPERTRADE_BINDCARD_ORDER t1
WHERE
    t1.ORDER_SYSTEM_CODE = 'PAPERORDER' 
    AND t1.LAST_UPDATE_TIME >= ${START}
    AND t1.LAST_UPDATE_TIME < ${STOP} 
GROUP BY
    YEAR(t1.LAST_UPDATE_TIME) ,MONTH(t1.LAST_UPDATE_TIME) ,DATE(t1.LAST_UPDATE_TIME) ,
    t1.MERCHANT_NO 
WITH ur",tztDB
xiaojinxieyipay,xjcustid,"select id as custid,customernumber as receiverid from db2inst1.customerinfo with ur",reportdb
PayProccessorOrderSuccrate,PayProccessorOrderSuccrate_E,"select MAX(ID) AS ID,
date(CREATE_TIME) AS CREATE_TIME, 
SUM(case when PAY_STATUS = 'SUCCESS' then 1 else 0 end) AS SUCC_CNT, 
COUNT(ID) AS TOTAL_CNT
from PP.TBL_PAYMENT_REQUEST
where CREATE_TIME  >= ${START}
AND CREATE_TIME < ${STOP}
AND CUSTOMER_NO not in ('10000418926','10000419166','10000420650','10000420652','10000419568','10000418926','10000419166','10000420650','10000420652','10000419758','10000420698','10011830662','10000457067','10012442782','10000447996','10000449591','10000450379','10012413438','10000449592','10000449633','10000466938','10000469946','10014929805','10015004197','10014282423','10014282523','10014282733','10014282751')
group by date(CREATE_TIME) 
WITH UR
",dzh_standby
PayProccessorPaySuccrate,PayProccessorPaySuccrate_E,"select max(p.RECORD_NO) as ID,
date(p.CREATE_TIME) AS CREATE_TIME,
p.PLATFORM_TYPE,
SUM(case when p.STATUS = 'SUCCESS' then 1 else 0 end) AS SUCC_CNT , 
COUNT(*) AS TOTAL_CNT
from PP.TBL_PAYMENT_PAY_RECORD p join PP.TBL_PAYMENT_REQUEST  pr on pr.ID  = p. REQUEST_ID
where 
 p.CREATE_TIME >= ${START} AND p.CREATE_TIME < ${STOP}
AND pr.CUSTOMER_NO not in ('10000418926','10000419166','10000420650','10000420652','10000419568','10000418926','10000419166','10000420650','10000420652','10000419758','10000420698','10011830662','10000457067','10012442782','10000447996','10000449591','10000450379','10012413438','10000449592','10000449633','10000466938','10000469946','10014929805','10015004197','10014282423','10014282523','10014282733','10014282751')
GROUP BY date(p.CREATE_TIME ),PLATFORM_TYPE
with ur",dzh_standby
PayProccessorMerchantDetail,PayProccessorMerchantDetail_E,"select  MAX(p.RECORD_NO) AS ID,
date(p.CREATE_TIME) as CREATE_TIME,
pr.CUSTOMER_NO ,
pr.CUSTOMER_NAME,
p.PLATFORM_TYPE, p.CASHIER_VERSION,
SUM(case when p.STATUS = 'SUCCESS' then p.AMOUNT else 0 end) as amount,
SUM(case when p.STATUS = 'SUCCESS' then 1 else 0 end) as succ_cnt,
count(*) as total_cnt
from PP.TBL_PAYMENT_PAY_RECORD p join PP.TBL_PAYMENT_REQUEST pr on pr.ID  = p. REQUEST_ID
where
 p.create_time >= ${START}
AND p.create_time < ${STOP}
AND pr.CUSTOMER_NO not in ('10000418926','10000419166','10000420650','10000420652','10000419568','10000418926','10000419166','10000420650','10000420652','10000419758','10000420698','10011830662','10000457067','10012442782','10000447996','10000449591','10000450379','10012413438','10000449592','10000449633','10000466938','10000469946','10014929805','10015004197','10014282423','10014282523','10014282733','10014282751')
group by date(p.CREATE_TIME),pr.CUSTOMER_NO,pr.CUSTOMER_NAME,p.PLATFORM_TYPE, p.CASHIER_VERSION with ur
",dzh_standby
PayProccessorError,PayProccessorError_E,"select  MIN(p.RECORD_NO) AS ID,
date(pr.CREATE_TIME) as CREATE_TIME,
pr.CUSTOMER_NO ,
pr.CUSTOMER_NAME,
p.PLATFORM_TYPE, p.CASHIER_VERSION,P.ERROR_CODE,P.ERROR_MSG,
count(ID) as ERROR_CNT
from PP.TBL_PAYMENT_REQUEST pr join PP.TBL_PAYMENT_PAY_RECORD p on pr.ID  = p. REQUEST_ID
where
pr.create_time >= ${START}
AND pr.create_time < ${STOP}
AND p.status='FAILUER'
AND pr.CUSTOMER_NO not in ('10000418926','10000419166','10000420650','10000420652','10000419568','10000418926','10000419166','10000420650','10000420652','10000419758','10000420698','10011830662','10000457067','10012442782','10000447996','10000449591','10000450379','10012413438','10000449592','10000449633','10000466938','10000469946','10014929805','10015004197','10014282423','10014282523','10014282733','10014282751')
group by date(pr.CREATE_TIME),pr.CUSTOMER_NO,pr.CUSTOMER_NAME,p.PLATFORM_TYPE, p.CASHIER_VERSION,P.ERROR_CODE,P.ERROR_MSG with ur
",dzh_standby
customerTradeDataJob,DAILYTRXSTAT1,"SELECT CU.ID AS CUSTOMER_ID
		, CU.MERCHANTNO AS CUSTOMER_NO
		, CU.CUSTOMERNUMBER AS RECEIVERID
		, CU.VMARK AS CUSTOMER_LEVEL
		, D.TRXDATE
		, PP.ACCOUNTINGTYPE
		, D.PRODUCT_CODE
		, P.PRODUCTNAME
		, D.SALES_PRODUCT_CODE
		, SP.PRODUCTNAME AS RETAIL_PRODUCT_NAME
		, D.BIZTYPEID
		, TB.DISPLAYNAME
		, D.TYPE AS TRADE_TYPE
		, TT.NAME AS TRADE_NAME
		, CS.EMPLOYEE_ID
		, EM.EMPLOYEE_NAME
		, EM.SALES_LEVEL AS EMPLOYEE_LEVEL
		, CU.AGENTCODE
		, CU.AGENTNAME
		, CU.BUSSINESSCATID
		, TG.NAME AS BUSSINESSCATNAME
		, CASE WHEN CS.ISSELF=0 THEN 'è½' ELSE '_' END AS ISSELF
		, DEC(CS.SHARESCALE*100,10,0)||'%' AS SHARESCALE
		, D.FEETYPE
		, D.TRXCHANNELID
		, CU.BRANCHCOMPANY
		, TA.BRANCHNAME
		, EMU.EMPLOYEE_NAME AS SUPER
		, DEC(SUM(D.TRXCOUNT*CS.SHARESCALE),18,4) AS TRADE_NUM
		, DEC(SUM(D.TRXAMOUNT*CS.SHARESCALE),18,4) AS TRADE_AMOUNT
		, DEC(SUM(D.REFUNDCOUNT*CS.SHARESCALE),18,4) AS REFUND_NUM
		, DEC(SUM(D.REFUNDAMOUNT*CS.SHARESCALE),18,4) AS REFUND_AMOUNT
		, DEC(SUM(D.TRXFEE*CS.SHARESCALE),18,4)  AS TRADE_FEE
		, DEC(SUM(D.REFUNDFEE*CS.SHARESCALE),18,4) AS REFUND_FEE
		, DEC((CASE WHEN SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)*(CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END))<=0 THEN 0 ELSE CASE WHEN SUM(D.TRXAMOUNT*CS.SHARESCALE)<=0 THEN 0 ELSE SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)*(CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END))/SUM(D.TRXAMOUNT*CS.SHARESCALE) END END)*100,18,4) AS CONTRACT_RATE
		
		, DEC(SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)),18,4) AS INCOME
		, DEC(SUM(D.ACCOUNTINGCOST*CS.SHARESCALE),18,4) AS COST
		, DEC(SUM(D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE-D.ACCOUNTINGCOST*CS.SHARESCALE),18,4) AS GROSS_PROFIT
		, CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END AS SALESRATIO
		, D.ID AS DAILY_ID
		, D.PAYERID AS PAYERID
		, D.ORDERTYPE AS ORDERTYPE
		, CU.AGENTTYPE AS AGENTTYPE
		, D.ACCOUNTINGCOST AS ACCOUNTINGCOST
		, CU.FULLNAME
		, PCS.EMPLOYEE_ID AS P_EMPLOYEE_ID
		, PEM.EMPLOYEE_NAME AS P_EMPLOYEE_NAME
		, PCU.FULLNAME AS P_FULLNAME
		, CURRENT TIMESTAMP AS CREATE_TIME
		,CU.PRODUCTLINE
FROM DB2INST1.DAILYTRXSTAT D
		LEFT JOIN DB2INST1.CUSTOMERINFO CU ON D.RECEIVERID=CU.ID
		LEFT JOIN DB2INST1.CUSTOMERINFO PCU ON D.PAYERID=PCU.ID
		LEFT JOIN DB2INST1.TRXSTATBIZTYPE TB ON D.BIZTYPEID=TB.ID 
		LEFT JOIN DB2INST1.TRXSTATTRXTYPE TT ON D.TYPE=TT.ID 
		LEFT JOIN DB2INST1.PRODUCTCODE P ON D.PRODUCT_CODE=P.PRODUCTCODE AND P.PRODUCTTYPE=2 
		LEFT JOIN DB2INST1.PRODUCTCODE SP ON D.SALES_PRODUCT_CODE=SP.PRODUCTCODE AND SP.PRODUCTTYPE=1
		LEFT JOIN DB2INST1.PRODUCTCODE_PROFILE PP ON D.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE AND D.PRODUCT_CODE=PP.PRODUCT_CODE
		LEFT JOIN TBL_CUSTOMER_RELATIONSHIP CS ON CU.ID=CS.CUSTOMER_ID AND CS.MONTH=YEAR(CURRENT DATE) || '-' || (MONTH((CURRENT TIMESTAMP)-day(current  date) days)) || '_'
		LEFT JOIN TBL_CUSTOMER_RELATIONSHIP PCS ON D.PAYERID=PCS.CUSTOMER_ID AND PCS.MONTH=YEAR(CURRENT DATE) || '-' || (MONTH((CURRENT TIMESTAMP)-day(current  date) days)) || '_'
		LEFT JOIN TBL_EMPLOYEEINFO PEM ON PCS.EMPLOYEE_ID=PEM.ID
		LEFT JOIN TBL_EMPLOYEEINFO EM ON CS.EMPLOYEE_ID=EM.ID 
		LEFT JOIN DB2INST1.TRXSTATBUSINESSCATEGORIE TG ON CU.BUSSINESSCATID=TG.ID 
		LEFT JOIN DB2INST1.TRXSTATCUSTOMERAREA TA ON CU.BRANCHCOMPANY=TA.AREAID
		LEFT JOIN TBL_EMPLOYEEINFO EMU ON EM.SUPER_ID=EMU.ID 
		LEFT JOIN DB2INST1.MONTHLYT_CUSTOMER_SALESRATIO MCS ON D.PRODUCT_CODE = MCS.SALES_PRODUCT_CODE 
		              AND CU.ID = MCS.CUSTOMER_ID AND MCS.MONTH=REPLACE(SUBSTR((CURRENT date)-day(current  date) days,1,7),'-','')
		WHERE 1=1 AND D.ISCOMPUTEBONUS=1 
		AND D.TRXDATE BETWEEN LAST_DAY(current date - 2 months) + 1 day AND LAST_DAY(current date - 1 months)
		and (d.type not in ('POSRENT','POSSALES') or d.type is null)
		GROUP BY D.ID,D.PAYERID,D.ORDERTYPE,CU.AGENTTYPE,EM.SALES_LEVEL,CU.VMARK,CU.MERCHANTNO,MCS.SALESRATIO,CU.ID
		    ,CU.CUSTOMERNUMBER,D.TRXDATE,PP.ACCOUNTINGTYPE,D.PRODUCT_CODE,P.PRODUCTNAME,D.SALES_PRODUCT_CODE,SP.PRODUCTNAME
		    ,D.BIZTYPEID,TB.DISPLAYNAME,D.TYPE,TT.NAME,CS.EMPLOYEE_ID,EM.EMPLOYEE_NAME,CU.AGENTCODE,CU.AGENTNAME,CU.BUSSINESSCATID,TG.NAME
		    ,CS.ISSELF,CS.SHARESCALE,D.FEETYPE,D.TRXCHANNELID,CU.BRANCHCOMPANY,TA.BRANCHNAME,EMU.EMPLOYEE_NAME
		    , D.ID
			, D.PAYERID
			, D.ORDERTYPE
			, CU.AGENTTYPE
			, D.ACCOUNTINGCOST
			, CU.FULLNAME
			, PCS.EMPLOYEE_ID
			, PEM.EMPLOYEE_NAME
			, PCU.FULLNAME
			, CU.PRODUCTLINE
		WITH UR",reportdb_yjkh
inputCustomerRelationshipJob,CUSTOMERRELATIONSHIP1,"SELECT  
CS.CUSTOMERID AS CUSTOMER_ID 
FROM DB2INST1.CUSTOMERRELATIONSHIP CS  
LEFT JOIN DB2INST1.CUSTOMERINFO CU ON CS.CUSTOMERID=CU.ID 
where CS.customerid= '13637087'",reportdb_yjkh
inputcustomerrelationship,customership1,"SELECT 
CS.CUSTOMERID AS CUSTOMER_ID,
CU.MERCHANTNO AS CUSTOMER_NO,
CU.CUSTOMERNUMBER AS RECEIVERID,
CS.EMPLOYEEID AS EMPLOYEE_ID,
 CS.ISSELF,
CS.TRANSFDATE,
 CS.ISSHARE,
CS.SHARESCALE ,
YEAR(CURRENT TIMESTAMP) || '-' || (MONTH((CURRENT TIMESTAMP)-day(current  date) days)) || '_' AS MONTH,
CURRENT TIMESTAMP AS CREATE_TIME ,
CU.PRODUCTLINE  
FROM DB2INST1.CUSTOMERRELATIONSHIP CS 
LEFT JOIN DB2INST1.CUSTOMERINFO CU ON CS.CUSTOMERID=CU.ID",reportdb_yjkh
inputcustomerrelationShipSSSSS,customership1222222222222,"SELECT  
CS.CUSTOMERID AS CUSTOMER_ID 
FROM DB2INST1.CUSTOMERRELATIONSHIP CS  
LEFT JOIN DB2INST1.CUSTOMERINFO CU ON CS.CUSTOMERID=CU.ID 
where CS.customerid= '13637087'",reportdb_yjkh
InputcustomerrelationShipSSSSSSS,Customership122222222222222,"SELECT  
CS.CUSTOMERID AS CUSTOMER_ID 
FROM DB2INST1.CUSTOMERRELATIONSHIP CS  
LEFT JOIN DB2INST1.CUSTOMERINFO CU ON CS.CUSTOMERID=CU.ID 
where CS.customerid= '13637087'",reportdb_yjkh
trxfeeaccountingcost,trxfeeshoudan,"SELECT COALESCE(CHAR(date(LAST_MODIFY_TIME))),'null')||COALESCE(CHAR(customer_no),'null')||COALESCE(CHAR(accounting_product),'null')||COALESCE(CHAR(product_code),'null')||'trxfeeshoudan' AS IDNOUSE,
    date(LAST_MODIFY_TIME) as TRXDATE,
    customer_no as RECEIVERID ,
    'Sales' as type,
    accounting_product as SALES_PRODUCT_CODE,
    product_code as PRODUCT_CODE,
    SUM(
        CASE src_fee_type
            WHEN 'INNER'
            THEN src_fee
            ELSE 0
        END +
        CASE target_fee_type
            WHEN 'INNER'
            THEN target_fee
            ELSE 0
        END) AS trxfee 
FROM
   ACCTG.tbl_acquiring_trx_request_1703
WHERE
    CREDIT_STATUS='SUCCESS'
AND
    CASE src_fee_type
        WHEN 'INNER'
        THEN src_fee
        ELSE 0
    END +
    CASE target_fee_type
        WHEN 'INNER'
        THEN target_fee
        ELSE 0
    END>0 
    and LAST_MODIFY_TIME>= ${START} and LAST_MODIFY_TIME< ${STOP} 
GROUP BY
    date(LAST_MODIFY_TIME),
    CUSTOMER_NO,
    ACCOUNTING_PRODUCT,
    PRODUCT_CODE 
    WITH ur ",billdb_standby
trxfeeaccountingcost,trxfeeyufu,"SELECT COALESCE(CHAR(date(A.LAST_MODIFY_TIME))),'null')||COALESCE(CHAR(A.customer_no),'null')||COALESCE(CHAR(A.accounting_product),'null')||COALESCE(CHAR(A.product_code),'null')||'trxfeeyufu' AS IDNOUSE,
    date(A.LAST_MODIFY_TIME) as TRXDATE,
    A.customer_no as RECEIVERID, 
    A.accounting_product as SALES_PRODUCT_CODE,
    A.product_code as PRODUCT_CODE,
    'Sales' as type,
    SUM(A.TRX_AMOUNT) AS trxfee 
FROM
    ACCTG.TBL_ACC_REQUEST_1703 A
LEFT JOIN
    ACCTG.TBL_ACC_REQUEST_DETAIL_1703 B
ON
    A.ID = B.ACC_REQUEST_ID
WHERE
    A.ACC_TYPE='DEBIT'
AND A.STATUS='SUCCESS' 
    and A.LAST_MODIFY_TIME>= ${START} and A.LAST_MODIFY_TIME< ${STOP} 
AND B.ACC_DIRECTION='CREDIT'
GROUP BY
    date(A.LAST_MODIFY_TIME),
    A.customer_no,
    A.accounting_product,
    A.product_code WITH ur",billdb_standby
trxfeeaccountingcost,trxfeedakuan,"SELECT COALESCE(CHAR(date(A.LAST_MODIFY_TIME))),'null')||COALESCE(CHAR(B.customer_no),'null')||COALESCE(CHAR(A.accounting_product),'null')||COALESCE(CHAR(A.product_code),'null')||'trxfeedakuan' AS IDNOUSE,
    date(A.LAST_MODIFY_TIME) as TRXDATE,
    B.customer_no as RECEIVERID,
    A.accounting_product as SALES_PRODUCT_CODE,
    A.product_code as PRODUCT_CODE,
    'Sales' as type,
    SUM(
        CASE A.fee_type
            WHEN 'INNER'
            THEN A.fee
            ELSE 0
        END +
        CASE A.target_fee_type
            WHEN 'INNER'
            THEN A.target_fee
            ELSE 0
        END) AS trxfee 
FROM
    ACCTG.TBL_TRX_REQUEST_1703 A
LEFT JOIN
    ACCTG.TBL_REMIT_DETAIL_1703 B
ON
    A.ID = B.TRX_REQUEST_ID
WHERE
    A.STATUS='SUCCESS'
AND
    CASE A.fee_type
        WHEN 'INNER'
        THEN A.fee
        ELSE 0
    END +
    CASE A.target_fee_type
        WHEN 'INNER'
        THEN A.target_fee
        ELSE 0
    END >0 
    and A.LAST_MODIFY_TIME>= ${START} and A.LAST_MODIFY_TIME< ${STOP} 
GROUP BY
    date(A.LAST_MODIFY_TIME),
    B.customer_no,
    A.accounting_product,
    A.product_code WITH ur",billdb_standby
trxfeeaccountingcost,trxfeetuikuan,"SELECT COALESCE(CHAR(date(LAST_MODIFY_TIME))),'null')||COALESCE(CHAR(customer_no),'null')||COALESCE(CHAR(accounting_product),'null')||COALESCE(CHAR(product_code),'null')||'trxfeetuikuan' AS IDNOUSE,
    date(LAST_MODIFY_TIME) as TRXDATE,
    customer_no as RECEIVERID,
    accounting_product as SALES_PRODUCT_CODE,
    product_code as PRODUCT_CODE,
    'Sales' as type,
    SUM(SRC_REFUND_FEE +TARGET_REFUND_FEE) AS refundfee 
FROM
    ACCTG.TBL_ACQUIRING_REFUND
WHERE
    REFUND_STATUS = 1
AND SRC_REFUND_FEE +TARGET_REFUND_FEE>0
    and LAST_MODIFY_TIME>= ${START} and LAST_MODIFY_TIME< ${STOP} 
GROUP BY
    date(LAST_MODIFY_TIME),
    customer_no,
    accounting_product,
    product_code WITH ur",billdb_standby
trxfeejingfen,tfjfshoudan,"SELECT COALESCE(CHAR(date(b.LAST_MODIFY_TIME)),'null')||COALESCE(CHAR(b.customer_no),'null')||COALESCE(CHAR(b.accounting_product),'null')||COALESCE(CHAR(b.product_code),'null')||'tfjfshoudan' AS IDNOUSE,'tfjfshoudan'  as DATAORIGIN,
    date(b.LAST_MODIFY_TIME) as TRXDATE,
    b.customer_no as RECEIVERID ,
    b.customer_no as CUSTOMERNUMBER,
    'Sales' as type,
    b.accounting_product as SALES_PRODUCT_CODE,
    b.product_code as PRODUCT_CODE,
    SUM(a.AMOUNT)       AS trxfee 
FROM
   ACCTG.tbl_acquiring_trx_request_1802 b
LEFT JOIN
    ACCTG.TBL_ACC_REQUEST_DETAIL_TEMP a
ON
    b.ID=a.ACQ_REQUEST_ID
WHERE
'etlnokill123123123'='etlnokill123123123' and
    b.CREDIT_STATUS='SUCCESS'
and b.LAST_MODIFY_TIME>= ${START} and b.LAST_MODIFY_TIME< ${STOP} 
AND a.ACC_PROPERTY='YP_ACCOUNT'
GROUP BY
    date(b.LAST_MODIFY_TIME),
    b.CUSTOMER_NO,
    b.ACCOUNTING_PRODUCT,
    b.PRODUCT_CODE 
    WITH ur ",billdb_standby
trxfeejingfen,tfjfyufu,"SELECT COALESCE(CHAR(date(A.LAST_MODIFY_TIME)),'null')||COALESCE(CHAR(A.customer_no),'null')||COALESCE(CHAR(A.accounting_product),'null')||COALESCE(CHAR(A.product_code),'null')||'tfjfyufu' AS IDNOUSE,'tfjfyufu' as DATAORIGIN,
    date(A.LAST_MODIFY_TIME) as TRXDATE,
    A.customer_no as RECEIVERID, 
    A.customer_no as CUSTOMERNUMBER,
    A.accounting_product as SALES_PRODUCT_CODE,
    A.product_code as PRODUCT_CODE,
    'Sales' as type,
    SUM(A.TRX_AMOUNT) AS trxfee 
FROM
    ACCTG.TBL_ACC_REQUEST_1802 A
LEFT JOIN
    ACCTG.TBL_ACC_REQUEST_DETAIL_1802 B
ON
    A.ID = B.ACC_REQUEST_ID
WHERE
'etlnokill123123123'='etlnokill123123123' and
    A.ACC_TYPE='DEBIT'
AND A.STATUS='SUCCESS' 
    and A.LAST_MODIFY_TIME>= ${START} and A.LAST_MODIFY_TIME< ${STOP} 
AND B.ACC_DIRECTION='CREDIT'
GROUP BY
    date(A.LAST_MODIFY_TIME),
    A.customer_no,
    A.accounting_product,
    A.product_code WITH ur",billdb_standby
trxfeejingfen,tfjfdakuan,"SELECT COALESCE(CHAR(date(A.LAST_MODIFY_TIME)),'null')||COALESCE(CHAR(B.customer_no),'null')||COALESCE(CHAR(A.accounting_product),'null')||COALESCE(CHAR(A.product_code),'null')||'tfjfdakuan' AS IDNOUSE,'tfjfdakuan' as DATAORIGIN,
    date(A.LAST_MODIFY_TIME) as TRXDATE,
    B.customer_no as RECEIVERID,
   B.customer_no as CUSTOMERNUMBER,
    A.accounting_product as SALES_PRODUCT_CODE,
    A.product_code as PRODUCT_CODE,
    'Sales' as type,
    SUM(
        CASE A.fee_type
            WHEN 'INNER'
            THEN A.fee
            ELSE 0
        END +
        CASE A.target_fee_type
            WHEN 'INNER'
            THEN A.target_fee
            ELSE 0
        END) AS trxfee 
FROM
    ACCTG.TBL_TRX_REQUEST_1802 A
LEFT JOIN
    ACCTG.TBL_REMIT_DETAIL_1802 B
ON
    A.ID = B.TRX_REQUEST_ID
WHERE
'etlnokill123123123'='etlnokill123123123' and
    A.STATUS='SUCCESS'
AND
    CASE A.fee_type
        WHEN 'INNER'
        THEN A.fee
        ELSE 0
    END +
    CASE A.target_fee_type
        WHEN 'INNER'
        THEN A.target_fee
        ELSE 0
    END >0 
    and A.LAST_MODIFY_TIME>= ${START} and A.LAST_MODIFY_TIME< ${STOP} 
GROUP BY
    date(A.LAST_MODIFY_TIME),
    B.customer_no,
    A.accounting_product,
    A.product_code WITH ur",billdb_standby
trxfeejingfen,tfjftuikuan,"SELECT COALESCE(CHAR(date(LAST_MODIFY_TIME)),'null')||COALESCE(CHAR(customer_no),'null')||COALESCE(CHAR(accounting_product),'null')||COALESCE(CHAR(product_code),'null')||'tfjftuikuan'   AS IDNOUSE,'tfjftuikuan' as DATAORIGIN,
    date(LAST_MODIFY_TIME) as TRXDATE,
    customer_no as RECEIVERID,
  customer_no as CUSTOMERNUMBER,
    accounting_product as SALES_PRODUCT_CODE,
    product_code as PRODUCT_CODE,
    'Sales' as type,
    SUM(SRC_REFUND_FEE +TARGET_REFUND_FEE) AS refundfee 
FROM
    ACCTG.TBL_ACQUIRING_REFUND
WHERE
'etlnokill123123123'='etlnokill123123123' and
    REFUND_STATUS = 1
AND SRC_REFUND_FEE +TARGET_REFUND_FEE>0
    and LAST_MODIFY_TIME>= ${START} and LAST_MODIFY_TIME< ${STOP} 
GROUP BY
    date(LAST_MODIFY_TIME),
    customer_no,
    accounting_product,
    product_code WITH ur",billdb_standby
trxfeejingfen,trxfeejfnum,"select customernumber as receiverid,id as custid from db2inst1.customerinfo  with ur",reportdb
accountcostjingfen,accostshoukuan,"select 
COALESCE(CHAR(a.clear_date),'null')||COALESCE(CHAR(a.CUSTOMER_NO),'null')||COALESCE(CHAR(a.ACCOUNTING_PRODUCT_CODE),'null')
||COALESCE(CHAR(a.MARKETING_PRODUCT_CODE),'null')||coalesce(char(a.bi_code),'null')||coalesce(char(a.BUSI_ANAL1),'null')||coalesce(char(a.TERMINAL_NO),'null')||coalesce(char(a.mcc),'null')||coalesce(char(t.card_type),'null')||'accostshoukuan' AS IDNOUSE,
a.clear_date AS TRXDATE,
a.CUSTOMER_NO as customernumber,
a.CUSTOMER_NO AS RECEIVERID,
a.bi_code as trxchannelid,
a.ACCOUNTING_PRODUCT_CODE AS PRODUCT_CODE,
a.MARKETING_PRODUCT_CODE  AS SALES_PRODUCT_CODE,
'Sales' as type,
sum(a.cost1+coalesce(a.cost3,0.00)+coalesce(a.cost4,0.00))  as accountingcost,
sum(a.OPER_COST) as externalcost,
(CASE 
            WHEN t.card_type='J' 
            THEN 'DEBIT' 
            WHEN t.card_type='X' 
            THEN 'CREDIT' 
            ELSE t.card_type
 END ) cardtype,
a.TERMINAL_NO as bank_customer_number,
a.mcc as mcc,
a.BUSI_ANAL1 as trxchannelid_frp,
sum(a.RECEIVE_MONEY) as trxamount,
count(*) as trxcount
from charge.actual_0001 a left join charge.bp_item t on a.itemid=t.id
where a.clear_date =${START} 
group by a.clear_date,a.customer_no,a.marketing_product_code,a.accounting_product_code,a.bi_code,a.BUSI_ANAL1,a.TERMINAL_NO,a.mcc,t.card_type
with ur",checkdb
COMMISSIONCHUANXIAO,commissionchuanxiao01,"SELECT IDNOUSE,RECEIVERID,SALES_PRODUCT_CODE,PRODUCT_CODE,BIZTYPEID,TYPE,dataorigin,MONTH,date(${STOP}) - 1 days as trxdate ,
date(${STOP}) - 1 days as true_trxdate ,
case when allayFee is null then FEE 
else FEE + allayFee  end as TRXFEE
FROM (SELECT coalesce(char(LORD_CODE),'null') ||coalesce(char(year(SHARE_DATE)),'null')||coalesce(char(month(SHARE_DATE)),'null')||'commissionchuanxiao01' as IDNOUSE ,
LORD_CODE as RECEIVERID ,
'3011001001003A' as SALES_PRODUCT_CODE ,
'3011001001003' as PRODUCT_CODE ,
301 as BIZTYPEID ,
'COMMISSION_LIKER' as TYPE ,
'lianmeng' as dataorigin ,
year(SHARE_DATE) * 100 + month(SHARE_DATE) as MONTH ,
sum(-SHARE) AS FEE 
FROM ymf.ALC_SHARE
WHERE  SHARE_DATE >= ${START} and SHARE_DATE < ${STOP} and ((SHARE_TYPE = 'ALLIANCE' AND CUSTOMER_NUMBER <> LORD_CODE)
 OR SHARE_TYPE = 'AGENT') 
group by LORD_CODE,year(SHARE_DATE),month(SHARE_DATE) 
) a
 left join 
(select lord_code as lord,sum(share) as allayFee from ymf.alc_share 
where share_type = 'ALLIANCE' and mer_type = 'ALLY' and SHARE_DATE >= ${START} and SHARE_DATE < ${STOP}
and lord_code in 
(select CUSTOMER_NUMBER from ymf.alc_share_rules where STATUS = 'ACTIVE' group by CUSTOMER_NUMBER)
group by lord_code) b on a.RECEIVERID = b.lord 
WITH ur",dzh_standby
inputcustomertradedatajob,DAILYTRXSTAT2,"SELECT CU.ID AS CUSTOMER_ID
		, CU.MERCHANTNO AS CUSTOMER_NO
		, CU.CUSTOMERNUMBER AS RECEIVERID
		, CU.VMARK AS CUSTOMER_LEVEL
		, D.TRXDATE
		, PP.ACCOUNTINGTYPE
		, D.PRODUCT_CODE
		, P.PRODUCTNAME
		, D.SALES_PRODUCT_CODE
		, SP.PRODUCTNAME AS RETAIL_PRODUCT_NAME
		, D.BIZTYPEID
		, TB.DISPLAYNAME
		, D.TYPE AS TRADE_TYPE
		, TT.NAME AS TRADE_NAME
		, CS.EMPLOYEE_ID
		, EM.EMPLOYEE_NAME
		, EM.SALES_LEVEL AS EMPLOYEE_LEVEL
		, CU.AGENTCODE
		, CU.AGENTNAME
		, CU.BUSSINESSCATID
		, TG.NAME AS BUSSINESSCATNAME
		, CASE WHEN CS.ISSELF=0 THEN 'è½' ELSE '_' END AS ISSELF
		, DEC(CS.SHARESCALE*100,10,0)||'%' AS SHARESCALE
		, D.FEETYPE
		, D.TRXCHANNELID
		, CU.BRANCHCOMPANY
		, TA.BRANCHNAME
		, EMU.EMPLOYEE_NAME AS SUPER
		, DEC(SUM(D.TRXCOUNT*CS.SHARESCALE),18,4) AS TRADE_NUM
		, DEC(SUM(D.TRXAMOUNT*CS.SHARESCALE),18,4) AS TRADE_AMOUNT
		, DEC(SUM(D.REFUNDCOUNT*CS.SHARESCALE),18,4) AS REFUND_NUM
		, DEC(SUM(D.REFUNDAMOUNT*CS.SHARESCALE),18,4) AS REFUND_AMOUNT
		, DEC(SUM(D.TRXFEE*CS.SHARESCALE),18,4)  AS TRADE_FEE
		, DEC(SUM(D.REFUNDFEE*CS.SHARESCALE),18,4) AS REFUND_FEE
		, DEC((CASE WHEN SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)*(CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END))<=0 THEN 0 ELSE CASE WHEN SUM(D.TRXAMOUNT*CS.SHARESCALE)<=0 THEN 0 ELSE SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)*(CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END))/SUM(D.TRXAMOUNT*CS.SHARESCALE) END END)*100,18,4) AS CONTRACT_RATE
		
		, DEC(SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)),18,4) AS INCOME
		, DEC(SUM(D.ACCOUNTINGCOST*CS.SHARESCALE),18,4) AS COST
		, DEC(SUM(D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE-D.ACCOUNTINGCOST*CS.SHARESCALE),18,4) AS GROSS_PROFIT
		, CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END AS SALESRATIO
		, D.ID AS DAILY_ID
		, D.PAYERID AS PAYERID
		, D.ORDERTYPE AS ORDERTYPE
		, CU.AGENTTYPE AS AGENTTYPE
		, D.ACCOUNTINGCOST AS ACCOUNTINGCOST
		, CU.FULLNAME
		, PCS.EMPLOYEE_ID AS P_EMPLOYEE_ID
		, PEM.EMPLOYEE_NAME AS P_EMPLOYEE_NAME
		, PCU.FULLNAME AS P_FULLNAME
		, CURRENT TIMESTAMP AS CREATE_TIME
		,CU.PRODUCTLINE
FROM DB2INST1.DAILYTRXSTAT D
		LEFT JOIN DB2INST1.CUSTOMERINFO CU ON D.RECEIVERID=CU.ID
		LEFT JOIN DB2INST1.CUSTOMERINFO PCU ON D.PAYERID=PCU.ID
		LEFT JOIN DB2INST1.TRXSTATBIZTYPE TB ON D.BIZTYPEID=TB.ID 
		LEFT JOIN DB2INST1.TRXSTATTRXTYPE TT ON D.TYPE=TT.ID 
		LEFT JOIN DB2INST1.PRODUCTCODE P ON D.PRODUCT_CODE=P.PRODUCTCODE AND P.PRODUCTTYPE=2 
		LEFT JOIN DB2INST1.PRODUCTCODE SP ON D.SALES_PRODUCT_CODE=SP.PRODUCTCODE AND SP.PRODUCTTYPE=1
		LEFT JOIN DB2INST1.PRODUCTCODE_PROFILE PP ON D.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE AND D.PRODUCT_CODE=PP.PRODUCT_CODE
		LEFT JOIN TBL_CUSTOMER_RELATIONSHIP CS ON CU.ID=CS.CUSTOMER_ID AND CS.MONTH=YEAR(CURRENT DATE) || '-' || (MONTH((CURRENT TIMESTAMP)-day(current  date) days)) || '_'
		LEFT JOIN TBL_CUSTOMER_RELATIONSHIP PCS ON D.PAYERID=PCS.CUSTOMER_ID AND PCS.MONTH=YEAR(CURRENT DATE) || '-' || (MONTH((CURRENT TIMESTAMP)-day(current  date) days)) || '_'
		LEFT JOIN TBL_EMPLOYEEINFO PEM ON PCS.EMPLOYEE_ID=PEM.ID
		LEFT JOIN TBL_EMPLOYEEINFO EM ON CS.EMPLOYEE_ID=EM.ID 
		LEFT JOIN DB2INST1.TRXSTATBUSINESSCATEGORIE TG ON CU.BUSSINESSCATID=TG.ID 
		LEFT JOIN DB2INST1.TRXSTATCUSTOMERAREA TA ON CU.BRANCHCOMPANY=TA.AREAID
		LEFT JOIN TBL_EMPLOYEEINFO EMU ON EM.SUPER_ID=EMU.ID 
		LEFT JOIN DB2INST1.MONTHLYT_CUSTOMER_SALESRATIO MCS ON D.PRODUCT_CODE = MCS.SALES_PRODUCT_CODE 
		              AND CU.ID = MCS.CUSTOMER_ID AND MCS.MONTH=REPLACE(SUBSTR((CURRENT date)-day(current  date) days,1,7),'-','')
		WHERE 1=1 AND D.ISCOMPUTEBONUS=1 
		AND D.TRXDATE BETWEEN LAST_DAY(current date - 2 months) + 1 day AND LAST_DAY(current date - 1 months)
		and (d.type not in ('POSRENT','POSSALES') or d.type is null)
		GROUP BY D.ID,D.PAYERID,D.ORDERTYPE,CU.AGENTTYPE,EM.SALES_LEVEL,CU.VMARK,CU.MERCHANTNO,MCS.SALESRATIO,CU.ID
		    ,CU.CUSTOMERNUMBER,D.TRXDATE,PP.ACCOUNTINGTYPE,D.PRODUCT_CODE,P.PRODUCTNAME,D.SALES_PRODUCT_CODE,SP.PRODUCTNAME
		    ,D.BIZTYPEID,TB.DISPLAYNAME,D.TYPE,TT.NAME,CS.EMPLOYEE_ID,EM.EMPLOYEE_NAME,CU.AGENTCODE,CU.AGENTNAME,CU.BUSSINESSCATID,TG.NAME
		    ,CS.ISSELF,CS.SHARESCALE,D.FEETYPE,D.TRXCHANNELID,CU.BRANCHCOMPANY,TA.BRANCHNAME,EMU.EMPLOYEE_NAME
		    , D.ID
			, D.PAYERID
			, D.ORDERTYPE
			, CU.AGENTTYPE
			, D.ACCOUNTINGCOST
			, CU.FULLNAME
			, PCS.EMPLOYEE_ID
			, PEM.EMPLOYEE_NAME
			, PCU.FULLNAME
			, CU.PRODUCTLINE
		WITH UR",reportdb_yjkh
inputcustomerTradeData,dailytrxstat,"SELECT TB.* ,ROW_NUMBER() OVER() AS ROWNUM  FROM(SELECT CU.ID AS CUSTOMER_ID
		, CU.MERCHANTNO AS CUSTOMER_NO
		, CU.CUSTOMERNUMBER AS RECEIVERID
		, CU.VMARK AS CUSTOMER_LEVEL
		, D.TRXDATE AS TRXDATE
		, PP.ACCOUNTINGTYPE AS ACCOUNTINGTYPE
		, D.PRODUCT_CODE AS PRODUCT_CODE
		, P.PRODUCTNAME AS PRODUCTNAME
		, D.SALES_PRODUCT_CODE AS SALES_PRODUCT_CODE
		, SP.PRODUCTNAME AS RETAIL_PRODUCT_NAME
		, D.BIZTYPEID AS BIZTYPEID
		, TB.DISPLAYNAME AS DISPLAYNAME
		, D.TYPE AS TRADE_TYPE
		, TT.NAME AS TRADE_NAME
		, CS.EMPLOYEE_ID AS EMPLOYEE_ID
		, EM.EMPLOYEE_NAME AS EMPLOYEE_NAME
		, EM.SALES_LEVEL AS EMPLOYEE_LEVEL
		, CU.AGENTCODE AS AGENTCODE
		, CU.AGENTNAME AS AGENTNAME
		, CU.BUSSINESSCATID AS BUSSINESSCATID
		, TG.NAME AS BUSSINESSCATNAME
		, CASE WHEN CS.ISSELF=0 THEN 'è½' ELSE '_' END AS ISSELF
		, CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END AS SHARESCALE
		, D.FEETYPE AS FEETYPE
		, D.TRXCHANNELID AS TRXCHANNELID
		, CU.BRANCHCOMPANY AS BRANCHCOMPANY
		, TA.BRANCHNAME AS BRANCHNAME
		, EMU.EMPLOYEE_NAME AS SUPER
		, DEC(SUM(D.TRXCOUNT*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS TRADE_NUM
		, DEC(SUM(D.TRXAMOUNT*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS TRADE_AMOUNT
		, DEC(SUM(D.REFUNDCOUNT*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS REFUND_NUM
		, DEC(SUM(D.REFUNDAMOUNT*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS REFUND_AMOUNT
		, DEC(SUM(D.TRXFEE*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4)  AS TRADE_FEE
		, DEC(SUM(D.REFUNDFEE*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS REFUND_FEE
		, DEC((CASE WHEN SUM((D.TRXFEE*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)-
		D.REFUNDFEE*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END))*
		(CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END))<=0 THEN 0 
		ELSE CASE WHEN SUM(D.TRXAMOUNT*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END))<=0 
		THEN 0 ELSE SUM((D.TRXFEE*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)-
		D.REFUNDFEE*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END))*
		(CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END))/SUM(D.TRXAMOUNT*
		(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)) END END)*100,18,4) AS CONTRACT_RATE
		, DEC(SUM((D.NEWTRXFEE-D.NEWREFUNDFEE+D.MANAGEFEE-D.AGENTFEE)*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS INCOME
		, DEC(SUM((D.NEWCOST+D.EXTERNALCOST)*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS COST
		, DEC(SUM((D.NEWTRXFEE-D.NEWREFUNDFEE+D.MANAGEFEE-D.NEWCOST-D.EXTERNALCOST-D.AGENTFEE)*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS GROSS_PROFIT
		, CASE WHEN MCS.SALESRATIO>0 THEN MCS.SALESRATIO ELSE 1 END AS SALESRATIO
		, D.ID AS DAILY_ID
		, D.PAYERID AS PAYERID
		, D.ORDERTYPE AS ORDERTYPE
		, CU.AGENTTYPE AS AGENTTYPE
		, D.ACCOUNTINGCOST AS ACCOUNTINGCOST
		, CU.FULLNAME AS FULLNAME
		, PCS.EMPLOYEE_ID AS P_EMPLOYEE_ID
		, PEM.EMPLOYEE_NAME AS P_EMPLOYEE_NAME
		, PCU.FULLNAME AS P_FULLNAME
		, CURRENT TIMESTAMP AS CREATE_TIME
		, CU.PRODUCTLINE as PRODUCTLINE
		, DEC(SUM((D.NEWTRXFEE-D.NEWREFUNDFEE+D.MANAGEFEE-D.NEWCOST-D.EXTERNALCOST-D.AGENTFEE)*(CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS REAL_PROFIT
		FROM DB2INST1.DAILYTRXSTAT D
		LEFT JOIN DB2INST1.CUSTOMERINFO CU ON D.RECEIVERID=CU.ID
		LEFT JOIN DB2INST1.CUSTOMERINFO PCU ON D.PAYERID=PCU.ID
		LEFT JOIN DB2INST1.TRXSTATBIZTYPE TB ON D.BIZTYPEID=TB.ID 
		LEFT JOIN DB2INST1.TRXSTATTRXTYPE TT ON D.TYPE=TT.ID 
		LEFT JOIN DB2INST1.PRODUCTCODE P ON D.PRODUCT_CODE=P.PRODUCTCODE AND P.PRODUCTTYPE=2 
		LEFT JOIN DB2INST1.PRODUCTCODE SP ON D.SALES_PRODUCT_CODE=SP.PRODUCTCODE AND SP.PRODUCTTYPE=1
		LEFT JOIN DB2INST1.PRODUCTCODE_PROFILE PP ON D.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE AND D.PRODUCT_CODE=PP.PRODUCT_CODE
		LEFT JOIN TBL_CUSTOMER_RELATIONSHIP CS ON CU.ID=CS.CUSTOMER_ID AND CS.MONTH=YEAR(CURRENT DATE) || '-' || (MONTH((CURRENT TIMESTAMP)-day(current  date) days)) || '_'
		LEFT JOIN TBL_CUSTOMER_RELATIONSHIP PCS ON D.PAYERID=PCS.CUSTOMER_ID AND PCS.MONTH=YEAR(CURRENT DATE) || '-' || (MONTH((CURRENT TIMESTAMP)-day(current  date) days)) || '_'
		LEFT JOIN TBL_EMPLOYEEINFO PEM ON PCS.EMPLOYEE_ID=PEM.ID
		LEFT JOIN TBL_EMPLOYEEINFO EM ON CS.EMPLOYEE_ID=EM.ID 
		LEFT JOIN DB2INST1.TRXSTATBUSINESSCATEGORIE TG ON CU.BUSSINESSCATID=TG.ID 
		LEFT JOIN DB2INST1.TRXSTATCUSTOMERAREA TA ON CU.BRANCHCOMPANY=TA.AREAID
		LEFT JOIN TBL_EMPLOYEEINFO EMU ON EM.SUPER_ID=EMU.ID 
		LEFT JOIN DB2INST1.MONTHLYT_CUSTOMER_SALESRATIO MCS ON D.PRODUCT_CODE = MCS.SALES_PRODUCT_CODE 
		              AND CU.ID = MCS.CUSTOMER_ID AND MCS.MONTH=REPLACE(SUBSTR((CURRENT date)-day(current  date) days,1,7),'-','')  
		LEFT JOIN DB2INST1.CUSTOMERINFO AG ON CU.AGENTCODE=AG.CUSTOMERNUMBER 
 		LEFT JOIN TBL_CUSTOMER_RELATIONSHIP AGCS ON AG.ID=AGCS.CUSTOMER_ID AND AGCS.MONTH=YEAR(CURRENT DATE) || '-' || (MONTH((CURRENT TIMESTAMP)-day(current  date) days)) || '_'         
		WHERE 1=1 AND D.ISCOMPUTEBONUS=1 
		AND D.TRXDATE BETWEEN LAST_DAY(current date - 2 months) + 1 day AND LAST_DAY(current date - 1 months)
		and (d.type not in ('POSRENT','POSSALES','ACTIVATIONFEE','SYSTEMFEE','SERVICEFEE') or d.type is null) 
		GROUP BY D.ID,D.PAYERID,D.ORDERTYPE,CU.AGENTTYPE,EM.SALES_LEVEL,CU.VMARK,CU.MERCHANTNO,MCS.SALESRATIO,CU.ID
		    ,CU.CUSTOMERNUMBER,D.TRXDATE,PP.ACCOUNTINGTYPE,D.PRODUCT_CODE,P.PRODUCTNAME,D.SALES_PRODUCT_CODE,SP.PRODUCTNAME
		    ,D.BIZTYPEID,TB.DISPLAYNAME,D.TYPE,TT.NAME,CS.EMPLOYEE_ID,EM.EMPLOYEE_NAME,CU.AGENTCODE,CU.AGENTNAME,CU.BUSSINESSCATID,TG.NAME
		    ,CS.ISSELF,CS.SHARESCALE,D.FEETYPE,D.TRXCHANNELID,CU.BRANCHCOMPANY,TA.BRANCHNAME,EMU.EMPLOYEE_NAME
		    , CASE WHEN CS.SHARESCALE is not null then coalesce(CS.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END
		    , D.ID
			, D.PAYERID
			, D.ORDERTYPE
			, CU.AGENTTYPE
			, D.ACCOUNTINGCOST
			, CU.FULLNAME
			, PCS.EMPLOYEE_ID
			, PEM.EMPLOYEE_NAME
			, PCU.FULLNAME
			, CU.PRODUCTLINE
		WITH UR) TB",reportdb_yjkh
inputpostpaidprofitdatajob,dailytrxstatpost,"SELECT TB.* ,ROW_NUMBER() OVER() AS ROWNUM  FROM(SELECT 
			CU.ID as CUSTOMER_ID
			, CU.MERCHANTNO as CUSTOMER_NO
			, CU.CUSTOMERNUMBER as RECEIVERID
			, CU.VMARK as CUSTOMER_LEVEL
			, '___' as ACCOUNTINGTYPE
			, '' as PRODUCT_CODE
			, '' as PRODUCTNAME
			, '' as SALES_PRODUCT_CODE
			, '' as RETAIL_PRODUCT_NAME
			, PP.BILLMONTH
			, 'REALPAID' as TRADE_TYPE
			, '___å®__æ¬' as TRADE_NAME
			, EM.ID  as EMPLOYEE_ID
			, EM.NAME  as EMPLOYEE_NAME
			, EM.SALES_LEVEL as EMPLOYEE_LEVEL
			, CU.AGENTCODE as AGENTCODE
			, CU.AGENTNAME as AGENTNAME
			, CU.BUSSINESSCATID as BUSSINESSCATID
			, TG.NAME as BUSSINESSCATNAME
			, CASE WHEN REL.ISSELF=0 THEN 'è½' ELSE '_' END AS ISSELF
			, CASE WHEN REL.SHARESCALE is not null then coalesce(REL.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END AS SHARESCALE
			, PP.RECEIVEFEE as FEETYPE
			, '' as TRXCHANNELID
			, CU.BRANCHCOMPANY as BRANCHCOMPANY
			, TA.BRANCHNAME as BRANCHNAME
			, EMU.NAME as SUPER
			, DEC(0.0000,18,4) as TRADE_NUM
			, DEC(0.0000,18,4) as TRADE_AMOUNT
			, DEC(0.0000,18,4) as REFUND_NUM
			, DEC(0.0000,18,4) as REFUND_AMOUNT
			, DEC(0.0000,18,4) as TRADE_FEE
			, DEC(0.0000,18,4) as REFUND_FEE
			, DEC(0.0000,18,4) as CONTRACT_RATE
			, DEC(SUM(PP.RECEIVEFEE*(CASE WHEN REL.SHARESCALE is not null then coalesce(REL.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END)),18,4) AS INCOME 
			, DEC(0.0000,18,4) as COST
			, DEC(SUM(PP.RECEIVEFEE*CASE WHEN REL.SHARESCALE is not null then coalesce(REL.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END),18,4) AS GROSS_PROFIT
			, DEC(1.0000,18,4) as SALESRATIO
			, CU.FULLNAME AS FULLNAME
			, CURRENT TIMESTAMP AS CREATE_TIME
			,CU.PRODUCTLINE
			,CU.PRODUCTLINEID AS POSTPAID_PERIOD
			,SUM(case 
                  WHEN timestampdiff(64,char(current timestamp-timestamp(substr(PP.billmonth,1,4)||'-'||substr(PP.billmonth,5,2)||'-01')))-CU.PRODUCTLINEID-1>6
                  THEN 0
                  WHEN timestampdiff(64,char(current timestamp-timestamp(substr(PP.billmonth,1,4)||'-'||substr(PP.billmonth,5,2)||'-01')))-CU.PRODUCTLINEID-1>3
                  THEN DEC(PP.RECEIVEFEE*(CASE WHEN REL.SHARESCALE is not null then coalesce(REL.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END),18,4)*0.3
                  WHEN timestampdiff(64,char(current timestamp-timestamp(substr(PP.billmonth,1,4)||'-'||substr(PP.billmonth,5,2)||'-01')))-CU.PRODUCTLINEID-1>1
                  THEN DEC(PP.RECEIVEFEE*(CASE WHEN REL.SHARESCALE is not null then coalesce(REL.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END),18,4)*0.5
                  WHEN timestampdiff(64,char(current timestamp-timestamp(substr(PP.billmonth,1,4)||'-'||substr(PP.billmonth,5,2)||'-01')))-CU.PRODUCTLINEID-1>0
                  THEN DEC(PP.RECEIVEFEE*(CASE WHEN REL.SHARESCALE is not null then coalesce(REL.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END),18,4)*0.6
                  ELSE DEC(PP.RECEIVEFEE*(CASE WHEN REL.SHARESCALE is not null then coalesce(REL.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END),18,4)
                  END)
             	 AS REAL_PROFIT
		FROM DB2INST1.postpaidreceivefee PP
		LEFT JOIN DB2INST1.CUSTOMERINFO CU ON PP.CUSTOMERNUMBER=CU.CUSTOMERNUMBER
		LEFT JOIN yjkh.TBL_CUSTOMER_RELATIONSHIP REL ON REL.CUSTOMER_ID=CU.ID AND REL.MONTH=YEAR(CURRENT TIMESTAMP) || '-' || (MONTH((CURRENT date)-day(current  date) days)) || '_'
		LEFT JOIN DB2INST1.EMPLOYEEINFO EM ON EM.ID=REL.EMPLOYEE_ID
		LEFT JOIN DB2INST1.EMPLOYEEINFO EMU ON EM.SUPERIORID=EMU.ID 
		LEFT JOIN DB2INST1.TRXSTATBUSINESSCATEGORIE TG ON CU.BUSSINESSCATID=TG.ID 
		LEFT JOIN DB2INST1.TRXSTATCUSTOMERAREA TA ON CU.BRANCHCOMPANY=TA.AREAID
		LEFT JOIN DB2INST1.CUSTOMERINFO AG ON CU.AGENTCODE=AG.CUSTOMERNUMBER 
        LEFT JOIN TBL_CUSTOMER_RELATIONSHIP AGCS ON AG.ID=AGCS.CUSTOMER_ID AND AGCS.MONTH=YEAR(CURRENT TIMESTAMP) || '-' || (MONTH((CURRENT date)-day(current  date) days)) || '_'
		WHERE PP.MONTH IN (REPLACE(SUBSTR((CURRENT date)-day(current  date) days,1,7),'-','')) 
		AND REL.ISSELF in (0,1) 
		GROUP BY CU.ID
			, CASE WHEN REL.SHARESCALE is not null then coalesce(REL.SHARESCALE,1)  else case when CU.AGENTCODE is not  NULL THEN  coalesce(AGCS.SHARESCALE,1)  else 1 END END
			, CU.MERCHANTNO
			, CU.CUSTOMERNUMBER
			, CU.VMARK
			, PP.BILLMONTH
			, EM.ID 
			, EM.NAME 
			, EM.SALES_LEVEL 
			, CU.AGENTCODE 
			, CU.AGENTNAME
			, CU.BUSSINESSCATID
			, REL.ISSELF
			, REL.SHARESCALE
			, PP.RECEIVEFEE
			, CU.BRANCHCOMPANY
			, EMU.NAME 
			, TG.NAME
			, TA.BRANCHNAME
			, CU.FULLNAME
			,CU.PRODUCTLINE
			,CU.PRODUCTLINEID
		WITH UR) TB",reportdb_yjkh
3gauthcost,3gauthcostall,"SELECT  '3gauthcostall'||request_date||fee_subject as IDNOUSE, request_date as trxdate,fee_subject as memo,sum(c) as trxcount,sum(fee) as cost,sum(fee) as accountingcost,'3011004003001' as product_code,
'3011004003001A' as sales_product_code,'_¨å_' as hangyeyejishuxing,24 as yejishuxing,226 as biztypeid,'3gauthcost' as type,
1 as operatorid,1 as iscomputeprofit,1 as computebonus,year(request_date)*100+month(request_date) as month,request_date as true_trxdate,
year(request_date)*100+month(request_date) as memomonth,'FOREIGN' as usetype,'026' as businesscatid,15 as branchid
FROM (
	(
		SELECT 
			o.request_date,s.fee_subject,count(1) c,sum(c.unit_price) fee,'1' 
		FROM 
			auth2.tbl_order_idcard o,auth2.tbl_docking_system s,auth2.tbl_docking_system_interface_config c
		WHERE 
			o.system_id = s.id 
			AND s.id = c.system_id 
			AND o.auth_type = c.auth_type
			AND c.auth_method = 'REPOSITORY_FIRST'
			AND o.auth_status IN ('SUCCESS','FAILURE','CANCELED')
			AND o.request_date  >=${START} and o.request_date< ${STOP}
		GROUP BY o.request_date,s.fee_subject
	)
	UNION
	(
		SELECT 
			o.request_date,s.fee_subject,count(1) c,sum(c.unit_price) fee,'2' 
		FROM 
			auth2.tbl_order_enterprise o,auth2.tbl_docking_system s,auth2.tbl_docking_system_interface_config c
		WHERE 
			o.system_id = s.id 
			AND s.id = c.system_id 
			AND o.auth_type = c.auth_type
			AND c.auth_method = 'REPOSITORY_FIRST'
			AND o.auth_status IN ('SUCCESS','FAILURE')
			AND o.request_date >=${START} and o.request_date< ${STOP}
		GROUP BY o.request_date,s.fee_subject
	)
	UNION
	(
		SELECT 
			o.request_date,s.FEE_SUBJECT,count(1) c,sum(c.unit_price) fee,'3'
		FROM 
			auth2.tbl_order_idcard_ocr o,auth2.tbl_docking_system s,auth2.tbl_docking_system_interface_config c
		WHERE 
			o.system_code = s.system_code 
			AND s.id = c.system_id
			AND c.auth_type = 'IDCARD_OCR' 
			AND c.auth_method = 'REPOSITORY_FIRST'
			AND o.status IN ('SUCCESS')
			AND o.request_date >=${START} and o.request_date< ${STOP}
		GROUP BY o.request_date,s.fee_subject
	)
	UNION
	(
		SELECT 
			o.request_date,s.fee_subject,count(1) c,sum(c.unit_price) fee,'4' 
		FROM 
			auth2.tbl_order_bankcard_ocr o,auth2.tbl_docking_system s,auth2.tbl_docking_system_interface_config c
		WHERE 
			o.system_code = s.system_code 
			AND s.id = c.system_id
			AND c.auth_type = 'BANKCARD_OCR' 
			AND c.auth_method = 'REPOSITORY_FIRST'
			AND o.status IN ('SUCCESS')
			AND o.request_date >=${START} and o.request_date< ${STOP}
		GROUP BY o.request_date,s.fee_subject
	)
	UNION
	(
		SELECT o.request_date,s.fee_subject,count(1) c,sum(c.unit_price) fee,'5' 
		FROM auth2.tbl_order_avatar_compare o,auth2.tbl_docking_system s,auth2.tbl_docking_system_interface_config c
		WHERE o.system_code = s.system_code 
			AND s.id = c.system_id
			AND c.auth_type = 'AVATAR_COMPARE' 
			AND c.auth_method = 'REPOSITORY_FIRST'
			AND o.status IN ('SUCCESS')
			AND o.request_date >=${START} and o.request_date< ${STOP}
		GROUP BY o.request_date,s.fee_subject
	)
)
GROUP BY request_date,fee_subject",basic
inputonetimeincomejob,onetimeincome1,"SELECT 
  		D.TRXDATE as TRXDATE
		,PP.ACCOUNTINGTYPE as ACCOUNTINGTYPE
		,D.PRODUCT_CODE as PRODUCT_CODE
		,P.PRODUCTNAME as PRODUCTNAME
		,D.SALES_PRODUCT_CODE as SALES_PRODUCT_CODE
		,SP.PRODUCTNAME as RETAIL_PRODUCT_NAME
		,D.BIZTYPEID as BIZTYPEID
		,TB.DISPLAYNAME as DISPLAYNAME
		,D.TYPE as TRADE_TYPE
		,TT.NAME as TRADE_NAME
		,EM.ID as EMPLOYEE_ID
		,EM.NAME as EMPLOYEE_NAME
		,D.BUSINESSCATID as BUSSINESSCATID
		,TG.NAME as BUSSINESSCATNAME
		,TA.AREAID as BRANCHCOMPANY
		,TA.BRANCHNAME as BRANCHNAME
		,EMU.NAME as SUPER
		,SUM(D.INCOME) AS INCOME
		,SUM(D.COST) AS COST
		,SUM(D.INCOME-D.COST) AS GROSS_PROFIT
		,1 AS TYPE
		,D.CREATEDATE as CREATE_TIME
	FROM DB2INST1.TRXSTATADDITIONALSTATFEE D
	LEFT JOIN DB2INST1.TRXSTATBIZTYPE TB ON D.BIZTYPEID=TB.ID
	LEFT JOIN DB2INST1.TRXSTATTRXTYPE TT ON D.TYPE=TT.ID
	LEFT JOIN DB2INST1.PRODUCTCODE P ON D.PRODUCT_CODE=P.PRODUCTCODE AND P.PRODUCTTYPE=2
	LEFT JOIN DB2INST1.PRODUCTCODE SP ON D.SALES_PRODUCT_CODE=SP.PRODUCTCODE AND SP.PRODUCTTYPE=1
	LEFT JOIN DB2INST1.PRODUCTCODE_PROFILE PP ON D.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE AND D.PRODUCT_CODE=PP.PRODUCT_CODE
	LEFT JOIN DB2INST1.EMPLOYEEINFO EM ON D.SALESID=EM.ID
	LEFT JOIN DB2INST1.TRXSTATBUSINESSCATEGORIE TG ON D.BUSINESSCATID=TG.ID
	LEFT JOIN DB2INST1.TRXSTATCUSTOMERAREA TA ON D.BRANCHID=TA.ID
	LEFT JOIN DB2INST1.EMPLOYEEINFO EMU ON EM.SUPERIORID=EMU.ID
	WHERE D.TRXDATE BETWEEN LAST_DAY(current date - 2 months) + 1 day AND  LAST_DAY(current date - 1 months) 
		AND D.USETYPE='ADDITIONAL' AND D.COMPUTEBONUS=1
	GROUP BY D.TRXDATE,D.CREATEDATE,PP.ACCOUNTINGTYPE,D.PRODUCT_CODE,P.PRODUCTNAME,D.SALES_PRODUCT_CODE,SP.PRODUCTNAME,D.BIZTYPEID,TB.DISPLAYNAME,D.TYPE,TT.NAME,EM.ID,EM.NAME,D.BUSINESSCATID,TG.NAME,TA.AREAID,TA.BRANCHNAME,EMU.NAME",reportdb_yjkh
inputonetimeincomejob,onetimeincome2,"SELECT 
        D.TRXDATE AS TRXDATE
      , PP.ACCOUNTINGTYPE AS ACCOUNTINGTYPE
      , D.PRODUCT_CODE AS PRODUCT_CODE
      , P.PRODUCTNAME AS PRODUCTNAME
      , D.SALES_PRODUCT_CODE AS SALES_PRODUCT_CODE
      , SP.PRODUCTNAME AS RETAIL_PRODUCT_NAME
      , D.BIZTYPEID AS BIZTYPEID
      , TB.DISPLAYNAME AS DISPLAYNAME
      , D.TYPE AS TRADE_TYPE
      , TT.NAME AS TRADE_NAME
      , CS.EMPLOYEE_ID AS EMPLOYEE_ID
      , EM.EMPLOYEE_NAME AS EMPLOYEE_NAME
      , CU.BUSSINESSCATID AS BUSSINESSCATID 
      , TG.NAME AS BUSSINESSCATNAME
      , CU.BRANCHCOMPANY AS BRANCHCOMPANY
      , TA.BRANCHNAME AS BRANCHNAME
      , EMU.EMPLOYEE_NAME AS SUPER
      , DEC(SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)),18,4) AS INCOME
      , DEC(SUM(D.ACCOUNTINGCOST*CS.SHARESCALE),18,4) AS COST
      , DEC(SUM(D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE-D.ACCOUNTINGCOST*CS.SHARESCALE),18,4) AS GROSS_PROFIT
      , 2 AS TYPE
      , CURRENT TIMESTAMP AS CREATE_TIME
      , D.MEMO AS SN
      FROM DB2INST1.DAILYTRXSTAT D 
    LEFT JOIN DB2INST1.CUSTOMERINFO CU ON D.RECEIVERID=CU.ID  
    LEFT JOIN DB2INST1.TRXSTATBIZTYPE TB ON D.BIZTYPEID=TB.ID 
    LEFT JOIN DB2INST1.TRXSTATTRXTYPE TT ON D.TYPE=TT.ID 
    LEFT JOIN DB2INST1.PRODUCTCODE P ON D.PRODUCT_CODE=P.PRODUCTCODE AND P.PRODUCTTYPE=2 
    LEFT JOIN DB2INST1.PRODUCTCODE SP ON D.SALES_PRODUCT_CODE=SP.PRODUCTCODE AND SP.PRODUCTTYPE=1 
    LEFT JOIN DB2INST1.PRODUCTCODE_PROFILE PP ON D.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE AND D.PRODUCT_CODE=PP.PRODUCT_CODE  
    LEFT JOIN TBL_CUSTOMER_RELATIONSHIP CS ON CU.ID=CS.CUSTOMER_ID AND CS.MONTH=
    YEAR(CURRENT TIMESTAMP) || '-' || (MONTH((CURRENT date)-day(current  date) days)) || '_' 
    LEFT JOIN TBL_EMPLOYEEINFO EM ON CS.EMPLOYEE_ID=EM.ID 
    LEFT JOIN DB2INST1.TRXSTATBUSINESSCATEGORIE TG ON CU.BUSSINESSCATID=TG.ID 
    LEFT JOIN DB2INST1.TRXSTATCUSTOMERAREA TA ON CU.BRANCHCOMPANY=TA.AREAID 
    LEFT JOIN TBL_EMPLOYEEINFO EMU ON EM.SUPER_ID=EMU.ID 
    WHERE  D.ISCOMPUTEBONUS=1 AND D.TRXDATE BETWEEN LAST_DAY(current date - 2 months) + 1 day AND LAST_DAY(current date - 1 months)  
    and d.type in ('POSRENT','POSSALES')
AND (D.MEMO IS NULL OR D.MEMO NOT IN (
		'J6N201407425',
		'J6N201407426',
		'J6N201407427'
) )
    GROUP BY D.TRXDATE,PP.ACCOUNTINGTYPE,D.PRODUCT_CODE,P.PRODUCTNAME,D.SALES_PRODUCT_CODE,SP.PRODUCTNAME
       ,D.BIZTYPEID,TB.DISPLAYNAME,D.TYPE,TT.NAME,CS.EMPLOYEE_ID,EM.EMPLOYEE_NAME,CU.BUSSINESSCATID,TG.NAME
       ,CS.SHARESCALE,CU.BRANCHCOMPANY,TA.BRANCHNAME,EMU.EMPLOYEE_NAME,D.MEMO,D.CREATEDATE
       , D.ID ",reportdb_yjkh
EPOSSALE,EPOSSALE,"select 
   p.externalId AS notes,p.trxDate AS trx_time,'CASH' AS account_type,'SALES' AS business_type,p.requestId AS merchant_orderid,t.amount AS income, 0 AS expenditure,
   ABS(COALESCE(p.target_fee, 0)) AS fee,
   a.postBalance AS balance,t.extendInfo AS extended_info,t.tempinfo AS order_number,'' AS refund_id,f.channel AS card_type,p.productName AS trx_type,
   cci.last4Place AS card_four,f.description AS bank,t.receiver_id  AS customer_no,'HK' as BUSINESS_OWN
from 
   MOBILEBE.accountHistory a
   left join MOBILEBE.PublishedTrx p  on a.trxId = p.id 
   left join MOBILEBE.payment pm on pm.id = p.id
   left join MOBILEBE.trxorder t on p.orderid=t.id 
   left join MOBILEBE.complexorder c on p.externalid=c.externalid
   left join MOBILEBE.frp f on p.frpid=f.id
   left join MOBILEBE.RevocationPayment rp on rp.originalTrx_id = pm.id and rp.revocation_flg <> rp.id
   left join MOBILEBE.creditcardinfo cci on cci.charid = pm.extinfo
   left join MOBILEBE.customer cus on cus.id = t.payer_id
where 
   a.account_id in (12533583, 15024855 ,14371428, 14371469, 14382357, 14778198, 14787719, 12857763, 15340417)
   and a.TRXDATE>= ${START} and a.TRXDATE < ${STOP} 
   and p.TARGET_CUSTID in (12233889,13518017,13187696,13187725,13193318,13393051,13397709,12408639,13675715)
   and p.CONFIRMORCANCEL >= char(timestamp(${START})) and p.CONFIRMORCANCEL < ${STOP}
   and p.TrxType in ('SALES', 'AUTHORIZE', 'DEBITNOCARDPAY')    
   and p.orderType<>'MERCHANT_SETTLE'
   and t.receiver_id in (12233889,13518017,13187696,13187725,13193318,13393051,13397709,12408639,13675715)
   and t.closeDate>=char(timestamp(${START})) and t.closeDate< ${STOP}
   and pm.targetAccountId in (12533583, 15024855 ,14371428, 14371469, 14382357, 14778198, 14787719, 12857763, 15340417)
   and pm.confirmOrCancel>=char(timestamp(${START})) and pm.confirmOrCancel < ${STOP}
   and pm.TrxType in ('SALES', 'AUTHORIZE')
   and pm.trxStatus = 'SUCCESS'
with ur",COPY2
AIR2GSALE,AIR2GSALE," select p.id AS IDNOUSE,recus.customernumber AS receiver_no ,recus.fullname AS receiver_name, ree.name AS receiver_sale,
 payercus.customernumber AS payer_no ,payercus.fullname AS payer_name, payere.name AS payer_sale,
 tx.orderdateonly AS tx_orderdateonly,tx.orderdate AS tx_orderdate,
 tx.amount AS tx_amount,tx.ordertype AS tx_ordertype,
 tx.requestid AS tx_requestid,tx.externalid AS tx_externalid,
 tx.orderoper AS tx_orderoper,tx.biztype AS tx_biztype,tx.channel AS tx_channel,
 tx.productcat AS tx_productcat,tx.productdesc AS tx_productdesc,
 p.id AS p_id, p.bankorderid AS p_bankorderid,p.banktrxid AS p_banktrxid,p.payway AS p_payway,p.payproduct AS p_payproduct,
 p.trxtype AS p_trxtype,p.trxstatus AS p_trxstatus,p.sourcefee AS p_sourcefee,p.targetfee AS p_targetfee,
 p.bankerrocode AS p_bankerrocode,p.bankerrorinfo AS p_bankerrorinfo,p.confirmorcancel AS p_confirmorcancel,p.trxdate AS p_trxdate,
 cci.debitelements AS cci_debitelements,cci.customererrorcode AS cci_customererrorcode,
(case when cci.customerErrormsg is null then '____' else cci.customerErrormsg end) as cci_customererrormsg,
 f.name AS frp_name,f.channel AS frp_channel,f.id AS frp_id,f.bank_id AS f_bank_id,'CNET' AS product_service
 from MOBILEBE.trxorder tx 
 left join MOBILEBE.customer recus on tx.receiver_id = recus.id 
 left join MOBILEBE.employee2customer reec on (recus.id=reec.cust_id)
 left join MOBILEBE.employee ree on (ree.id=reec.emp_id)  
 left join MOBILEBE.customer payercus on tx.payer_id = payercus.id  
 left join MOBILEBE.employee2customer payerec on (payercus.id=payerec.cust_id)
 left join MOBILEBE.employee payere on (payere.id=payerec.emp_id) , 
 MOBILEBE.payment p 
 left join MOBILEBE.creditcardinfo cci on cci.charid = p.extinfo 
 left join MOBILEBE.frp f on f.id = p.frp_id 
 where
 p.trxorder_id = tx.id
 and p.frp_id >= 8006330 
 and p.frp_id <= 8006335
 and tx.orderType in('AUTH','AUTHANDCONFIRM') 
 and p.trxType in ('AUTHORIZE','SALES') 
 and p.payproduct in ('EPOS_DEBIT','EPOS_CREDIT','EPOS_AIR_XTY')  
 and p.trxdate>= ${START} and p.trxdate < ${STOP} 
 with ur",COPY2
test123,tbl_pos_customer,"select pc.CUSTOMER_CODE,pc.PRODUCT_CODE,a.CORP_NAME as æ³_ºº
from TBL_POS_PRODUCTONCUSTOMER pc
left join TBL_POS_OA_CUSTOMER_INFO a on pc.CUSTOMER_CODE=a.CUSTOMER_NUMBER
where pc.CUSTOMER_CODE in 
(
select distinct c.customer_number
from tbl_pos_order o
left join tbl_pos_customer c on o.customer_number=c.customer_number
where o.create_time between '2017-07-01 00:00:00' and '2017-07-31 23:59:59'
and o.ORDER_STATUS in('SUCCESS','SETTLED')
)
and pc.STATUS='NORMAL'
with ur
",poscopy1
customercat,cu_cat,"select ID AS CODE,NAME FROM TRXSTATBUSINESSCATEGORIE",reportdb
customersubcat,subcat_s,"select CODE,NAME from TRXSTATSUBBUSINESSCATEGORIE",reportdb
AIR2GSALEEPOS,AIR2GSALEEPOS," select recus.customernumber AS receiver_no ,recus.fullname AS receiver_name, ree.name AS receiver_sale,
 tx.orderdateonly AS tx_orderdateonly,tx.orderdate AS tx_orderdate,
 tx.amount AS tx_amount,tx.ordertype AS tx_ordertype,
 tx.requestid AS tx_requestid,tx.externalid AS tx_externalid,
 tx.orderoper AS tx_orderoper,tx.biztype AS tx_biztype,tx.channel AS tx_channel,
 tx.productcat AS tx_productcat,tx.productdesc AS tx_productdesc,
 p.bankorderid AS p_bankorderid,p.banktrxid AS p_banktrxid,p.payway AS p_payway,p.payproduct AS p_payproduct,
 p.trxtype AS p_trxtype,p.trxstatus AS p_trxstatus,p.sourcefee AS p_sourcefee,p.targetfee AS p_targetfee,
 p.bankerrocode AS p_bankerrocode,p.bankerrorinfo AS p_bankerrorinfo,p.confirmorcancel AS p_confirmorcancel,
 cci.debitelements AS cci_debitelements,cci.customererrorcode AS cci_customererrorcode,cci.customererrorcode AS cci_customererrorcode,
 f.name AS frp_name,f.channel AS frp_channel,f.id AS frp_id,f.bank_id AS bank_id,'EPOS' AS product_service
 from MOBILEBE.trxorder tx 
 left join MOBILEBE.customer recus on tx.receiver_id = recus.id 
 left join MOBILEBE.employee2customer reec on (recus.id=reec.cust_id)
 left join MOBILEBE.employee ree on (ree.id=reec.emp_id)  , 
 MOBILEBE.payment p 
 left join MOBILEBE.creditcardinfo cci on cci.charid = p.extinfo 
 left join MOBILEBE.frp f on f.id = p.FRP_ID 
 where
 p.trxorder_id = tx.id
 and tx.receiver_id = tx.payer_id
 and p.FRP_ID >= 8000000 
 and p.FRP_ID <= 9000001
 and tx.orderType in('AUTH','AUTHANDCONFIRM') 
 and p.trxType in ('AUTHORIZE','SALES') 
 and tx.orderdateonly= ${START} 
 with ur",COPY2
AIR2GEPOSSALE,AIR2GEPOSSALE,"select
p.id AS IDNOUSE,
p.id as p_id,
recus.customernumber AS receiver_no ,
recus.fullname AS receiver_name,
ree.name AS receiver_sale,
'' AS payer_no ,
'' AS payer_name,
'' AS payer_sale,
tx.orderdateonly AS tx_orderdateonly,
tx.orderdate AS tx_orderdate,
tx.amount AS tx_amount,
tx.ordertype AS tx_ordertype,
tx.requestid AS tx_requestid,
tx.externalid AS tx_externalid,
tx.orderoper AS tx_orderoper,
tx.biztype AS tx_biztype,
tx.channel AS tx_channel,
tx.productcat AS tx_productcat,
tx.productdesc AS tx_productdesc,
p.bankorderid AS p_bankorderid,
p.banktrxid AS p_banktrxid,
p.payway AS p_payway,
p.payproduct AS p_payproduct,
p.trxtype AS p_trxtype,
p.trxstatus AS p_trxstatus,
(case p.trxstatus when  'INIT' then '___' when 'CANCELED' then '___' when 'PROCESS' then 'å¤__ä¸' when 'FAIL' then 'å¤±è´¥' when 'SUCCESS' then '___' end) as p_trxstatus_msg,
p.sourcefee AS p_sourcefee,
p.targetfee AS p_targetfee,
p.bankerrocode AS p_bankerrocode,
p.bankerrorinfo AS p_bankerrorinfo,
p.confirmorcancel AS p_confirmorcancel,
p.trxdate AS p_trxdate,
cci.debitelements AS cci_debitelements,
cci.customererrorcode AS cci_customererrorcode,
(case when cci.customerErrormsg is null then '____' else cci.customerErrormsg end) as cci_customererrormsg,
f.name AS frp_name,
f.channel AS frp_channel,
f.id AS frp_id,
f.bank_id AS f_bank_id,
'EPOS' AS product_service,
b.FULLNAME as bank_name
from MOBILEBE.trxorder tx
left join MOBILEBE.customer recus on tx.receiver_id = recus.id
left join MOBILEBE.employee2customer reec on (recus.id=reec.cust_id)
left join MOBILEBE.employee ree on (ree.id=reec.emp_id)  ,
MOBILEBE.payment p
left join MOBILEBE.creditcardinfo cci on cci.charid = p.extinfo
left join MOBILEBE.frp f on f.id = p.FRP_ID
LEFT JOIN MOBILEBE.Bank b on  b.ID=cci.BANK_ID
where
p.trxorder_id = tx.id
--and tx.receiver_id = tx.payer_id
and p.FRP_ID >= 8000000
and p.FRP_ID <= 9000001
and p.frp_id not in ( 8006330,8006331,8006332,8006333,8006334,8006335)
and tx.orderType = 'AUTHANDCONFIRM'
and p.trxType in ('AUTHORIZE','SALES')
and p.payproduct in ('EPOS_DEBIT','EPOS_CREDIT','EPOS_AIR_XTY')
and p.trxdate>= ${START} and p.trxdate < ${STOP} 
with ur",COPY2
zxyjdailytrx,zxyjdailytrx,"select 
COALESCE(date(CREATE_TIME),'null')||COALESCE(CARD_ID,'null') as IDNOUSE,
date(CREATE_TIME) as trxcreatetime,
CARD_ID as cardnum,
count(*) as trxcount,
sum(ORDER_AMOUNT) as trxamount 
from NCC.TBL_NC_PAY_ORDER
where CREATE_TIME >= ${START} and CREATE_TIME < ${STOP} and state = 'SUCCESS'
group by date(CREATE_TIME), CARD_ID 
with ur",INNO_STANBY
zxyjdailytrxhis,zxyjdailytrxhis,"select 
COALESCE(date(CREATE_TIME),'null')||COALESCE(CARD_ID,'null') as IDNOUSE,
date(CREATE_TIME) as trxcreatetime,
CARD_ID as cardnum,
count(*) as trxcount,
sum(ORDER_AMOUNT) as trxamount 
from NCC.TBL_NC_PAY_ORDER
where CREATE_TIME >= ${START} and CREATE_TIME < ${STOP} and state = 'SUCCESS'
group by date(CREATE_TIME), CARD_ID 
with ur",his5
AIR2GACCOUNTPAYRECEIVER,AIR2GACCOUNTPAYRECEIVER,"select p.id AS IDNOUSE,recus.customernumber AS receiver_no ,recus.fullname AS receiver_name, ree.name AS receiver_sale,
payercus.customernumber AS payer_no ,payercus.fullname AS payer_name, payere.name AS payer_sale,
tx.orderdateonly AS tx_orderdateonly,tx.orderdate AS tx_orderdate,
tx.amount AS tx_amount,tx.ordertype AS tx_ordertype,
tx.requestid AS tx_requestid,tx.externalid AS tx_externalid,
tx.orderoper AS tx_orderoper,tx.biztype AS tx_biztype,tx.channel AS tx_channel,
tx.productcat AS tx_productcat,tx.productdesc AS tx_productdesc,
p.id AS p_id, p.bankorderid AS p_bankorderid,p.banktrxid AS p_banktrxid,p.payway AS p_payway,p.payproduct AS p_payproduct,
p.trxtype AS p_trxtype,p.trxstatus AS p_trxstatus,p.sourcefee AS p_sourcefee,p.targetfee AS p_targetfee,
p.bankerrocode AS p_bankerrocode,p.bankerrorinfo AS p_bankerrorinfo,p.confirmorcancel AS p_confirmorcancel,p.trxdate AS p_trxdate,
cci.debitelements AS cci_debitelements,cci.customererrorcode AS cci_customererrorcode,
(case when cci.customerErrormsg is null then '____' else cci.customerErrormsg end) as cci_customererrormsg,
f.name AS frp_name,f.channel AS frp_channel,f.id AS frp_id,f.bank_id AS f_bank_id,'MERCHANT_ACCOUNT_PAY_AIR_RECEIVER' AS product_service
from MOBILEBE.trxorder tx 
left join MOBILEBE.customer recus on tx.receiver_id = recus.id 
left join MOBILEBE.employee2customer reec on (recus.id=reec.cust_id)
left join MOBILEBE.employee ree on (ree.id=reec.emp_id)  
left join MOBILEBE.customer payercus on tx.payer_id = payercus.id  
left join MOBILEBE.employee2customer payerec on (payercus.id=payerec.cust_id)
left join MOBILEBE.employee payere on (payere.id=payerec.emp_id) , 
MOBILEBE.payment p 
left join MOBILEBE.creditcardinfo cci on cci.charid = p.extinfo 
left join MOBILEBE.frp f on f.id = p.frp_id 
where
p.trxorder_id = tx.id
and tx.orderType = 'SALES'
and p.trxType = 'SALES' 
and p.FRP_ID = 1000001  
and p.payproduct = 'MERCHANT_ACCOUNT_PAY_AIR_RECEIVER'  
and p.trxdate>= ${START} and p.trxdate < ${STOP} 
with ur",COPY2
AIR2GACCOUNTPAY,AIR2GACCOUNTPAY,"select p.id AS IDNOUSE,recus.customernumber AS receiver_no ,recus.fullname AS receiver_name, ree.name AS receiver_sale,
payercus.customernumber AS payer_no ,payercus.fullname AS payer_name, payere.name AS payer_sale,
tx.orderdateonly AS tx_orderdateonly,tx.orderdate AS tx_orderdate,
tx.amount AS tx_amount,tx.ordertype AS tx_ordertype,
tx.requestid AS tx_requestid,tx.externalid AS tx_externalid,
tx.orderoper AS tx_orderoper,tx.biztype AS tx_biztype,tx.channel AS tx_channel,
tx.productcat AS tx_productcat,tx.productdesc AS tx_productdesc,
p.id AS p_id, p.bankorderid AS p_bankorderid,p.banktrxid AS p_banktrxid,p.payway AS p_payway,p.payproduct AS p_payproduct,
p.trxtype AS p_trxtype,p.trxstatus AS p_trxstatus,p.sourcefee AS p_sourcefee,p.targetfee AS p_targetfee,
p.bankerrocode AS p_bankerrocode,p.bankerrorinfo AS p_bankerrorinfo,p.confirmorcancel AS p_confirmorcancel,p.trxdate AS p_trxdate,
cci.debitelements AS cci_debitelements,cci.customererrorcode AS cci_customererrorcode,
(case when cci.customerErrormsg is null then '____' else cci.customerErrormsg end) as cci_customererrormsg,
f.name AS frp_name,f.channel AS frp_channel,f.id AS frp_id,f.bank_id AS f_bank_id,'MERCHANT_ACCOUNT' AS product_service
from MOBILEBE.trxorder tx 
left join MOBILEBE.customer recus on tx.receiver_id = recus.id 
left join MOBILEBE.employee2customer reec on (recus.id=reec.cust_id)
left join MOBILEBE.employee ree on (ree.id=reec.emp_id)  
left join MOBILEBE.customer payercus on tx.payer_id = payercus.id  
left join MOBILEBE.employee2customer payerec on (payercus.id=payerec.cust_id)
left join MOBILEBE.employee payere on (payere.id=payerec.emp_id) , 
MOBILEBE.payment p 
left join MOBILEBE.creditcardinfo cci on cci.charid = p.extinfo 
left join MOBILEBE.frp f on f.id = p.frp_id 
where
p.trxorder_id = tx.id
and tx.orderType = 'SALES' 
and recus.productLine='HK' 
and p.trxType = 'SALES' 
and p.FRP_ID = 1000001  
and p.payproduct in ('MERCHANT_ACCOUNT_PAY','MERCHANT_ACCOUNT_PAY_AIR_SYXT_BUYDIRECT') 
and p.trxdate>= ${START} and p.trxdate < ${STOP} 
with ur",COPY2
AIR2GACCOUNTPAYPAYER,AIR2GACCOUNTPAYPAYER,"select p.id AS IDNOUSE,recus.customernumber AS receiver_no ,recus.fullname AS receiver_name, ree.name AS receiver_sale,
payercus.customernumber AS payer_no ,payercus.fullname AS payer_name, payere.name AS payer_sale,
tx.orderdateonly AS tx_orderdateonly,tx.orderdate AS tx_orderdate,
tx.amount AS tx_amount,tx.ordertype AS tx_ordertype,
tx.requestid AS tx_requestid,tx.externalid AS tx_externalid,
tx.orderoper AS tx_orderoper,tx.biztype AS tx_biztype,tx.channel AS tx_channel,
tx.productcat AS tx_productcat,tx.productdesc AS tx_productdesc,
p.id AS p_id, p.bankorderid AS p_bankorderid,p.banktrxid AS p_banktrxid,p.payway AS p_payway,p.payproduct AS p_payproduct,
p.trxtype AS p_trxtype,p.trxstatus AS p_trxstatus,p.sourcefee AS p_sourcefee,p.targetfee AS p_targetfee,
p.bankerrocode AS p_bankerrocode,p.bankerrorinfo AS p_bankerrorinfo,p.confirmorcancel AS p_confirmorcancel,p.trxdate AS p_trxdate,
cci.debitelements AS cci_debitelements,cci.customererrorcode AS cci_customererrorcode,
(case when cci.customerErrormsg is null then '____' else cci.customerErrormsg end) as cci_customererrormsg,
f.name AS frp_name,f.channel AS frp_channel,f.id AS frp_id,f.bank_id AS f_bank_id,'MERCHANT_ACCOUNT_PAY_AIR_PAYER' AS product_service
from MOBILEBE.trxorder tx 
left join MOBILEBE.customer recus on tx.receiver_id = recus.id 
left join MOBILEBE.employee2customer reec on (recus.id=reec.cust_id)
left join MOBILEBE.employee ree on (ree.id=reec.emp_id)  
left join MOBILEBE.customer payercus on tx.payer_id = payercus.id  
left join MOBILEBE.employee2customer payerec on (payercus.id=payerec.cust_id)
left join MOBILEBE.employee payere on (payere.id=payerec.emp_id) , 
MOBILEBE.payment p 
left join MOBILEBE.creditcardinfo cci on cci.charid = p.extinfo 
left join MOBILEBE.frp f on f.id = p.frp_id 
where
p.trxorder_id = tx.id
and tx.orderType = 'SALES'
and p.trxType = 'SALES' 
and p.FRP_ID = 1000001  
and p.payproduct = 'MERCHANT_ACCOUNT_PAY_AIR_PAYER'  
and p.trxdate>= ${START} and p.trxdate < ${STOP} 
with ur",COPY2
zxyjmonthlytrx,zxyjmonthlytrx,"SELECT
    CONCAT(COALESCE( year(date(trxcreatetime))*100+month(date(trxcreatetime)) ,'null' ) ,COALESCE(cardnum,'null' ) ) AS IDNOUSE, 
    year(date(trxcreatetime))*100+month(date(trxcreatetime)) as MONTH, 
cardnum as cardnum, sum(trxcount) as trxcount,
 SUM(trxamount) as trxamount 
FROM
    zxyjdailytrx 
WHERE
    trxcreatetime >= ${START} and trxcreatetime < ${STOP}
GROUP BY
    year(date(trxcreatetime))*100+month(date(trxcreatetime)) ,cardnum",bigdata_report
zxyjmonthidcard,zxyjmonthidcard," SELECT
    CONCAT(COALESCE( month ,'null' ) ,COALESCE(cardnum,'null' ) ) AS IDNOUSE, cardnum  from cardnum_lastmonth 
",bigdata_report
zxyjmonthidcard,zxyjcardidnum,"select id as cardnum,idcard as idcardnum  from member.TBL_CWH_BANK_CARD_INFO",member
AIR2GEPOSAUTH,AIR2GEPOSAUTH,"select p.id AS IDNOUSE,recus.customernumber AS receiver_no ,recus.fullname AS receiver_name, ree.name AS receiver_sale,
'' AS payer_no ,'' AS payer_name, '' AS payer_sale,
tx.orderdateonly AS tx_orderdateonly,tx.orderdate AS tx_orderdate,
tx.amount AS tx_amount,tx.ordertype AS tx_ordertype,
tx.requestid AS tx_requestid,tx.externalid AS tx_externalid,
tx.orderoper AS tx_orderoper,tx.biztype AS tx_biztype,tx.channel AS tx_channel,
tx.productcat AS tx_productcat,tx.productdesc AS tx_productdesc,p.id as p_id,
p.bankorderid AS p_bankorderid,p.banktrxid AS p_banktrxid,p.payway AS p_payway,p.payproduct AS p_payproduct,
p.trxtype AS p_trxtype,p.trxstatus AS p_trxstatus,p.sourcefee AS p_sourcefee,p.targetfee AS p_targetfee,
p.bankerrocode AS p_bankerrocode,p.bankerrorinfo AS p_bankerrorinfo,p.confirmorcancel AS p_confirmorcancel,p.trxdate AS p_trxdate,
cci.debitelements AS cci_debitelements,cci.customererrorcode AS cci_customererrorcode,
(case when cci.customerErrormsg is null then '____' else cci.customerErrormsg end) as cci_customererrormsg,
f.name AS frp_name,f.channel AS frp_channel,f.id AS frp_id,f.bank_id AS f_bank_id,'EPOS' AS product_service
from MOBILEBE.trxorder tx 
left join MOBILEBE.customer recus on tx.receiver_id = recus.id 
left join MOBILEBE.employee2customer reec on (recus.id=reec.cust_id)
left join MOBILEBE.employee ree on (ree.id=reec.emp_id)  , 
MOBILEBE.payment p 
left join MOBILEBE.creditcardinfo cci on cci.charid = p.extinfo 
left join MOBILEBE.frp f on f.id = p.FRP_ID 
where
p.trxorder_id = tx.id
--and tx.receiver_id = tx.payer_id
and p.FRP_ID >= 8000000 
and p.FRP_ID <= 9000001 
and p.frp_id not in ( 8006330,8006331,8006332,8006333,8006334,8006335) 
and p.trxstatus = 'SUCCESS' 
and tx.orderType ='AUTH' 
and p.trxType in ('AUTHORIZE','SALES') 
and p.payproduct in ('EPOS_DEBIT','EPOS_CREDIT','EPOS_AIR_XTY')  
and p.confirmorcancel>= ${START} and p.confirmorcancel < ${STOP} 
with ur",COPY2
tcairidcard,tcairidcard,"select coalesce(CERTIFICATE_NUMBER,'null')||coalesce(char(year(CREATE_DATE)*100+month(CREATE_DATE)),'null')||'tcairidcard' as IDNOUSE, 
CERTIFICATE_NUMBER as idnum,year(CREATE_DATE)*100+month(CREATE_DATE) AS MONTH 
from airticket.TBL_AIR_FLIGHT_PASSENGER 
where CREATE_DATE>=${START} AND CREATE_DATE<${STOP} 
 with ur",accnt
1213,12121,select * from bigdata_test,bigdata_test
monthlytrxstatjinfen,monthlytrxstatjinfen,"select COALESCE(CHAR(d.product_code),'null')||
COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(d.receiverid),'null')||
COALESCE(CHAR(d.bizTypeId),'null')||
COALESCE(CHAR(d.type),'null')||
COALESCE(CHAR(r.employeeid),'null')||
COALESCE(CHAR(c.productlineid),'null')||
COALESCE(CHAR(c.areaid),'null')||
COALESCE(CHAR(r.isSelf),'null')||
COALESCE(CHAR(r.isShare),'null')||
COALESCE(CHAR(r.shareScale),'null')||
COALESCE(CHAR(r.transfDate),'null')||
COALESCE(CHAR(c.productGroup),'null')||
COALESCE(CHAR(c.bussinessCatId),'null')||
COALESCE(CHAR(c.level),'null')||
COALESCE(CHAR(em.BRANCHCOMPANY),'null')||
COALESCE(CHAR(d.feetype),'null')||
COALESCE(CHAR(month(trxdate)),'null')||
COALESCE(CHAR(year(trxdate)),'null')||
COALESCE(CHAR(month(true_trxdate)),'null')||
COALESCE(CHAR(year(true_trxdate)),'null')||
COALESCE(CHAR(d.PAYERID),'null')||
COALESCE(CHAR(d.TRXCHANNELID),'null')||
COALESCE(CHAR(d.ORDERTYPE),'null')||
COALESCE(CHAR(d.ISCOMPUTEPROFIT),'null')||
COALESCE(CHAR(d.ISCOMPUTEBONUS),'null')||
COALESCE(CHAR(d.USETYPE),'null')||
COALESCE(CHAR(d.PAYPRODUCT),'null') as IDNOUSE,month(trxdate)+year(trxdate)*100 as month,month(true_trxdate)+year(true_trxdate)*100 as true_month,d.product_code,d.sales_product_code,d.receiverid as customerid,d.bizTypeId,d.type,coalesce(r.employeeid,25) as salesid,c.productlineid,c.areaid,c.productGroup,r.isSelf,r.isShare as issharecustomer,coalesce(r.shareScale,1) as salesscale,
r.transfDate,sum(trxCount)-sum(refundCount) as trxCount,sum(trxAmount)-sum(refundAmount) as trxAmount,0 as trxFee,
0 as innerCost,0 as externalCost,0 as shareFrpCost,0 as accountingcost
,c.bussinessCatId as businessCatId,c.level as customerlevel,em.BRANCHCOMPANY,d.feetype,sum(refundCount) as refundcount,sum(refundAmount) as refundamount,'RECEIVER' as customertype,d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT,0 as refundfee,0 as REFUNDFRPCOST,sum(WHOLEPAYCOUNT) as WHOLEPAYCOUNT,sum(WHOLEORDERCOUNT) as WHOLEORDERCOUNT,sum(WHOLEORDERAMOUNT) as WHOLEORDERAMOUNT
  from DailyTrxStat d left join CustomerInfo c on d.receiverid=c.id
  left join CustomerRelationship r on r.customerid=d.receiverid
  left join employeeinfo em on r.EMPLOYEEID=em.ID
  where receiverid is not null and receiverid not in(524857,980067,11219567) and d.ISCOMPUTEPROFIT=1 and d.type not in ('SettleTransf','POSTPAID') and trxdate>=${START} and trxdate<${STOP}  
  group by d.product_code,d.sales_product_code,d.receiverid,d.bizTypeId,d.type,r.employeeid,c.productlineid,c.areaid,r.isSelf,r.isShare,r.shareScale,r.transfDate,c.productGroup,c.bussinessCatId,c.level,em.BRANCHCOMPANY,d.feetype,month(trxdate),year(trxdate),month(true_trxdate),year(true_trxdate),d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT with ur",reportdb
PublishedMonthlyTrxStatjinfen,PublishedMonthlyTrxStatjinfen,"select 
char(COALESCE(m.CUSTOMERID,0))||COALESCE(c.CUSTOMERNUMBER,'null')||COALESCE(c.FULLNAME,'null')||char(COALESCE(m.SALESID,0))||char(COALESCE(m.AREAID,0))||char(COALESCE(m.biztypeid,0))||COALESCE(m.TYPE,'null') ||char(COALESCE(m.salesscale,1))||char(COALESCE(m.isShareCustomer,0))||char(COALESCE(m.isself,1))||COALESCE(m.productgroup,'null')||COALESCE(m.businesscatid,'null')||COALESCE(m.branchcompany,'null')||COALESCE(m.product_code,'null')||COALESCE(m.sales_product_code,'null')||COALESCE(m.managemark,'null')||char(COALESCE(c2a.ACHIEVEMENT_ID,0))||'RECEIVER'||char(COALESCE(m.true_month,0))||char(COALESCE(m.payerid,0))||char(coalesce(c.productline,'')) as IDNOUSE,
1594 as timeLatitudeId,201709 as MONTH,m.true_month,m.CUSTOMERID,m.payerid,c.CUSTOMERNUMBER,c.FULLNAME as customerName,m.SALESID as saleid,0 as teamId,m.AREAID,0 as productLineId,c.productline as hangyeyejishuxing,
m.biztypeid, m.TYPE as trxTypeId,sum(m.trxcount*m.salesscale*coalesce(c2a.PERCENT,1)) as trxcount,sum(m.trxamount*m.salesscale*coalesce(c2a.PERCENT,1)) as trxamount,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)) as innerincome,
sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as innerCost,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as innerprofit,'RECEIVER' as grouptype,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,sum(m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as accountingCost,sum(m.trxfee*m.salesscale*coalesce(c2a.PERCENT,1)-m.accountingcost*m.salesscale*coalesce(c2a.PERCENT,1)) as accountingProfit,
m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT
from monthlytrxstat_jinfen m left join customerinfo c on m.CUSTOMERID=c.ID left join customer2achievement c2a on c. customernumber=c2a.customer_number
where m.month=201709 and m.customertype='RECEIVER'   group by m.CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME,m.SALESID,m.AREAID,m.biztypeid, m.TYPE,m.salesscale,m.isShareCustomer,
m.isself,m.transfdate,m.productgroup,m.businesscatid,m.branchcompany,m.product_code,m.sales_product_code,m.managemark,c2a.ACHIEVEMENT_ID,c2a.PERCENT,m.true_month,m.payerid,c.productline with ur",reportdb
PublishedMonthlyTrxStatjinfen,publishedtrxstatadditonalstatfeejinfen,"select char(coalesce(salesid,0))||char(coalesce(bizTypeId,0))||char(coalesce(salesid,0))||char(coalesce(productlineid,0))||char(coalesce(t.areaid,0))||coalesce(type,'')||coalesce(productGroup,'')||coalesce(businessCatId,'')||coalesce(a.AREAID,'')||coalesce(product_code,'')||coalesce(sales_product_code,'')||char(coalesce(t.yejishuxing,0))||'RECEIVER'||char(COALESCE(t.memomonth,0))||char(coalesce(t.hangyeyejishuxing,'')) as IDNOUSE,1594 as timeLatitudeId,201709 as MONTH,t.memomonth as true_month,salesid,bizTypeId,salesid as saleid,0 as teamId,productlineid,t.areaid,type as trxTypeId,productGroup,businessCatId,a.AREAID as branchcompany,product_code,sales_product_code,'RECEIVER' as grouptype,t.hangyeyejishuxing,sum(income) as innerincome,sum(cost) as innerCost,sum(income-cost) as INNERPROFIT,sum(accountingcost) as accountingCost,sum(income-accountingcost) as ACCOUNTINGPROFIT, sum(trxcount) as trxcount, sum(trxamount) as trxamount,t.yejishuxing as ACHIEVEMENT_ID,1 as PERCENT from TrxStatAdditionalStatFee t left join trxstatcustomerarea a on t.branchid=a.id where  month=201709 and iscomputeprofit=1 group by salesid,bizTypeId,salesid,productlineid,t.areaid,type,productGroup,businessCatId,a.AREAID,product_code,sales_product_code,t.yejishuxing,t.memomonth,t.hangyeyejishuxing  with ur
",reportdb
monthlytrxstatjinfen,monthlytrxstatjinfenpostpaid,"select COALESCE(CHAR(d.product_code),'null')||
COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(d.receiverid),'null')||
COALESCE(CHAR(d.bizTypeId),'null')||
COALESCE(CHAR(d.type),'null')||
COALESCE(CHAR(r.employeeid),'null')||
COALESCE(CHAR(c.productlineid),'null')||
COALESCE(CHAR(c.areaid),'null')||
COALESCE(CHAR(r.isSelf),'null')||
COALESCE(CHAR(r.isShare),'null')||
COALESCE(CHAR(r.shareScale),'null')||
COALESCE(CHAR(r.transfDate),'null')||
COALESCE(CHAR(c.productGroup),'null')||
COALESCE(CHAR(c.bussinessCatId),'null')||
COALESCE(CHAR(c.level),'null')||
COALESCE(CHAR(em.BRANCHCOMPANY),'null')||
COALESCE(CHAR(d.feetype),'null')||
COALESCE(CHAR(month(trxdate)),'null')||
COALESCE(CHAR(year(trxdate)),'null')||
COALESCE(CHAR(month(true_trxdate)),'null')||
COALESCE(CHAR(year(true_trxdate)),'null')||
COALESCE(CHAR(d.PAYERID),'null')||
COALESCE(CHAR(d.TRXCHANNELID),'null')||
COALESCE(CHAR(d.ORDERTYPE),'null')||
COALESCE(CHAR(d.ISCOMPUTEPROFIT),'null')||
COALESCE(CHAR(d.ISCOMPUTEBONUS),'null')||
COALESCE(CHAR(d.USETYPE),'null')||
COALESCE(CHAR(d.PAYPRODUCT),'null') as IDNOUSE,month(trxdate)+year(trxdate)*100 as month,month(true_trxdate)+year(true_trxdate)*100 as true_month,d.product_code,d.sales_product_code,d.receiverid as customerid,d.bizTypeId,d.type,coalesce(r.employeeid,25) as salesid,c.productlineid,c.areaid,c.productGroup,r.isSelf,r.isShare as issharecustomer,coalesce(r.shareScale,1) as salesscale,
r.transfDate,sum(trxCount)-sum(refundCount) as trxCount,sum(trxAmount)-sum(refundAmount) as trxAmount,sum(trxFee)-sum(refundFee) as trxFee,
sum(frpCost) as innerCost,sum(externalCost) as externalCost,sum(shareFrpCost) as shareFrpCost,sum(accountingCost) as accountingcost
,c.bussinessCatId as businessCatId,c.level as customerlevel,em.BRANCHCOMPANY,d.feetype,sum(refundCount) as refundcount,sum(refundAmount) as refundamount,'RECEIVER' as customertype,d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT,sum(refundFee) as refundfee,sum(REFUNDFRPCOST) as REFUNDFRPCOST,sum(WHOLEPAYCOUNT) as WHOLEPAYCOUNT,sum(WHOLEORDERCOUNT) as WHOLEORDERCOUNT,sum(WHOLEORDERAMOUNT) as WHOLEORDERAMOUNT
  from DailyTrxStat d left join CustomerInfo c on d.receiverid=c.id
  left join CustomerRelationship r on r.customerid=d.receiverid
  left join employeeinfo em on r.EMPLOYEEID=em.ID
  where receiverid is not null and receiverid not in(524857,980067,11219567) and d.ISCOMPUTEPROFIT=1 and d.type  in ('POSTPAID') and trxdate>=${START} and trxdate<${STOP}  
  group by d.product_code,d.sales_product_code,d.receiverid,d.bizTypeId,d.type,r.employeeid,c.productlineid,c.areaid,r.isSelf,r.isShare,r.shareScale,r.transfDate,c.productGroup,c.bussinessCatId,c.level,em.BRANCHCOMPANY,d.feetype,month(trxdate),year(trxdate),month(true_trxdate),year(true_trxdate),d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT with ur",reportdb
monthlytrxstatjinfen,monthlytrxstatjinfennewfee,"select COALESCE(CHAR(d.product_code),'null')||
COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(d.receiverid),'null')||
COALESCE(CHAR(d.bizTypeId),'null')||
COALESCE(CHAR(d.type),'null')||
COALESCE(CHAR(r.employeeid),'null')||
COALESCE(CHAR(c.productlineid),'null')||
COALESCE(CHAR(c.areaid),'null')||
COALESCE(CHAR(r.isSelf),'null')||
COALESCE(CHAR(r.isShare),'null')||
COALESCE(CHAR(r.shareScale),'null')||
COALESCE(CHAR(r.transfDate),'null')||
COALESCE(CHAR(c.productGroup),'null')||
COALESCE(CHAR(c.bussinessCatId),'null')||
COALESCE(CHAR(c.level),'null')||
COALESCE(CHAR(em.BRANCHCOMPANY),'null')||
COALESCE(CHAR(d.feetype),'null')||
COALESCE(CHAR(month(trxdate)),'null')||
COALESCE(CHAR(year(trxdate)),'null')||
COALESCE(CHAR(month(true_trxdate)),'null')||
COALESCE(CHAR(year(true_trxdate)),'null')||
COALESCE(CHAR(d.PAYERID),'null')||
COALESCE(CHAR(d.TRXCHANNELID),'null')||
COALESCE(CHAR(d.ORDERTYPE),'null')||
COALESCE(CHAR(d.ISCOMPUTEPROFIT),'null')||
COALESCE(CHAR(d.ISCOMPUTEBONUS),'null')||
COALESCE(CHAR(d.USETYPE),'null')||
COALESCE(CHAR(d.PAYPRODUCT),'null') as IDNOUSE,month(trxdate)+year(trxdate)*100 as month,month(true_trxdate)+year(true_trxdate)*100 as true_month,d.product_code,d.sales_product_code,d.receiverid as customerid,d.bizTypeId,d.type,coalesce(r.employeeid,25) as salesid,c.productlineid,c.areaid,c.productGroup,r.isSelf,r.isShare as issharecustomer,coalesce(r.shareScale,1) as salesscale,
r.transfDate,sum(trxCount)-sum(refundCount) as trxCount,sum(trxAmount)-sum(refundAmount) as trxAmount,sum(trxFee)-sum(refundFee) as trxFee,
sum(frpCost) as innerCost,sum(externalCost) as externalCost,sum(shareFrpCost) as shareFrpCost,sum(accountingCost) as accountingcost
,c.bussinessCatId as businessCatId,c.level as customerlevel,em.BRANCHCOMPANY,d.feetype,sum(refundCount) as refundcount,sum(refundAmount) as refundamount,'RECEIVER' as customertype,d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT,sum(refundFee) as refundfee,sum(REFUNDFRPCOST) as REFUNDFRPCOST,sum(WHOLEPAYCOUNT) as WHOLEPAYCOUNT,sum(WHOLEORDERCOUNT) as WHOLEORDERCOUNT,sum(WHOLEORDERAMOUNT) as WHOLEORDERAMOUNT
  from jingfen_dailytrx d left join CustomerInfo c on d.receiverid=c.id
  left join CustomerRelationship r on r.customerid=d.receiverid
  left join employeeinfo em on r.EMPLOYEEID=em.ID
  where receiverid is not null  and  trxdate>=${START} and trxdate<${STOP}  
  group by d.product_code,d.sales_product_code,d.receiverid,d.bizTypeId,d.type,r.employeeid,c.productlineid,c.areaid,r.isSelf,r.isShare,r.shareScale,r.transfDate,c.productGroup,c.bussinessCatId,c.level,em.BRANCHCOMPANY,d.feetype,month(trxdate),year(trxdate),month(true_trxdate),year(true_trxdate),d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT with ur",reportdb
dlbdailytrxdepartment,dlbdailytrxdepartment_month,"select concat(COALESCE(CHAR((case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___' when a.full_name like '%_______%' then '_______' when a.full_name like '%__º¬____%' then '__º¬____' when a.full_name like '%æ·±å_____%' then 'æ·±å_____' when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__' when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end)),'null'),'dlbdailytrx') as idnouse,
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(case when month(S.CREATEDATE)=month(CURRENT_DATE-1 days)  and year(S.CREATEDATE)=year(CURRENT_DATE-1 days) then d.SUC_AMOUNT else 0 end) as mon_dec_suc_amount,
sum(case when month(S.CREATEDATE)=month(CURRENT_DATE-1 days)  and year(S.CREATEDATE)=year(CURRENT_DATE-1 days) then d.SUC_COUNT else 0 end) as mon_dec_suc_count,
sum(case when month(d.trxdate)=month(CURRENT_DATE-1 days) then d.SUC_AMOUNT else 0 end) as mon_suc_amount,
sum(case when month(d.trxdate)=month(CURRENT_DATE-1 days) then d.SUC_COUNT else 0 end) as mon_suc_count
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num  
where d.trxdate>= (CURRENT_DATE -(DAY(CURRENT_DATE)-1) days) and d.trxdate < current_date 
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbdailytrxdepartment,dlbdailytrxdepartment_d1,"select 
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(D.SUC_AMOUNT) as daily_suc_amount
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num 
where d.trxdate>= current_date-1 days and  d.trxdate < current_date
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbdailytrxdepartment,dlbdailytrxdepartment_m1,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as mon_dec_shop
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
left join dlb_agent_info a on c.agent_num=a.agent_num  
where  S.CREATEDATE>= (CURRENT_DATE -(DAY(CURRENT_DATE)-1) days) and S.CREATEDATE < current_date
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
3gauthcost,3gsmsnotify,"SELECT
	RECORD.CREATED_DATE||RECORD.FEE_SUBJECT||'3gsmsnotify' as IDNOUSE, RECORD.CREATED_DATE as trxdate,
  RECORD.FEE_SUBJECT as memo,
  SUM(RECORD.SPILT_COUNT) AS trxcount,
  SUM(RECORD.SPILT_COUNT * USER.MESSAGE_PRICE) AS accountingcost,
  SUM(RECORD.SPILT_COUNT * USER.MESSAGE_PRICE) AS cost,'3011901002003' as product_code,
'3011901001001A' as sales_product_code,
  '_¨å_' as hangyeyejishuxing,24 as yejishuxing,181 as biztypeid,'SMS_COST' as type,
1 as operatorid,1 as iscomputeprofit,1 as computebonus,year(RECORD.CREATED_DATE)*100+month(RECORD.CREATED_DATE) as month,RECORD.CREATED_DATE as true_trxdate,
year(RECORD.CREATED_DATE)*100+month(RECORD.CREATED_DATE) as memomonth,'FOREIGN' as usetype,'026' as businesscatid,15 as branchid
FROM
  NOTIFY.TBL_NOTIFY_INVOKE_RECORD_201805 RECORD
  LEFT JOIN NOTIFY.TBL_NOTIFY_RULE RULE ON RECORD.NOTIFY_RULE_NAME = RULE.NAME
  LEFT JOIN NOTIFY.TBL_SYSTEM_USER USER ON RULE.APP_ID = USER.ID
WHERE RECORD.CREATED_DATE >=${START} AND RECORD.CREATED_DATE < ${STOP}
GROUP BY RECORD.CREATED_DATE,
  RECORD.FEE_SUBJECT",basic
dlbdailytrxdepartment,dlbdailytrxdepartment_m2,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
count(DISTINCT d.shop_num) as mon_youxiao_shop
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num
left join dlb_customer_info  c on d.customer_num=c.customer_num 
where  S.CREATEDATE>= (CURRENT_DATE -(DAY(CURRENT_DATE)-1) days) and S.CREATEDATE < current_date and d.SUC10_AMOUNT>=10 and c.declare_status='PASS'
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbdailytrxdepartment,dlbdailytrxdepartment_m3,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
count(DISTINCT d.shop_num ) as mon_liucun_shop
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num
left join dlb_customer_info  c on d.customer_num=c.customer_num 
where  S.CREATEDATE>= (CURRENT_DATE -(DAY(CURRENT_DATE)-1) days) and S.CREATEDATE < current_date  and c.declare_status='PASS'
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end
",reportdb
dlbdailytrxdepartment,dlbdailytrxdepartment_d2,"select 
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(D.SUC_COUNT) as daily_suc_count
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num 
where d.trxdate>= current_date-1 days and  d.trxdate < current_date
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbdailytrxdepartment,dlbdailytrxdepartment_d3,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as daily_dec_shop
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
left join dlb_agent_info a on c.agent_num=a.agent_num  
where S.CREATEDATE>= current_date-1 days and S.CREATEDATE < current_date
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbdailytrxdepartment,dlbdailytrxdepartment_w1,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as WEEK_DEC_SHOP
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
left join dlb_agent_info a on c.agent_num=a.agent_num  
where  S.CREATEDATE>=CURRENT_DATE- (DAYOFWEEK_ISO(current_date)   -1) DAYS  and  S.CREATEDATE < current_date
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end
",reportdb
dlbdailytrxcity,dlbdailytrxcity_month,"select coalesce(COALESCE(CHAR(c.province),'null'),COALESCE(CHAR(c.city),'null'),'dlbdailytrx') as idnouse,
c.province as PROVINCE,
c.city as CITY,
sum(case when month(d.trxdate)=month(CURRENT_DATE-1 days) then d.SUC_AMOUNT else 0 end) as mon_suc_amount,
sum(case when month(d.trxdate)=month(CURRENT_DATE-1 days) then d.SUC_COUNT else 0 end) as mon_suc_count
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num  
where d.trxdate>= (CURRENT_DATE -(DAY(CURRENT_DATE)-1) days) and d.trxdate < current_date 
group by 
c.province,
c.city",reportdb
dlbdailytrxcity,dlbdailytrxcity_d1,"select 
c.province as PROVINCE,
c.city as CITY,
sum(D.SUC_AMOUNT) as daily_suc_amount
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num
where d.trxdate>= current_date-1 days and  d.trxdate < current_date
group by 
c.province,
c.city",reportdb
dlbdailytrxcity,dlbdailytrxcity_d2,"select 
c.province as PROVINCE,
c.city as CITY,
sum(D.SUC_COUNT) as daily_suc_count
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num
where d.trxdate>= current_date-1 days and  d.trxdate < current_date
group by 
c.province,
c.city",reportdb
dlbdailytrxcity,dlbdailytrxcity_d3,"select
c.province as PROVINCE,
c.city as CITY,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as daily_dec_shop
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
where S.CREATEDATE>= current_date-1 days and S.CREATEDATE < current_date
group by 
c.province,
c.city",reportdb
dlbdailytrxcity,dlbdailytrxcity_w1,"select
c.province as PROVINCE,
c.city as CITY,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as WEEK_DEC_SHOP
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
where  S.CREATEDATE>=CURRENT_DATE- (DAYOFWEEK_ISO(current_date)   -1) DAYS  and  S.CREATEDATE < current_date
group by 
c.province,
c.city
",reportdb
dlbdailytrxcity,dlbdailytrxcity_m1,"select
c.province as PROVINCE,
c.city as CITY,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as mon_dec_shop
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
where  S.CREATEDATE>= (CURRENT_DATE -(DAY(CURRENT_DATE)-1) days) and S.CREATEDATE < current_date
group by 
c.province,
c.city",reportdb
dlbdailytrxcity,dlbdailytrxcity_hy1,"select
c.province as PROVINCE,
c.city as CITY,
count(DISTINCT d.shop_num ) as daily_huoyue_shop
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num 
where S.CREATEDATE>= current_date-1 days and S.CREATEDATE < current_date and c.declare_status='PASS'
group by 
c.province,
c.city",reportdb
dlbdailytrxcity,dlbdailytrxcity_hy2,"select
c.province as PROVINCE,
c.city as CITY,
count(DISTINCT d.shop_num ) as MON_HUOYUE_SHOP
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num 
where  S.CREATEDATE>= (CURRENT_DATE -(DAY(CURRENT_DATE)-1) days) and S.CREATEDATE < current_date  and c.declare_status='PASS'
group by 
c.province,
c.city",reportdb
dlbtrxcity,dlbtrxcity_month,"select COALESCE(CHAR(c.province),'null')||COALESCE(CHAR(c.city),'null')||'dlbdailytrx' as idnouse,
c.city as CITY,
c.province as PROVINCE,
c.province||c.city AS KEY,
sum( d.SUC_AMOUNT) as mon_suc_amount,
sum(d.SUC_COUNT) as mon_suc_count
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num  
where d.trxdate>= '2017-09-01' and d.trxdate < '2017-10-01' 
group by 
c.city,
c.province",reportdb
dlbtrxcity,dlbtrxcity_d1,"select 
c.province||c.city AS KEY,
sum(D.SUC_AMOUNT) as daily_suc_amount
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num
where d.trxdate>= current_date-1 days and  d.trxdate < current_date
group by c.city,c.province",reportdb
dlbtrxcity,dlbtrxcity_d2,"select 
c.province||c.city AS KEY,
sum(D.SUC_COUNT) as daily_suc_count
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num
where d.trxdate>= current_date-1 days and  d.trxdate < current_date
group by c.city,c.province",reportdb
dlbtrxcity,dlbtrxcity_d3,"select
c.province||c.city AS KEY,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as daily_dec_shop
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
where S.CREATEDATE>= current_date-1 days and S.CREATEDATE < current_date
group by c.city,c.province",reportdb
dlbtrxcity,dlbtrxcity_w1,"select
c.province||c.city AS KEY,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as WEEK_DEC_SHOP
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
where  S.CREATEDATE>=CURRENT_DATE-7 DAYS  and  S.CREATEDATE < current_date
group by c.city,c.province
",reportdb
dlbtrxcity,dlbtrxcity_m1,"select
c.province||c.city AS KEY,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as mon_dec_shop
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
where S.CREATEDATE>= '2017-09-01' and S.CREATEDATE < '2017-10-01' 
group by c.city,c.province",reportdb
dlbtrxcity,dlbtrxcity_hy1,"select
c.province||c.city AS KEY,
count(DISTINCT d.shop_num ) as daily_huoyue_shop
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num 
where S.CREATEDATE>= current_date-1 days and S.CREATEDATE < current_date and c.declare_status='PASS'
group by c.city,c.province",reportdb
dlbtrxcity,dlbtrxcity_hy2,"select
c.province||c.city AS KEY,
count(DISTINCT d.shop_num ) as MON_HUOYUE_SHOP
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num 
where S.CREATEDATE>= '2017-09-01' and S.CREATEDATE < '2017-10-01'   and  d.trxdate>= '2017-08-01' and d.trxdate < '2017-09-01' and c.declare_status='PASS'
group by c.city,c.province",reportdb
dlbtrxdepartment,dlbtrxdepartment_month,"select concat(COALESCE(CHAR((case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___' when a.full_name like '%_______%' then '_______' when a.full_name like '%__º¬____%' then '__º¬____' when a.full_name like '%æ·±å_____%' then 'æ·±å_____' when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__' when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end)),'null'),'dlbdailytrx') as idnouse,
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum( d.SUC_AMOUNT ) as mon_dec_suc_amount,
sum(d.SUC_COUNT ) as mon_dec_suc_count
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num  
where S.CREATEDATE>= '2017-09-01' and S.CREATEDATE < '2017-10-01'  and  d.trxdate>= '2017-09-01' and d.trxdate < '2017-10-01' 
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbtrxdepartment,dlbtrxdepartment_d1,"select 
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(D.SUC_AMOUNT) as daily_suc_amount
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num 
where d.trxdate>= current_date-1 days and  d.trxdate < current_date
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbtrxdepartment,dlbtrxdepartment_m1,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as mon_dec_shop
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
left join dlb_agent_info a on c.agent_num=a.agent_num  
where  S.CREATEDATE>= '2017-09-01' and S.CREATEDATE < '2017-10-01' 
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbtrxdepartment,dlbtrxdepartment_m2,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
count(DISTINCT  d.shop_num )  as mon_youxiao_shop
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num
left join dlb_customer_info  c on d.customer_num=c.customer_num 
where S.CREATEDATE>= '2017-09-01' and S.CREATEDATE < '2017-10-01'  and  d.trxdate>= '2017-09-01' and d.trxdate < '2017-10-01' and c.declare_status='PASS' and  d.SUC10_COUNT >=10
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbtrxdepartment,dlbtrxdepartment_m3,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
count(DISTINCT d.shop_num ) as mon_liucun_shop
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num
left join dlb_customer_info  c on d.customer_num=c.customer_num 
where S.CREATEDATE>= '2017-09-01' and S.CREATEDATE < '2017-10-01'  and  d.trxdate>= '2017-09-01' and d.trxdate < '2017-10-01'  and c.declare_status='PASS'
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbtrxdepartment,dlbtrxdepartment_d2,"select 
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(D.SUC_COUNT) as daily_suc_count
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num 
where d.trxdate>= current_date-1 days and  d.trxdate < current_date
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbtrxdepartment,dlbtrxdepartment_d3,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as daily_dec_shop
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
left join dlb_agent_info a on c.agent_num=a.agent_num  
where S.CREATEDATE>= current_date-1 days and S.CREATEDATE < current_date
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbtrxdepartment,dlbtrxdepartment_w1,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(case when  c.declare_status='PASS' then 1 else 0 end) as WEEK_DEC_SHOP
from dlb_customer_info c
left join dlb_shop_info s on c.customer_num=s.customer_num
left join dlb_agent_info a on c.agent_num=a.agent_num  
where  S.CREATEDATE>=CURRENT_DATE-7 DAYS  and  S.CREATEDATE < current_date
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end
",reportdb
dlbtrxdepartment,dlbtrxdepartment_m4,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum(d.SUC_COUNT ) as mon_suc_count
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num  
where d.trxdate>= '2017-09-01' and d.trxdate < '2017-10-01'
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
dlbtrxdepartment,dlbtrxdepartment_m5,"select
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
sum( d.SUC_AMOUNT) as mon_suc_amount
from dlb_dailytrx d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num  
where d.trxdate>= '2017-09-01' and d.trxdate < '2017-10-01'
group by case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%è¶_º§å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end",reportdb
POSCUSTOMERINFO,POSQUERY,"select distinct c.customer_number AS CUSTOMERNUMBER,c.FULL_NAME AS FULLNAME,
c.signedName AS SIGNEDNAME,c.SALES_NAME AS SALESNAME,c.SALES_AREA AS SALESAREA,
c.CUSTOMER_LEVEL AS CUSTOMERLEVEL,c.TYPE AS TYPE,c.CREATE_TIME AS CREATETIME,
c.STATUS AS STATUS,c.CUSTOMER_STATUS AS CUSTOMERSTATUS,c.industry AS MCC,
c.LINKMAN AS LINKMAN,c.PHONE AS PHONE,c.MOBILE AS MOBILE,c.ADDRESS AS ADDRESS,
u.MERCHANT_CLASS AS MERCHANTCLASS,a.CORP_NAME AS CORPNAME
from tbl_pos_order o
left join tbl_pos_customer c on o.customer_number=c.customer_number
left join TBL_POS_UNIONPAYRATESASSORT u on c.INDUSTRY=u.MCC_CODE
left join TBL_POS_OA_CUSTOMER_INFO a on c.customer_number=a.CUSTOMER_NUMBER
where  o.ORDER_STATUS in('SUCCESS','SETTLED')
and u.NAME!='_¨é_è¡__'  AND 
o.create_time >='2017-08-01 00:00:00' and o.create_time <'2017-09-01 00:00:00'
with ur",poscopy1
dlbdailytrxtab,dlbdailytrxtab,"select 
coalesce(char(d.TRXDATE),'null')||
coalesce(char(d.PAY_WAY),'null')||
coalesce(char(UR.USER_NAME),'null')||
coalesce(char(d.CUSTOMER_NUM),'null')||
coalesce(char(C.FULL_NAME),'null')||
coalesce(char(C.CUSTOMER_TYPE),'null')||
coalesce(char(C.PROVINCE),'null')||
coalesce(char(C.CITY),'null')||
coalesce(char(C.DISTRICT),'null')||
coalesce(char(C.INDUSTRY),'null')||
coalesce(char(c.declare_status),'null')||
coalesce(char(d.SHOP_NUM),'null')||
coalesce(char(S.SHOP_NAME),'null')||
coalesce(char(S.CITY),'null')||
coalesce(char(S.PROVINCE),'null')||
coalesce(char(S.DISTRICT),'null')||
coalesce(char(S.ONE_INDUSTRY),'null')||
coalesce(char(S.TWO_INDUSTRY),'null')||
coalesce(char(S.CREATEDATE),'null')||
coalesce(char(A.AGENT_NUM),'null')||
coalesce(char(A.FULL_NAME),'null')||
coalesce(char(A.SALESMAN),'null')||
coalesce(char(d.SOURCE),'null')||
coalesce(char(d.BUSSINESS_TYPE),'null')||
coalesce(char(d.TYPE),'null')||'dlbdailytrxtab' as IDNOUSE,
d.TRXDATE as trxdate,
d.PAY_WAY as PAY_WAY,
UR.USER_NAME as USER_NAME,
d.CUSTOMER_NUM as CUSTOMER_NUM,
C.FULL_NAME as CUSTOMER_FULL_NAME,
C.CUSTOMER_TYPE as CUSTOMER_TYPE,
C.PROVINCE as CUSTOMER_PROVINCE,
C.CITY as CUSTOMER_CITY,
C.DISTRICT as CUSTOMER_DISTRICT,
C.INDUSTRY as INDUSTRY,
c.declare_status  as declare_status,
d.SHOP_NUM as SHOP_NUM,
S.SHOP_NAME AS SHOP_NAME,
S.CITY AS SHOP_CITY,
S.PROVINCE AS SHOP_PROVINCE,
S.DISTRICT AS SHOP_DISTRICT,
S.ONE_INDUSTRY AS ONE_INDUSTRY,
S.TWO_INDUSTRY AS TWO_INDUSTRY,
S.CREATEDATE AS CREATEDATE,
A.AGENT_NUM as AGENT_NUM,
A.FULL_NAME as AGENT_FULL_NAME,
A.SALESMAN as SALESMAN,
d.SOURCE as SOURCE,
d.BUSSINESS_TYPE as BUSSINESS_TYPE,
d.TYPE as TYPE,
sum(d.SUC_COUNT) as SUC_COUNT,
sum(d.SUC_AMOUNT) as SUC_AMOUNT,
sum(d.SUC5_COUNT) as SUC5_COUNT,
sum(d.SUC5_AMOUNT) as SUC5_AMOUNT,
sum(d.REF_COUNT) as REF_COUNT,
sum(d.REF_AMOUNT) as REF_AMOUNT,
sum(d.TRXFEE) as TRXFEE,
max(d.TRXDATE) as  LAST_TRX_TIME,
sum(d.SUC10_COUNT) as SUC10_COUNT,
sum(d.SUC10_AMOUNT) as SUC10_AMOUNT
from dlb_dailytrx  d
left join dlb_shop_info s on d.shop_num=s.shop_num 
left join dlb_agent_info a on s.agent_num=a.agent_num 
left join dlb_customer_info  c on d.customer_num=c.customer_num 
left join dlb_userrole  ur	on c.user_num=ur.user_num
left join DLB_SHOP_INFO_PROFILE  sp  on  d.shop_num=sp.shop_num
where d.TRXDATE>=${START} and d.TRXDATE<${STOP}  
group by
d.TRXDATE,
d.PAY_WAY,
UR.USER_NAME,
d.CUSTOMER_NUM,
C.FULL_NAME,
C.CUSTOMER_TYPE,
C.PROVINCE,
C.CITY,
C.DISTRICT,
C.INDUSTRY,
c.declare_status,
d.SHOP_NUM,
S.SHOP_NAME,
S.CITY,
S.PROVINCE,
S.DISTRICT,
S.ONE_INDUSTRY,
S.TWO_INDUSTRY,
S.CREATEDATE,
A.AGENT_NUM,
A.FULL_NAME,
A.SALESMAN,
d.SOURCE,
d.BUSSINESS_TYPE,
d.TYPE",reportdb
customerinfo,postpaid_payment_period,"SELECT 
CUSTOMER_NUMBER as CUSTOMERNUMBER,
integer(PAYMENT_PERIOD) as PRODUCTLINEID
FROM FEE.TBL_FRONT_FEE_CUSTOMER WHERE PAYMENT_PERIOD IS NOT NULL with ur",feedb
riskEpos,re_syn,"SELECT
COALESCE(BIZ, 'null')|| COALESCE(MEC_NO, 'null')||COALESCE(REQ_ID, 'null')||COALESCE(to_char(OCC_TM,'YYYYMMDDHH24MISS') ,'null') as IDNOUSE,
BIZ,MEC_NO,PROD,DOORGOD_RETCODE,SUB_SYS,DOORGOD_TM,REQ_ID,GOODS_IF
FROM
TL.TBL_RRS_SYNREQ
WHERE
OCC_TM >= ${START} and OCC_TM < ${STOP}
AND BIZ = 'EPOS' and PROD = 'NOCARDPAY'
WITH UR",tldb
riskEpos,re_asy,"SELECT 
COALESCE(BIZ, 'null')|| COALESCE(MEC_NO, 'null')||COALESCE(REQ_ID, 'null')||COALESCE(to_char(OCC_TM,'YYYYMMDDHH24MISS'), 'null') 
||COALESCE(PAY_RESULT, 'null') as IDNOUSE,REQ_IF,PARAM_TYP
FROM 
TL.TBL_RRS_ASYNREQ
WHERE 
OCC_TM >= ${START} and OCC_TM < ${STOP} 
AND BIZ = 'EPOS' and PROD = 'NOCARDPAY'
WITH UR",tldb
riskOffline,ro_syn,"SELECT
COALESCE(PAY_ID, 'null') as IDNOUSE,
PROD,BIZ,PAY_ID,REQ_ID,SEQ_ID,AMT,ORDER_TYPE,OCC_TM,ORDER_TM,MEC_NO,POS_TERMINAL_NO,POS_REQUEST_NO,POS_BATCH_NO,POS_NETWORK_NO,CRD_TYP,BNK_ID,CRD_NO,BANK_CODE,
TRADE_PRODUCT,OPERATE_SE_CODE,PASSWORD_TYPE,GOODS_CODE,USR_IP,GOODS_IF,
RTS_RETDESC,RLSB_RETDESC,RLSG_RETDESC,DOORGOD_RETCODE,SUB_SYS,BANGSUN_TRIGERRULE,RTS_TM,RLSB_TM,RBS_TM,DOORGOD_TM
FROM
TL.TBL_OFFLINE_SYNREQ
WHERE
ORDER_TM >= ${START} and ORDER_TM < ${STOP}
AND ORDER_TYPE = 'SALE'
WITH UR",tldb
riskOffline,ro_asy,"SELECT
COALESCE(ORIG_PAY_TID, 'null') as IDNOUSE,
ORIG_PAY_TID,BANK_ERROR,POSP_RESP_CODE,CORE_PLAT_OD_ST,PAY_TM,PAY_RESULT,BANK_SEQ,BANK_ORDERNO,
BANK_MERCHANT_NO,ACQUIRER_BANK,BANK_PRODUCT_CODE,FRP_CODE,BANK_INTF_ID,AREA32_MSG,AREA32_CODE
FROM
TL.TBL_OFFLINE_ASYNREQ
WHERE
ORDER_TM >= ${START} and ORDER_TM < ${STOP}
AND (ORDER_TYPE = 'SALE' or ORDER_TYPE = 'SALE_CL')
WITH UR",tldb
COMMISSIONCHUANXIAO,commissionlmadjust,"SELECT coalesce(char(a.CODE),'null')||coalesce(char(year(s.ADJUST_TIME)),'null')||coalesce(char(month(s.ADJUST_TIME)),'null')||'commissionlmadjust' AS IDNOUSE,
a.CODE AS RECEIVERID ,
date(${STOP}) - 1 days as trxdate ,
date(${STOP}) - 1 days as true_trxdate ,
'3011001001003A' AS SALES_PRODUCT_CODE ,
'3011001001003' AS PRODUCT_CODE ,
301 AS BIZTYPEID ,
'COMMISSION_LIKER' AS TYPE ,
'lianmengad' as dataorigin ,
year(s.ADJUST_TIME) * 100 + month(s.ADJUST_TIME) as MONTH ,
SUM(s.ADJUST_AMOUNT) AS TRXFEE 
FROM TBL_DAILI_SHAREPROFITADJUSTMENTAPPLICATION s 
LEFT JOIN TBL_DAILI_AGENT a ON s.AGENT_ID = a.ID 
WHERE s.SHAREPROFITADJUSTBUSINESS_TYPE = 'ALC_ADJUST' 
AND s.ADJUST_TIME >=${START} 
and s.ADJUST_TIME< ${STOP}  
group by a.code ,
year(s.ADJUST_TIME) ,
month(s.ADJUST_TIME) 
WITH ur",opendb
COMMISSIONCHUANXIAO,commissionchuanxiao02,"select customernumber as RECEIVERID,id AS CUSTOMERID from db2inst1.customerinfo with ur",reportdb
trxfeepredict,COMMISSIONPR_nohk,"SELECT COALESCE(CHAR(d.CUSTOMER_NUM),'null')||COALESCE(CHAR(date(d.TRX_DATE)),'null')||'COMMISSIONPR_nohk'||char(coalesce(d.BIZ_TYPE,'null'))||coalesce(d.BANK_CODE,'null')  as IDNOUSE,
        year(date(d.TRX_DATE))*100+month(date(d.TRX_DATE)) as month,date(d.TRX_DATE)  as trxdate,
   d.CUSTOMER_NUM AS receiverid,
   (case when d.BIZ_TYPE='netPay' then 4
      when d.BIZ_TYPE='memberPay' then 18
      when d.BIZ_TYPE='creditPay' then 5
      when d.BIZ_TYPE='epos' then 6
      when d.BIZ_TYPE='noBankCard' then
      (case
        when d.BANK_CODE='JIUYOU' then 7
        when d.BANK_CODE='JUNNET' then 8
        when d.BANK_CODE='LIANHUAOKCARD' then 9
        when d.BANK_CODE='NETEASE' then 10
        when d.BANK_CODE='QQCARD' then 12
        when d.BANK_CODE='SHTEL' then 14
        when d.BANK_CODE='SHTELCARD' then 15
        when d.BANK_CODE='SNDACARD' then 16
        when d.BANK_CODE='SOHU' then 17
        when d.BANK_CODE='SZX' then 19
        when d.BANK_CODE='TELECOM' then 20
        when d.BANK_CODE='UNICOM' then 22
        when d.BANK_CODE='WANMEI' then 23
        when d.BANK_CODE='YPCARD' then 24
        when d.BANK_CODE='ZHENGTU' then 25
        when d.BANK_CODE='ZHIFUKA' then 26
        when d.BANK_CODE='TIANXIA' then 41
        when d.BANK_CODE='ZONGYOU' then 81
        when d.BANK_CODE='TIANHONG' then 101
        when d.BANK_CODE='THIRTYTWOCARD' then 242
        when d.BANK_CODE='YICHONGCARD' then 243
        when d.BANK_CODE='YICHONGTIANHONGCARD' then 281
        when d.BANK_CODE='YICHONGZONGYOUCARD' then 282
        when d.BANK_CODE='YICHONGTHIRTYTWOCARD' then 283
        when d.BANK_CODE='ZYZC' then 285
        when d.BANK_CODE='ZYFK' then 286
        else 19 end)
      when d.BIZ_TYPE='entrusted' then 13
      when d.BIZ_TYPE='pos' then 29
      when d.BIZ_TYPE='transferinday' then 13
      when d.BIZ_TYPE='yjzf' then 222
ELSE 4 END) as biztypeid,
  d.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION' as TYPE, 
'COMMISSION' as ORDERTYPE,
'YP3G_COMMISSION' as dataorigin,
  SUM(-d.PROFIT_AMOUNT) AS trxfee 
FROM
    agentfr.TBL_EVERYDAY_COLLECTION_DATA d 
LEFT JOIN
    agentfr.TBL_AGENT a
ON
    d.AGENT_ID = a.ID
WHERE
    d.TRX_DATE >=${START}
AND d.TRX_DATE <${STOP}
AND (a.PRODUCTION_LINE != 'airTravel' or  a.PRODUCTION_LINE IS NULL)
AND (d.BIZ_TYPE!='noBankCard' or d.BIZ_TYPE is null)
GROUP BY 
    year(d.TRX_DATE),month(d.TRX_DATE),date(d.TRX_DATE), 
    d.CUSTOMER_NUM,
    d.BANK_CODE,
    d.BIZ_TYPE 
    with ur",agentfr
trxfeepredict,COMMISSIONPR_hk,"SELECT COALESCE(CHAR(a.NUM),'null')||date(d.TRX_DATE)||'COMMISSIONPR_hk'||char(coalesce(d.BIZ_TYPE,'null'))||coalesce(d.BANK_CODE,'null') as IDNOUSE,
    year(date(d.TRX_DATE))*100+month(date(d.TRX_DATE)) as month,
    date(d.TRX_DATE)  as trxdate,
    a.NUM AS receiverid ,
   (case when d.BIZ_TYPE='netPay' then 4
      when d.BIZ_TYPE='memberPay' then 18
      when d.BIZ_TYPE='creditPay' then 5
      when d.BIZ_TYPE='epos' then 6
      when d.BIZ_TYPE='noBankCard' then
      (case
        when d.BANK_CODE='JIUYOU' then 7
        when d.BANK_CODE='JUNNET' then 8
        when d.BANK_CODE='LIANHUAOKCARD' then 9
        when d.BANK_CODE='NETEASE' then 10
        when d.BANK_CODE='QQCARD' then 12
        when d.BANK_CODE='SHTEL' then 14
        when d.BANK_CODE='SHTELCARD' then 15
        when d.BANK_CODE='SNDACARD' then 16
        when d.BANK_CODE='SOHU' then 17
        when d.BANK_CODE='SZX' then 19
        when d.BANK_CODE='TELECOM' then 20
        when d.BANK_CODE='UNICOM' then 22
        when d.BANK_CODE='WANMEI' then 23
        when d.BANK_CODE='YPCARD' then 24
        when d.BANK_CODE='ZHENGTU' then 25
        when d.BANK_CODE='ZHIFUKA' then 26
        when d.BANK_CODE='TIANXIA' then 41
        when d.BANK_CODE='ZONGYOU' then 81
        when d.BANK_CODE='TIANHONG' then 101
        when d.BANK_CODE='THIRTYTWOCARD' then 242
        when d.BANK_CODE='YICHONGCARD' then 243
        when d.BANK_CODE='YICHONGTIANHONGCARD' then 281
        when d.BANK_CODE='YICHONGZONGYOUCARD' then 282
        when d.BANK_CODE='YICHONGTHIRTYTWOCARD' then 283
        when d.BANK_CODE='ZYZC' then 285
        when d.BANK_CODE='ZYFK' then 286
        else 19 end)
      when d.BIZ_TYPE='entrusted' then 13
      when d.BIZ_TYPE='pos' then 29
      when d.BIZ_TYPE='transferinday' then 13
      when d.BIZ_TYPE='yjzf' then 222
ELSE 4 END) as biztypeid,
d.BIZ_TYPE AS PAYPRODUCT,
'COMMISSION_HK' as TYPE, 
'COMMISSION' as ORDERTYPE,
'YP3G_COMMISSION' as dataorigin,
  SUM(-d.PROFIT_AMOUNT) AS trxfee
FROM
    agentfr.TBL_EVERYDAY_COLLECTION_DATA d
LEFT JOIN
    agentfr.TBL_AGENT a
ON
    a.id = d.AGENT_ID
WHERE
    d.TRX_DATE >=${START}
AND d.TRX_DATE <${STOP}
AND a.PRODUCTION_LINE = 'airTravel' 
AND d.BIZ_TYPE!='noBankCard'
GROUP BY year(d.TRX_DATE),month(d.TRX_DATE),date(d.TRX_DATE),
   a.num,
   d.BANK_CODE,
    d.BIZ_TYPE
    with ur",agentfr
trxfeepredict,trxpridnum,"select id as CUSTOMERID,customernumber as receiverid from db2inst1.customerinfo with ur",reportdb
trxfeepredict,trxprspnum,"select PAYPRODUCT,salesproductcode as SALES_PRODUCT_CODE from db2inst1.payproduct2productcode with ur",reportdb
trxfeepredict,trxprpnum,"select PAYPRODUCT,productcode as PRODUCT_CODE from db2inst1.payproduct2productcode with ur",reportdb
POSSHARECOSTpredict,POSSHARECOSTpredict,"select coalesce(char(date(c.SHARE_TIME)),'null')||coalesce(char(c.AGENT_CODE),'null')||coalesce(char(PRODUCT_TYPE_S),'null')||coalesce(char(c.PRODUCT_CODE_S),'null')||'POSSHARECOSTpredict' as idnouse,
c.AGENT_CODE as RECEIVERID ,
date(c.SHARE_TIME) as trxdate ,
year(c.SHARE_TIME) * 100 + month(c.SHARE_TIME) as month ,
sum(c.FEE_AMOUNT) as TRXFEE ,
c.PRODUCT_TYPE_S as PRODUCT_CODE ,
c.PRODUCT_CODE_S as SALES_PRODUCT_CODE ,
29 as BIZTYPEID ,
'POSSHARECOST' as TYPE ,
'POSP' as dataorigin 
from POSREAD.TDS_DAYADJUST c 
where c.SHARE_TIME>=${START} and c.SHARE_TIME<${STOP} 
group by year(c.SHARE_TIME),month(c.SHARE_TIME),date(c.SHARE_TIME),
AGENT_CODE ,
PRODUCT_TYPE_S ,
PRODUCT_CODE_S 
with ur",opendb
POSSHARECOSTpredict,PSCpridnum,"select customernumber as receiverid,id as customerid from db2inst1.customerinfo with ur",reportdb
publisheddailytrxstat,pbdcommissionpr,"select COALESCE(CHAR(d.trxdate),'null')||COALESCE(CHAR(i.transfdate),'null')||COALESCE(CHAR(d.trxdate),'null')||
COALESCE(CHAR(d.receiverid),'null')||COALESCE(CHAR(d.payerid),'null')||COALESCE(CHAR(d.biztypeid),'null')||
COALESCE(CHAR(d.type),'null')||COALESCE(CHAR(d.product_code),'null')||COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(i.custnum),'null')||COALESCE(CHAR(i.custname),'null')||COALESCE(CHAR(i.salesid),'null')||
COALESCE(CHAR(i.salesname),'null')||COALESCE(CHAR(i.isself),'null')||COALESCE(CHAR(i.isshare),'null')||
COALESCE(CHAR(i.salesscale),'null')||COALESCE(CHAR(i.yejishuxing),'null')||COALESCE(CHAR(i.yejiscale),'null')||
COALESCE(CHAR(i.vmark),'null')||COALESCE(CHAR(i.vipmark),'null')||COALESCE(CHAR(i.branchcompany),'null')||
COALESCE(CHAR(i.businesscatid),'null')||COALESCE(CHAR(i.subbusinesscat),'null')||'pbdcommissionpr' as IDNOUSE,
d.trxdate as trxdate,
i.transfdate as transfdate,
d.trxdate as true_date,
d.receiverid as receiverid,
d.payerid as payerid,
d.biztypeid as biztypeid,
d.type as trxtypeid,
d.product_code as product_code,
d.sales_product_code as sales_product_code,
i.custnum as custnum,
i.custname as custname,
i.salesid as salesid,
i.salesname as salesname,
i.isself as isself,
i.isshare as isshare,
i.salesscale as salesscale,
i.yejishuxing as yejishuxing,
i.yejiscale as yejiscale,
i.vmark as vmark,
i.vipmark as vipmark,
i.branchcompany as branchcompany,
i.businesscatid as businesscatid,
i.subbusinesscat as subbusinesscat,
SUM(d.accountingcost * i.salesscale * i.yejiscale) as accountingcost,
SUM(d.trxfee * i.salesscale* i.yejiscale - d.refundfee * i.salesscale * i.yejiscale - d.accountingcost * i.salesscale * i.yejiscale + d.refundfrpcost * i.salesscale * i.yejiscale) as accountingprofit,
SUM(d.accountingcost * i.salesscale * i.yejiscale) as innercost,
SUM(d.trxfee * i.salesscale * i.yejiscale- d.refundfee * i.salesscale * i.yejiscale) as innerincome,
SUM(d.trxfee * i.salesscale * i.yejiscale- d.refundfee * i.salesscale * i.yejiscale) as newincome,
SUM(d.trxfee * i.salesscale* i.yejiscale - d.refundfee * i.salesscale * i.yejiscale - d.accountingcost * i.salesscale * i.yejiscale + d.refundfrpcost * i.salesscale * i.yejiscale) as innerprofit,
SUM(d.trxamount * i.salesscale * i.yejiscale- d.refundamount * i.salesscale * i.yejiscale) as trxamount,
SUM(d.trxcount * i.salesscale * i.yejiscale- d.refundcount * i.salesscale * i.yejiscale) as trxcount 
from db2inst1.predict_dailytrx d 
left join db2inst1.publisheddailyinfo i on d.receiverid=i.custid and i.trxdate=d.trxdate
where d.receiverid is not null 
and d.receiverid not in (524857,980067,11219567) 
AND d.ISCOMPUTEPROFIT = 1 
AND d.type NOT IN('SettleTransf') 
AND d.trxdate >= ${START} AND d.trxdate < ${STOP} 
group by 
d.trxdate,
i.transfdate,
d.trxdate,
d.receiverid,
d.payerid,
d.biztypeid,
d.type,
d.product_code,
d.sales_product_code,
i.custnum,
i.custname,
i.salesid,
i.salesname,
i.isself,
i.isshare,
i.salesscale,
i.yejishuxing,
i.yejiscale,
i.vmark,
i.vipmark,
i.branchcompany,
i.businesscatid,
i.subbusinesscat 
with ur",reportdb
rjtonline,rjtLKsucc," SELECT 
 COALESCE(CHAR(T.CUSTOMERID),'null')||COALESCE(CHAR(DATE(TB.DEBITDATE)),'null')||COALESCE(CHAR(TE.CHARVALUE),'null')||coalesce(char(T.BANKID),'null')||'rjtLKsucc' as IDNOUSE,
 'YP2G' AS DATAORIGIN,YEAR(DATE(TB.DEBITDATE))*100+MONTH(DATE(TB.DEBITDATE)) AS MONTH,
 DATE(TB.DEBITDATE) AS TRXDATE,T.CUSTOMERID AS RECEIVERID ,
 TE.CHARVALUE AS TRXCHANNELID,
 T.BANKID AS BANK_CODE,
 'TRANSFEXT_INDAY' AS PAYPRODUCT,
 COUNT(*) TRXCOUNT, SUM(T.SRCAMOUNT) TRXAMOUNT,
 SUM(T.SRCFEE) TRXSOURCEFEE,
 SUM(T.TARGETFEE) TRXTARGETFEE,
 SUM(T.SRCFEE+T.TARGETFEE) AS TRXFEE,
 'REMIT' AS ORDERTYPE, '3011101001001' AS PRODUCT_CODE,
 '3011001001003A' AS SALES_PRODUCT_CODE,
  13 AS BIZTYPEID, 'TRANSFINDAY' AS TYPE 
        FROM TRANSFER T 
        left join TBL_BALANCE_REQUEST TB ON TB.ID=T.ID
        LEFT JOIN TRANSFEREXTINFO TE ON T.ID=TE.TRANSFER_ID AND TE.EXTSOURCE='CHANNELID3G22G' 
       left join TRANSFEREXTINFO TEE on T.ID=TEE.TRANSFER_ID AND TEE.EXTSOURCE = 'SECOND_PRODUCT_CODE' 
        WHERE
         TB.REMITSTATUS IN ('ACCOUNTDEBITED','GENERATEBATCH','FAIL','SUCCESS','REFUNDED')  
          AND TEE.CHARVALUE='LIKER'
          AND TB.DEBITDATE >= ${START} AND TB.DEBITDATE < ${STOP} 
          AND T.BUSITYPE IN('TRANSFEXT_INDAY') 
          GROUP BY T.CUSTOMERID,DATE(TB.DEBITDATE), TE.CHARVALUE,T.BANKID WITH UR",COPY2
rjtonline,rjtLKrefund,"SELECT COALESCE(CHAR(TR.CUSTOMERID),'null')||COALESCE(CHAR(DATE(TR.CONFIRMDATE)),'null')||COALESCE(CHAR(TE.CHARVALUE),'null')||coalesce(char(T.BANKID),'null')||'rjtLKrefund' as IDNOUSE,
  'YP2G' AS DATAORIGIN,YEAR(DATE(TR.CONFIRMDATE))*100+MONTH(DATE(TR.CONFIRMDATE)) AS MONTH,DATE(TR.CONFIRMDATE) AS TRXDATE,
TR.CUSTOMERID AS RECEIVERID ,
             TE.CHARVALUE AS TRXCHANNELID,T.BANKID AS BANK_CODE,
             'TRANSFEXT_INDAY' AS PAYPRODUCT,
             COUNT(*) REFUNDCOUNT,
                      SUM(T.SRCAMOUNT) REFUNDAMOUNT,
                                       SUM(REFUNDSRCFEE+REFUNDTARGETFEE) AS REFUNDFEE,
                                       'REMIT' AS ORDERTYPE,
             '3011101001001' AS PRODUCT_CODE,
             '3011001001003A' AS SALES_PRODUCT_CODE,
             13 AS BIZTYPEID,
             'TRANSFINDAY' AS TYPE
      FROM TRANSFERREFUNDRECORD TR
      LEFT JOIN TRANSFER T ON TR.ORGTRANSFER_ID=T.ID
      LEFT JOIN TRANSFEREXTINFO TE ON T.ID=TE.TRANSFER_ID AND TE.EXTSOURCE='CHANNELID3G22G'
      left join TRANSFEREXTINFO TEE on T.ID=TEE.TRANSFER_ID AND TEE.EXTSOURCE = 'SECOND_PRODUCT_CODE'
      WHERE T.BUSITYPE IN('TRANSFEXT_INDAY')
        AND TR.STATUS='SUCCESS' 
        AND TEE.CHARVALUE  IN ('LIKER')
        AND TR.CONFIRMDATE >= ${START} AND TR.CONFIRMDATE < ${STOP} 
      GROUP BY TR.CUSTOMERID,DATE(TR.CONFIRMDATE),
               TE.CHARVALUE,T.BANKID WITH UR",COPY2
testmonthlyreport,monthlycurrent," select
 2017 AS YEAR,
 08 AS MONTH,
 3 AS QUARTER,
 1 AS VERSION,
 CURRENT_TIMESTAMP AS CREATE_TIME,
 CUSTOMER.CUSTOMERNUMBER AS CUSTOMER_NO,
 coalesce(coalesce(ex.NAME,ex1.name),'_¨å_') AS PERFORMANCE_ATTRIBUTE,
 EMPLOYEE.NAME AS SALES_NAME ,
 EMPLOYEE.loginusername AS SALES_EMAIL_PROFIX ,
 EMPLOYEE1.NAME AS SALES_DIRECTOR_NAME,
 STAT.hangyeyejishuxing AS PRODUCT_LINE,
 sum(STAT.TRXAMOUNT*coalesce(c2a.PERCENT,1)) AS TRX_AMOUNT,
 sum(STAT.ACCOUNTINGPROFIT*coalesce(c2a.PERCENT,1)) AS PROFIT,
 case when coalesce(coalesce(ex.NAME,ex1.name),'_¨å_') in ('ä¿__è¡__çº','__è¡__çº','_¿ä¿¡è¡__çº','_µä¿¡ä¸___')            and (case when CUSTOMER.VMARK is null then 'V' else CUSTOMER.VMARK end)='V' then 'TRUE'       when  coalesce(coalesce(ex.NAME,ex1.name),'_¨å_') in ('__º¬____','æ²³å_____','å±±ä_____','å±±è¥¿____','__¥¿____','å¤©æ´¥____','æ±______','ä¸_µ·____','æµ______','ç¦_»º____','å¹¿ä_____','_______')             and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) in ('çº¿ä_','ç§»å_')            and (case when CUSTOMER.VMARK is null then 'V' else CUSTOMER.VMARK end)='V'  then 'TRUE'         when coalesce(coalesce(ex.NAME,ex1.name),'_¨å_') in ('__º¬____','æ²³å_____','å±±ä_____','å±±è¥¿____','__¥¿____','å¤©æ´¥____','æ±______','ä¸_µ·____','æµ______','ç¦_»º____','å¹¿ä_____','_______')                and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) in ('çº¿ä_','___ç»_')            and (case when CUSTOMER.VMARK is null then 'V' else CUSTOMER.VMARK end) in ('V','V-') then '1'             else '0'             end AS IS_COMPUTE_PROFIT
 from db2inst1.PUBLISHEDMONTHLYTRXSTAT AS STAT
 left join db2inst1.EMPLOYEEINFO AS EMPLOYEE on 1=1 and STAT.SALEID=EMPLOYEE.ID
 left join db2inst1.CUSTOMERINFO AS CUSTOMER on 1=1 and STAT.CUSTOMERID   =CUSTOMER.ID
 left join db2inst1.TRXSTATBUSINESSCATEGORIE AS TBC on 1=1 and CUSTOMER.BUSSINESSCATID=TBC.ID
 left join db2inst1.PRODUCTCODE AS P on 1=1 and STAT.PRODUCT_CODE=P.PRODUCTCODE and P.PRODUCTTYPE=2
 left join db2inst1.PRODUCTCODE AS P1 on 1=1 and STAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE and P1.PRODUCTTYPE=1
 left join db2inst1.EMPLOYEEINFO AS EMPLOYEE1 on 1=1 and EMPLOYEE.SUPERIORID=EMPLOYEE1.ID
 left join db2inst1.productcode_profile AS PP on 1=1 and STAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE and STAT.PRODUCT_CODE=PP.PRODUCT_CODE
 left join db2inst1.customer2achievement AS c2a on 1=1 and CUSTOMER.customernumber=c2a.customer_number
 left join db2inst1.EXISTENCE AS ex on 1=1 and c2a.ACHIEVEMENT_ID=ex.ID and ex.CLASSTYPE='Department'
 left join db2inst1.TRXSTATSUBBUSINESSCATEGORIE AS tsb on 1=1 and CUSTOMER.SUBBUSINESSCAT=tsb.CODE
 left join db2inst1.PRODUCTCODE2PRODUCTGROUP AS p2pg on 1=1 and STAT.PRODUCT_CODE=p2pg.PRODUCT_CODE and STAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE
 left join db2inst1.EMPLOYEEYEJISHUXING_201601_201607 AS e on 1=1 and STAT.SALEID=e.SALESID 
 left join db2inst1.EXISTENCE AS ex1 on 1=1 and e.YEJISHUXING=ex1.id and ex1.CLASSTYPE='Department' 
 where 1=1 and 
 STAT.month between '201708' and '201708'
 group by
 STAT.month,
 CUSTOMER.CUSTOMERNUMBER,
 ex.NAME,
 EMPLOYEE.NAME,
 EMPLOYEE.loginusername,
 EMPLOYEE1.NAME,
 ex1.name,
 CUSTOMER.SIGNEDNAME,
 CUSTOMER.VMARK,
 PP.ACCOUNTCLASS,
 STAT.hangyeyejishuxing
 with ur",reportdb_read
accountcostjingfen,accosttuikuan,"select COALESCE(CHAR(clear_date),'null')||COALESCE(CHAR(CUSTOMER_NO),'null')||COALESCE(CHAR(ACCOUNTING_PRODUCT_CODE),'null')||COALESCE(CHAR(MARKETING_PRODUCT_CODE),'null')||coalesce(char(bi_code),'null')||coalesce(char(BUSI_ANAL1),'null')||coalesce(char(TERMINAL_NO),'null')||coalesce(char(mcc),'null')||coalesce(char(card_type),'null')||'accosttuikuan' AS IDNOUSE,
clear_date   AS TRXDATE,
bi_code as trxchannelid,
CUSTOMER_NO    AS RECEIVERID,
CUSTOMER_NO as customernumber,
ACCOUNTING_PRODUCT_CODE   AS PRODUCT_CODE,
MARKETING_PRODUCT_CODE     AS SALES_PRODUCT_CODE,
'Sales' as type,
-sum(cost+coalesce(cost3,0.00)+coalesce(cost4,0.00)) as accountingcost,
-sum(OPER_COST) as externalcost,
(CASE 
            WHEN card_type='J' 
            THEN 'DEBIT' 
            WHEN card_type='X' 
            THEN 'CREDIT' 
            ELSE card_type
 END ) as cardtype,
TERMINAL_NO as bank_customer_number,
mcc as mcc,
BUSI_ANAL1 as trxchannelid_frp,
sum(RECEIVE_MONEY) as refundamount,
count(*) as refundcount 
from charge.actual_0002 
where clear_date =${START} 
group by clear_date,customer_no,marketing_product_code,accounting_product_code,bi_code,BUSI_ANAL1,TERMINAL_NO,mcc,card_type
with ur",checkdb
accountcostjingfen,accostdakuan,"select COALESCE(CHAR(clear_date),'null')||COALESCE(CHAR(CUSTOMER_NO),'null')||COALESCE(CHAR(ACCOUNTING_PRODUCT_CODE),'null')||COALESCE(CHAR(MARKETING_PRODUCT_CODE),'null')||coalesce(char(REMIT_CHANNEL_NO),'null')||coalesce(char(BUSI_ANAL1),'null')||'accostdakuan' AS IDNOUSE,
clear_date   AS TRXDATE,
CUSTOMER_NO    AS RECEIVERID,
CUSTOMER_NO as customernumber,
REMIT_CHANNEL_NO as trxchannelid,
ACCOUNTING_PRODUCT_CODE  AS PRODUCT_CODE,
MARKETING_PRODUCT_CODE   AS SALES_PRODUCT_CODE,
sum(cost+coalesce(cost3,0.00)+coalesce(cost4,0.00)) as accountingcost,
sum(OPER_COST) as externalcost,
BUSI_ANAL1 as trxchannelid_frp,
sum(AMOUNT) as trxamount,
count(*) as trxcount 
from charge.actual_0003 
where clear_date =${START} 
group by clear_date,customer_no,marketing_product_code,accounting_product_code,REMIT_CHANNEL_NO,BUSI_ANAL1
with ur",checkdb
BCSALESORDER,BCSALESORDER," select 
 o.id AS IDNOUSE ,
 o.id as ID,
 o.PRODUCT,
 o.PRODUCT_SERVICE,
 o.CUSTOMER_NO,
 o.TERMINAL_NO,
 o.CUSTOMER_NAME,
 o.CUSTOMER_REQUEST_ID,
 o.ORDER_TYPE,
 o.PAY_TYPE,
 o.STATUS,
 o.AMOUNT ,
	o.PAYER_CUSTOMER_NO  ,
	o.PAYER_ACCOUNT_NO ,
	o.PAYER_FEE ,
	o.PAYER_FEE_TYPE ,
	o.RECEIVER_ACCOUNT_NO ,
	o.RECEIVER_FEE ,
	o.RECEIVER_FEE_TYPE , 
 o.CUSTOMER_REQUEST_ID ,
 o.EXTERNAL_ID  ,
 o.ORDER_DATE ,
 ext.GOODS_NAME,
 ext.EXTEND_INFO ,
 ext.CUSTOMER_BIZ_REQUEST_ID,
 o.PAYER_FEE ,
 ext.GOODS_DES 
FROM TBL_ORDER_1710 as o,TBL_ORDER_EXT_1710 as ext  
where o.id = ext.id  
and o.STATUS ='SUCCESS' 
and o.PAYER_CUSTOMER_NO='10012434097' 
and o.ORDER_DATE >= ${START} 
and o.ORDER_DATE < ${STOP}",bctrade
liushantest,test1,"select P.etltaskid as ID, count(distinct P.TRXDATE) as COUNT from (select left(D.etltaskid,length(D.etltaskid)-3) as ETLTASKID, 
D.TRXDATE from dailytrxstat D where D.TRXDATE between '2017-09-01' and '2017-09-30' group by D.etltaskid, D.TRXDATE) as P 
group by P.etltaskid with ur",reportdb
G2Frp,G2Frp,"select id as frpId,name as frpName,g3payinterface as frpg3payinterface,business as frpbussiness,frptype as frptype,bankacttype as frpbankacttype,availablefor as frpavailablefor 
from frp
with ur",COPY2
accountPayStat,memberOrder,"    select 
        char(date(p.trxDate))||'memberOrder' as IDNOUSE, 
        char(date(p.trxDate)) as TRXDATE , 
        sum(case when p.TRXSTATUS ='SUCCESS' then 1 else 0 end) as SUCCESS_COUNT_G2, 
        sum(case when p.TRXSTATUS ='SUCCESS' then AMOUNT else 0 end) as SUCCESS_TOTAL_AMOUNT_G2, 
        sum(case when p.TRXSTATUS ='FAIL' then 1 else 0 end) as FAIL_COUNT_G2, 
        sum(case when p.TRXSTATUS ='FAIL' then AMOUNT else 0 end) as FAIL_TOTAL_AMOUNT_G2, 
        sum(AMOUNT) as TOTAL_AMOUNT_G2, 
        count(*) as TOTAL_COUNT_G2 
from 
        MOBILEBE.trxOrder t 
left join 
        MOBILEBE.payment p 
on 
        t.id=p.trxOrder_id 
where 
        p.trxDate>=${START} 
        and p.trxDate< ${STOP} 
        and p.bankerrorInfo='yeepay_wait_accountpay' 
group by date(p.trxDate) with ur",COPY2
accountPayStat,accountPayOrder,"select 
        char(date(t.trx_time))||'accountPayOrder' as IDNOUSE,
        char(date(t.trx_time)) as TRXDATE,  
        sum(case when t.status='SUCCESS' then 1 else 0 end) as SUCCESS_COUNT_ACCOUNTPAY,
        sum(case when t.status='SUCCESS' then AMOUNT else 0 end) as SUCCESS_TOTAL_AMOUNT_ACCOUNTPAY,
        sum(case when t.status='FAIL' then 1 else 0 end) as FAIL_COUNT_ACCOUNTPAY,
        sum(case when t.status='FAIL' then AMOUNT else 0 end) as FAIL_TOTAL_AMOUNT_ACCOUNTPAY,
        sum(AMOUNT) as TOTAL_AMOUNT_ACCOUNTPAY, 
        count(*) as TOTAL_COUNT_ACCOUNTPAY   
from 
        ACCNTPAY.tbl_pay_order_1712  t 
where 
        t.operator='G2MEMBERPAY' 
        and t.trx_time>=${START}
        and t.trx_time<${STOP}
        group by date(t.trx_time) with ur",dzh_standby
G2Bank,G2Bank,"select id as bankid,banktype as banktype,briefname as bankbriefname,fullname as bankfullname
from bank
with ur",COPY2
productcentermonthly,productcentermonthly,"select coalesce(char(STAT.MONTH),'null')||
coalesce(char(STAT.GROUPTYPE),'null')||
coalesce(char(CUSTOMER.CUSTOMERNUMBER),'null')||
coalesce(char(CUSTOMER.SIGNEDNAME),'null')||
coalesce(char(CUSTOMER.AGENTNAME),'null')||
coalesce(char(CUSTOMER.FULLNAME),'null')||
coalesce(char(TBC.NAME),'null')||
coalesce(char(tsb.NAME),'null')||
coalesce(char(P1.PRODUCTNAME),'null')||
coalesce(char(P.PRODUCTNAME),'null')||
coalesce(char(EMPLOYEE.NAME),'null')||
coalesce(char(BRA.BRANCHNAME),'null')||
coalesce(char(coalesce(CUSTOMER.PRODUCTLINE,STAT.HANGYEYEJISHUXING)),'null')||
coalesce(char(BIZTYPE.DISPLAYNAME),'null')||
coalesce(char(TRXTYPE.NAME),'null')||
coalesce(char(coalesce(coalesce(ex.NAME,ex1.name),'_¨å_')),'null')||
coalesce(char(CASE WHEN CUSTOMER.VIPMARK=1 THEN 'VIP' WHEN CUSTOMER.VIPMARK=2 THEN 'SVIP' ELSE  '____'  END),'null') as IDNOUSE,
CUSTOMER.CUSTOMERNUMBER as CUSTOMERNUMBER,
CUSTOMER.SIGNEDNAME as SIGNEDNAME,
CUSTOMER.AGENTNAME as AGENTNAME,
CUSTOMER.FULLNAME as FULLNAME,
TBC.NAME as  FIRNAME,
tsb.NAME as SECNAME,
P1.PRODUCTNAME as salesproductname,
P.PRODUCTNAME as productname,
(CASE WHEN CUSTOMER.VIPMARK=1 THEN 'VIP' WHEN CUSTOMER.VIPMARK=2 THEN 'SVIP' ELSE  '____'  END) as VMARK,
EMPLOYEE.NAME as SALESNAME,
BRA.BRANCHNAME as BRANCHNAME,
coalesce(CUSTOMER.PRODUCTLINE,STAT.HANGYEYEJISHUXING) as HANGYEYEJISHUXING,
BIZTYPE.DISPLAYNAME as DISPLAYNAME,
TRXTYPE.NAME as TRXTYPE,
coalesce(coalesce(ex.NAME,ex1.name),'_¨å_') as YEJISHUXING,
STAT.MONTH as MONTH,
STAT.GROUPTYPE as GROUPTYPE,
sum(CASE WHEN (STAT.BIZTYPEID IN (29,129) and STAT.TRXTYPEID not in ('POSRENT','POSSALES')) THEN 0 ELSE STAT.ACCOUNTINGCOST*coalesce(c2a.PERCENT,1) END ) as ACCOUNTINGCOST,
sum(STAT.TRXCOUNT*coalesce(c2a.PERCENT,1)) as TRXCOUNT,
sum(STAT.TRXAMOUNT*coalesce(c2a.PERCENT,1)) as TRXAMOUNT,
sum(CASE WHEN (STAT.BIZTYPEID IN (29,129) and STAT.TRXTYPEID not in ('POSRENT','POSSALES')) THEN STAT.ACCOUNTINGPROFIT*coalesce(c2a.PERCENT,1) ELSE STAT.INNERINCOME*coalesce(c2a.PERCENT,1) END) as TRXFEE,
sum(STAT.ACCOUNTINGPROFIT*coalesce(c2a.PERCENT,1)) as accountingprofit,
sum(STAT.NEWCOST*coalesce(c2a.PERCENT,1)) as NEWCOST,
sum(STAT.NEWINCOME*coalesce(c2a.PERCENT,1)) as NEWINCOME
from PUBLISHEDMONTHLYTRXSTAT STAT
left join TIMELATITUDE on 1=1 and STAT.TIMELATITUDEID=TIMELATITUDE.ID 
left join TRXSTATCUSTOMERAREA AS AREA on 1=1 and STAT.AREAID=AREA.ID 
left join TRXSTATBIZTYPE AS BIZTYPE on 1=1 and STAT.BIZTYPEID=BIZTYPE.ID 
left join EMPLOYEEINFO AS EMPLOYEE on 1=1 and STAT.SALEID=EMPLOYEE.ID 
left join TRXSTATTRXTYPE AS TRXTYPE on 1=1 and STAT.TRXTYPEID=TRXTYPE.ID 
left join CUSTOMERINFO AS CUSTOMER on 1=1 and STAT.CUSTOMERID   =CUSTOMER.ID 
left join PRODUCTGROUPTYPE on 1=1 and STAT.PRODUCTGROUP=PRODUCTGROUPTYPE.ID 
left join TRXSTATCUSTOMERAREA AS BRA on 1=1 and STAT.BRANCHCOMPANY=BRA.AREAID 
left join TRXSTATBUSINESSCATEGORIE AS TB on 1=1 and STAT.BUSINESSCATID=TB.ID 
left join TRXSTATBUSINESSCATEGORIE AS TBC on 1=1 and CUSTOMER.BUSSINESSCATID=TBC.ID 
left join TRXSTATBIZTYPE_PROFILE AS tp on 1=1 and STAT.BIZTYPEID=tp.BIZTYPEID 
left join TRXSTATACCMARK AS acc on 1=1 and CUSTOMER.ACCMARK=acc.CODE 
left join PRODUCTCODE AS P on 1=1 and STAT.PRODUCT_CODE=P.PRODUCTCODE and P.PRODUCTTYPE=2 
left join PRODUCTCODE AS P1 on 1=1 and STAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE and P1.PRODUCTTYPE=1 
left join EMPLOYEEINFO AS EMPLOYEE1 on 1=1 and EMPLOYEE.SUPERIORID=EMPLOYEE1.ID 
left join productcode_profile AS PP on 1=1 and STAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE and STAT.PRODUCT_CODE=PP.PRODUCT_CODE 
left join customer2achievement AS c2a on 1=1 and CUSTOMER.customernumber=c2a.customer_number 
left join EXISTENCE AS ex on 1=1 and c2a.ACHIEVEMENT_ID=ex.ID and ex.CLASSTYPE='Department' 
left join TRXSTATSUBBUSINESSCATEGORIE AS tsb on 1=1 and CUSTOMER.SUBBUSINESSCAT=tsb.CODE 
left join PRODUCTCODE2PRODUCTGROUP AS p2pg on 1=1 and STAT.PRODUCT_CODE=p2pg.PRODUCT_CODE and STAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE 
left join EMPLOYEEYEJISHUXING_201601_201607 AS e on 1=1 and STAT.SALEID=e.SALESID 
left join EXISTENCE AS ex1 on 1=1 and e.YEJISHUXING=ex1.id and ex1.CLASSTYPE='Department' 
left join CUSTOMERINFO AS PAYER on 1=1 and STAT.PAYERID=PAYER.ID 
where STAT.MONTH=year(date(${START}))*100+month(date(${START}))
group by
CUSTOMER.CUSTOMERNUMBER,
CUSTOMER.SIGNEDNAME,
CUSTOMER.AGENTNAME,
CUSTOMER.FULLNAME,
TBC.NAME,
tsb.NAME,
P1.PRODUCTNAME,
P.PRODUCTNAME,
EMPLOYEE.NAME,
BRA.BRANCHNAME,
coalesce(CUSTOMER.PRODUCTLINE,STAT.HANGYEYEJISHUXING),
CASE WHEN CUSTOMER.VIPMARK=1 THEN 'VIP' WHEN CUSTOMER.VIPMARK=2 THEN 'SVIP' ELSE '____' END,
BIZTYPE.DISPLAYNAME,
TRXTYPE.NAME,
STAT.MONTH,
STAT.GROUPTYPE,
coalesce(coalesce(ex.NAME,ex1.name),'_¨å_')
with ur",reportdb
accountPayStat,csOrder,"SELECT
      char(date(O.CREATE_DATE))||'csOrder' as IDNOUSE, 
      char(date(O.CREATE_DATE)) as TRXDATE,
      SUM( O.AMOUNT ) as TOTAL_AMOUNT_ACCOUNT ,
      COUNT( * ) as TOTAL_COUNT_ACCOUNT
    FROM
      CS.TBL_PROCESS_TRXORDER_1712 O
    WHERE
      O.CREATE_DATE >= ${START}
      AND O.CREATE_DATE < ${STOP}
      AND O.CHANNEL_SIGN = 'ACCOUNT_PAY'
      AND O.ORDER_STATUS = 'SUCCESS'
group by date(O.CREATE_DATE) with ur",zxdb_standby
TdMerchantTop20,TdMerchantTop20_total,"SELECT  min(ID) as ID,date(create_time) as Create_time,BANKID,YEEPAY_MERCHANT_NO,COUNT(a.ID)  AS  total_cnt,sum(CASE WHEN DEAL_STATUS='SUCCESS' THEN 1 ELSE 0 END) AS SUCC_CNT,SUM(CASE WHEN DEAL_STATUS='SUCCESS' THEN COALESCE(a.TRADE_AMOUNT,0) ELSE 0 END) AS  succMoney,
rownumber() over(partition by BANKID order by SUM(CASE WHEN DEAL_STATUS='SUCCESS' THEN COALESCE(a.TRADE_AMOUNT,0) ELSE 0 END) desc) RANKS
FROM BANK.TBL_BANK_NOCARD_ORDER a
WHERE  a.create_time>=${START} AND a.create_time <${STOP}
GROUP BY date(create_time),BANKID,a.YEEPAY_MERCHANT_NO
with ur
",cashier_bank
TdBankLostOrderRate,TdBankLostOrderRate_total,"select * from (select MIN(PAYMENT_NO) AS ID,date(CREATE_TIME ) as createdate,frp_code AS TEMP,BANK_CODE AS BANKID,COUNT(PAYMENT_NO) AS SUCC_CNT,SUM(CASE WHEN STATE IN ('FAULT_REFUND','REVERSE') THEN 1 ELSE 0 END) AS LOST_CNT from NCC.tbl_nc_pay_order where CREATE_TIME >=${START} and CREATE_TIME<${STOP} AND bank_state ='SUCCESS' group by date(CREATE_TIME ),frp_code,BANK_CODE) where LOST_CNT>0 with ur",INNO_STANBY
accountcostjingfen,accostidnum,"select customernumber as receiverid,id as custid from db2inst1.customerinfo with ur",reportdb
dlbcustomer,dlbcustomer,"select
COALESCE(CHAR(SP.FIRST_TRX_TIME),'null')||
COALESCE(CHAR(S.PROVINCE),'null')||
COALESCE(CHAR(S.CITY),'null')||
COALESCE(CHAR(SP.LAST_TRX_TIME),'null')||
COALESCE(CHAR(S.CREATEDATE),'null')||
COALESCE(CHAR(S.DISTRICT),'null')||
COALESCE(CHAR(S.SHOP_NUM),'null')||
COALESCE(CHAR(S.SHOP_NAME),'null')||
COALESCE(CHAR(C.CUSTOMER_NUM),'null')||
COALESCE(CHAR(C.DISTRICT),'null')||
COALESCE(CHAR(C.PROVINCE),'null')||
COALESCE(CHAR(C.CITY),'null')||
COALESCE(CHAR(C.FULL_NAME),'null')||
COALESCE(CHAR(A.AGENT_NUM),'null')||
COALESCE(CHAR(A.FULL_NAME),'null')||
COALESCE(CHAR(C.BD_CREATE),'null')||
COALESCE(CHAR(C.DECLARE_STATUS),'null')||
COALESCE(CHAR(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end),'null') as IDNOUSE,
SP.FIRST_TRX_TIME as FIRST_TRX_TIME,
S.PROVINCE as SHOP_PROVINCE,
S.CITY as SHOP_CITY,
SP.LAST_TRX_TIME as LAST_TRX_TIME,
S.CREATEDATE as CREATEDATE,
S.DISTRICT as SHOP_DISTRICT,
S.SHOP_NUM as SHOP_NUM,
S.SHOP_NAME as SHOP_NAME,
C.CUSTOMER_NUM as CUSTOMER_NUM,
C.DISTRICT as CUSTOMER_DISTRICT,
C.PROVINCE as CUSTOMER_PROVINCE,
C.CITY as CUSTOMER_CITY,
C.FULL_NAME as CUSTOMER_FULL_NAME,
C.DECLARE_STATUS as DECLARE_STATUS,
A.AGENT_NUM as AGENT_NUM,
(case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end) as department,
A.FULL_NAME as AGENT_FULL_NAME,
C.BD_CREATE as BDDATE
from DLB_SHOP_INFO AS S
left join DLB_AGENT_INFO AS A on S.AGENT_NUM=A.AGENT_NUM 
left join DLB_CUSTOMER_INFO AS C on S.CUSTOMER_NUM=C.CUSTOMER_NUM 
left join DLB_SHOP_INFO_PROFILE AS SP on  S.SHOP_NUM=SP.SHOP_NUM 
left join DLB_USERROLE AS U on  C.USER_NUM=U.USER_NUM 
left join DLB_SHOP_FIRST30D AS F30D on  S.SHOP_NUM=F30D.SHOP_NUM 
group by
SP.FIRST_TRX_TIME,
S.PROVINCE,
S.CITY,
SP.LAST_TRX_TIME,
S.CREATEDATE,
S.DISTRICT,
S.SHOP_NUM,
S.SHOP_NAME,
C.CUSTOMER_NUM,
C.DISTRICT,
C.PROVINCE,
C.CITY,
C.FULL_NAME,
C.DECLARE_STATUS,
A.AGENT_NUM,
case when a.full_name like '%_______%' then '_______' when a.full_name like '%æ´______%' then 'æ´______' when a.full_name like '%__º¬___%' then '__º¬___'when a.full_name like '%_______%' then '_______'when a.full_name like '%__º¬____%' then '__º¬____'when a.full_name like '%æ·±å_____%' then 'æ·±å_____'when a.full_name like '%å°__%' then 'è¶_º§å°__'when a.full_name like '%å¤§å_%' then 'å¤§å_' else 'æ¸__' end,
A.FULL_NAME,
C.BD_CREATE",reportdb
TdBankCompulsoryRate,TdBankCompulsoryRate,"select A.*,B.BANK_CHANNEL_NAME from 
(select * from (select max(id) as ID,DATE(CONFIRM_TIME) AS CONFIRM_TIME ,TRADE_INTERFACE,BANKID,count(*) as SUCC_CNT,SUM(CASE WHEN DRIVE_TYPE='REPAIR_COMPULSORY' THEN 1 ELSE 0 END) AS LOST_CNT 
from BANK.TBL_BANK_NOCARD_ORDER 
where REQUEST_TYPE='PAY' AND  DEAL_STATUS='SUCCESS' AND CONFIRM_TIME>=${START} AND CONFIRM_TIME<${STOP}
GROUP BY DATE(CONFIRM_TIME),TRADE_INTERFACE,BANKID) where  LOST_CNT >0 ) as A  
left join BANK.TBL_BANK_BASIC_CHANNEL  as B 
ON A.TRADE_INTERFACE=B.BANK_CHANNEL_CODE
with ur",cashier_bank
TdBankCallbackCost,TdBankCallbackCost_E,"select tt.ID,tt.CREATE_TIME,ch.BANK_CHANNEL_NAME,COALESCE(t1s.sec1,0)  AS suc_1,COALESCE(t2s.sec2,0) AS suc_2,COALESCE(t3s.sec3,0) AS suc_3,COALESCE(t5s.sec5,0) AS suc_5,COALESCE(t30s.sec30,0) AS suc_30,COALESCE(t30m.min30,0) AS min_30,COALESCE(t45m.min45,0) AS min_45,COALESCE(t60m.min60,0) AS min_60,COALESCE(t120m.min120,0) AS min_120,COALESCE(t121m.min121,0) AS min_121,COALESCE(tt.total,0) AS total FROM
  (
  SELECT MIN(A.ID) AS ID,DATE(a.CREATE_TIME) AS CREATE_TIME,a.TRADE_INTERFACE ,count(a.ID) total FROM BANK.TBL_BANK_NOCARD_ORDER  a where  a.CREATE_TIME>=${START}
        AND a.CREATE_TIME<${STOP} GROUP BY a.TRADE_INTERFACE,DATE(a.CREATE_TIME)
  ) tt  left JOIN 
BANK.TBL_BANK_BASIC_CHANNEL ch ON tt.TRADE_INTERFACE=ch.BANK_CHANNEL_CODE LEFT join
(
select a.TRADE_INTERFACE,count(a.ID) sec1 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(2, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))<1 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME< ${STOP} GROUP BY a.TRADE_INTERFACE) t1s
         ON tt.TRADE_INTERFACE=t1s.TRADE_INTERFACE LEFT JOIN 
(
select a.TRADE_INTERFACE,count(a.ID) sec2 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(2, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))<2 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME<${STOP} GROUP BY a.TRADE_INTERFACE) t2s
       ON tt.TRADE_INTERFACE=t2s.TRADE_INTERFACE LEFT JOIN 
(
 select a.TRADE_INTERFACE,count(a.ID) sec3 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(2, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))<3 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME<${STOP} GROUP BY a.TRADE_INTERFACE  )t3s 
      ON tt.TRADE_INTERFACE=t3s.TRADE_INTERFACE LEFT JOIN    
     (   
 select a.TRADE_INTERFACE,count(a.ID) sec5 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(2, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))<5 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME<${STOP} GROUP BY a.TRADE_INTERFACE   )t5s 
        ON tt.TRADE_INTERFACE=t5s.TRADE_INTERFACE LEFT JOIN  
(
 select a.TRADE_INTERFACE,count(a.ID) sec30 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(2, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))<30 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME<${STOP} GROUP BY a.TRADE_INTERFACE )t30s 
        ON tt.TRADE_INTERFACE=t30s.TRADE_INTERFACE LEFT JOIN 
(
 select a.TRADE_INTERFACE,count(a.ID) min30 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(4, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))<30 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME<${STOP} GROUP BY a.TRADE_INTERFACE ) t30m 
        ON tt.TRADE_INTERFACE=t30m.TRADE_INTERFACE LEFT JOIN 
 (       
 select a.TRADE_INTERFACE,count(a.ID) min45 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(4, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))<45 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME<${STOP} GROUP BY a.TRADE_INTERFACE  )t45m 
        ON tt.TRADE_INTERFACE=t45m.TRADE_INTERFACE LEFT JOIN 
 (       
 select a.TRADE_INTERFACE,count(a.ID) min60 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(4, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))<60 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME< ${STOP} GROUP BY a.TRADE_INTERFACE )t60m 
        ON tt.TRADE_INTERFACE=t60m.TRADE_INTERFACE LEFT JOIN 
 (       
 select a.TRADE_INTERFACE,count(a.ID) min120 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(4, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))<120 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME<${STOP} GROUP BY a.TRADE_INTERFACE )t120m 
        ON tt.TRADE_INTERFACE=t120m.TRADE_INTERFACE LEFT JOIN 
 (       
 select a.TRADE_INTERFACE,count(a.ID) min121 FROM BANK.TBL_BANK_NOCARD_ORDER  a where timestampdiff(4, char( 
timestamp(a.CONFIRM_TIME)- 
timestamp(a.CREATE_TIME)))>=120 and     a.CREATE_TIME>=${START}
        AND a.CREATE_TIME<${STOP} GROUP BY a.TRADE_INTERFACE )t121m 
        ON tt.TRADE_INTERFACE=t121m.TRADE_INTERFACE  

        ORDER by tt.total desc with ur
",cashier_bank
TdBankOrderCnt,TdBankOrderCnt,"SELECT A.*,B.BANK_CHANNEL_NAME FROM (select min(ID) as ID,DATE(CONFIRM_TIME) AS CREATE_DATE,TRADE_INTERFACE,BANKID,COUNT(*) as SUCC_CNT 
from BANK.TBL_BANK_NOCARD_ORDER  
where TRADE_INTERFACE in (select BANK_CHANNEL_CODE from BANK.TBL_BANK_BASIC_CHANNEL where BUSINESS_TYPE='ä»£æ_') and CONFIRM_TIME>=${START} AND CONFIRM_TIME<${STOP} AND REQUEST_TYPE='PAY'
AND  DEAL_STATUS='SUCCESS' 
group by  DATE(CONFIRM_TIME),TRADE_INTERFACE,BANKID) AS A
Left join BANK.TBL_BANK_BASIC_CHANNEL  as B 
ON A.TRADE_INTERFACE=B.BANK_CHANNEL_CODE 
with ur
",cashier_bank
TdProcessingOrder,TdProcessingOrder_E,"SELECT A.*,ROUND(CAST(A.PROCESSING_CNT AS DOUBLE)/TOTAL_CNT,5) AS RATE FROM  (SELECT  max(b.ID) as ID,DATE(a.create_time) AS CREATE_TIME,b.BANK_CHANNEL_NAME,COUNT(a.ID) AS TOTAL_CNT,sum(CASE WHEN a.deal_status='PROCESSING' THEN 1 ELSE 0 END) AS PROCESSING_CNT
FROM BANK.tbl_bank_nocard_order a
LEFT JOIN BANK.TBL_BANK_BASIC_CHANNEL b
ON a.trade_interface=b.BANK_CHANNEL_CODE
WHERE a.create_time>=${START} AND a.create_time <${STOP}
GROUP BY DATE(a.create_time),b.BANK_CHANNEL_NAME) AS A
WITH UR",cashier_bank
TdStartsWithSix,TdStartsWithSix_E,"select a.*,b.total_cnt from 
(select  min(PAYMENT_NO) as ID,date(CREATE_TIME) as CREATE_TIME,MERCHANT_NO,TRADE_ERROR,TRADE_MSG,count(*) as error_cnt
from NCC.TBL_NC_PAY_ORDER
where
MERCHANT_NO in ('10014187781','10012409374','10011341379','10012436510','10012434097','10014804708','10014804668','10014144432','10014700926','10012470020','10013779221','10015533876','10012437267','10014219026','10013890418','10013843389','10014271777','10012429199','10012432863','10014217827','10012431583','10012468709','10013588088','10013842859','10013802055','10015005792','10013375078','10012408885','10015208013','10012428694')
and  CREATE_TIME between ${START} and ${STOP} and TRADE_ERROR like '6%'
and length(TRADE_ERROR)=6
GROUP BY date(CREATE_TIME),MERCHANT_NO,TRADE_ERROR,TRADE_MSG) as a
left join
(select count(*) as total_cnt,MERCHANT_NO from NCC.TBL_NC_PAY_ORDER
where
MERCHANT_NO in ('10014187781','10012409374','10011341379','10012436510','10012434097','10014804708','10014804668','10014144432','10014700926','10012470020','10013779221','10015533876','10012437267','10014219026','10013890418','10013843389','10014271777','10012429199','10012432863','10014217827','10012431583','10012468709','10013588088','10013842859','10013802055','10015005792','10013375078','10012408885','10015208013','10012428694')
and  CREATE_TIME between  ${START} and  ${STOP}
group by MERCHANT_NO) as b
on a.MERCHANT_NO=b.MERCHANT_NO
with ur",INNO_STANBY
TdNocardTrend14,TdNocardTrend14_E,"select MIN(TBL_CHANNEL_QUALITY.ID) AS ID,date(LAST_MODIFY_TIME) as LAST_MODIFY_TIME,sum(CASE WHEN CHANNEL_TYPE = 'DEDUCT' THEN ORDER_SUCCESS_NUM ELSE 0 END) as DEDUCT_SUCC_CNT,sum(CASE WHEN CHANNEL_TYPE = 'FASTPAY' THEN ORDER_SUCCESS_NUM ELSE 0 END) as FASTPAY_SUCC_CNT,sum(CASE WHEN CHANNEL_TYPE = 'DEDUCT' THEN ORDER_CANCEL_NUM ELSE 0 END) DEDUCT_LOST_CNT,sum(CASE WHEN CHANNEL_TYPE = 'FASTPAY' THEN ORDER_CANCEL_NUM ELSE 0 END) FASTPAY_LOST_CNT 
from ROUTER.TBL_CHANNEL_QUALITY
LEFT JOIN ROUTER.TBL_BANK_CHANNEL 
ON TBL_CHANNEL_QUALITY.CHANNEL_CODE = TBL_BANK_CHANNEL.CODE 
where TBL_CHANNEL_QUALITY.LAST_MODIFY_TIME >=${START} and LAST_MODIFY_TIME <${STOP}
GROUP BY date(LAST_MODIFY_TIME) 
ORDER by LAST_MODIFY_TIME desc
with ur",cashier_bank_standby
TdErrorSuccRate,TdErrorSuccRate_E,"select A.ID,A.CREATE_TIME,A.YEEPAY_MERCHANT_NO,A.BANKID,A.TRADE_INTERFACE,A.TOTAL_CNT,A.SUCC_CNT,B.merrcnt from 
(select max(ID) AS ID,DATE(CREATE_TIME) AS CREATE_TIME,YEEPAY_MERCHANT_NO,bankid,trade_interface,COUNT(ID)  AS TOTAL_CNT,SUM(CASE DEAL_STATUS WHEN 'SUCCESS' THEN 1 ELSE 0 END) AS SUCC_CNT
from BANK.TBL_BANK_NOCARD_ORDER 
where request_type='PAY' AND CREATE_TIME >=${START} AND CREATE_TIME<${STOP}  AND BANKID is not null
group by DATE(CREATE_TIME),YEEPAY_MERCHANT_NO,bankid,trade_interface) as A
left join 
(select YEEPAY_MERCHANT_NO,TRADE_INTERFACE,BANKID,count(*) as merrcnt from BANK.TBL_BANK_NOCARD_ORDER as t
where  t.CREATE_TIME >=${START} and t.CREATE_TIME <${STOP} and REQUEST_TYPE ='PAY' AND 
exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('705022','707008','708022','708021','709003','709001','707007','706009','707020','706019','701026','701025','700009','705017','705014','705050','705021',
'705015','705013','705046','705045','705044','705043','705042','705041','705040','705039','705038','705037','705036','705035','705034','705033','705032',
'705031','705030','705026','705024','705009','705003','705002','704016','704015','704014','704013','704012','704011','704010','704009','704008','704007',
'704006','704005','704003','704002','704001','701014','701008','701007')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by YEEPAY_MERCHANT_NO,TRADE_INTERFACE,BANKID) AS B
on  A.YEEPAY_MERCHANT_NO=B.YEEPAY_MERCHANT_NO and A.TRADE_INTERFACE=B.TRADE_INTERFACE and A.BANKID=B.BANKID
with ur",cashier_bank
TdErrorMsg,TdErrorMsg_E,"select max(ID) AS ID,DATE(CREATE_TIME) AS CREATE_TIME,YEEPAY_MERCHANT_NO,TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG,count(*) as merrcnt from BANK.TBL_BANK_NOCARD_ORDER as t
where  t.CREATE_TIME >=${START} and t.CREATE_TIME <${STOP} and REQUEST_TYPE ='PAY' and deal_status='FAILED' AND BANKID is not null AND not
exists  (select 1 from 
(select bank_code,GROUP_ID  from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR where biz_code in ('705022','707008','708022','708021','709003','709001','707007','706009','707020','706019','701026','701025','700009','705017','705014','705050','705021',
'705015','705013','705046','705045','705044','705043','705042','705041','705040','705039','705038','705037','705036','705035','705034','705033','705032',
'705031','705030','705026','705024','705009','705003','705002','704016','704015','704014','704013','704012','704011','704010','704009','704008','704007',
'704006','704005','704003','704002','704001','701014','701008','701007')) as t1 
where t1.bank_code=t.BANK_RETURN_CODE and t1.group_id=t.TRADE_INTERFACE)
group by DATE(CREATE_TIME),YEEPAY_MERCHANT_NO,TRADE_INTERFACE,BANKID,BANK_RETURN_CODE,BANK_RETURN_MSG
with ur",cashier_bank
customeryange,cuyange1,"select 'baiweioutkill20161125' as baiweioutkill20161125,c.id as id,c.active,c.customerNumber,c.fullname,c.groupId,c.shortname,c.createDate,bc.name as businessCat,subBusinessCat,c.area,pf1.value as linkman,pf2.value as webUrl,pf.value as signedName,a.balance as accountBalance,ca.balance as creditBalance,ca.creditLimit,c.bindMobile as mobile,c.phone,date(si.lastsettledate) as lastsettledate, pf3.value as netSigned, c.productGroup,pf4.value as address,bc.id as bussinessCatId,pf5.value as province,pf8.value as city,si.cycleType as cycletype,si.reserveDays,coalesce(cg.grade,'') as gradelevel, 'NETSIGNED' as customertype,c.customerNumber as MERCHANTNO,a.balancelastupdatedate,cd.DOCUMENTNUMBER as legal_idcard,cd.DESCRIPTION as legal_name,pf6.value as audit_Status,a.status as account_status,r.BANKACTID as settle_bankaccount,r.province as settle_bankprovince,r.city as settle_bankcity,r.branchName as settle_bankbranch,ba.fullname as settle_bankname,r.accountName as settle_accountname,pf7.value as icp,c.customertype as signed_type   from Customer c left join profile pf on c.ID=pf.customer_id and pf.name='p_signedName'  left join profile pf1 on c.id=pf1.customer_id and pf1.name='p_linkman'  left join profile pf2 on c.id=pf2.customer_id and pf2.name='p_customerSiteUrl'  left join profile pf3 on c.id=pf3.customer_id and pf3.name='p_signed'  left join profile pf4 on c.id=pf4.customer_id and pf4.name='p_address'  left join profile pf5 on c.id=pf5.customer_id and pf5.name='p_province'  left join profile pf6 on c.id=pf6.customer_id and pf6.name='p_auditStatus' left join profile pf7 on c.ID=pf7.CUSTOMER_ID and pf7.NAME='p_icp' left join profile pf8 on c.id=pf8.customer_id and pf8.name='p_city'  left join account a on (c.id=a.customer_id and a.classtype='LocalAccount' and a.localAccountType='SVA')  left join CreditAccount ca on (c.id=ca.customerId)  left join settlementinfo si on c.id=si.customer_id left join account r on si.bankAccount_id=r.id and r.classtype='RemoteAccount' left join bank ba on r.bank_id=ba.id left join BusinessCategorie  bc on bc.id=c.businessCat  left join customergradeinfo cg on c.id=cg.customerid and cg.status in ('WAITRESCORE','COMPLETE','NOQUESSCORE') left join customerdocinfo  cd on  (c.CUSTOMERNUMBER=cd.CUSTOMERNUMBER and  cd.DOCUMENTNAME='æ³_ººèº»½è¯')  where c.customerType='ENTERPRISE' and c.customerNumber is not null with ur",COPY2
customeryange,cuyangevmark,"select CUSTOMERNUMBER CUSTOMERNUMBER, coalesce(CUSTOMERLEVEL,'V') as VMARK from CUSTOMERGRADELEVEL where CUSTOMERNUMBER is not null with ur",COPY2
customeryange,yangeaccmark,"select customerExt.CUSTOMERNUMBER as CUSTOMERNUMBER,customerExt.PERFORMANCE_ATTRIBUTE as ACCMARK from SIGNING.TBL_CUSTOMER_EXT customerExt,SIGNING.TBL_PERFORMANCE_ATTRIBUTE attribute  where customerExt.PERFORMANCE_ATTRIBUTE=attribute.ATTRIBUTE_CODE and customerExt.customernumber is not null and customerExt.PERFORMANCE_ATTRIBUTE != '5' with ur",BOSS
customeryange,yangesigndate,"select  customernumber as CUSTOMERNUMBER, min(STARTDATE) as SIGNED_DATE
from mobilebe.CONTRACTMANAGER 
group by customernumber
with ur",COPY2
customeryange,yangesalesname,"select  e.cust_id as ID,em.name as SALESNAME,em.id as SALESID 
from db2inst1.employee2customer e 
left join db2inst1.employeeinfo em on e.emp_id=em.id 
with ur",reportdb
customeryange,yangevipmark,"select  CUSTOMER_NUMBER as CUSTOMERNUMBER , case when CUSTOMER_LABEL_VALUE='SVIP' then 2 else 1 end as vipmark 
from SIGNING.TBL_CUSTOMER_LABEL_ATTRIBUTE 
where CUSTOMER_LABEL='customer_vip_level' and status=1 
with ur",BOSS
customeryange,yangehangyeyeji,"select NUMBER as CUSTOMERNUMBER,TAG as PRODUCTLINE from CUSCENTER.TBL_TAG",dzh_standby
customeryange,yangepostpaidzhangqi,"SELECT 
CUSTOMER_NUMBER as CUSTOMERNUMBER,
integer(PAYMENT_PERIOD) as PRODUCTLINEID
FROM FEE.TBL_FRONT_FEE_CUSTOMER WHERE PAYMENT_PERIOD IS NOT NULL with ur",feedb
dlbtestwwx,dlbtest,"SELECT 
	ID               AS Card_id,
	OWNER						 AS Self_acc_name,
	IDCARD_TYPE			 AS Id_type,
	IDCARD           AS Id_no,
	BANK_NAME				 AS Bank_name
FROM
	MEMBER.TBL_CWH_BANK_CARD_INFO
WHERE
        CREATE_TIME >'2018-02-01'",member_standby
companytrade,companytradee,"select 
sum(trxamount)/100000000 AS TRXAMOUNT,
sum(trxprofit)/10000 AS TRXPROFIT,
sum(newprofit)/10000 AS NEW_PROFIT,
sum(trxprofit)*1.0000/sum(income) AS GROSS_PROFIT_RATE,
sum(income)*1.00000/sum(trxamount) AS RATE,
sum(newprofit)*1.0000/sum(newincome) AS NEW_GROSS_PROFIT_RATE,
sum(newincome)*1.00000/sum(trxamount) AS NEW_RATE,
DATE(${START}) -6 DAY AS START_DATE,
DATE(${START}) AS END_DATE,
CURRENT TIMESTAMP AS CREATE_TIME
from (
select
  sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) as trxprofit,
  sum(CASE WHEN (P.BIZTYPEID IN (29,129) and P.TRXTYPEID not in ('POSRENT','POSSALES')) THEN P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1) ELSE P.INNERINCOME*coalesce(P.YEJISCALE,1) END) as income,
sum(CASE WHEN P.BIZTYPEID IN (29) then coalesce(P.NEWINCOME,0)*coalesce(P.YEJISCALE,1)-coalesce(P.NEWCOST,0)*coalesce(P.YEJISCALE,1) else coalesce(P.NEWINCOME,0)*coalesce(P.YEJISCALE,1) end) AS newincome,
sum(coalesce(P.NEWINCOME,0)*coalesce(P.YEJISCALE,1)-coalesce(P.NEWCOST,0)*coalesce(P.YEJISCALE,1)) as newprofit,
sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1)) as trxamount
  from DB2INST1.PUBLISHEDDAILYTRX AS P
  left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
  left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
  left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
  left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
  left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
  left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
  left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID 
  where 1=1
  AND P.TRXDATE between DATE(${START}) -6 DAY and DATE(${START})
  AND (PP.ACCOUNTCLASS is null OR PP.ACCOUNTCLASS != '___è¡__')
and (C.CUSTOMERNUMBER != '10000460331' or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
        )",reportdb_read
companyoperateproductline,companyoperateproductlinee,"SELECT
    DATE(${START}) -6 DAY AS START_DATE,
    DATE(${START})        AS END_DATE,
    PRODUCTLINE,
    TRXAMOUNT,
    TRXPROFIT,
MANAGER_PROFIT,
    CURRENT TIMESTAMP AS CREATE_TIME
FROM
    (
        SELECT
            PRODUCTLINE,
            SUM(trxamount)/100000000 AS TRXAMOUNT,
sum(MANAGER_PROFIT)/10000 AS MANAGER_PROFIT,
            SUM(trxprofit)/10000     AS TRXPROFIT
        FROM
            (
                SELECT
                   P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1) AS trxprofit,
                    P.TRXAMOUNT*COALESCE(P.YEJISCALE,1)        AS trxamount,
P.NEWINCOME*coalesce(P.YEJISCALE,1)+P.MANAGEFEEPREDICT*coalesce(P.YEJISCALE,1)-(P.NEWCOST*coalesce(P.YEJISCALE,1)+P.EXTERNALCOSTPREDICT*coalesce(P.YEJISCALE,1))  AS MANAGER_PROFIT,
                    CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END AS PRODUCTLINE
                FROM
                    DB2INST1.PUBLISHEDDAILYTRX AS P
                LEFT JOIN
                    DB2INST1.TRXSTATBUSINESSCATEGORIE AS B
                ON
                    1=1
                AND P.BUSINESSCATID=B.ID
                LEFT JOIN
                    DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S
                ON
                    1=1
                AND P.SUBBUSINESSCAT=S.CODE
                LEFT JOIN
                    DB2INST1.CUSTOMERINFO AS C
                ON
                    1=1
                AND P.RECEIVERID=C.ID
                LEFT JOIN
                    DB2INST1.PRODUCTCODE_PROFILE AS PP
                ON
                    1=1
                AND P.PRODUCT_CODE=PP.PRODUCT_CODE
                AND P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS PC
                ON
                    1=1
                AND P.PRODUCT_CODE=PC.PRODUCTCODE
                AND PC.PRODUCTTYPE=2
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS SPC
                ON
                    1=1
                AND P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE
                AND SPC.PRODUCTTYPE=1
                LEFT JOIN
                    DB2INST1.EXISTENCE AS E
                ON
                    1=1
                AND P.YEJISHUXING=E.ID
                AND E.CLASSTYPE='Department'
                LEFT JOIN
                    DB2INST1.TRXSTATTRXTYPE AS T
                ON
                    1=1
                AND P.TRXTYPEID=T.ID
                WHERE
                    1=1
and (C.CUSTOMERNUMBER != '10000460331' or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
                AND P.TRXDATE BETWEEN DATE(${START}) -6 DAY AND DATE(${START})
                AND (PP.ACCOUNTCLASS IS NULL OR  PP.ACCOUNTCLASS != '___è¡__') )
        GROUP BY
            PRODUCTLINE )",reportdb_yjkh
companybusinessprofittop,companybusinessprofittope,"SELECT 
DATE(${START}) -6 DAY AS START_DATE,
DATE(${START}) AS END_DATE,
SIGNEDNAME,
PRODUCTLINE,
TRXPROFIT,
MANAGER_PROFIT,
PROFIT_RAKING,
BEFORE_RAKING,
CHANGE_RAKING,
CURRENT TIMESTAMP AS CREATE_TIME,
EMPLOYEE_NAME
FROM (
SELECT
    base.PROFIT_RAKING,
    base.PRODUCTLINE AS PRODUCTLINE,
    base.SIGNEDNAME  AS SIGNEDNAME,
    base.TRXPROFIT   AS TRXPROFIT,
base. MANAGER_PROFIT,
    base.EMPLOYEE_NAME,
    CASE
        WHEN br.PROFIT_RAKING IS NULL OR br.PROFIT_RAKING>10
        THEN '_'
        ELSE CHAR(br.PROFIT_RAKING)
    END AS BEFORE_RAKING,
    CASE
        WHEN base.PROFIT_RAKING > br.PROFIT_RAKING
        THEN 'ä¸__'
        WHEN base.PROFIT_RAKING = br.PROFIT_RAKING
        THEN '__¹³'
        ELSE 'ä¸__'
    END AS CHANGE_RAKING
FROM
    (
        SELECT
            ROWNUMBER() OVER(ORDER BY sum(profit) DESC) AS PROFIT_RAKING,
            SUM(profit)/10000                            AS TRXPROFIT,
sum(MANAGER_PROFIT)/10000 AS MANAGER_PROFIT,
            SIGNEDNAME                              AS SIGNEDNAME,
            LISTAGG(EMPLOYEE_NAME)  AS EMPLOYEE_NAME,
PRODUCTLINE 
        FROM
            (
                select
  sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) as profit,
sum(P.NEWINCOME*coalesce(P.YEJISCALE,1)+P.MANAGEFEEPREDICT*coalesce(P.YEJISCALE,1)-(P.NEWCOST*coalesce(P.YEJISCALE,1)+P.EXTERNALCOSTPREDICT*coalesce(P.YEJISCALE,1)))  AS MANAGER_PROFIT,
  C.SIGNEDNAME,
  P.SALESNAME AS EMPLOYEE_NAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END AS PRODUCTLINE
  from DB2INST1.PUBLISHEDDAILYTRX AS P
  left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
  left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
  left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
  left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
  left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
  left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
  left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID 
  where 1=1
  AND P.TRXDATE between DATE(${START}) -6 DAY and DATE(${START})
  AND (PP.ACCOUNTCLASS is null OR PP.ACCOUNTCLASS != '___è¡__')
and (C.CUSTOMERNUMBER not in ('10000460331') or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
GROUP BY 
  C.SIGNEDNAME,
  P.SALESNAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END
            )
            GROUP BY SIGNEDNAME,PRODUCTLINE

 ) base
LEFT JOIN
    TBL_WEEK_BUSINESS_PROFIT_INFO br
ON
    br.SIGNEDNAME = base.SIGNEDNAME
AND br.START_DATE=DATE(${START}) -13 DAY)
ORDER BY
   TRXPROFIT DESC
FETCH
    FIRST 30 rows only",reportdb_yjkh
companybusinessprofitadd,companybusinessprofitadde,"SELECT
 current date - 10 day AS START_DATE,
 current date - 4 day AS END_DATE,
 current date - 17 day AS LAST_START_DATE,
 current date - 11 day AS LAST_END_DATE,
CURRENT TIMESTAMP AS CREATE_TIME,
    t1.PRODUCTLINE  AS PRODUCTLINE,
    t1.SIGNEDNAME   AS SIGNEDNAME,
    t2.profit/10000 AS TRXPROFIT_BEFORE,
    t1.profit/10000 AS TRXPROFIT,
    (t1.profit-
    CASE t2.profit
        WHEN NULL
        THEN 0
        ELSE t2.profit
    END)/10000 AS PROFIT_CHANGE,
    1          AS ADD_FLAG
FROM
    (
        SELECT
            SUM(
                CASE
                    WHEN RECEIVER.SIGNEDNAME ='___å¤©ä_ï¼__äº_ä¿¡æ________'
                    AND P.PRODUCTNAME IN('ä¸__ä»',
                                         'ä¸ººç½____ï¼_2Cï¼')
                    THEN DA.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.REFUNDFEE
                        *COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.ACCOUNTINGCOST*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)+ DA.REFUNDFRPCOST*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- 0.001*(DA.TRXAMOUNT*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.REFUNDAMOUNT*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1))
                    ELSE DA.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.REFUNDFEE
                        *COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.ACCOUNTINGCOST*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)+ DA.REFUNDFRPCOST*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)
                END )AS profit,
            RECEIVER.SIGNEDNAME,
            RECEIVER.PRODUCTLINE
        FROM
            DB2INST1.DAILYTRXSTAT AS DA
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS RECEIVER
        ON
            1=1
        AND DA.RECEIVERID=RECEIVER.ID
        LEFT JOIN
            DB2INST1.CUSTOMERRELATIONSHIP AS E2C
        ON
            1=1
        AND RECEIVER.ID=E2C.CUSTOMERID
        LEFT JOIN
            DB2INST1.customer2achievement AS c2a
        ON
            1=1
        AND RECEIVER.customernumber=c2a.customer_number
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS TRXS
        ON
            1=1
        AND DA.TYPE=TRXS.ID
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMP
        ON
            1=1
        AND E2C.EMPLOYEEID=EMP.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS BRA
        ON
            1=1
        AND EMP.BRANCHCOMPANY=BRA.AREAID
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P
        ON
            1=1
        AND DA.PRODUCT_CODE=P.PRODUCTCODE
        AND P.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.productcode_profile AS PP
        ON
            1=1
        AND DA.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        AND DA.PRODUCT_CODE=PP.PRODUCT_CODE
        WHERE
            DA.TRXDATE BETWEEN (current date - 10 day) AND (current date - 4 day)
        AND (
                CASE
                    WHEN PP.ACCOUNTCLASS IS NULL
                    THEN 'çº¿ä_'
                    ELSE PP.ACCOUNTCLASS
                END) NOT IN('___è¡__')
        AND trxs.NAME NOT IN('POS__¶¦___',
                             'POS__',
                             'POSç§__',
                             'ä»£ç_è´',
                             '__¶¦',
                             '_©ºçº¿è_ä½',
                             '_¥å__¶¦',
                             '_¥ç____æ¶',
                             '__·¥è°__')
        GROUP BY
            SIGNEDNAME,
            PRODUCTLINE) t1
LEFT JOIN
    (
        SELECT
            SUM(
                CASE
                    WHEN RECEIVER.SIGNEDNAME ='___å¤©ä_ï¼__äº_ä¿¡æ________'
                    AND P.PRODUCTNAME IN('ä¸__ä»',
                                         'ä¸ººç½____ï¼_2Cï¼')
                    THEN DA.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.REFUNDFEE
                        *COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.ACCOUNTINGCOST*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)+ DA.REFUNDFRPCOST*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- 0.001*(DA.TRXAMOUNT*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.REFUNDAMOUNT*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1))
                    ELSE DA.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.REFUNDFEE
                        *COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)- DA.ACCOUNTINGCOST*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)+ DA.REFUNDFRPCOST*
                        COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)
                END )AS profit,
            RECEIVER.SIGNEDNAME,
            RECEIVER.PRODUCTLINE
        FROM
            DB2INST1.DAILYTRXSTAT AS DA
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS RECEIVER
        ON
            1=1
        AND DA.RECEIVERID=RECEIVER.ID
        LEFT JOIN
            DB2INST1.CUSTOMERRELATIONSHIP AS E2C
        ON
            1=1
        AND RECEIVER.ID=E2C.CUSTOMERID
        LEFT JOIN
            DB2INST1.customer2achievement AS c2a
        ON
            1=1
        AND RECEIVER.customernumber=c2a.customer_number
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS TRXS
        ON
            1=1
        AND DA.TYPE=TRXS.ID
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMP
        ON
            1=1
        AND E2C.EMPLOYEEID=EMP.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS BRA
        ON
            1=1
        AND EMP.BRANCHCOMPANY=BRA.AREAID
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P
        ON
            1=1
        AND DA.PRODUCT_CODE=P.PRODUCTCODE
        AND P.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.productcode_profile AS PP
        ON
            1=1
        AND DA.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        AND DA.PRODUCT_CODE=PP.PRODUCT_CODE
        WHERE
            DA.TRXDATE BETWEEN (current date - 17 day) AND (current date - 11 day)
        AND (
                PP.ACCOUNTCLASS IS NULL
            OR  PP.ACCOUNTCLASS != '___è¡__')
        AND trxs.NAME NOT IN('POS__¶¦___',
                             'POS__',
                             'POSç§__',
                             'ä»£ç_è´',
                             '__¶¦',
                             '_©ºçº¿è_ä½',
                             '_¥å__¶¦',
                             '_¥ç____æ¶',
                             '__·¥è°__')
        GROUP BY
            SIGNEDNAME,
            PRODUCTLINE) t2
ON
    t1.SIGNEDNAME=t2.SIGNEDNAME
AND t1.PRODUCTLINE=t2.PRODUCTLINE
WHERE
    t2.SIGNEDNAME IS NOT NULL
AND t2.PRODUCTLINE IS NOT NULL
ORDER BY
    (t1.profit-
    CASE t2.profit
        WHEN NULL
        THEN 0
        ELSE t2.profit
    END)  desc
FETCH
    FIRST 30 rows only",reportdb_yjkh
companybusinessprofitreduce,companybusinessprofitreducee,"select 
START_DATE,END_DATE,LAST_START_DATE,LAST_END_DATE,SIGNEDNAME,PRODUCTLINE,TRXPROFIT,TRXPROFIT_BEFORE,PROFIT_CHANGE,TRXPROFIT_BEFORE,MANAGER_TRXPROFIT,MANAGER_PROFIT_CHANGE,MANAGER_TRXPROFIT_BEFORE,ADD_FLAG,EMPLOYEE_NAME,CREATE_TIME
from(
SELECT
 DATE(${START}) - 6 day AS START_DATE,
 DATE(${START})  AS END_DATE,
 DATE(${START}) - 13 day AS LAST_START_DATE,
 DATE(${START}) -  7 day AS LAST_END_DATE,
CURRENT TIMESTAMP AS CREATE_TIME,
    t3.PRODUCTLINE  AS PRODUCTLINE,
    t3.SIGNEDNAME   AS SIGNEDNAME,
    t2.profit/10000 AS TRXPROFIT_BEFORE,
    t2.MANAGER_PROFIT/10000 AS MANAGER_TRXPROFIT_BEFORE,
    t3.profit/10000 AS TRXPROFIT,
    t3.MANAGER_PROFIT/10000 AS MANAGER_TRXPROFIT,
    (t3.profit-
    CASE t2.profit
        WHEN NULL
        THEN 0
        ELSE t2.profit
    END)/10000 AS PROFIT_CHANGE,
    (t3.MANAGER_PROFIT-
    CASE t2.MANAGER_PROFIT
        WHEN NULL
        THEN 0
        ELSE t2.MANAGER_PROFIT
    END)/10000 AS MANAGER_PROFIT_CHANGE,
EMPLOYEE_NAME AS EMPLOYEE_NAME,
    0          AS ADD_FLAG
FROM
    (
    select 
    LISTAGG(EMPLOYEE_NAME) AS EMPLOYEE_NAME,
    sum(profit) AS PROFIT,
sum(MANAGER_PROFIT) as MANAGER_PROFIT,
    SIGNEDNAME,
    PRODUCTLINE
    from (
         select
  sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) as profit,
sum(P.NEWINCOME*coalesce(P.YEJISCALE,1)+P.MANAGEFEEPREDICT*coalesce(P.YEJISCALE,1)-(P.NEWCOST*coalesce(P.YEJISCALE,1)+P.EXTERNALCOSTPREDICT*coalesce(P.YEJISCALE,1)))   AS MANAGER_PROFIT,
  C.SIGNEDNAME,
  P.SALESNAME AS EMPLOYEE_NAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END AS PRODUCTLINE
  from DB2INST1.PUBLISHEDDAILYTRX AS P
  left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
  left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
  left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
  left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
  left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
  left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
  left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID 
  where 1=1
  AND P.TRXDATE between DATE(${START}) -6 DAY and DATE(${START})
  AND (PP.ACCOUNTCLASS is null OR PP.ACCOUNTCLASS != '___è¡__')
and (C.CUSTOMERNUMBER not in ('10000460331') or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
GROUP BY 
  C.SIGNEDNAME,
  P.SALESNAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END) t1
            group by
   				 SIGNEDNAME,
   				 PRODUCTLINE
            ) t3
LEFT JOIN
    (
         select
  sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) as profit,
sum(P.NEWINCOME*coalesce(P.YEJISCALE,1)+P.MANAGEFEEPREDICT*coalesce(P.YEJISCALE,1)-(P.NEWCOST*coalesce(P.YEJISCALE,1)+P.EXTERNALCOSTPREDICT*coalesce(P.YEJISCALE,1)))  AS MANAGER_PROFIT,
  C.SIGNEDNAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END AS PRODUCTLINE
  from DB2INST1.PUBLISHEDDAILYTRX AS P
  left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
  left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
  left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
  left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
  left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
  left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
  left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID 
  where 1=1
  AND P.TRXDATE between DATE(${START}) -13 DAY and DATE(${START})-7 DAY
  AND (PP.ACCOUNTCLASS is null OR PP.ACCOUNTCLASS != '___è¡__')
and (C.CUSTOMERNUMBER not in ('10000460331') or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
GROUP BY 
  C.SIGNEDNAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END) t2
ON
    t3.SIGNEDNAME=t2.SIGNEDNAME
AND t3.PRODUCTLINE=t2.PRODUCTLINE
WHERE
    t2.SIGNEDNAME IS NOT NULL
AND t2.PRODUCTLINE IS NOT NULL
ORDER BY
    (t3.profit-
    CASE t2.profit
        WHEN NULL
        THEN 0
        ELSE t2.profit
    END) 
    )
FETCH
    FIRST 30 rows only",reportdb_yjkh
operationnineweektrent,operationnineweektrentbs,"      select 
      sum(TRX_AMOUNT) as TRX_AMOUNT,
      sum(GROSS_PROFIT) as GROSS_PROFIT
      from (
      select
      sum(TRX_AMOUNT) as TRX_AMOUNT,
      sum(GROSS_PROFIT) as GROSS_PROFIT
      from (
       select  
       sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1)) AS TRX_AMOUNT,
       case when SPC.PRODUCTNAME in ('_¶æå®','_¥å____','_________') then sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1))*0.6 
       else sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) end AS GROSS_PROFIT
       FROM DB2INST1.PUBLISHEDDAILYTRX AS P
       left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
       left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
       left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
       left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
       left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
       left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
       left join DB2INST1.EXISTENCE AS ex on 1=1 and P.YEJISHUXING=ex.ID and ex.CLASSTYPE='Department' 
       left join DB2INST1.TRXSTATTRXTYPE AS TRXS on 1=1 and P.TRXTYPEID=TRXS.ID  
       where 
        P.TRXDATE between current date -7 day and current date -1 day
        and C.SIGNEDNAME != '__º¬_£è_¶å_ç§_______'
        and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) not in('___è¡__')
        and ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
        and (C.PRODUCTLINE not in ('ä¸_å¾ä¸_º¿','ä¸_å¾__','çº¿ä_V-') or C.PRODUCTLINE is null)
        and ((C.CUSTOMERNUMBER != '10000460331') or (TRXS.NAME != 'OPè°_´¦'))
      group by SPC.PRODUCTNAME

        union all

       select  
       sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1)) AS TRX_AMOUNT,
       sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1))*0.0052 - sum(ACCOUNTINGCOST) AS GROSS_PROFIT
       FROM DB2INST1.PUBLISHEDDAILYTRX AS P
       left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
       left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
       left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
       left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
       left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
       left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
       left join DB2INST1.EXISTENCE AS ex on 1=1 and P.YEJISHUXING=ex.ID and ex.CLASSTYPE='Department' 
       left join DB2INST1.TRXSTATTRXTYPE AS TRXS on 1=1 and P.TRXTYPEID=TRXS.ID   
       where 
        P.TRXDATE between current date -7 day and current date -1 day
        and C.SIGNEDNAME = '__º¬_£è_¶å_ç§_______'
        and ((C.CUSTOMERNUMBER != '10000460331') or (TRXS.NAME != 'OPè°_´¦'))
        and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) not in('___è¡__')
        and ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
        and (C.PRODUCTLINE not in ('ä¸_å¾ä¸_º¿','ä¸_å¾__','çº¿ä_V-') or C.PRODUCTLINE is null)
        )
      )",reportdb_yjkh
bigareagrossprofitrank,bigareagrossprofitranke,"select  row_number() over (order by r.PERCENT desc) AS RANK,
        row_number() over (order by r.MANAGE_PERCENT desc) AS MANAGER_RANK,
        r.AREA_KEY,
        r.AREA,
        r.GROSS_PROFIT,
        r.MANAGE_PROFIT,
        r.BUDGET,
        r.PERCENT,
        r.MANAGE_PERCENT
        from(
        select 
        t1.daqu || CURRENT DATE AS AREA_KEY,
        t1.daqu AS AREA,
        max(t1.trxprofit) AS GROSS_PROFIT,
        max(t1.manage_trxprofit) AS MANAGE_PROFIT,
        sum(budget.BUDGET_AMOUNT) AS BUDGET,
        COALESCE(max(t1.trxprofit)/sum(budget.BUDGET_AMOUNT),0)*100  AS PERCENT,
        COALESCE(max(t1.manage_trxprofit)/sum(budget.BUDGET_AMOUNT),0)*100  AS MANAGE_PERCENT
        from (
        select t.DAQU as daqu,
        sum(t.trxprofit) as trxprofit,
        sum(t.MANAGER_PROFIT) as manage_trxprofit
        from(
       select  
       ex.NAME as yejishuxing,
       case when ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______') then '_¼å_' when ex.NAME in ('å±±ä_____','æµ______','æ±______') then '___' when ex.NAME in ('ç¦_»º____','å¹¿ä_____') then 'é¾__' else ex.NAME end as DAQU,
       case when C.SIGNEDNAME = '__º¬_£è_¶å_ç§_______' then sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1))*0.0052 - sum(ACCOUNTINGCOST) 
       when SPC.PRODUCTNAME in ('_¶æå®','_¥å____','_________') then sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1))*0.6 
       else sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) end AS trxprofit,
       sum(P.NEWINCOME*coalesce(P.YEJISCALE,1)+P.MANAGEFEEPREDICT*coalesce(P.YEJISCALE,1)-(P.NEWCOST*coalesce(P.YEJISCALE,1)+P.EXTERNALCOSTPREDICT*coalesce(P.YEJISCALE,1)))   AS MANAGER_PROFIT
       FROM DB2INST1.PUBLISHEDDAILYTRX AS P
       left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
       left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
       left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
       left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
       left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
       left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
       left join DB2INST1.EXISTENCE AS ex on 1=1 and P.YEJISHUXING=ex.ID and ex.CLASSTYPE='Department' 
       left join DB2INST1.TRXSTATTRXTYPE AS TRXS on 1=1 and P.TRXTYPEID=TRXS.ID
       where 
        P.TRXDATE between current date -7 day and current date -1 day
        and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) not in('___è¡__')
        and ((C.CUSTOMERNUMBER != '10000460331') or (TRXS.NAME != 'OPè°_´¦'))
        and ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
        and (C.PRODUCTLINE not in ('ä¸_å¾ä¸_º¿','ä¸_å¾__','çº¿ä_V-') or C.PRODUCTLINE is null)
        group by ex.NAME,C.SIGNEDNAME,SPC.PRODUCTNAME
        ) t
        group by t.DAQU
        )t1
        left join yjkh.tbl_budget_info budget on 1=1 and t1.daqu = budget.AREA
        where 
        budget.YEAR='2018'
        group by t1.daqu
        ) r
",reportdb_yjkh
companylastweekgcrossprofitoverrank,companylastweekgcrossprofitoverranke,"select row_number() over (order by r.PERCENT desc) AS RANK,
        r.AREA,
        r.BRANCH,
        r.GROSS_PROFIT,
        r.BUDGET,
        r.PERCENT,
        r.BRANCH_KEY 
from(
  select t1.daqu AS AREA,
        t1.yejishuxing AS BRANCH,
        t1.trxprofit AS GROSS_PROFIT,
        t1.BUDGET_AMOUNT AS BUDGET,
        COALESCE(trxprofit/BUDGET_AMOUNT,0)*100 AS PERCENT,
        t1.yejishuxing||CURRENT DATE AS BRANCH_KEY 
        from (
     select t.DAQU as daqu, 
         t.yejishuxing as yejishuxing, 
         sum(t.trxprofit) as trxprofit,
         max (budget.BUDGET_AMOUNT) as BUDGET_AMOUNT
    from(
        select  
        case 
        when ex.name in ('ä¸_µ·____','_______','æ±______','å±±ä_____','æµ______','ç¦_»º____','å¹¿ä_____') then ex.name 
        when ex.name in ('__¥¿____','å¤©æ´¥____','__º¬äº____') then '__º¬äº____' 
        when (ex.name='__º¬____' and P.SALESNAME in ('èµµæ_','å¼__-3','__','_¨ç__','å­_»¤é¡','å½_','é©_','èµµé_','_·ç_å¥','_°æ_','___','___-2','_¨æ__')) then '__º¬äº____' 
        else '__º¬ä¸____' end as yejishuxing,
        case when ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______') then '_¼å_' when ex.NAME in ('å±±ä_____','æµ______','æ±______') then '___' when ex.NAME in ('ç¦_»º____','å¹¿ä_____') then 'é¾__' else ex.NAME end as DAQU,

        case when C.SIGNEDNAME = '__º¬_£è_¶å_ç§_______' then sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1))*0.0052 - sum(ACCOUNTINGCOST) 
        when SPC.PRODUCTNAME in ('_¶æå®','_¥å____','_________') then sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1))*0.6 
        else sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) end AS trxprofit
       FROM DB2INST1.PUBLISHEDDAILYTRX AS P
       left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
       left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
       left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
       left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
       left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
       left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
       left join DB2INST1.EXISTENCE AS ex on 1=1 and P.YEJISHUXING=ex.ID and ex.CLASSTYPE='Department' 
       left join DB2INST1.TRXSTATTRXTYPE AS TRXS on 1=1 and P.TRXTYPEID=TRXS.ID  
       where 
        P.TRXDATE between current date -7 day and current date -1 day
        and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) not in('___è¡__')
        and ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
        and (C.PRODUCTLINE not in ('ä¸_å¾ä¸_º¿','ä¸_å¾__','çº¿ä_V-') or C.PRODUCTLINE is null)
        group by ex.NAME,P.SALESNAME,C.SIGNEDNAME,SPC.PRODUCTNAME
      )t
        left join yjkh.tbl_budget_info budget on 1=1 and t.yejishuxing = budget.DEP_NAME
        where budget.YEAR='2018'
        group by t.yejishuxing,t.DAQU
        ) as t1      
) r",reportdb_yjkh
companysaleslastweekprofitrank,companysaleslastweekprofitranke,"        select  
        rt.RANK,
        rt.SALES_NAME,
        rt.AREA,
        rt.BRANCH,
        rt.GROSS_PROFIT,
        rt.SALES_KEY
FROM (
select row_number() over (order by r.GROSS_PROFIT desc) AS RANK,
       r.SALES_NAME,
       r.AREA,
       r.BRANCH,
       r.GROSS_PROFIT,
       r.SALES_KEY 
  from (
    select t.salesname AS SALES_NAME,
        dict.AREA AS AREA,
        dict.BRANCH AS BRANCH,
        t.trxprofit AS GROSS_PROFIT,
        t.salesname || current date as SALES_KEY
        from (
        select 
        salesname as salesname,
        sum(trxprofit) as trxprofit
        from(
        select  
        P.SALESNAME as salesname,
        case when SPC.PRODUCTNAME in ('_¶æå®','_¥å____','_________') then sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1))*0.6 
        else  sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) end  AS trxprofit
       FROM DB2INST1.PUBLISHEDDAILYTRX AS P
       left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
       left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
       left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
       left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
       left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
       left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
       left join DB2INST1.EXISTENCE AS ex on 1=1 and P.YEJISHUXING=ex.ID and ex.CLASSTYPE='Department' 
       left join DB2INST1.TRXSTATTRXTYPE AS TRXS on 1=1 and P.TRXTYPEID=TRXS.ID  
       where 
        P.TRXDATE between current date -7 day and current date -1 day
        and P.SALESNAME != '___'
        and P.SALESNAME not in ('å§__ä¼','___è¾','_°æ_','___','__','____','ç«¥è_æ±','___äº','é½__å®','å¥__','ç¥__','_¡è_é£','ä¸_¼º','_±æ__','___','é»__')
        and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) not in('___è¡__')
        and ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
        and (C.PRODUCTLINE not in ('ä¸_å¾ä¸_º¿','ä¸_å¾__','çº¿ä_V-') or C.PRODUCTLINE is null)
        and ((C.CUSTOMERNUMBER != '10000460331') or (TRXS.NAME != 'OPè°_´¦'))
        group by P.SALESNAME,SPC.PRODUCTNAME

        union all 

        select 
        salesname,
        sum(trxprofit) AS trxprofit
        from (
        select  
        P.SALESNAME as salesname,
        case when C.SIGNEDNAME = '__º¬_£è_¶å_ç§_______' then sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1))*0.0052 - sum(ACCOUNTINGCOST) 
        when SPC.PRODUCTNAME in ('_¶æå®','_¥å____','_________') then sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1))*0.6 
        else sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) end AS trxprofit
       FROM DB2INST1.PUBLISHEDDAILYTRX AS P
       left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
       left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
       left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
       left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
       left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
       left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
       left join DB2INST1.EXISTENCE AS ex on 1=1 and P.YEJISHUXING=ex.ID and ex.CLASSTYPE='Department' 
       left join DB2INST1.TRXSTATTRXTYPE AS TRXS on 1=1 and P.TRXTYPEID=TRXS.ID   
       where 
        P.TRXDATE between current date -7 day and current date -1 day
        and P.SALESNAME = '___'
        and P.SALESNAME not in ('å§__ä¼','___è¾','_°æ_','___','__','____','ç«¥è_æ±','___äº','é½__å®','å¥__','ç¥__','_¡è_é£','ä¸_¼º','_±æ__','___','é»__')
        and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) not in('___è¡__')
        and ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
        and (C.PRODUCTLINE not in ('ä¸_å¾ä¸_º¿','ä¸_å¾__','çº¿ä_V-') or C.PRODUCTLINE is null)
        and ((C.CUSTOMERNUMBER != '10000460331') or (TRXS.NAME != 'OPè°_´¦'))
        group by P.SALESNAME,C.SIGNEDNAME,SPC.PRODUCTNAME
        ) sub
        group by salesname
        )
        group by salesname
        ) t 
        left join YJKH.TBL_DICT_SALES_BRANCH dict on 1=1 and t.salesname=dict.sales_name
      ) r 
    ) rt where rt.RANK <=40
",reportdb_yjkh
lastweekgcrossprofittopten,lastweekgcrossprofittoptene,"        select rt.RANK,
       rt.SIGNED_NAME,
       rt.PRODUCTLINE,
       rt.SALES_NAME,
       rt.BRANCH,
       rt.SIGNED_SALES_NAME,
       rt.GROSS_PROFIT
from (

select row_number() over (order by r.GROSS_PROFIT desc) AS RANK,
       r.SIGNED_NAME,
       r.PRODUCTLINE,
       r.SALES_NAME,
       r.BRANCH,
       r.SIGNED_SALES_NAME,
       r.GROSS_PROFIT
from (
      select 
        t.SIGNEDNAME AS SIGNED_NAME,
        t.PRODUCTLINE AS PRODUCTLINE,
        t.name AS SALES_NAME,
        dict.BRANCH AS BRANCH,
        t.SIGNEDNAME || t.name || CURRENT DATE AS SIGNED_SALES_NAME,
        t.trxprofit AS GROSS_PROFIT
        from (
        select 
          sub.SIGNEDNAME,
          sub.PRODUCTLINE,
          sub.name,
          sum(sub.trxprofit) AS trxprofit
          from (
          select  
          C.SIGNEDNAME as SIGNEDNAME,
          CASE WHEN C.PRODUCTLINE IS NOT NULL THEN C.PRODUCTLINE 
          WHEN SPC.PRODUCTNAME IN ('_¶æå®', '_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸' 
          WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____' 
          WHEN SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') AND (PP.ACCOUNTCLASS IN ('ç§»å_', 'çº¿ä_') OR PP.ACCOUNTCLASS IS NULL) THEN '_£æ_ä¸__'
          WHEN SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') AND PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸' 
          ELSE null END AS PRODUCTLINE,
          max(P.SALESNAME) as name,
          case when C.SIGNEDNAME = '__º¬_£è_¶å_ç§_______' then sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1))*0.0052 - sum(ACCOUNTINGCOST) 
          when SPC.PRODUCTNAME in ('_¶æå®','_¥å____','_________') then sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1))*0.6 
          else sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) end AS trxprofit
          FROM DB2INST1.PUBLISHEDDAILYTRX AS P
          left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
          left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
          left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
          left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
          left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
          left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
          left join DB2INST1.EXISTENCE AS ex on 1=1 and P.YEJISHUXING=ex.ID and ex.CLASSTYPE='Department' 
          left join DB2INST1.TRXSTATTRXTYPE AS TRXS on 1=1 and P.TRXTYPEID=TRXS.ID  
        where 
            P.TRXDATE between current date -7 day and current date -1 day
            and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) not in('___è¡__')
            and ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
            and (C.PRODUCTLINE not in ('ä¸_å¾ä¸_º¿','ä¸_å¾__','çº¿ä_V-') or C.PRODUCTLINE is null)
            and ((C.CUSTOMERNUMBER != '10000460331') or (TRXS.NAME != 'OPè°_´¦'))
            group by C.SIGNEDNAME, ex.NAME, C.PRODUCTLINE,SPC.PRODUCTNAME,PP.ACCOUNTCLASS
            ) sub
            group by sub.SIGNEDNAME, sub.NAME, sub.PRODUCTLINE
          )t
          left join YJKH.TBL_DICT_SALES_BRANCH dict on 1=1 and t.name=dict.sales_name
  ) r 

  ) rt where rt.RANK <=40",reportdb_yjkh
hjreporthistorymerchant,hjreporthistorymerchantextractor,"SELECT
    ${STOP} || tmp.SIGNEDNAME AS IDNOUSE,
    ${STOP}                  AS PERIOD,
    ${STOP}                   AS DATA_PERIOD,
    tmp.SIGNEDNAME                                      AS MERCHANT_NAME,
    MIN(tmp.yejishuxing)                                AS YEJISHUXING,
    MIN(tmp.salesname)                                  AS SALES_NAME,
    SUM(tmp.TRXPROFIT)                                  AS PROFIT_INCREMENT,
    'äº__è¡__çº'                                             AS HANGYEYEJISHUXING,
    'HISTORY'                                           AS DATA_TYPE,
    'MERCHANT'                                          AS DIMENSION_TYPE
FROM
    (
        SELECT
            STAT.month,
            STAT.TRUE_MONTH,
            CUSTOMER.CUSTOMERNUMBER,
            CUSTOMER.FULLNAME,
            STAT.GROUPTYPE      AS shoufufang,
            BIZTYPE.DISPLAYNAME AS yewuleixing,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END                                       AS hesuanzhonglei,
            COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') AS yejishuxing,
            acc.NAME                                  AS kaohebiaoji,
            PP.ACCOUNTINGTYPE                         AS hesuankoujing,
            CUSTOMER.VMARK,
            TBC.NAME               AS businesscat,
            EMPLOYEE.NAME          AS salesname ,
            EMPLOYEE.loginusername AS youxiangqianzhui ,
            EMPLOYEE1.NAME         AS supername,
            BRA.BRANCHNAME,
            P.PRODUCTNAME  AS jichuchanpin,
            P1.PRODUCTNAME AS lingshouchanpin,
            TRXTYPE.NAME   AS jiaoyileixing,
            CUSTOMER.SIGNEDNAME,
            STAT.hangyeyejishuxing                   AS hangyeyejishuxing,
            (STAT.TRXCOUNT*COALESCE(c2a.PERCENT,1))  AS trxcount,
            (STAT.TRXAMOUNT*COALESCE(c2a.PERCENT,1)) AS trxamount,
            (
                CASE
                    WHEN (STAT.BIZTYPEID IN (29,129)
                        AND STAT.TRXTYPEID NOT IN ('POSRENT',
                                                   'POSSALES'))
                    THEN STAT.ACCOUNTINGPROFIT*COALESCE(c2a.PERCENT,1)
                    ELSE STAT.INNERINCOME*COALESCE(c2a.PERCENT,1)
                END) AS trxfee,
            (
                CASE
                    WHEN STAT.BIZTYPEID IN (29,129)
                    THEN 0
                    ELSE STAT.ACCOUNTINGCOST*COALESCE(c2a.PERCENT,1)
                END)                                        AS accountingcost,
            (STAT.ACCOUNTINGPROFIT*COALESCE(c2a.PERCENT,1)) AS trxprofit,
            CASE
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('ä¿__è¡__çº',
                                                                   '__è¡__çº',
                                                                   '_¿ä¿¡è¡__çº',
                                                                   '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('__º¬____',
                                                                   'æ²³å_____',
                                                                   'å±±ä_____',
                                                                   'å±±è¥¿____',
                                                                   '__¥¿____',
                                                                   'å¤©æ´¥____',
                                                                   'æ±______',
                                                                   'ä¸_µ·____',
                                                                   'æµ______',
                                                                   'ç¦_»º____',
                                                                   'å¹¿ä_____',
                                                                   '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('__º¬____',
                                                                   'æ²³å_____',
                                                                   'å±±ä_____',
                                                                   'å±±è¥¿____',
                                                                   '__¥¿____',
                                                                   'å¤©æ´¥____',
                                                                   'æ±______',
                                                                   'ä¸_µ·____',
                                                                   'æµ______',
                                                                   'ç¦_»º____',
                                                                   'å¹¿ä_____',
                                                                   '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END AS jixiaojisuan
        FROM
            DB2INST1.PUBLISHEDMONTHLYTRXSTAT AS STAT
        LEFT JOIN
            DB2INST1.TIMELATITUDE AS TL
        ON
            1=1
        AND STAT.TIMELATITUDEID=TL.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS AREA
        ON
            1=1
        AND STAT.AREAID=AREA.ID
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE AS BIZTYPE
        ON
            1=1
        AND STAT.BIZTYPEID=BIZTYPE.ID
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMPLOYEE
        ON
            1=1
        AND STAT.SALEID=EMPLOYEE.ID
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS TRXTYPE
        ON
            1=1
        AND STAT.TRXTYPEID=TRXTYPE.ID
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS CUSTOMER
        ON
            1=1
        AND STAT.CUSTOMERID =CUSTOMER.ID
        LEFT JOIN
            DB2INST1.PRODUCTGROUPTYPE AS PGT
        ON
            1=1
        AND STAT.PRODUCTGROUP=PGT.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS BRA
        ON
            1=1
        AND STAT.BRANCHCOMPANY=BRA.AREAID
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS TB
        ON
            1=1
        AND STAT.BUSINESSCATID=TB.ID
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS TBC
        ON
            1=1
        AND CUSTOMER.BUSSINESSCATID=TBC.ID
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE_PROFILE AS tp
        ON
            1=1
        AND STAT.BIZTYPEID=tp.BIZTYPEID
        LEFT JOIN
            DB2INST1.TRXSTATACCMARK AS acc
        ON
            1=1
        AND CUSTOMER.ACCMARK=acc.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P
        ON
            1=1
        AND STAT.PRODUCT_CODE=P.PRODUCTCODE
        AND P.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P1
        ON
            1=1
        AND STAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE
        AND P1.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMPLOYEE1
        ON
            1=1
        AND EMPLOYEE.SUPERIORID=EMPLOYEE1.ID
        LEFT JOIN
            DB2INST1.productcode_profile AS PP
        ON
            1=1
        AND STAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        AND STAT.PRODUCT_CODE=PP.PRODUCT_CODE
        LEFT JOIN
            DB2INST1.customer2achievement AS c2a
        ON
            1=1
        AND CUSTOMER.customernumber=c2a.customer_number
        LEFT JOIN
            DB2INST1.EXISTENCE AS ex
        ON
            1=1
        AND c2a.ACHIEVEMENT_ID=ex.ID
        AND ex.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS tsb
        ON
            1=1
        AND CUSTOMER.SUBBUSINESSCAT=tsb.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE2PRODUCTGROUP AS p2pg
        ON
            1=1
        AND STAT.PRODUCT_CODE=p2pg.PRODUCT_CODE
        AND STAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.EMPLOYEEYEJISHUXING_201601_201607 AS e
        ON
            1=1
        AND STAT.SALEID=e.SALESID
        LEFT JOIN
            DB2INST1.EXISTENCE AS ex1
        ON
            1=1
        AND e.YEJISHUXING=ex1.id
        AND ex1.CLASSTYPE='Department'
        WHERE
            1=1
        AND STAT.month >= '201709'
        AND STAT.month < '201711' ) tmp
WHERE
    tmp.hangyeyejishuxing = 'äº__è¡__çº'
AND tmp.hesuanzhonglei != '___è¡__'
GROUP BY
    tmp.SIGNEDNAME WITH ur",reportdb_yjkh
hjreportcurrentmerchant,hjreportcurrentmerchante,"SELECT
    ${STOP} || tmp.SIGNEDNAME AS IDNOUSE,
    ${STOP}                   AS PERIOD,
	${STOP}												AS DATA_PERIOD,
    tmp.SIGNEDNAME                                      AS MERCHANT_NAME,
    MIN(tmp.yejishuxing)                                AS YEJISHUXING,
    MIN(tmp.SALESNAME)                                  AS SALES_NAME,
    SUM(tmp.PROFIT)                                     AS PROFIT_INCREMENT,
    'äº__è¡__çº'                                         	AS HANGYEYEJISHUXING,
    'CURRENT'                                           AS DATA_TYPE,
    'MERCHANT'                                          AS DIMENSION_TYPE
FROM
    (
        SELECT
            SUM(P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1)) AS profit,
            SUM(
                CASE
                    WHEN (P.BIZTYPEID IN (29,129)
                        AND P.TRXTYPEID NOT IN ('POSRENT',
                                                'POSSALES'))
                    THEN P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1)
                    ELSE P.INNERINCOME*COALESCE(P.YEJISCALE,1)
                END)                                AS income,
            SUM(P.TRXCOUNT*COALESCE(P.YEJISCALE,1)) AS trxcount,
            SUM(
                CASE
                    WHEN (P.BIZTYPEID IN (29,129)
                        AND P.TRXTYPEID NOT IN ('POSRENT',
                                                'POSSALES'))
                    THEN 0
                    ELSE P.ACCOUNTINGCOST*COALESCE(P.YEJISCALE,1)
                END)                                 AS accountcost,
            SUM(P.TRXAMOUNT*COALESCE(P.YEJISCALE,1)) AS trxamount,
            P.TRXDATE,
            C.PRODUCTLINE AS hangyeyejishuxing,
            CASE
                WHEN COALESCE(E.NAME,'_¨å_') IN ('ä¿__è¡__çº',
                                               '__è¡__çº',
                                               '_¿ä¿¡è¡__çº',
                                               '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END AS jixiaobiaoqian,
            P.CUSTNAME,
            PC.PRODUCTNAME AS jichuchanpin,
            S.NAME         AS subbusinesscat,
            P.SALESNAME,
            COALESCE(E.NAME,'_¨å_') AS yejishuxing,
            T.NAME                AS jiaoyileixing,
            CASE
                WHEN P.VMARK IS NULL
                THEN 'V'
                ELSE P.VMARK
            END AS vmark,
            P.CUSTNUM,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END    AS hesuanzhonglei,
            B.NAME AS lishihangyexian,
            C.SIGNEDNAME,
            CASE
                WHEN PP.ACCOUNTINGTYPE IS NULL
                THEN 'çº¿ä_-__'
                ELSE PP.ACCOUNTINGTYPE
            END             AS hesuankoujing,
            SPC.PRODUCTNAME AS lingshouchanpin
        FROM
            DB2INST1.PUBLISHEDDAILYTRX AS P
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS B
        ON
            1=1
        AND P.BUSINESSCATID=B.ID
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S
        ON
            1=1
        AND P.SUBBUSINESSCAT=S.CODE
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND P.RECEIVERID=C.ID
        LEFT JOIN
            DB2INST1.PRODUCTCODE_PROFILE AS PP
        ON
            1=1
        AND P.PRODUCT_CODE=PP.PRODUCT_CODE
        AND P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS PC
        ON
            1=1
        AND P.PRODUCT_CODE=PC.PRODUCTCODE
        AND PC.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS SPC
        ON
            1=1
        AND P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE
        AND SPC.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EXISTENCE AS E
        ON
            1=1
        AND P.YEJISHUXING=E.ID
        AND E.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS T
        ON
            1=1
        AND P.TRXTYPEID=T.ID
        WHERE
            1=1
        AND P.TRXDATE >= '2017-11-01'
        AND P.TRXDATE < ${STOP}
        GROUP BY
            P.TRXDATE,
            C.PRODUCTLINE,
            CASE
                WHEN COALESCE(E.NAME,'_¨å_') IN ('ä¿__è¡__çº',
                                               '__è¡__çº',
                                               '_¿ä¿¡è¡__çº',
                                               '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END,
            P.CUSTNAME,
            PC.PRODUCTNAME,
            S.NAME,
            P.SALESNAME,
            COALESCE(E.NAME,'_¨å_'),
            T.NAME,
            CASE
                WHEN P.VMARK IS NULL
                THEN 'V'
                ELSE P.VMARK
            END,
            P.CUSTNUM,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END,
            B.NAME,
            C.SIGNEDNAME,
            CASE
                WHEN PP.ACCOUNTINGTYPE IS NULL
                THEN 'çº¿ä_-__'
                ELSE PP.ACCOUNTINGTYPE
            END,
            SPC.PRODUCTNAME) tmp
WHERE
    tmp.hangyeyejishuxing = 'äº__è¡__çº'
AND tmp.hesuanzhonglei != '___è¡__'
GROUP BY
    tmp.SIGNEDNAME WITH ur",reportdb_yjkh
xjreporthistorymerchant,xjreporthistorymerchante,"SELECT
    ${STOP} || tmp.SIGNEDNAME AS IDNOUSE,
    ${STOP}                   AS PERIOD,
    ${STOP}                   AS DATA_PERIOD,
    tmp.SIGNEDNAME                                      AS MERCHANT_NAME,
    MIN(tmp.yejishuxing)                                AS YEJISHUXING,
    MIN(tmp.salesname)                                  AS SALES_NAME,
    SUM(tmp.TRXPROFIT)                                  AS PROFIT_INCREMENT,
    'æ¶__è¡__çº'                                             AS HANGYEYEJISHUXING,
    'HISTORY'                                           AS DATA_TYPE,
    'MERCHANT'                                          AS DIMENSION_TYPE
FROM
    (
        SELECT
            STAT.month,
            STAT.TRUE_MONTH,
            CUSTOMER.CUSTOMERNUMBER,
            CUSTOMER.FULLNAME,
            STAT.GROUPTYPE                            AS shoufufang,
            BIZTYPE.DISPLAYNAME                       AS yewuleixing ,
            COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') AS yejishuxing,
            acc.NAME                                  AS kaohebiaoji,
            PP.ACCOUNTINGTYPE                         AS hesuankoujing,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END AS hesuanzhonglei,
            CUSTOMER.VMARK,
            TBC.NAME               AS businesscat,
            EMPLOYEE.NAME          AS salesname ,
            EMPLOYEE.loginusername AS youxiangqianzhui ,
            EMPLOYEE1.NAME         AS supername,
            BRA.BRANCHNAME,
            P.PRODUCTNAME  AS jichuchanpin,
            P1.PRODUCTNAME AS lingshouchanpin,
            TRXTYPE.NAME   AS jiaoyileixing,
            CUSTOMER.SIGNEDNAME,
            STAT.hangyeyejishuxing                   AS hangyeyejishuxing,
            (STAT.TRXCOUNT*COALESCE(c2a.PERCENT,1))  AS trxcount,
            (STAT.TRXAMOUNT*COALESCE(c2a.PERCENT,1)) AS trxamount,
            (
                CASE
                    WHEN (STAT.BIZTYPEID IN (29,129)
                        AND STAT.TRXTYPEID NOT IN ('POSRENT',
                                                   'POSSALES'))
                    THEN STAT.ACCOUNTINGPROFIT*COALESCE(c2a.PERCENT,1)
                    ELSE STAT.INNERINCOME*COALESCE(c2a.PERCENT,1)
                END) AS trxfee,
            (
                CASE
                    WHEN STAT.BIZTYPEID IN (29,129)
                    THEN 0
                    ELSE STAT.ACCOUNTINGCOST*COALESCE(c2a.PERCENT,1)
                END)                                        AS accountingcost,
            (STAT.ACCOUNTINGPROFIT*COALESCE(c2a.PERCENT,1)) AS trxprofit,
            CASE
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('ä¿__è¡__çº',
                                                                   '__è¡__çº',
                                                                   '_¿ä¿¡è¡__çº',
                                                                   '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('__º¬____',
                                                                   'æ²³å_____',
                                                                   'å±±ä_____',
                                                                   'å±±è¥¿____',
                                                                   '__¥¿____',
                                                                   'å¤©æ´¥____',
                                                                   'æ±______',
                                                                   'ä¸_µ·____',
                                                                   'æµ______',
                                                                   'ç¦_»º____',
                                                                   'å¹¿ä_____',
                                                                   '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('__º¬____',
                                                                   'æ²³å_____',
                                                                   'å±±ä_____',
                                                                   'å±±è¥¿____',
                                                                   '__¥¿____',
                                                                   'å¤©æ´¥____',
                                                                   'æ±______',
                                                                   'ä¸_µ·____',
                                                                   'æµ______',
                                                                   'ç¦_»º____',
                                                                   'å¹¿ä_____',
                                                                   '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END AS jixiaojisuan
        FROM
            DB2INST1.PUBLISHEDMONTHLYTRXSTAT AS STAT
        LEFT JOIN
            DB2INST1.TIMELATITUDE AS TL
        ON
            1=1
        AND STAT.TIMELATITUDEID=TL.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS AREA
        ON
            1=1
        AND STAT.AREAID=AREA.ID
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE AS BIZTYPE
        ON
            1=1
        AND STAT.BIZTYPEID=BIZTYPE.ID
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMPLOYEE
        ON
            1=1
        AND STAT.SALEID=EMPLOYEE.ID
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS TRXTYPE
        ON
            1=1
        AND STAT.TRXTYPEID=TRXTYPE.ID
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS CUSTOMER
        ON
            1=1
        AND STAT.CUSTOMERID =CUSTOMER.ID
        LEFT JOIN
            DB2INST1.PRODUCTGROUPTYPE AS PGT
        ON
            1=1
        AND STAT.PRODUCTGROUP=PGT.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS BRA
        ON
            1=1
        AND STAT.BRANCHCOMPANY=BRA.AREAID
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS TB
        ON
            1=1
        AND STAT.BUSINESSCATID=TB.ID
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS TBC
        ON
            1=1
        AND CUSTOMER.BUSSINESSCATID=TBC.ID
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE_PROFILE AS tp
        ON
            1=1
        AND STAT.BIZTYPEID=tp.BIZTYPEID
        LEFT JOIN
            DB2INST1.TRXSTATACCMARK AS acc
        ON
            1=1
        AND CUSTOMER.ACCMARK=acc.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P
        ON
            1=1
        AND STAT.PRODUCT_CODE=P.PRODUCTCODE
        AND P.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P1
        ON
            1=1
        AND STAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE
        AND P1.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMPLOYEE1
        ON
            1=1
        AND EMPLOYEE.SUPERIORID=EMPLOYEE1.ID
        LEFT JOIN
            DB2INST1.productcode_profile AS PP
        ON
            1=1
        AND STAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        AND STAT.PRODUCT_CODE=PP.PRODUCT_CODE
        LEFT JOIN
            DB2INST1.customer2achievement AS c2a
        ON
            1=1
        AND CUSTOMER.customernumber=c2a.customer_number
        LEFT JOIN
            DB2INST1.EXISTENCE AS ex
        ON
            1=1
        AND c2a.ACHIEVEMENT_ID=ex.ID
        AND ex.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS tsb
        ON
            1=1
        AND CUSTOMER.SUBBUSINESSCAT=tsb.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE2PRODUCTGROUP AS p2pg
        ON
            1=1
        AND STAT.PRODUCT_CODE=p2pg.PRODUCT_CODE
        AND STAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.EMPLOYEEYEJISHUXING_201601_201607 AS e
        ON
            1=1
        AND STAT.SALEID=e.SALESID
        LEFT JOIN
            DB2INST1.EXISTENCE AS ex1
        ON
            1=1
        AND e.YEJISHUXING=ex1.id
        AND ex1.CLASSTYPE='Department'
        WHERE
            1=1
        AND STAT.month >= '201709'
        AND STAT.month < '201711' ) tmp
WHERE
    tmp.hangyeyejishuxing = 'æ¶__è¡__çº'
AND tmp.hesuanzhonglei != '___è¡__'
GROUP BY
    tmp.SIGNEDNAME WITH ur",reportdb_yjkh
xjreportcurrentmerchant,xjreportcurrentmerchante,"SELECT
    ${STOP} || tmp.SIGNEDNAME AS IDNOUSE,
    ${STOP}                      PERIOD,
    ${STOP}                      DATA_PERIOD,
    tmp.SIGNEDNAME                                      AS MERCHANT_NAME,
    MIN(tmp.yejishuxing)                                AS YEJISHUXING,
    MIN(tmp.SALESNAME)                                     SALES_NAME,
    SUM(tmp.PROFIT)                                     AS PROFIT_INCREMENT,
    'æ¶__è¡__çº'                                             AS HANGYEYEJISHUXING,
    'CURRENT'                                           AS DATA_TYPE,
    'MERCHANT'                                          AS DIMENSION_TYPE
FROM
    (
        SELECT
            SUM(P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1)) AS profit,
            SUM(
                CASE
                    WHEN (P.BIZTYPEID IN (29,129)
                        AND P.TRXTYPEID NOT IN ('POSRENT',
                                                'POSSALES'))
                    THEN P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1)
                    ELSE P.INNERINCOME*COALESCE(P.YEJISCALE,1)
                END)                                AS income,
            SUM(P.TRXCOUNT*COALESCE(P.YEJISCALE,1)) AS trxcount,
            SUM(
                CASE
                    WHEN (P.BIZTYPEID IN (29,129)
                        AND P.TRXTYPEID NOT IN ('POSRENT',
                                                'POSSALES'))
                    THEN 0
                    ELSE P.ACCOUNTINGCOST*COALESCE(P.YEJISCALE,1)
                END)                                 AS accountcost,
            SUM(P.TRXAMOUNT*COALESCE(P.YEJISCALE,1)) AS trxamount,
            P.TRXDATE,
            C.PRODUCTLINE AS hangyeyejishuxing,
            CASE
                WHEN COALESCE(E.NAME,'_¨å_') IN ('ä¿__è¡__çº',
                                               '__è¡__çº',
                                               '_¿ä¿¡è¡__çº',
                                               '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END AS jixiaobiaoqian,
            P.CUSTNAME,
            PC.PRODUCTNAME AS jichuchanpin,
            S.NAME         AS subbusinesscat,
            P.SALESNAME,
            COALESCE(E.NAME,'_¨å_') AS yejishuxing,
            T.NAME                AS jiaoyileixing,
            CASE
                WHEN P.VMARK IS NULL
                THEN 'V'
                ELSE P.VMARK
            END AS vmark,
            P.CUSTNUM,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END    AS hesuanzhonglei,
            B.NAME AS lishihangyexian,
            C.SIGNEDNAME,
            CASE
                WHEN PP.ACCOUNTINGTYPE IS NULL
                THEN 'çº¿ä_-__'
                ELSE PP.ACCOUNTINGTYPE
            END             AS hesuankoujing,
            SPC.PRODUCTNAME AS lingshouchanpin
        FROM
            DB2INST1.PUBLISHEDDAILYTRX AS P
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS B
        ON
            1=1
        AND P.BUSINESSCATID=B.ID
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S
        ON
            1=1
        AND P.SUBBUSINESSCAT=S.CODE
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND P.RECEIVERID=C.ID
        LEFT JOIN
            DB2INST1.PRODUCTCODE_PROFILE AS PP
        ON
            1=1
        AND P.PRODUCT_CODE=PP.PRODUCT_CODE
        AND P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS PC
        ON
            1=1
        AND P.PRODUCT_CODE=PC.PRODUCTCODE
        AND PC.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS SPC
        ON
            1=1
        AND P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE
        AND SPC.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EXISTENCE AS E
        ON
            1=1
        AND P.YEJISHUXING=E.ID
        AND E.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS T
        ON
            1=1
        AND P.TRXTYPEID=T.ID
        WHERE
            1=1
        AND P.TRXDATE >= '2017-11-01'
        AND P.TRXDATE < ${STOP}
        GROUP BY
            P.TRXDATE,
            C.PRODUCTLINE,
            CASE
                WHEN COALESCE(E.NAME,'_¨å_') IN ('ä¿__è¡__çº',
                                               '__è¡__çº',
                                               '_¿ä¿¡è¡__çº',
                                               '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END,
            P.CUSTNAME,
            PC.PRODUCTNAME,
            S.NAME,
            P.SALESNAME,
            COALESCE(E.NAME,'_¨å_'),
            T.NAME,
            CASE
                WHEN P.VMARK IS NULL
                THEN 'V'
                ELSE P.VMARK
            END,
            P.CUSTNUM,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END,
            B.NAME,
            C.SIGNEDNAME,
            CASE
                WHEN PP.ACCOUNTINGTYPE IS NULL
                THEN 'çº¿ä_-__'
                ELSE PP.ACCOUNTINGTYPE
            END,
            SPC.PRODUCTNAME) tmp
WHERE
    tmp.hangyeyejishuxing = 'æ¶__è¡__çº'
AND tmp.hesuanzhonglei != '___è¡__'
GROUP BY
    tmp.SIGNEDNAME WITH ur",reportdb_yjkh
companybusinessprofitinc,companybusinessprofitince,"select 
START_DATE,END_DATE,LAST_START_DATE,LAST_END_DATE,SIGNEDNAME,PRODUCTLINE,TRXPROFIT,TRXPROFIT_BEFORE,PROFIT_CHANGE,ADD_FLAG,EMPLOYEE_NAME,CREATE_TIME
from(
SELECT
 DATE(${START}) - 6 day AS START_DATE,
 DATE(${START})  AS END_DATE,
 DATE(${START}) - 13 day AS LAST_START_DATE,
 DATE(${START}) -  7 day AS LAST_END_DATE,
CURRENT TIMESTAMP AS CREATE_TIME,
    t3.PRODUCTLINE  AS PRODUCTLINE,
    t3.SIGNEDNAME   AS SIGNEDNAME,
    t2.profit/10000 AS TRXPROFIT_BEFORE,
    t3.profit/10000 AS TRXPROFIT,
    (t3.profit-
    CASE t2.profit
        WHEN NULL
        THEN 0
        ELSE t2.profit
    END)/10000 AS PROFIT_CHANGE,
EMPLOYEE_NAME AS EMPLOYEE_NAME,
    1          AS ADD_FLAG
FROM
    (
    select 
    LISTAGG(EMPLOYEE_NAME) AS EMPLOYEE_NAME,
    sum(profit) AS PROFIT,
    SIGNEDNAME,
    PRODUCTLINE
    from (
        select
  sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) as profit,
  C.SIGNEDNAME,
  P.SALESNAME AS EMPLOYEE_NAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END AS PRODUCTLINE
  from DB2INST1.PUBLISHEDDAILYTRX AS P
  left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
  left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
  left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
  left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
  left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
  left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
  left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID 
  where 1=1
  AND P.TRXDATE between DATE(${START}) -6 DAY and DATE(${START})
  AND (PP.ACCOUNTCLASS is null OR PP.ACCOUNTCLASS != '___è¡__')
and (C.CUSTOMERNUMBER not in ('10000460331') or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
GROUP BY 
  C.SIGNEDNAME,
  P.SALESNAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END) t1
            group by
   				 SIGNEDNAME,
   				 PRODUCTLINE
            ) t3       
LEFT JOIN
    (
        select
  sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) as profit,
  C.SIGNEDNAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END AS PRODUCTLINE
  from DB2INST1.PUBLISHEDDAILYTRX AS P
  left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
  left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
  left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
  left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
  left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
  left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
  left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID 
  where 1=1
  AND P.TRXDATE between DATE(${START}) -13 DAY and DATE(${START})-7 DAY
  AND (PP.ACCOUNTCLASS is null OR PP.ACCOUNTCLASS != '___è¡__')
and (C.CUSTOMERNUMBER not in ('10000460331') or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
GROUP BY 
  C.SIGNEDNAME,
 CASE
                        WHEN C.PRODUCTLINE IS NULL
                        AND C.PRODUCTLINE IN('çº¿ä_V-',
                                              'ä¸_å¾ä¸_º¿')
                        THEN 'ä¸_å¾__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('_¶æå®',
                                              '_¥å____')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        WHEN C.PRODUCTLINE IS NULL
                        AND SPC.PRODUCTNAME IN('____')
                        THEN '_°é__ä¸_º¿____'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_',
                                                'ç§»å_')
                        THEN '_£æ_ä¸__'
                        WHEN C.PRODUCTLINE IS NULL
                        AND PP.ACCOUNTCLASS IN ('çº¿ä_')
                        THEN '_°é__ä¸_º¿__º¿ä¸'
                        ELSE C.PRODUCTLINE
                    END) t2
ON
    t3.SIGNEDNAME=t2.SIGNEDNAME
AND t3.PRODUCTLINE=t2.PRODUCTLINE
WHERE
    t2.SIGNEDNAME IS NOT NULL
AND t2.PRODUCTLINE IS NOT NULL
ORDER BY
    (t3.profit-
    CASE t2.profit
        WHEN NULL
        THEN 0
        ELSE t2.profit
    END) DESC
    )
FETCH
    FIRST 30 rows only",reportdb_yjkh
hjreporthistorysales,hjreporthistorysalese,"SELECT
    ${STOP} || tmp.salesname AS IDNOUSE,
    ${STOP}                  AS PERIOD,
    ${STOP}                  AS DATA_PERIOD,
    tmp.salesname                                      AS SALES_NAME,
    MIN(tmp.yejishuxing)                               AS YEJISHUXING,
    SUM(tmp.TRXPROFIT)                                 AS PROFIT_INCREMENT,
    'äº__è¡__çº'                                         AS HANGYEYEJISHUXING,
    'HISTORY'                                          AS DATA_TYPE,
    'SALES'                                            AS DIMENSION_TYPE
FROM
    (
        SELECT
            STAT.month,
            STAT.TRUE_MONTH,
            CUSTOMER.CUSTOMERNUMBER,
            CUSTOMER.FULLNAME,
            STAT.GROUPTYPE                            AS shoufufang,
            BIZTYPE.DISPLAYNAME                       AS yewuleixing ,
            COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') AS yejishuxing,
            acc.NAME                                  AS kaohebiaoji,
            PP.ACCOUNTINGTYPE                         AS hesuankoujing,
            CUSTOMER.VMARK,
            TBC.NAME               AS businesscat,
            EMPLOYEE.NAME          AS salesname ,
            EMPLOYEE.loginusername AS youxiangqianzhui ,
            EMPLOYEE1.NAME         AS supername,
            BRA.BRANCHNAME,
            P.PRODUCTNAME  AS jichuchanpin,
            P1.PRODUCTNAME AS lingshouchanpin,
            TRXTYPE.NAME   AS jiaoyileixing,
            CUSTOMER.SIGNEDNAME,
            STAT.hangyeyejishuxing                   AS hangyeyejishuxing,
            (STAT.TRXCOUNT*COALESCE(c2a.PERCENT,1))  AS trxcount,
            (STAT.TRXAMOUNT*COALESCE(c2a.PERCENT,1)) AS trxamount,
            (
                CASE
                    WHEN (STAT.BIZTYPEID IN (29,129)
                        AND STAT.TRXTYPEID NOT IN ('POSRENT',
                                                   'POSSALES'))
                    THEN STAT.ACCOUNTINGPROFIT*COALESCE(c2a.PERCENT,1)
                    ELSE STAT.INNERINCOME*COALESCE(c2a.PERCENT,1)
                END) AS trxfee,
            (
                CASE
                    WHEN STAT.BIZTYPEID IN (29,129)
                    THEN 0
                    ELSE STAT.ACCOUNTINGCOST*COALESCE(c2a.PERCENT,1)
                END)                                        AS accountingcost,
            (STAT.ACCOUNTINGPROFIT*COALESCE(c2a.PERCENT,1)) AS trxprofit,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END AS hesuanzhonglei,
            CASE
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('ä¿__è¡__çº',
                                                                   '__è¡__çº',
                                                                   '_¿ä¿¡è¡__çº',
                                                                   '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('__º¬____',
                                                                   'æ²³å_____',
                                                                   'å±±ä_____',
                                                                   'å±±è¥¿____',
                                                                   '__¥¿____',
                                                                   'å¤©æ´¥____',
                                                                   'æ±______',
                                                                   'ä¸_µ·____',
                                                                   'æµ______',
                                                                   'ç¦_»º____',
                                                                   'å¹¿ä_____',
                                                                   '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('__º¬____',
                                                                   'æ²³å_____',
                                                                   'å±±ä_____',
                                                                   'å±±è¥¿____',
                                                                   '__¥¿____',
                                                                   'å¤©æ´¥____',
                                                                   'æ±______',
                                                                   'ä¸_µ·____',
                                                                   'æµ______',
                                                                   'ç¦_»º____',
                                                                   'å¹¿ä_____',
                                                                   '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END AS jixiaojisuan
        FROM
            DB2INST1.PUBLISHEDMONTHLYTRXSTAT AS STAT
        LEFT JOIN
            DB2INST1.TIMELATITUDE AS TL
        ON
            1=1
        AND STAT.TIMELATITUDEID=TL.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS AREA
        ON
            1=1
        AND STAT.AREAID=AREA.ID
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE AS BIZTYPE
        ON
            1=1
        AND STAT.BIZTYPEID=BIZTYPE.ID
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMPLOYEE
        ON
            1=1
        AND STAT.SALEID=EMPLOYEE.ID
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS TRXTYPE
        ON
            1=1
        AND STAT.TRXTYPEID=TRXTYPE.ID
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS CUSTOMER
        ON
            1=1
        AND STAT.CUSTOMERID =CUSTOMER.ID
        LEFT JOIN
            DB2INST1.PRODUCTGROUPTYPE AS PGT
        ON
            1=1
        AND STAT.PRODUCTGROUP=PGT.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS BRA
        ON
            1=1
        AND STAT.BRANCHCOMPANY=BRA.AREAID
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS TB
        ON
            1=1
        AND STAT.BUSINESSCATID=TB.ID
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS TBC
        ON
            1=1
        AND CUSTOMER.BUSSINESSCATID=TBC.ID
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE_PROFILE AS tp
        ON
            1=1
        AND STAT.BIZTYPEID=tp.BIZTYPEID
        LEFT JOIN
            DB2INST1.TRXSTATACCMARK AS acc
        ON
            1=1
        AND CUSTOMER.ACCMARK=acc.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P
        ON
            1=1
        AND STAT.PRODUCT_CODE=P.PRODUCTCODE
        AND P.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P1
        ON
            1=1
        AND STAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE
        AND P1.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMPLOYEE1
        ON
            1=1
        AND EMPLOYEE.SUPERIORID=EMPLOYEE1.ID
        LEFT JOIN
            DB2INST1.productcode_profile AS PP
        ON
            1=1
        AND STAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        AND STAT.PRODUCT_CODE=PP.PRODUCT_CODE
        LEFT JOIN
            DB2INST1.customer2achievement AS c2a
        ON
            1=1
        AND CUSTOMER.customernumber=c2a.customer_number
        LEFT JOIN
            DB2INST1.EXISTENCE AS ex
        ON
            1=1
        AND c2a.ACHIEVEMENT_ID=ex.ID
        AND ex.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS tsb
        ON
            1=1
        AND CUSTOMER.SUBBUSINESSCAT=tsb.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE2PRODUCTGROUP AS p2pg
        ON
            1=1
        AND STAT.PRODUCT_CODE=p2pg.PRODUCT_CODE
        AND STAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.EMPLOYEEYEJISHUXING_201601_201607 AS e
        ON
            1=1
        AND STAT.SALEID=e.SALESID
        LEFT JOIN
            DB2INST1.EXISTENCE AS ex1
        ON
            1=1
        AND e.YEJISHUXING=ex1.id
        AND ex1.CLASSTYPE='Department'
        WHERE
            1=1
        AND STAT.month >= '201709'
        AND STAT.month < '201711') tmp
WHERE
    tmp.hangyeyejishuxing = 'äº__è¡__çº'
AND tmp.hesuanzhonglei != '___è¡__'
AND tmp.jixiaojisuan = 'TRUE'
GROUP BY
    tmp.salesname WITH ur",reportdb_yjkh
hjreportcurrentsales,hjreportcurrentsalese,"SELECT
    ${STOP} || tmp.salesname AS IDNOUSE,
    ${STOP}                  AS PERIOD,
    ${STOP}                  AS DATA_PERIOD,
    tmp.SALESNAME                                      AS SALES_NAME,
    MIN(tmp.yejishuxing)                               AS YEJISHUXING,
    SUM(tmp.PROFIT)                                    AS PROFIT_INCREMENT,
    'äº__è¡__çº'                                            AS HANGYEYEJISHUXING,
    'CURRENT'                                          AS DATA_TYPE,
    'SALES'                                            AS DIMENSION_TYPE
FROM
    (
        SELECT
            SUM(P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1)) AS profit,
            SUM(
                CASE
                    WHEN (P.BIZTYPEID IN (29,129)
                        AND P.TRXTYPEID NOT IN ('POSRENT',
                                                'POSSALES'))
                    THEN P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1)
                    ELSE P.INNERINCOME*COALESCE(P.YEJISCALE,1)
                END)                                AS income,
            SUM(P.TRXCOUNT*COALESCE(P.YEJISCALE,1)) AS trxcount,
            SUM(
                CASE
                    WHEN (P.BIZTYPEID IN (29,129)
                        AND P.TRXTYPEID NOT IN ('POSRENT',
                                                'POSSALES'))
                    THEN 0
                    ELSE P.ACCOUNTINGCOST*COALESCE(P.YEJISCALE,1)
                END)                                 AS accountcost,
            SUM(P.TRXAMOUNT*COALESCE(P.YEJISCALE,1)) AS trxamount,
            P.TRXDATE,
            C.PRODUCTLINE AS hangyeyejishuxing,
            CASE
                WHEN COALESCE(E.NAME,'_¨å_') IN ('ä¿__è¡__çº',
                                               '__è¡__çº',
                                               '_¿ä¿¡è¡__çº',
                                               '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END AS jixiaobiaoqian,
            P.CUSTNAME,
            PC.PRODUCTNAME AS jichuchanpin,
            S.NAME         AS subbusinesscat,
            P.SALESNAME,
            COALESCE(E.NAME,'_¨å_') AS yejishuxing,
            T.NAME                AS jiaoyileixing,
            CASE
                WHEN P.VMARK IS NULL
                THEN 'V'
                ELSE P.VMARK
            END AS vmark,
            P.CUSTNUM,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END    AS hesuanzhonglei,
            B.NAME AS lishihangyexian,
            C.SIGNEDNAME,
            CASE
                WHEN PP.ACCOUNTINGTYPE IS NULL
                THEN 'çº¿ä_-__'
                ELSE PP.ACCOUNTINGTYPE
            END             AS hesuankoujing,
            SPC.PRODUCTNAME AS lingshouchanpin
        FROM
            DB2INST1.PUBLISHEDDAILYTRX AS P
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS B
        ON
            1=1
        AND P.BUSINESSCATID=B.ID
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S
        ON
            1=1
        AND P.SUBBUSINESSCAT=S.CODE
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND P.RECEIVERID=C.ID
        LEFT JOIN
            DB2INST1.PRODUCTCODE_PROFILE AS PP
        ON
            1=1
        AND P.PRODUCT_CODE=PP.PRODUCT_CODE
        AND P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS PC
        ON
            1=1
        AND P.PRODUCT_CODE=PC.PRODUCTCODE
        AND PC.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS SPC
        ON
            1=1
        AND P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE
        AND SPC.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EXISTENCE AS E
        ON
            1=1
        AND P.YEJISHUXING=E.ID
        AND E.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS T
        ON
            1=1
        AND P.TRXTYPEID=T.ID
        WHERE
            1=1
        AND P.TRXDATE >= '2017-11-01'
        AND P.TRXDATE < ${STOP}
        GROUP BY
            P.TRXDATE,
            C.PRODUCTLINE,
            CASE
                WHEN COALESCE(E.NAME,'_¨å_') IN ('ä¿__è¡__çº',
                                               '__è¡__çº',
                                               '_¿ä¿¡è¡__çº',
                                               '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END,
            P.CUSTNAME,
            PC.PRODUCTNAME,
            S.NAME,
            P.SALESNAME,
            COALESCE(E.NAME,'_¨å_'),
            T.NAME,
            CASE
                WHEN P.VMARK IS NULL
                THEN 'V'
                ELSE P.VMARK
            END,
            P.CUSTNUM,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END,
            B.NAME,
            C.SIGNEDNAME,
            CASE
                WHEN PP.ACCOUNTINGTYPE IS NULL
                THEN 'çº¿ä_-__'
                ELSE PP.ACCOUNTINGTYPE
            END,
            SPC.PRODUCTNAME) tmp
WHERE
    tmp.hangyeyejishuxing = 'äº__è¡__çº'
AND tmp.hesuanzhonglei != '___è¡__'
AND tmp.jixiaobiaoqian = 'TRUE'
GROUP BY
    tmp.SALESNAME WITH ur",reportdb_yjkh
xjreporthistorysales,xjreporthistorysalese,"SELECT
    ${STOP} || tmp.salesname AS IDNOUSE,
    ${STOP}                 AS PERIOD,
    ${STOP}                 AS DATA_PERIOD,
    tmp.salesname                                      AS SALES_NAME,
    MIN(tmp.yejishuxing)                               AS YEJISHUXING,
    SUM(tmp.TRXPROFIT)                                 AS PROFIT_INCREMENT,
    'æ¶__è¡__çº'                                            AS HANGYEYEJISHUXING,
    'HISTORY'                                          AS DATA_TYPE,
    'SALES'                                            AS DIMENSION_TYPE
FROM
    (
        SELECT
            STAT.month,
            STAT.TRUE_MONTH,
            CUSTOMER.CUSTOMERNUMBER,
            CUSTOMER.FULLNAME,
            STAT.GROUPTYPE                            AS shoufufang,
            BIZTYPE.DISPLAYNAME                       AS yewuleixing ,
            COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') AS yejishuxing,
            acc.NAME                                  AS kaohebiaoji,
            PP.ACCOUNTINGTYPE                         AS hesuankoujing,
            CUSTOMER.VMARK,
            TBC.NAME               AS businesscat,
            EMPLOYEE.NAME          AS salesname ,
            EMPLOYEE.loginusername AS youxiangqianzhui ,
            EMPLOYEE1.NAME         AS supername,
            BRA.BRANCHNAME,
            P.PRODUCTNAME  AS jichuchanpin,
            P1.PRODUCTNAME AS lingshouchanpin,
            TRXTYPE.NAME   AS jiaoyileixing,
            CUSTOMER.SIGNEDNAME,
            STAT.hangyeyejishuxing                   AS hangyeyejishuxing,
            (STAT.TRXCOUNT*COALESCE(c2a.PERCENT,1))  AS trxcount,
            (STAT.TRXAMOUNT*COALESCE(c2a.PERCENT,1)) AS trxamount,
            (
                CASE
                    WHEN (STAT.BIZTYPEID IN (29,129)
                        AND STAT.TRXTYPEID NOT IN ('POSRENT',
                                                   'POSSALES'))
                    THEN STAT.ACCOUNTINGPROFIT*COALESCE(c2a.PERCENT,1)
                    ELSE STAT.INNERINCOME*COALESCE(c2a.PERCENT,1)
                END) AS trxfee,
            (
                CASE
                    WHEN STAT.BIZTYPEID IN (29,129)
                    THEN 0
                    ELSE STAT.ACCOUNTINGCOST*COALESCE(c2a.PERCENT,1)
                END)                                        AS accountingcost,
            (STAT.ACCOUNTINGPROFIT*COALESCE(c2a.PERCENT,1)) AS trxprofit,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END AS hesuanzhonglei,
            CASE
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('ä¿__è¡__çº',
                                                                   '__è¡__çº',
                                                                   '_¿ä¿¡è¡__çº',
                                                                   '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('__º¬____',
                                                                   'æ²³å_____',
                                                                   'å±±ä_____',
                                                                   'å±±è¥¿____',
                                                                   '__¥¿____',
                                                                   'å¤©æ´¥____',
                                                                   'æ±______',
                                                                   'ä¸_µ·____',
                                                                   'æµ______',
                                                                   'ç¦_»º____',
                                                                   'å¹¿ä_____',
                                                                   '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(COALESCE(ex.NAME,ex1.name),'_¨å_') IN ('__º¬____',
                                                                   'æ²³å_____',
                                                                   'å±±ä_____',
                                                                   'å±±è¥¿____',
                                                                   '__¥¿____',
                                                                   'å¤©æ´¥____',
                                                                   'æ±______',
                                                                   'ä¸_µ·____',
                                                                   'æµ______',
                                                                   'ç¦_»º____',
                                                                   'å¹¿ä_____',
                                                                   '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN CUSTOMER.VMARK IS NULL
                            THEN 'V'
                            ELSE CUSTOMER.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END AS jixiaojisuan
        FROM
            DB2INST1.PUBLISHEDMONTHLYTRXSTAT AS STAT
        LEFT JOIN
            DB2INST1.TIMELATITUDE AS TL
        ON
            1=1
        AND STAT.TIMELATITUDEID=TL.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS AREA
        ON
            1=1
        AND STAT.AREAID=AREA.ID
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE AS BIZTYPE
        ON
            1=1
        AND STAT.BIZTYPEID=BIZTYPE.ID
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMPLOYEE
        ON
            1=1
        AND STAT.SALEID=EMPLOYEE.ID
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS TRXTYPE
        ON
            1=1
        AND STAT.TRXTYPEID=TRXTYPE.ID
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS CUSTOMER
        ON
            1=1
        AND STAT.CUSTOMERID =CUSTOMER.ID
        LEFT JOIN
            DB2INST1.PRODUCTGROUPTYPE AS PGT
        ON
            1=1
        AND STAT.PRODUCTGROUP=PGT.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS BRA
        ON
            1=1
        AND STAT.BRANCHCOMPANY=BRA.AREAID
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS TB
        ON
            1=1
        AND STAT.BUSINESSCATID=TB.ID
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS TBC
        ON
            1=1
        AND CUSTOMER.BUSSINESSCATID=TBC.ID
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE_PROFILE AS tp
        ON
            1=1
        AND STAT.BIZTYPEID=tp.BIZTYPEID
        LEFT JOIN
            DB2INST1.TRXSTATACCMARK AS acc
        ON
            1=1
        AND CUSTOMER.ACCMARK=acc.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P
        ON
            1=1
        AND STAT.PRODUCT_CODE=P.PRODUCTCODE
        AND P.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P1
        ON
            1=1
        AND STAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE
        AND P1.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMPLOYEE1
        ON
            1=1
        AND EMPLOYEE.SUPERIORID=EMPLOYEE1.ID
        LEFT JOIN
            DB2INST1.productcode_profile AS PP
        ON
            1=1
        AND STAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        AND STAT.PRODUCT_CODE=PP.PRODUCT_CODE
        LEFT JOIN
            DB2INST1.customer2achievement AS c2a
        ON
            1=1
        AND CUSTOMER.customernumber=c2a.customer_number
        LEFT JOIN
            DB2INST1.EXISTENCE AS ex
        ON
            1=1
        AND c2a.ACHIEVEMENT_ID=ex.ID
        AND ex.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS tsb
        ON
            1=1
        AND CUSTOMER.SUBBUSINESSCAT=tsb.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE2PRODUCTGROUP AS p2pg
        ON
            1=1
        AND STAT.PRODUCT_CODE=p2pg.PRODUCT_CODE
        AND STAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.EMPLOYEEYEJISHUXING_201601_201607 AS e
        ON
            1=1
        AND STAT.SALEID=e.SALESID
        LEFT JOIN
            DB2INST1.EXISTENCE AS ex1
        ON
            1=1
        AND e.YEJISHUXING=ex1.id
        AND ex1.CLASSTYPE='Department'
        WHERE
            1=1
        AND STAT.month >= '201709'
        AND STAT.month < '201711') tmp
WHERE
    tmp.hangyeyejishuxing = 'æ¶__è¡__çº'
AND tmp.hesuanzhonglei != '___è¡__'
GROUP BY
    tmp.salesname WITH ur",reportdb_yjkh
xjreportcurrentsales,xjreportcurrentsalese,"SELECT
    ${STOP} || tmp.salesname AS IDNOUSE,
    ${STOP}                  AS PERIOD,
    ${STOP}                  AS DATA_PERIOD,
    tmp.SALESNAME                                      AS SALES_NAME,
    MIN(tmp.yejishuxing)                               AS YEJISHUXING,
    SUM(tmp.PROFIT)                                    AS PROFIT_INCREMENT,
    'æ¶__è¡__çº'                                            AS HANGYEYEJISHUXING,
    'CURRENT'                                          AS DATA_TYPE,
    'SALES'                                            AS DIMENSION_TYPE
FROM
    (
        SELECT
            SUM(P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1)) AS profit,
            SUM(
                CASE
                    WHEN (P.BIZTYPEID IN (29,129)
                        AND P.TRXTYPEID NOT IN ('POSRENT',
                                                'POSSALES'))
                    THEN P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1)
                    ELSE P.INNERINCOME*COALESCE(P.YEJISCALE,1)
                END)                                AS income,
            SUM(P.TRXCOUNT*COALESCE(P.YEJISCALE,1)) AS trxcount,
            SUM(
                CASE
                    WHEN (P.BIZTYPEID IN (29,129)
                        AND P.TRXTYPEID NOT IN ('POSRENT',
                                                'POSSALES'))
                    THEN 0
                    ELSE P.ACCOUNTINGCOST*COALESCE(P.YEJISCALE,1)
                END)                                 AS accountcost,
            SUM(P.TRXAMOUNT*COALESCE(P.YEJISCALE,1)) AS trxamount,
            P.TRXDATE,
            C.PRODUCTLINE AS hangyeyejishuxing,
            CASE
                WHEN COALESCE(E.NAME,'_¨å_') IN ('ä¿__è¡__çº',
                                               '__è¡__çº',
                                               '_¿ä¿¡è¡__çº',
                                               '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END AS jixiaobiaoqian,
            P.CUSTNAME,
            PC.PRODUCTNAME AS jichuchanpin,
            S.NAME         AS subbusinesscat,
            P.SALESNAME,
            COALESCE(E.NAME,'_¨å_') AS yejishuxing,
            T.NAME                AS jiaoyileixing,
            CASE
                WHEN P.VMARK IS NULL
                THEN 'V'
                ELSE P.VMARK
            END AS vmark,
            P.CUSTNUM,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END    AS hesuanzhonglei,
            B.NAME AS lishihangyexian,
            C.SIGNEDNAME,
            CASE
                WHEN PP.ACCOUNTINGTYPE IS NULL
                THEN 'çº¿ä_-__'
                ELSE PP.ACCOUNTINGTYPE
            END             AS hesuankoujing,
            SPC.PRODUCTNAME AS lingshouchanpin
        FROM
            DB2INST1.PUBLISHEDDAILYTRX AS P
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS B
        ON
            1=1
        AND P.BUSINESSCATID=B.ID
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S
        ON
            1=1
        AND P.SUBBUSINESSCAT=S.CODE
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND P.RECEIVERID=C.ID
        LEFT JOIN
            DB2INST1.PRODUCTCODE_PROFILE AS PP
        ON
            1=1
        AND P.PRODUCT_CODE=PP.PRODUCT_CODE
        AND P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS PC
        ON
            1=1
        AND P.PRODUCT_CODE=PC.PRODUCTCODE
        AND PC.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS SPC
        ON
            1=1
        AND P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE
        AND SPC.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EXISTENCE AS E
        ON
            1=1
        AND P.YEJISHUXING=E.ID
        AND E.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS T
        ON
            1=1
        AND P.TRXTYPEID=T.ID
        WHERE
            1=1
        AND P.TRXDATE >= '2017-11-01'
        AND P.TRXDATE < ${STOP}
        GROUP BY
            P.TRXDATE,
            C.PRODUCTLINE,
            CASE
                WHEN COALESCE(E.NAME,'_¨å_') IN ('ä¿__è¡__çº',
                                               '__è¡__çº',
                                               '_¿ä¿¡è¡__çº',
                                               '_µä¿¡ä¸___')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 'ç§»å_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END)='V'
                THEN 'TRUE'
                WHEN COALESCE(E.NAME,'_¨å_') IN ('__º¬____',
                                               'æ²³å_____',
                                               'å±±ä_____',
                                               'å±±è¥¿____',
                                               '__¥¿____',
                                               'å¤©æ´¥____',
                                               'æ±______',
                                               'ä¸_µ·____',
                                               'æµ______',
                                               'ç¦_»º____',
                                               'å¹¿ä_____',
                                               '_______')
                AND (
                        CASE
                            WHEN PP.ACCOUNTCLASS IS NULL
                            THEN 'çº¿ä_'
                            ELSE PP.ACCOUNTCLASS
                        END) IN ('çº¿ä_',
                                 '___ç»_')
                AND (
                        CASE
                            WHEN C.VMARK IS NULL
                            THEN 'V'
                            ELSE C.VMARK
                        END) IN ('V',
                                 'V-')
                THEN 'TRUE'
                ELSE 'FALSE'
            END,
            P.CUSTNAME,
            PC.PRODUCTNAME,
            S.NAME,
            P.SALESNAME,
            COALESCE(E.NAME,'_¨å_'),
            T.NAME,
            CASE
                WHEN P.VMARK IS NULL
                THEN 'V'
                ELSE P.VMARK
            END,
            P.CUSTNUM,
            CASE
                WHEN PP.ACCOUNTCLASS IS NULL
                THEN 'çº¿ä_'
                ELSE PP.ACCOUNTCLASS
            END,
            B.NAME,
            C.SIGNEDNAME,
            CASE
                WHEN PP.ACCOUNTINGTYPE IS NULL
                THEN 'çº¿ä_-__'
                ELSE PP.ACCOUNTINGTYPE
            END,
            SPC.PRODUCTNAME) tmp
WHERE
    tmp.hangyeyejishuxing = 'æ¶__è¡__çº'
AND tmp.hesuanzhonglei != '___è¡__'
GROUP BY
    tmp.SALESNAME WITH ur",reportdb_yjkh
reportprofitratedx,reportprofitratedxe,"SELECT
    COALESCE(tmp.TRXDATE, '-') || COALESCE(tmp.PRODUCTLINE, '-') || COALESCE(tmp.JIAOYILEIXING, '-') || COALESCE(tmp.PRODUCTNAME, '-') || COALESCE(tmp.CUSTOMERNUMBER, '-') || COALESCE(tmp.SIGNEDNAME, '-') AS IDNOUSE,
    tmp.TRXDATE                                         AS DATA_PERIOD,
    tmp.CUSTOMERNUMBER                                  AS MERCHANT_NUMBER,
    tmp.SIGNEDNAME                                      AS SIGNED_NAME,
    tmp.PRODUCTLINE                                             AS INDUSTRY,
    tmp.PRODUCTNAME                                              AS BASIC_PRODUCT,
    tmp.JIAOYILEIXING                                              AS JIAOYILEIXING,
    tmp.trxprofit                                       AS TRX_PROFIT,
    tmp.trxfee                                          AS TRX_FEE,
    CASE
        WHEN tmp.trxprofit != 0
        AND tmp.trxfee != 0
        THEN CAST(tmp.trxprofit AS DECIMAL(18,4)) / tmp.trxfee
        ELSE 0
    END AS PROFIT_RATE
FROM
    (
        SELECT
            t.TRXDATE,
            t.PRODUCTLINE,
            t.PRODUCTNAME,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            t.JIAOYILEIXING,
            (SUM(t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*COALESCE
            (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE(t.SHARESCALE,1)*
            COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)))
            AS trxprofit,
            (SUM(
                CASE
                    WHEN t.BIZTYPEID IN (29,129)
                    THEN (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                    ELSE (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                END)) AS trxfee
        FROM
            (
                SELECT
                    DA.TRXDATE,
                    DA.BIZTYPEID,
                    DA.TRXFEE,
                    E2C.SHARESCALE,
                    c2a.PERCENT,
                    DA.REFUNDFEE,
                    DA.ACCOUNTINGCOST,
                    DA.REFUNDFRPCOST,
                    RECEIVER.CUSTOMERNUMBER,
                    RECEIVER.SIGNEDNAME,
                    RECEIVER.PRODUCTLINE,
                    P.PRODUCTNAME,
TST.NAME AS JIAOYILEIXING
                FROM
                    DB2INST1.DAILYTRXSTAT AS DA
                LEFT JOIN
                    DB2INST1.CUSTOMERINFO AS RECEIVER
                ON
                    1=1
                AND DA.RECEIVERID=RECEIVER.ID
                LEFT JOIN
                    DB2INST1.CUSTOMERRELATIONSHIP AS E2C
                ON
                    1=1
                AND RECEIVER.ID=E2C.CUSTOMERID
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS P
                ON
                    1=1
                AND DA.PRODUCT_CODE=P.PRODUCTCODE
                AND P.PRODUCTTYPE=2
                LEFT JOIN
                    DB2INST1.customer2achievement AS c2a
                ON
                    1=1
                AND RECEIVER.customernumber=c2a.customer_number
                left join DB2INST1.TRXSTATTRXTYPE TST 
                on 1=1 and DA.TYPE=TST.ID
                WHERE
                    RECEIVER.PRODUCTLINE in ('_µä¿¡è¡__çº', 'ä¿__è¡__çº', '__è¡__çº')
                AND P.PRODUCTNAME in ('___è´¦æ_', '_±å___', 'Cç½__ä»_')
                AND DA.TRXDATE = ${START} ) t
        GROUP BY
            t.TRXDATE,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            t.PRODUCTLINE,
            t.PRODUCTNAME,
            t.JIAOYILEIXING) tmp",reportdb_yjkh
ReportProfitRateDxCWYFT,ReportProfitRateDxCWYFTe,"SELECT tmp.TRXDATE || tmp.CUSTOMERNUMBER || tmp.SIGNEDNAME AS IDNOUSE, tmp.TRXDATE AS DATA_PERIOD, tmp.CUSTOMERNUMBER AS MERCHANT_NUMBER, tmp.SIGNEDNAME AS SIGNED_NAME, '_µä¿¡è¡__çº' AS INDUSTRY, 'Cç½__ä»_' AS BASIC_PRODUCT, tmp.trxprofit AS TRX_PROFIT, tmp.trxfee AS TRX_FEE, case when tmp.trxprofit != 0 and tmp.trxfee != 0 then cast(tmp.trxprofit as Decimal(18,4)) / tmp.trxfee else 0 end AS PROFIT_RATE from ( SELECT t.TRXDATE, t.CUSTOMERNUMBER, t.SIGNEDNAME, (sum(t.TRXFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.REFUNDFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.ACCOUNTINGCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)+t.REFUNDFRPCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1))) as trxprofit, (sum(CASE WHEN t.BIZTYPEID IN (29,129) THEN (t.TRXFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.REFUNDFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.ACCOUNTINGCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)+t.REFUNDFRPCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)) ELSE (t.TRXFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.REFUNDFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)) END)) as trxfee FROM ( SELECT DA.TRXDATE, DA.BIZTYPEID, DA.TRXFEE, E2C.SHARESCALE, c2a.PERCENT, DA.REFUNDFEE, DA.ACCOUNTINGCOST, DA.REFUNDFRPCOST, RECEIVER.CUSTOMERNUMBER, RECEIVER.SIGNEDNAME FROM DB2INST1.DAILYTRXSTAT AS DA LEFT JOIN DB2INST1.CUSTOMERINFO AS RECEIVER ON 1=1 AND DA.RECEIVERID=RECEIVER.ID LEFT JOIN DB2INST1.CUSTOMERRELATIONSHIP AS E2C ON 1=1 AND RECEIVER.ID=E2C.CUSTOMERID LEFT JOIN DB2INST1.PRODUCTCODE AS P ON 1=1 AND DA.PRODUCT_CODE=P.PRODUCTCODE AND P.PRODUCTTYPE=2 LEFT JOIN DB2INST1.customer2achievement AS c2a ON 1=1 AND RECEIVER.customernumber=c2a.customer_number WHERE RECEIVER.PRODUCTLINE = '_µä¿¡è¡__çº' and P.PRODUCTNAME = 'Cç½__ä»_' and DA.TRXDATE >= current date - 1 day and DA.TRXDATE < current date ) t group by t.TRXDATE, t.CUSTOMERNUMBER, t.SIGNEDNAME ) tmp",reportdb_yjkh
ReportProfitRateBxQBZF,ReportProfitRateBxQBZFe,"SELECT tmp.TRXDATE || tmp.CUSTOMERNUMBER || tmp.SIGNEDNAME AS IDNOUSE, tmp.TRXDATE AS DATA_PERIOD, tmp.CUSTOMERNUMBER AS MERCHANT_NUMBER, tmp.SIGNEDNAME AS SIGNED_NAME, 'ä¿__è¡__çº' AS INDUSTRY, '_±å___' AS BASIC_PRODUCT, tmp.trxprofit AS TRX_PROFIT, tmp.trxfee AS TRX_FEE, case when tmp.trxprofit != 0 and tmp.trxfee != 0 then cast(tmp.trxprofit as Decimal(18,4)) / tmp.trxfee else 0 end AS PROFIT_RATE from ( SELECT t.TRXDATE, t.CUSTOMERNUMBER, t.SIGNEDNAME, (sum(t.TRXFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.REFUNDFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.ACCOUNTINGCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)+t.REFUNDFRPCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1))) as trxprofit, (sum(CASE WHEN t.BIZTYPEID IN (29,129) THEN (t.TRXFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.REFUNDFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.ACCOUNTINGCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)+t.REFUNDFRPCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)) ELSE (t.TRXFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.REFUNDFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)) END)) as trxfee FROM ( SELECT DA.TRXDATE, DA.BIZTYPEID, DA.TRXFEE, E2C.SHARESCALE, c2a.PERCENT, DA.REFUNDFEE, DA.ACCOUNTINGCOST, DA.REFUNDFRPCOST, RECEIVER.CUSTOMERNUMBER, RECEIVER.SIGNEDNAME FROM DB2INST1.DAILYTRXSTAT AS DA LEFT JOIN DB2INST1.CUSTOMERINFO AS RECEIVER ON 1=1 AND DA.RECEIVERID=RECEIVER.ID LEFT JOIN DB2INST1.CUSTOMERRELATIONSHIP AS E2C ON 1=1 AND RECEIVER.ID=E2C.CUSTOMERID LEFT JOIN DB2INST1.PRODUCTCODE AS P ON 1=1 AND DA.PRODUCT_CODE=P.PRODUCTCODE AND P.PRODUCTTYPE=2 LEFT JOIN DB2INST1.customer2achievement AS c2a ON 1=1 AND RECEIVER.customernumber=c2a.customer_number WHERE RECEIVER.PRODUCTLINE = 'ä¿__è¡__çº' and P.PRODUCTNAME = '_±å___' and DA.TRXDATE >= ${START} and DA.TRXDATE < ${STOP} ) t group by t.TRXDATE, t.CUSTOMERNUMBER, t.SIGNEDNAME ) tmp",reportdb_yjkh
ReportProfitRateBxQBZFNew,ReportProfitRateBxQBZFNewe,"SELECT tmp.TRXDATE || tmp.CUSTOMERNUMBER || tmp.SIGNEDNAME AS IDNOUSE, tmp.TRXDATE AS DATA_PERIOD, tmp.CUSTOMERNUMBER AS MERCHANT_NUMBER, tmp.SIGNEDNAME AS SIGNED_NAME, 'ä¿__è¡__çº' AS INDUSTRY, '_±å___' AS BASIC_PRODUCT, tmp.trxprofit AS TRX_PROFIT, tmp.trxfee AS TRX_FEE, case when tmp.trxprofit != 0 and tmp.trxfee != 0 then cast(tmp.trxprofit as Decimal(18,4)) / tmp.trxfee else 0 end AS PROFIT_RATE from ( SELECT t.TRXDATE, t.CUSTOMERNUMBER, t.SIGNEDNAME, (sum(t.TRXFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.REFUNDFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.ACCOUNTINGCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)+t.REFUNDFRPCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1))) as trxprofit, (sum(CASE WHEN t.BIZTYPEID IN (29,129) THEN (t.TRXFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.REFUNDFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.ACCOUNTINGCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)+t.REFUNDFRPCOST*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)) ELSE (t.TRXFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)-t.REFUNDFEE*coalesce(t.SHARESCALE,1)*coalesce(t.PERCENT,1)) END)) as trxfee FROM ( SELECT DA.TRXDATE, DA.BIZTYPEID, DA.TRXFEE, E2C.SHARESCALE, c2a.PERCENT, DA.REFUNDFEE, DA.ACCOUNTINGCOST, DA.REFUNDFRPCOST, RECEIVER.CUSTOMERNUMBER, RECEIVER.SIGNEDNAME FROM DB2INST1.DAILYTRXSTAT AS DA LEFT JOIN DB2INST1.CUSTOMERINFO AS RECEIVER ON 1=1 AND DA.RECEIVERID=RECEIVER.ID LEFT JOIN DB2INST1.CUSTOMERRELATIONSHIP AS E2C ON 1=1 AND RECEIVER.ID=E2C.CUSTOMERID LEFT JOIN DB2INST1.PRODUCTCODE AS P ON 1=1 AND DA.PRODUCT_CODE=P.PRODUCTCODE AND P.PRODUCTTYPE=2 LEFT JOIN DB2INST1.customer2achievement AS c2a ON 1=1 AND RECEIVER.customernumber=c2a.customer_number WHERE RECEIVER.PRODUCTLINE = 'ä¿__è¡__çº' and P.PRODUCTNAME = '_±å___' and DA.TRXDATE >= ${START} and DA.TRXDATE < ${STOP} ) t group by t.TRXDATE, t.CUSTOMERNUMBER, t.SIGNEDNAME ) tmp",reportdb_yjkh
customeryange,customeryangezizhi,"select c.customernumber as CUSTOMERNUMBER,cd5.DOCUMENTNUMBER as business_licence,cd5.AVAILABDATA as business_licence_AVAILABDATE,cd4.DOCUMENTNUMBER as Unified_credit_no,cd4.AVAILABDATA as  Unified_credit_no_AVAILABDATE,cd7.DOCUMENTNUMBER as organization_no,cd7.AVAILABDATA as organization_no_AVAILABDATE,cd8.DOCUMENTNUMBER as tax_regist_no,ca.auditPassTime as audit_date,c.email as email
from mobilebe.CUSTOMER c 
left join mobilebe.customerdocinfo cd4 on cd4.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd4.DOCUMENTNAME='ç»__ç¤¾ä_ä¿¡ç_ä»£ç_' 
left join mobilebe.customerdocinfo cd5 on cd5.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd5.DOCUMENTNAME='_¥ä__§ç_' 
left join mobilebe.customerdocinfo cd7 on cd7.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd7.DOCUMENTNAME='ç»___ºæ_ä»£ç_è¯' 
left join mobilebe.customerdocinfo cd8 on cd8.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd8.DOCUMENTNAME='ç¨___»èè¯' 
left join mobilebe.CustomerAptitudeAduit ca on c.id=ca.customerid
with ur",COPY2
WeeklyReportNewMerchants,WeeklyReportNewMerchantse,"SELECT
COALESCE(cu.CUSTOMERNUMBER, '-') ||  COALESCE(cu.SIGNEDNAME, '-') ||  COALESCE(e.NAME, '-') as IDNOUSE, 
DATE(${START}) + 1 DAY AS PERIOD, 
    cu.CUSTOMERNUMBER                            AS MERCHANT_NUMBER,
    cu.SIGNEDNAME                                AS SIGNED_NAME,
    cu.FULLNAME                                  AS MERCHANT_NAME,
    tg.NAME                                      AS YIJIHANGYE,
    stg.name                                     AS ERJIHANGYE,
    cu.SALESNAME                                 AS SALES_NAME,
    e.NAME                                       AS YEJISHUXING,
    cu.PRODUCTLINE                               AS HANGYEYEJISHUXING,
    cu.CREATEDATE                                AS ZHUCESHIJIAN,
    cu.AUDIT_DATE                                AS AUDIT_DATE,
    cu.VMARK                                     AS VMARK
FROM
    db2inst1.customerinfo cu
LEFT JOIN
    db2inst1.trxstatbusinesscategorie tg
ON
    cu.BUSSINESSCATID=tg.ID
LEFT JOIN
    db2inst1.TRXSTATSUBBUSINESSCATEGORIE stg
ON
    cu.SUBBUSINESSCAT=stg.CODE
LEFT JOIN
    db2inst1.CUSTOMER2ACHIEVEMENT ca
ON
    ca.CUSTOMER_NUMBER=cu.CUSTOMERNUMBER
LEFT JOIN
    db2inst1.EXISTENCE e
ON
    ca.ACHIEVEMENT_ID=e.ID
WHERE
    cu.AUDIT_DATE between date(${START}) - 6 DAY AND  ${START}
AND cu.SIGNEDNAME NOT IN
    (
        SELECT
            zm.signed_name
        FROM
            yjkh.TBL_ZZYXZB_MERCHANTS zm) WITH ur",reportdb_yjkh
ReportProfitRateDxEPOS,ReportProfitRateDxEPOSe,"SELECT
    tmp.TRXDATE || tmp.BANK_CODE AS IDNOUSE,
    tmp.TRXDATE                  AS DATA_PERIOD,
    tmp.BANK_CODE                AS BANK_CODE,
    tmp.PRODUCTLINE             AS INDUSTRY,
    tmp.PRODUCTNAME           AS BASIC_PRODUCT,
    tmp.trxprofit                AS TRX_PROFIT,
    tmp.trxfee                   AS TRX_FEE,
    CASE
        WHEN tmp.trxprofit != 0
        AND tmp.trxfee != 0
        THEN CAST(tmp.trxprofit AS DECIMAL(18,4)) / tmp.trxfee
        ELSE 0
    END AS PROFIT_RATE
FROM
    (
        SELECT
            t.TRXDATE,
            t.BANK_CODE,
                    t.PRODUCTLINE,
                    t.PRODUCTNAME,
            (SUM(t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*COALESCE
            (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE(t.SHARESCALE,1)*
            COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)))
            AS trxprofit,
            (SUM(
                CASE
                    WHEN t.BIZTYPEID IN (29,129)
                    THEN (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                    ELSE (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                END)) AS trxfee
        FROM
            (
                SELECT
                    DA.TRXDATE,
                    DA.BANK_CODE,
                    DA.BIZTYPEID,
                    DA.TRXFEE,
                    E2C.SHARESCALE,
                    c2a.PERCENT,
                    DA.REFUNDFEE,
                    DA.ACCOUNTINGCOST,
                    DA.REFUNDFRPCOST,
                    RECEIVER.CUSTOMERNUMBER,
                    RECEIVER.SIGNEDNAME,
                    RECEIVER.PRODUCTLINE,
                    P.PRODUCTNAME
                FROM
                    DB2INST1.DAILYTRXSTAT AS DA
                LEFT JOIN
                    DB2INST1.CUSTOMERINFO AS RECEIVER
                ON
                    1=1
                AND DA.RECEIVERID=RECEIVER.ID
                LEFT JOIN
                    DB2INST1.CUSTOMERRELATIONSHIP AS E2C
                ON
                    1=1
                AND RECEIVER.ID=E2C.CUSTOMERID
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS P
                ON
                    1=1
                AND DA.PRODUCT_CODE=P.PRODUCTCODE
                AND P.PRODUCTTYPE=2
                LEFT JOIN
                    DB2INST1.customer2achievement AS c2a
                ON
                    1=1
                AND RECEIVER.customernumber=c2a.customer_number
                WHERE
                    RECEIVER.PRODUCTLINE in ('_µä¿¡è¡__çº', 'ä¿__è¡__çº')
                AND P.PRODUCTNAME in ('EPOS', 'ä¸__ä»', 'POS_¶å_', 'ä¼__ç½____ï¼_2Bï¼', 'ä¸ººç½____ï¼_2Cï¼')
                AND DA.TRXDATE = ${START} ) t
        GROUP BY
            t.TRXDATE,
            t.BANK_CODE,
            t.PRODUCTLINE,
            t.PRODUCTNAME ) tmp",reportdb_read
hlmrnegativeincom,hlmrnegativeincome,"select pp2.SIGNEDNAME AS SIGNEDNAME,pp2.salesname AS SALESNAME,pp2.INCOME INCOME,pp2.NOWDATE AS NOWDATE
from (SELECT
   p.SIGNEDNAME,p.salesname,p.TRXFEE-p.ACCOUNTINGCOST AS INCOME,date(current timestamp - 1 days ) AS NOWDATE
FROM
    (SELECT RECEIVER.SIGNEDNAME, 
        EMP.NAME          AS salesname,
        SUM(DAILYTRXSTAT.TRXCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            DAILYTRXSTAT.REFUNDCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)) AS
            trxcount,
            SUM(DAILYTRXSTAT.TRXAMOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            DAILYTRXSTAT.REFUNDAMOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)) AS
            trxamount,
            SUM(
                CASE
                    WHEN DAILYTRXSTAT.BIZTYPEID IN (29,129)
                    THEN (DAILYTRXSTAT.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
                        DAILYTRXSTAT.REFUNDFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
                        DAILYTRXSTAT.ACCOUNTINGCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT
                        ,1)+DAILYTRXSTAT.REFUNDFRPCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE
                        (c2a.PERCENT,1))
                    ELSE (DAILYTRXSTAT.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
                        DAILYTRXSTAT.REFUNDFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1))
                END) AS trxfee,
            SUM(
                CASE
                    WHEN DAILYTRXSTAT.BIZTYPEID IN (29,129)
                    THEN 0
                    ELSE (DAILYTRXSTAT.ACCOUNTINGCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE
                        (c2a.PERCENT,1)-DAILYTRXSTAT.REFUNDFRPCOST*COALESCE(E2C.SHARESCALE,1)*
                        COALESCE(c2a.PERCENT,1))
                END ) AS accountingcost,
            SUM(DAILYTRXSTAT.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            DAILYTRXSTAT.REFUNDFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            DAILYTRXSTAT.ACCOUNTINGCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)+
            DAILYTRXSTAT.REFUNDFRPCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)) AS
            trxprofit
         FROM DAILYTRXSTAT
        LEFT JOIN
            TRXSTATBIZTYPE
        ON
            1=1
        AND DAILYTRXSTAT.BIZTYPEID=TRXSTATBIZTYPE.ID
        LEFT JOIN
            CUSTOMERINFO AS RECEIVER
        ON
            1=1
        AND DAILYTRXSTAT.RECEIVERID=RECEIVER.ID
        
        LEFT JOIN
            TRXSTATCUSTOMERPRODUCTLINE AS PRODUCTLINE
        ON
            1=1
        AND RECEIVER.PRODUCTLINEID=PRODUCTLINE.ID
        LEFT JOIN
            CUSTOMERRELATIONSHIP AS E2C
        ON
            1=1
        AND RECEIVER.ID=E2C.CUSTOMERID
      LEFT JOIN
            EMPLOYEEINFO AS EMP
        ON
            1=1
        AND E2C.EMPLOYEEID=EMP.ID
        LEFT JOIN
            TRXSTATBUSINESSCATEGORIE AS TB
        ON
            1=1
        AND RECEIVER.BUSSINESSCATID=TB.ID
      LEFT JOIN
            customer2achievement AS c2a
        ON
            1=1
        AND RECEIVER.customernumber=c2a.customer_number
        WHERE
        DAILYTRXSTAT.TRXDATE  between date(current timestamp - 1 days ) and date(current timestamp ) 
        AND RECEIVER.PRODUCTLINE IN ('__è¡__çº')
  
        GROUP BY
            RECEIVER.SIGNEDNAME,EMP.NAME) p ) pp2
where pp2.INCOME < 0",reportdb_read
ReportProfitRateBank,ReportProfitRateBanke,"SELECT
    tmp.TRXDATE || COALESCE(tmp.BANK_CODE, '-') || COALESCE(tmp.BANK_NAME, '-') || COALESCE(tmp.CUSTOMERNUMBER, '-') || COALESCE(tmp.PRODUCTNAME, '-') || COALESCE(tmp.PRODUCTLINE, '-') AS IDNOUSE,
    tmp.TRXDATE                AS DATA_PERIOD,
    tmp.BANK_CODE                AS BANK_CODE,
    tmp.BANK_NAME                AS BANK_NAME,
    tmp.CUSTOMERNUMBER AS MERCHANT_NUMBER,
    tmp.PRODUCTLINE             AS INDUSTRY,
    tmp.PRODUCTNAME           AS BASIC_PRODUCT,
    tmp.trxprofit                AS TRX_PROFIT,
    tmp.trxfee                   AS TRX_FEE,
    CASE
        WHEN tmp.trxprofit != 0
        AND tmp.trxfee != 0
        THEN CAST(tmp.trxprofit AS DECIMAL(18,4)) / tmp.trxfee
        ELSE 0
    END AS PROFIT_RATE
FROM
    (
        SELECT
            t.TRXDATE,
            t.BANK_CODE,
            t.CUSTOMERNUMBER,
            t.BANK_NAME,
                    t.PRODUCTLINE,
                    t.PRODUCTNAME,
            (SUM(t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*COALESCE
            (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE(t.SHARESCALE,1)*
            COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)))
            AS trxprofit,
            (SUM(
                CASE
                    WHEN t.BIZTYPEID IN (29,129)
                    THEN (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                    ELSE (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                END)) AS trxfee
        FROM
            (
                SELECT
                    DA.TRXDATE,
                    DA.BANK_CODE,
                    cbi.name AS BANK_NAME,
                    DA.BIZTYPEID,
                    DA.TRXFEE,
                    E2C.SHARESCALE,
                    c2a.PERCENT,
                    DA.REFUNDFEE,
                    DA.ACCOUNTINGCOST,
                    DA.REFUNDFRPCOST,
                    RECEIVER.CUSTOMERNUMBER,
                    RECEIVER.SIGNEDNAME,
                    RECEIVER.PRODUCTLINE,
                    P.PRODUCTNAME
                FROM
                    DB2INST1.DAILYTRXSTAT AS DA
                LEFT JOIN
                    DB2INST1.CUSTOMERINFO AS RECEIVER
                ON
                    1=1
                AND DA.RECEIVERID=RECEIVER.ID
                LEFT JOIN
                    DB2INST1.CUSTOMERRELATIONSHIP AS E2C
                ON
                    1=1
                AND RECEIVER.ID=E2C.CUSTOMERID
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS P
                ON
                    1=1
                AND DA.PRODUCT_CODE=P.PRODUCTCODE
                AND P.PRODUCTTYPE=2
                LEFT JOIN
                    DB2INST1.customer2achievement AS c2a
                ON
                    1=1
                AND RECEIVER.customernumber=c2a.customer_number
                LEFT JOIN
                    DB2INST1.cfg_bank_info cbi
                ON
                    DA.BANK_CODE=cbi.CODE
                WHERE
                    RECEIVER.PRODUCTLINE in ('_µä¿¡è¡__çº', 'ä¿__è¡__çº', '__è¡__çº')
                AND P.PRODUCTNAME in ('EPOS', 'ä¸__ä»', 'POS_¶å_', 'ä¼__ç½____ï¼_2Bï¼', 'ä¸ººç½____ï¼_2Cï¼')
                AND DA.TRXDATE = ${START}) t
        GROUP BY
            t.TRXDATE,
            t.BANK_CODE,
            t.CUSTOMERNUMBER,
            t.BANK_NAME,
            t.PRODUCTLINE,
            t.PRODUCTNAME ) tmp",reportdb_read
ReportHJSH,ReportHJSHe,"SELECT
    ${STOP}  || '-äº_____ç»´åº¦-' || tmp.MERCHANT_NAME AS IDNOUSE,
    ${STOP}                                                         AS DATA_PERIOD,
    'äº__è¡__çº'                                                              AS HANGYEYEJISHUXING,
    'MERCHANT'                                                           AS DIMENSION_TYPE,
    tmp.MERCHANT_NAME                                                    AS MERCHANT_NAME,
    MIN(tmp.YEJISHUXING)                                                 AS BRANCH_OFFICE_NAME,
    MIN(brm.REGION_NAME)                                                 AS REGION_NAME,
    MIN(tmp.SALES_NAME)                                                  AS SALES_NAME,
    SUM(tmp.PROFIT_INCREMENT)                                            AS PROFIT_INCREMENT
FROM
    (
        SELECT
            PRM1.MERCHANT_NAME AS MERCHANT_NAME,
            PRM1.YEJISHUXING,
            PRM1.SALES_NAME AS SALES_NAME,
            (PRM1.PROFIT_INCREMENT- COALESCE(MPR1.PROFIT_STOCK, 0) * (CAST(TO_CHAR(${STOP},
            'dd') AS INTEGER) - 1)) AS PROFIT_INCREMENT
        FROM
            YJKH.TBL_ZZYXZB_PROFIT_REPORT_MERCHANT PRM1
        LEFT JOIN
            YJKH.TBL_ZZYXZB_HJ_MERCHANT_PROFIT_REAL MPR1
        ON
            PRM1.MERCHANT_NAME = MPR1.MERCHANT_NAME
        WHERE
            PRM1.HANGYEYEJISHUXING = 'äº__è¡__çº'
        AND PRM1.DATA_TYPE = 'CURRENT'
        AND PRM1.DIMENSION_TYPE = 'MERCHANT'
        AND PRM1.DATA_PERIOD = ${STOP}
        UNION ALL
        SELECT
            PRM2.MERCHANT_NAME AS MERCHANT_NAME,
            PRM2.YEJISHUXING,
            PRM2.SALES_NAME AS SALES_NAME,
            (PRM2.PROFIT_INCREMENT-COALESCE(MPR2.PROFIT_STOCK, 0) * (days(last_day(date(${STOP}) - 1
            MONTH)) - days('2017-08-31'))) AS PROFIT_INCREMENT
        FROM
            YJKH.TBL_ZZYXZB_PROFIT_REPORT_MERCHANT PRM2
        LEFT JOIN
            YJKH.TBL_ZZYXZB_HJ_MERCHANT_PROFIT MPR2
        ON
            PRM2.MERCHANT_NAME = MPR2.MERCHANT_NAME
        WHERE
            PRM2.HANGYEYEJISHUXING = 'äº__è¡__çº'
        AND PRM2.DATA_PERIOD = ${STOP}
        AND PRM2.DATA_TYPE = 'HISTORY'
        AND PRM2.DIMENSION_TYPE = 'MERCHANT') tmp
LEFT JOIN
    YJKH.TBL_BRANCH_OFFICE_AND_REGION_MAPPING brm
ON
    tmp.YEJISHUXING = brm.BO_NAME
GROUP BY
    tmp.MERCHANT_NAME
ORDER BY
    SUM(tmp.PROFIT_INCREMENT) DESC",reportdb_yjkh
wtjsUnurgencyOrder,UnurgencyOrderSt,"select char(date(MCT_DATE))||char(HOUR)||DAY_TYPE||TRANSFER_TYPE||BANK_ID||CARD_TYPE||BANK_FRP||'memberOrder' as IDNOUSE,  
 MCT_DATE AS MCTDATE, HOUR AS HOUR,DAY_TYPE AS DAYTYPE, TRANSFER_TYPE AS URGENCYTYPE, BANK_ID AS BANKID, 
 CARD_TYPE AS CARDTYPE, BANK_FRP AS BANKFRP,  TOTAL_COUNT AS TOTALCOUNT, INTIME_COUNT AS INTIMECOUNT, TOTAL_AMOUNT AS 
 TOTALAMOUNT, INTIME_AMOUNT AS INTIMEAMOUNT from advance.TBL_NOURGENCY_DATA_TMP  where MCT_DATE>=${START} and MCT_DATE<${STOP} with ur
",zxdb_standby
QAErrorCodeHJ,QAErrorCodeHJe,"SELECT
            '_´æ_' || coalesce(tmp1.MERCHANT_NO, '-') || coalesce(tmp1.BANK_CODE, '-') || coalesce(tmp1.ERROR_CODE, '-') || ${START} AS IDNOUSE,
            '_´æ_' AS ORDER_TYPE,
            ${START} AS TX_DATE,
            tmp1.MERCHANT_NO AS MERCHANT_NUMBER,
            tmp1.BANK_CODE AS BANK_CODE,
            tmp1.ERROR_CODE AS ERROR_CODE,
            tmp1.ERROR_MSG AS ERROR_MSG,
            tmp1.ERROR_NUMBER AS ERROR_NUMBER,
            tmp1.TOTAL_TRADE_NUMBER AS TOTAL_TRADE_NUMBER,
            tmp1.TOTAL_ERROR_NUMBER AS TOTAL_ERROR_NUMBER,
CASE WHEN tmp1.TOTAL_TRADE_NUMBER != 0 THEN
cast(cast(tmp1.ERROR_NUMBER as Decimal(18,6)) / tmp1.TOTAL_TRADE_NUMBER * 100 as Decimal(18,4))  ELSE 0.0 END AS TRX_RATE
        FROM
            (
                SELECT
                    MAX(a1.TOTAL_NUMBER) TOTAL_TRADE_NUMBER,
                    MAX(a2.ERROR_NUMBER) TOTAL_ERROR_NUMBER,
                    a.MERCHANT_NO,
		    a.BANK_CODE,
                    a.ERROR_CODE,
                    MIN(a.ERROR_MSG)                          AS ERROR_MSG,
                    COUNT(1)                                  AS ERROR_NUMBER
                FROM
                    TZT.TZT_BINDCARD_ORDER AS a
                LEFT JOIN
                    (
                        SELECT
                            COUNT(1) TOTAL_NUMBER
                        FROM
                            TZT.TZT_BINDCARD_ORDER t1
                        WHERE
                            t1.REQUEST_TIME >= ${START} and t1.REQUEST_TIME < ${STOP}
                       ) a1
                ON 
                       1=1
                LEFT JOIN
                    (
                        SELECT
                            COUNT(1) ERROR_NUMBER
                        FROM
                            TZT.TZT_BINDCARD_ORDER t2
                        WHERE
                            t2.REQUEST_TIME >= ${START} and t2.REQUEST_TIME < ${STOP}
                        AND t2.ERROR_CODE IS NOT NULL
                        AND t2.ERROR_CODE != '' 
                       ) a2
                ON
                  1=1
                WHERE
                    a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}
                AND a.ERROR_CODE IS NOT NULL
                AND a.ERROR_CODE != ''
                GROUP BY
                    a.MERCHANT_NO,
		    a.BANK_CODE,
                    a.ERROR_CODE,
                    a.ERROR_MSG,
                    date(a.REQUEST_TIME) ) tmp1 ",tztDB
QAErrorCodeRefundHJ,QAErrorCodeRefundHJe,"SELECT
            '_æ¬' || coalesce(tmp1.MERCHANT_NO, '-') || coalesce(tmp1.ERROR_CODE, '-') || ${START} AS IDNOUSE,
            '_æ¬' AS ORDER_TYPE,
            ${START} AS TX_DATE,
            tmp1.MERCHANT_NO AS MERCHANT_NUMBER,
            tmp1.ERROR_CODE AS ERROR_CODE,
            tmp1.ERROR_MSG AS ERROR_MSG,
            tmp1.ERROR_NUMBER AS ERROR_NUMBER,
            tmp1.TOTAL_TRADE_NUMBER AS TOTAL_TRADE_NUMBER,
            tmp1.TOTAL_ERROR_NUMBER AS TOTAL_ERROR_NUMBER,
CASE WHEN tmp1.TOTAL_TRADE_NUMBER != 0 THEN
cast(cast(tmp1.ERROR_NUMBER as Decimal(18,6)) / tmp1.TOTAL_TRADE_NUMBER  as Decimal(18,4))  ELSE 0.0 END AS TRX_RATE
        FROM
            (
                SELECT
                    MAX(a1.TOTAL_NUMBER) TOTAL_TRADE_NUMBER,
                    MAX(a2.ERROR_NUMBER) TOTAL_ERROR_NUMBER,
                    a.MERCHANT_NO,
                    a.ERROR_CODE,
                    MIN(a.ERROR_MSG)                          AS ERROR_MSG,
                    COUNT(1)                                  AS ERROR_NUMBER
                FROM
                    TZT.TZT_REFUND_ORDER AS a
                LEFT JOIN
                    (
                        SELECT
                            COUNT(1) TOTAL_NUMBER
                        FROM
                            TZT.TZT_REFUND_ORDER t1
                        WHERE
                            t1.REQUEST_TIME >= ${START} and t1.REQUEST_TIME < ${STOP}
                    ) a1
                ON 
                       1=1
                LEFT JOIN
                    (
                        SELECT
                            COUNT(1) ERROR_NUMBER
                        FROM
                            TZT.TZT_REFUND_ORDER t2
                        WHERE
                            t2.REQUEST_TIME >= ${START} and t2.REQUEST_TIME < ${STOP}
                        AND t2.ERROR_CODE IS NOT NULL
                        AND t2.ERROR_CODE != '' 
                  ) a2
                ON
                    1=1
                WHERE
                    a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}
                AND a.ERROR_CODE IS NOT NULL
                AND a.ERROR_CODE != ''
                GROUP BY
                    a.MERCHANT_NO,
                    a.ERROR_CODE,
                    a.ERROR_MSG,
                    date(a.REQUEST_TIME) ) tmp1 ",tztDB
QAErrorCodePayHJ,QAErrorCodePayHJe,"SELECT
            '__' || coalesce(tmp1.MERCHANT_NO, '-') || coalesce(tmp1.BANK_CODE, '-') || coalesce(tmp1.ERROR_CODE, '-') || ${START} AS IDNOUSE,
            '__' AS ORDER_TYPE,
            ${START} AS TX_DATE,
            tmp1.MERCHANT_NO AS MERCHANT_NUMBER,
            tmp1.BANK_CODE AS BANK_CODE,
            tmp1.ERROR_CODE AS ERROR_CODE,
            tmp1.ERROR_MSG AS ERROR_MSG,
            tmp1.ERROR_NUMBER AS ERROR_NUMBER,
            tmp1.TOTAL_TRADE_NUMBER AS TOTAL_TRADE_NUMBER,
            tmp1.TOTAL_ERROR_NUMBER AS TOTAL_ERROR_NUMBER,
CASE WHEN tmp1.TOTAL_TRADE_NUMBER != 0 THEN
cast(cast(tmp1.ERROR_NUMBER as Decimal(18,6)) / tmp1.TOTAL_TRADE_NUMBER  as Decimal(18,4))  ELSE 0.0 END AS TRX_RATE
        FROM
            (
                SELECT
                    MAX(a1.TOTAL_NUMBER) TOTAL_TRADE_NUMBER,
                    MAX(a2.ERROR_NUMBER) TOTAL_ERROR_NUMBER,
                    a.MERCHANT_NO,
		    a.BANK_CODE,
                    a.ERROR_CODE,
                    MIN(a.ERROR_MSG)                          AS ERROR_MSG,
                    COUNT(1)                                  AS ERROR_NUMBER
                FROM
                    TZT.TZT_PAYMENT_ORDER AS a
                LEFT JOIN
                    (
                        SELECT
                            COUNT(1) TOTAL_NUMBER
                        FROM
                            TZT.TZT_PAYMENT_ORDER t1
                        WHERE
                            t1.REQUEST_TIME >= ${START} and t1.REQUEST_TIME < ${STOP}
) a1
                ON 
                        1=1
                LEFT JOIN
                    (
                        SELECT
                            COUNT(1) ERROR_NUMBER
                        FROM
                            TZT.TZT_PAYMENT_ORDER t2
                        WHERE
                            t2.REQUEST_TIME >= ${START} and t2.REQUEST_TIME < ${STOP}
                        AND t2.ERROR_CODE IS NOT NULL
                        AND t2.ERROR_CODE != '' 
                      ) a2
                ON
                   1=1
                WHERE
                    a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}
                AND a.ERROR_CODE IS NOT NULL
                AND a.ERROR_CODE != ''
                GROUP BY
                    a.MERCHANT_NO,
		    a.BANK_CODE,
                    a.ERROR_CODE,
                    a.ERROR_MSG,
                    date(a.REQUEST_TIME) ) tmp1 ",tztDB
QAErrorCodeWithdrawHJ,QAErrorCodeWithdrawHJe,"SELECT
            '___' || coalesce(tmp1.MERCHANT_NO, '-') || coalesce(tmp1.ERROR_CODE, '-') || ${START} AS IDNOUSE,
            '___' AS ORDER_TYPE,
            ${START} AS TX_DATE,
            tmp1.MERCHANT_NO AS MERCHANT_NUMBER,
            tmp1.ERROR_CODE AS ERROR_CODE,
            tmp1.ERROR_MSG AS ERROR_MSG,
            tmp1.ERROR_NUMBER AS ERROR_NUMBER,
            tmp1.TOTAL_TRADE_NUMBER AS TOTAL_TRADE_NUMBER,
            tmp1.TOTAL_ERROR_NUMBER AS TOTAL_ERROR_NUMBER,
CASE WHEN tmp1.TOTAL_TRADE_NUMBER != 0 THEN
cast(cast(tmp1.ERROR_NUMBER as Decimal(18,6)) / tmp1.TOTAL_TRADE_NUMBER  as Decimal(18,4))  ELSE 0.0 END AS TRX_RATE
        FROM
            (
                SELECT
                    MAX(a1.TOTAL_NUMBER) TOTAL_TRADE_NUMBER,
                    MAX(a2.ERROR_NUMBER) TOTAL_ERROR_NUMBER,
                    a.MERCHANT_NO,
                    a.ERROR_CODE,
                    MIN(a.ERROR_MSG)                          AS ERROR_MSG,
                    COUNT(1)                                  AS ERROR_NUMBER
                FROM
                    TZT.TZT_WITHDRAW_ORDER AS a
                LEFT JOIN
                    (
                        SELECT
                            COUNT(1) TOTAL_NUMBER
                        FROM
                            TZT.TZT_WITHDRAW_ORDER t1
                        WHERE
                            t1.REQUEST_TIME >= ${START} and t1.REQUEST_TIME < ${STOP}
                         ) a1
                ON 
                     1=1
                LEFT JOIN
                    (
                        SELECT
                            COUNT(1) ERROR_NUMBER
                        FROM
                            TZT.TZT_WITHDRAW_ORDER t2
                        WHERE
                            t2.REQUEST_TIME >= ${START} and t2.REQUEST_TIME < ${STOP}
                        AND t2.ERROR_CODE IS NOT NULL
                        AND t2.ERROR_CODE != '' 
                      ) a2
                ON
                  1=1
                WHERE
                    a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}
                AND a.ERROR_CODE IS NOT NULL
                AND a.ERROR_CODE != ''
                GROUP BY
                    a.MERCHANT_NO,
                    a.ERROR_CODE,
                    a.ERROR_MSG,
                    date(a.REQUEST_TIME) ) tmp1 ",tztDB
yqtcustomerInfos,yqtMerchantBaseInfos,"select PP_MERCHANT_NO as IDNOUSE ,PP_MERCHANT_NO,SINGED_NAME, CONTACTOR, BIND_MOBILE from yqtuser.tbl_merchant  with ur",yqt
yqtcustomerInfos,yqtMerchantModelInfos,"select PP_MERCHANT_NO, MODEL  from yqtuser.TBL_MERCHANT_MODEL",yqt
financedailyreport,financedailyreporte,"SELECT
    t.*,
   case when  MERCHANT_NO is null then '' else MERCHANT_NO end || case when MERCHANT_NAME is null then '' else MERCHANT_NAME end  || case when PAYMENT_BANK_NAME is null then '' else PAYMENT_BANK_NAME end || case when INDUSTRY_ATTR is null then '' else INDUSTRY_ATTR end  AS UNIQUE_NO,
     current timestamp AS VERSION_NO,
     current timestamp AS CREATE_TIME,
     current timestamp AS LAST_UPDATE_TIME
FROM
    (
        SELECT
TIMESTAMP(DA.TRXDATE,'00.00.00') AS TRANS_DATE,
RECEIVER.CUSTOMERNUMBER AS MERCHANT_NO,
RECEIVER.fullname AS MERCHANT_NAME,
cbi.name AS PAYMENT_BANK_NAME,
SUM(DA.TRXAMOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            DA.REFUNDAMOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)) AS
            AMOUNT,
SUM(DA.TRXCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            DA.REFUNDCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)) AS
            TRANS_NUM,
            SUM(
                CASE
                    WHEN DA.BIZTYPEID IN (29,129)
                    THEN (DA.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
                        DA.REFUNDFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
                        DA.ACCOUNTINGCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT
                        ,1)+DA.REFUNDFRPCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE
                        (c2a.PERCENT,1))
                    ELSE (DA.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
                        DA.REFUNDFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1))
                END) AS INCOME,
            SUM(
                CASE
                    WHEN DA.BIZTYPEID IN (29,129)
                    THEN 0
                    ELSE (DA.ACCOUNTINGCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE
                        (c2a.PERCENT,1)-DA.REFUNDFRPCOST*COALESCE(E2C.SHARESCALE,1)*
                        COALESCE(c2a.PERCENT,1))
                END ) AS COST,
            SUM(DA.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            DA.REFUNDFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            DA.ACCOUNTINGCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)+
            DA.REFUNDFRPCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)) AS
            PROFIT,
            RECEIVER.PRODUCTLINE AS INDUSTRY_ATTR
	FROM
            DB2INST1.DAILYTRXSTAT AS DA 
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE AS TRXS
        ON
            1=1
        AND DA.BIZTYPEID=TRXS.ID
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS RECEIVER
        ON
            1=1
        AND DA.RECEIVERID=RECEIVER.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS AREA
        ON
            1=1
        AND RECEIVER.AREAID=AREA.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERPRODUCTLINE AS PRODUCTLINE
        ON
            1=1
        AND RECEIVER.PRODUCTLINEID=PRODUCTLINE.ID
        LEFT JOIN
            DB2INST1.CUSTOMERRELATIONSHIP AS E2C
        ON
            1=1
        AND RECEIVER.ID=E2C.CUSTOMERID
        LEFT JOIN
            DB2INST1.EMPLOYEEINFO AS EMP
        ON
            1=1
        AND E2C.EMPLOYEEID=EMP.ID
        LEFT JOIN
            DB2INST1.PRODUCTGROUPTYPE AS PROD
        ON
            1=1
        AND RECEIVER.PRODUCTGROUP=PROD.ID
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS TRS
        ON
            1=1
        AND DA.TYPE=TRS.ID
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS TB
        ON
            1=1
        AND RECEIVER.BUSSINESSCATID=TB.ID
        LEFT JOIN
            DB2INST1.TRXSTATCUSTOMERAREA AS BRA
        ON
            1=1
        AND EMP.BRANCHCOMPANY=BRA.AREAID
        LEFT JOIN
            DB2INST1.TRXSTATACCMARK AS acc
        ON
            1=1
        AND RECEIVER.ACCMARK=acc.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P
        ON
            1=1
        AND DA.PRODUCT_CODE=P.PRODUCTCODE
        AND P.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS P1
        ON
            1=1
        AND DA.SALES_PRODUCT_CODE=P1.PRODUCTCODE
        AND P1.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.TRXSTATBIZTYPE_PROFILE AS BP
        ON
            1=1
        AND DA.BIZTYPEID=BP.BIZTYPEID
        LEFT JOIN
            DB2INST1.productcode_profile AS PP
        ON
            1=1
        AND DA.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        AND DA.PRODUCT_CODE=PP.PRODUCT_CODE
        LEFT JOIN
            DB2INST1.frpchannel AS fc
        ON
            1=1
        AND DA.trxchannelid=fc.trxchannelid
        LEFT JOIN
            DB2INST1.customer2achievement AS c2a
        ON
            1=1
        AND RECEIVER.customernumber=c2a.customer_number
        LEFT JOIN
            DB2INST1.EXISTENCE AS ex
        ON
            1=1
        AND c2a.ACHIEVEMENT_ID=ex.ID
        AND ex.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS tsg
        ON
            1=1
        AND RECEIVER.SUBBUSINESSCAT=tsg.CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE2PRODUCTGROUP AS p2pg
        ON
            1=1
        AND DA.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE
        AND DA.PRODUCT_CODE=p2pg.PRODUCT_CODE
      left join DB2INST1.cfg_bank_info cbi 
      on DA.BANK_CODE=cbi.CODE
        WHERE
            1=1
           AND RECEIVER.PRODUCTLINE='äº__è¡__çº'
           AND P1.PRODUCTNAME IN('____','____(_)')
           AND P.PRODUCTNAME IN('ä¸__ä»','____')
           AND DA.TRXDATE >= ${START} AND DA.TRXDATE< ${STOP}
       group by DA.TRXDATE,RECEIVER.CUSTOMERNUMBER,RECEIVER.fullname,RECEIVER.PRODUCTLINE,cbi.name
           ) t",reportdb_yjkh
QAMissRate,QAMissRatee,"SELECT
    ${START} || TRADE_INTERFACE || YEEPAY_MERCHANT_NO || BANKID AS IDNOUSE,
    ${START}                                                      AS DATA_PERIOD,
    COUNTTBL.TRADE_INTERFACE                                                  AS TRADE_INTERFACE,
    COUNTTBL.YEEPAY_MERCHANT_NO                                                  AS MERCHANT_NUMBER,
    COUNTTBL.BANKID                                                                    AS BANKID,
    ROUND(CAST((COUNTTBL.TOTALNUM-COUNTTBL.NORMALNUM) AS DOUBLE)/COUNTTBL.TOTALNUM, 5) AS
                          MISSING_ORDER_RATE,
    COUNTTBL.NORMALNUM AS NORMAL_NUMBER,
    COUNTTBL.TOTALNUM  AS ORDER_NUMBER
FROM
    (
        SELECT
            TRADE_INTERFACE,
            YEEPAY_MERCHANT_NO,
            BANKID,
            SUM(
                CASE
                    WHEN DRIVE_TYPE ='NORMAL'
                    THEN 1
                    ELSE 0
                END) AS NORMALNUM,
            SUM(1)   AS TOTALNUM
        FROM
            BANK.TBL_BANK_NOCARD_ORDER
        WHERE
            REQUEST_TYPE='PAY'
        AND BASIC_PRODUCT_CODE = '3011001005002'
        AND RETAIL_PRODUCT_CODE = '3011004001005A'
        AND CREATE_TIME BETWEEN ${START} AND ${STOP}
        GROUP BY
            TRADE_INTERFACE,
            YEEPAY_MERCHANT_NO,
            BANKID ) COUNTTBL WITH UR",cashier_bank_standby
QATimeCostHJ,QATimeCostHJe,"select '__'||coalesce(tmp.MERCHANT_NO, '-')||tmp.REQUEST_TIME||coalesce(tmp.BANK_CODE, '-') AS IDNOUSE, '__' AS ORDER_TYPE, tmp.MERCHANT_NO AS MERCHANT_NUMBER, tmp.REQUEST_TIME AS TX_DATE, tmp.BANK_CODE AS BANK_CODE, avg(tc) AS TIME_COST from (
SELECT a.MERCHANT_NO, date(a.REQUEST_TIME) REQUEST_TIME, a.BANK_CODE,
 BIGINT((a.PAY_FINISH_TIME - a.CREATE_TIME)*1000) tc
FROM
    TZT.TZT_PAYMENT_ORDER AS a where a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}) tmp
GROUP BY tmp.MERCHANT_NO, tmp.REQUEST_TIME, tmp.BANK_CODE",INNO_STANBY
QASuccRateHJ,QASuccRateHJe,"select '_´æ_'||'äº__'|| date(a.REQUEST_TIME) || coalesce(a.MERCHANT_NO, '-') || coalesce(a.BANK_CODE, '-') AS IDNOUSE, 'auth' AS ORDER_TYPE, 'äº__è¡__çº' AS INDUSTRY, a.MERCHANT_NO AS MERCHANT_NUMBER, a.BANK_CODE AS BANK_CODE, date(a.REQUEST_TIME) AS TX_DATE, 
count(1) AS TOTAL_TRADE_NUMBER, count(case when a.status = 'BIND_SUCCESS' then 1 else null end) AS SUCCESS_TRADE_NUMBER
from TZT.TZT_BINDCARD_ORDER as a
where a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}
group by a.MERCHANT_NO, a.BANK_CODE, date(a.REQUEST_TIME)
union all
select '__'||'äº__'|| date(a.REQUEST_TIME) || coalesce(a.MERCHANT_NO, '-') || coalesce(a.BANK_CODE, '-') AS IDNOUSE, 'pay' AS ORDER_TYPE, 'äº__è¡__çº' AS INDUSTRY, a.MERCHANT_NO AS MERCHANT_NUMBER, a.BANK_CODE AS BANK_CODE, date(a.REQUEST_TIME) AS TX_DATE, 
count(1) AS TOTAL_TRADE_NUMBER, count(case when a.status = 'PAY_SUCCESS' then 1 else null end) AS SUCCESS_TRADE_NUMBER
from TZT.TZT_PAYMENT_ORDER as a
where a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}
group by a.MERCHANT_NO, a.BANK_CODE, date(a.REQUEST_TIME)
union all
select '___'||'äº__'|| date(a.REQUEST_TIME) || coalesce(a.MERCHANT_NO, '-') || coalesce(a.RECIPIENT_BANK_CODE, '-') AS IDNOUSE, 'withdraw' AS ORDER_TYPE, 'äº__è¡__çº' AS INDUSTRY, a.MERCHANT_NO AS MERCHANT_NUMBER, a.RECIPIENT_BANK_CODE AS BANK_CODE, date(a.REQUEST_TIME) AS TX_DATE, 
count(1) AS TOTAL_TRADE_NUMBER, count(case when a.status = 'WITHDRAW_SUCCESS' then 1 else null end) AS SUCCESS_TRADE_NUMBER
from TZT.TZT_WITHDRAW_ORDER as a
where a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}
group by a.MERCHANT_NO, a.RECIPIENT_BANK_CODE, date(a.REQUEST_TIME)
union all
select '_æ¬'||'äº__'|| date(a.REQUEST_TIME) || coalesce(a.MERCHANT_NO, '-') || coalesce(a.BANK_CODE, '-') AS IDNOUSE, 'refund' AS ORDER_TYPE, 'äº__è¡__çº' AS INDUSTRY, a.MERCHANT_NO AS MERCHANT_NUMBER, a.BANK_CODE AS BANK_CODE, date(a.REQUEST_TIME) AS TX_DATE, 
count(1) AS TOTAL_TRADE_NUMBER, count(case when a.status = 'REFUND_SUCCESS' then 1 else null end) AS SUCCESS_TRADE_NUMBER
from TZT.TZT_NEW_REFUND_ORDER as a
where a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}
group by a.MERCHANT_NO, a.BANK_CODE, date(a.REQUEST_TIME)
union all
select 'æ¸__'||'äº__'|| date(a.REQUEST_TIME) || coalesce(a.MERCHANT_NO, '-') || coalesce(a.BANK_CODE, '-') AS IDNOUSE, 'settle' AS ORDER_TYPE, 'äº__è¡__çº' AS INDUSTRY, a.MERCHANT_NO AS MERCHANT_NUMBER, a.BANK_CODE AS BANK_CODE, date(a.REQUEST_TIME) AS TX_DATE, 
count(case when a.status = 'PAY_SUCCESS' then 1 else null end) AS TOTAL_TRADE_NUMBER, count(case when a.status = 'PAY_SUCCESS' and a.FEE_DEAL_TIME >= a.REQUEST_TIME then 1 else null end) AS SUCCESS_TRADE_NUMBER
from TZT.TZT_PAYMENT_ORDER as a
where a.REQUEST_TIME >= ${START} and a.REQUEST_TIME < ${STOP}
group by a.MERCHANT_NO, a.BANK_CODE, date(a.REQUEST_TIME)",INNO_STANBY
16Merchant,16Merchante,"SELECT
    cu.CUSTOMERNUMBER || cu.SIGNEDNAME || e.NAME || AUDIT_DATE as IDNOUSE, 
    cu.CUSTOMERNUMBER                            AS MERCHANT_NUMBER,
    cu.SIGNEDNAME                                AS SIGNED_NAME,
    cu.FULLNAME                                  AS MERCHANT_NAME,
    tg.NAME                                      AS YIJIHANGYE,
    stg.name                                     AS ERJIHANGYE,
    cu.SALESNAME                                 AS SALES_NAME,
    e.NAME                                       AS YEJISHUXING,
    cu.PRODUCTLINE                               AS HANGYEYEJISHUXING,
    cu.CREATEDATE                                AS ZHUCESHIJIAN,
    cu.AUDIT_DATE                                AS AUDIT_DATE,
    cu.VMARK                                     AS VMARK
FROM
    db2inst1.customerinfo cu
LEFT JOIN
    db2inst1.trxstatbusinesscategorie tg
ON
    cu.BUSSINESSCATID=tg.ID
LEFT JOIN
    db2inst1.TRXSTATSUBBUSINESSCATEGORIE stg
ON
    cu.SUBBUSINESSCAT=stg.CODE
LEFT JOIN
    db2inst1.CUSTOMER2ACHIEVEMENT ca
ON
    ca.CUSTOMER_NUMBER=cu.CUSTOMERNUMBER
LEFT JOIN
    db2inst1.EXISTENCE e
ON
    ca.ACHIEVEMENT_ID=e.ID
WHERE
    cu.AUDIT_DATE  BETWEEN '2012-01-01' AND current date
WITH ur",reportdb_yjkh
yqtmerchantInfos,yqtmerchantInfos,"select m. PP_MERCHANT_NO ,md.role,md.model,m. SINGED_NAME MERCHANT_NAME,m.status,m. BIND_MOBILE,
m.LEGAL_PERSON,m.CONTACTOR,m.PROVINCE,m.CITY,
md.BRANCH_NO,md.SUBBANK_NO,md.BANK_NO,m.create_time,md.PARENT_PP_MER_NO
from yqtuser.TBL_MERCHANT m
left join yqtuser.TBL_MERCHANT_MODEL md on md.pp_merchant_no = m.pp_merchant_no
where  md.role in ('AGENT','MERCHANT')",yqt
yqtTradeDailyStat,yqtTradeDailyStat,"select 
char(date(o.CREATE_TIME))||o.PP_MERCHANT_NO||md.model||md.BANK_NO ||o.PAY_TOOL||o.SCENE_TYPE  AS IDNOUSE,
date(o.CREATE_TIME) trxDate,o.PP_MERCHANT_NO,md.model,md.BANK_NO,o.PAY_TOOL, o.SCENE_TYPE,md.PARENT_PP_MER_NO ,count(*) cnt,sum(o.ORDER_AMOUNT) sumamount
from yqtorder.TBL_TRX_ORDER  o
left join yqtuser.tbl_merchant_model  md on md.pp_merchant_no = o.pp_merchant_no
where 1=1
and o.CREATE_TIME  >=${START} 
and o.CREATE_TIME  <${STOP}
and o.status = 'SUCCESS'
group by date(o.CREATE_TIME),o.PP_MERCHANT_NO,md.model,md.PARENT_PP_MER_NO,md.BANK_NO,o.PAY_TOOL, o.SCENE_TYPE",yqt
yqtMerchantExpandStat,yqtMerchantExpandStat,"select char(EXPAND_DATE)||bank_no||model as IDNOUSE,EXPAND_DATE,bank_no,model,jinjian_cnt,tongguo_cnt
 from (
select 
case when shenhetongguo.date1 is not null then shenhetongguo.date1 else  ruwangjinjian.date2  end as EXPAND_DATE,
case when shenhetongguo.BANK_NO is not null then shenhetongguo.BANK_NO else ruwangjinjian.bank_no end as bank_no ,
case when shenhetongguo.model is not null then shenhetongguo.model else ruwangjinjian.OP_TYPE end as model,
ruwangjinjian.cnt as jinjian_cnt,shenhetongguo.cnt as tongguo_cnt from (
select 
date (md. CREATE_TIME ) date1,md. BANK_NO ,
case
 when md.model = 'AGENT' then 'ä»£ç__'
when md.model = 'AGENT_MERCHANT' then 'ä»£ç_______'
when md.model = 'CHAIN' then 'è¿___»å_'
when md.model = 'CHAIN_MERCHANT' then 'è¿__å­__åº'
when md.model = 'DIRECT_MERCHANT' then '_´é____'
else md.model
end as  model
,count(*) cnt from yqtuser.tbl_merchant m
left join yqtuser.tbl_merchant_model md on m. PP_MERCHANT_NO = md. PP_MERCHANT_NO
where 1=1
AND md. CREATE_TIME >=${START}
AND md. CREATE_TIME <${STOP}
and  md.role in ('AGENT','MERCHANT')
group by date (md. CREATE_TIME ),md.bank_no,md.model
order by BANK_NO ,model
)  shenhetongguo  FULL join (
select date (op. CREATE_TIME ) date2,BANK_NO ,
case when OP_TYPE ='AGENT_MERCHANT_REGISTER' then 'ä»£ç_______' 
when OP_TYPE='AGENT_REGISTER' then 'ä»£ç__' 
when OP_TYPE='CHAIN_HEAD_REGISTER' then 'è¿___»å_' 
when OP_TYPE='CHAIN_REGISTER' then 'è¿__å­__åº' 
when OP_TYPE='MERCHANT_REGISTER' then '_´é____' 
else OP_TYPE end as OP_TYPE
,count (*) cnt from yqtuser.tbl_MERCHANT_OP op 
left join yqtuser.tbl_MERCHANT_MODEL md on( md.ROLE = 'BRANCH' AND  md.PP_MERCHANT_NO = op. BRANCH_CODE)
where 1=1
and op.OP_TYPE in ('AGENT_MERCHANT_REGISTER','AGENT_REGISTER','CHAIN_HEAD_REGISTER','CHAIN_REGISTER','MERCHANT_REGISTER') 
and op.OP_STATUS in ('DEALING','CLOSE','SUCCESS') 
and op.CREATE_TIME>=${START}
and op.CREATE_TIME<${STOP}
group by date (op. CREATE_TIME ),BANK_NO ,OP_TYPE
order by BANK_NO
) ruwangjinjian on ( shenhetongguo.date1 = ruwangjinjian.date2 and shenhetongguo.BANK_NO = ruwangjinjian.bank_no 
and shenhetongguo.model = ruwangjinjian.OP_TYPE) 
order by shenhetongguo.date1
) where bank_no is not null


",yqt
customeryange,netagentyange,"select customer_num as CUSTOMERNUMBER,num as AGENTCODE,name as AGENTNAME,'NET' as AGENTTYPE from agentfr.tbl_agency_relation ar left join agentfr.tbl_agent a on a.id = ar.agent_id where ar.state='ENABLE' and a.agency_state!='STOP' and customer_num is not null with ur",agentfr
agentreport4airtravel,agentreport4airtravele,"SELECT A.NUM AS AGENT_NO,
A.NAME AS AGENT_NAME,
A.SALES_NAME AS SALES_NAME,
PR.PROFIT_RATIO PROFIT_PERCENT_SIGNED,
PR.COST_RATIO AS AGENT_FEE,
A.SALES_EMAIL AS SALES_EMAIL,
case PF.FORMULA
  when '#trxIncomeTotalAmount  * #profitRatio' then '___å­___·æ__*_ºå_æ¯__ï¼'
  when '#trxIncomeTotalAmount * #profitRatio' then '___å­___·æ__*_ºå_æ¯__ï¼'
  when '#trxIncomeTotalAmount - (#trxTotalAmount * #costRatio)' then '___å­___·æ__-å­___·äº¤__*_ºå_æ¯_____ï¼'
  when '#trxTotalAmount  * #profitRatio' then '___å­___·äº¤__ï¼______æ¬¾é_é¢__* __¶¦æ¯__'
  when '#trxTotalAmount * #profitRatio' then '___å­___·äº¤__ï¼______æ¬¾é_é¢__* __¶¦æ¯__'
  when '#trxTotalAmount*#profitRatio' then '___å­___·äº¤__ï¼______æ¬¾é_é¢__* __¶¦æ¯__'
  when '#trxTotalAmount*#signRatio + #signFixedValue-#costFixedValue' then '___å­___·æ__*_ºå_æ¯__ï¼'
  when '#trxTotalNum * #profitRatio' then '_(äº¤æ__»ç__°ï__æ¬¾æ»ç__°ï_*__¶¦æ¯__'
  when '#trxTotalNum < 1 ? 0 : (#trxIncomeTotalAmount - (#trxTotalNum * #costRatio))' then '_______¶å_ï¼(äº¤æ__»ç__°ï__æ¬¾æ»ç__°ï_*___è´¹ç_'
  when '(#trxIncomeTotalAmount-#trxTotalAmount*#costRatio)*#profitRatio' then '___å­___·æ__¥ï_äº¤æ___*___è´¹ç_ï¼*__¶¦æ¯__'
  when '(#trxIncomeTotalAmount-(#trxTotalAmount*#costRatio))*#profitRatio' then '___å­___·æ__¥ï_äº¤æ___*___è´¹ç_ï¼*__¶¦æ¯__'
else PF.FORMULA end AS PROFIT_EXPRESSION,
MC.CALC_FORMULA_MEMO AS NEW_PROFIT_EXPRESSION,
D.CUSTOMER_NUM AS CUSTOMER_NO,D.CUSTOMER_NAME AS CUSTOMER_NAME,
BT.BIZ_TYPE_NAME AS PROFIT_BIZ,D.SALE_PRODUCT_NAME AS ACCOUNTING_PRODUCT,R.PROFIT_YEAR AS PROFIT_YEAR,R.PROFIT_MONTH AS PROFIT_MONTH,
D.PROFIT_AMOUNT AS PROFIT_AMOUNT,
case A.PRODUCTION_LINE
  when 'salesCenter' then '__¸­å¿'
  when 'airTravel' then '__è¡__çº'
when 'digital' then '_°å_çº'
when 'education' then '___è¡__çº'
when 'productCenter' then 'äº§å_ä¸_'
when 'telecommunication' then '_µä¿¡è¡__çº'
else A.PRODUCTION_LINE end
AS PRODUCTLINE,D.TRX_START_DATE AS START_TIME,D.TRX_END_DATE AS END_TIME,
D.TRX_TOTAL_AMOUNT AS TRX_AMOUNT,
D.TRX_TOTAL_NUM AS TRX_COUNT,
D.TRX_INCOME_TOTAL_AMOUNT AS INCOME,
case D.PROFIT_TYPE
  when 'NORMAL' then 'æ­£å¸¸'
  when 'SUPPLEMENT' then 'è¡¥è_'
else D.PROFIT_TYPE end
AS PROFIT_TYPE,
D.DESCRIPTION AS PROFIT_DESCRITION,
case A.TYPE
  when 'RESOURCES' then 'èµ___'
  when 'ADVISER' then 'é¡¾é__'
  when 'RESOURCES_SD' then 'èµ___-_£æ_ä¸__'
  when 'RESOURCES_O2O' then '____-O2Oè¡__çº'
  when 'STRATEGY_HJ' then '____-äº__è¡__çº'
  when 'STRATEGY_XJ' then '____-æ¶__è¡__çº'
else A.TYPE end
AS AGENT_TYPE,
DC.ADJUST_AMOUNT AS ADJUST_AMOUNT
FROM TBL_PROFIT_RECORD R
LEFT JOIN TBL_PROFIT_DETAIL D 
ON R.ID=D.PROFIT_RECORD_ID
LEFT JOIN TBL_AGENT A ON D.AGENT_ID=A.ID
LEFT JOIN TBL_PROFIT_RULE PR ON D.BIZ_TYPE=PR.BIZ_TYPE AND D.AGENT_ID=PR.AGENT_ID 
LEFT JOIN TBL_PROFIT_FORMULA PF ON PR.BIZ_TYPE=PF.BIZ_TYPE AND PR.PROFIT_MODEL=PF.PROFIT_MODEL
LEFT JOIN TBL_ADJUST_RECORD AR ON D.AGENT_ID=AR.AGENT_ID AND D.BIZ_TYPE=AR.BIZ_TYPE  AND 
CONCAT(CONCAT(R.PROFIT_YEAR,'-'),
CASE LENGTH(R.PROFIT_MONTH) WHEN 1 THEN '0'||R.PROFIT_MONTH
ELSE R.PROFIT_MONTH END)=AR.FINISH_YEAR_MONTH
LEFT JOIN TBL_ADJUST_DETAIL_CUS DC ON AR.ID=DC.ADJUST_RECORD_ID AND D.CUSTOMER_NUM=DC.CUSTOMER_NUM
LEFT JOIN TBL_BIZ_TYPE BT ON D.BIZ_TYPE=BT.BIZ_TYPE_NUM
LEFT JOIN TBL_PROFIT_MODEL_CONFIG MC ON PR.PROFIT_MODEL_NEW=MC.PROFIT_MODEL
WHERE R.PROFIT_YEAR='2017' AND R.PROFIT_MONTH='10' AND R.PROFIT_CONFIRM_STATE='CALCULATED' and A.PRODUCTION_LINE NOT IN ('digital','telecommunication','airTravel') AND PR.STATE='ENABLE'
AND D.STATUS='ACTIVE'",agentfr_standby
ReportHJSuccRate,ReportHJSuccRatee,"select 
t.TX_DATE || coalesce(t.MERCHANT_NUMBER, '-') || coalesce(t.BANK_CODE, '-') || ORDER_TYPE AS IDNOUSE,
t.TX_DATE AS TRANS_DATE, t.MERCHANT_NUMBER AS MERCHANT_NO, cu.FULLNAME AS MERCHANT_NAME, stg.name INDUSTRY_TYPE,
case when bi.BANK_NAME is not null then bi.BANK_NAME else t.BANK_CODE end AS BANK_NAME,
t.ORDER_TYPE AS ORDER_TYPE, t.TOTAL_TRADE_NUMBER AS TRANS_NUM, t.SUCCESS_TRADE_NUMBER AS SUCCESS_NUM
from YJKH.TBL_QUALITY_ANALYSIS_SUCCESS_RATE t
left join db2inst1.customerinfo cu on t.MERCHANT_NUMBER = cu.CUSTOMERNUMBER
left join db2inst1.TRXSTATSUBBUSINESSCATEGORIE stg on cu.SUBBUSINESSCAT = stg.CODE
left join YJKH.TBL_BANK_INFO bi on t.BANK_CODE = bi.BANK_CODE
where t.TX_DATE = ${START}",reportdb_yjkh
eposBaseDataValue,eposBaseDataValue,"select
COALESCE(CHAR(RECEIVER.FULLNAME),'null')||COALESCE(CHAR(DATE(DAILYTRXSTAT.TRXDATE)),'null')||COALESCE(CHAR(EMP.NAME),'null')||coalesce(char(DAILYTRXSTAT.TRXCHANNELID),'null')||coalesce(char(ex.NAME),'null')||coalesce(char(fc.bankname),'null')||coalesce(char(RECEIVER.CUSTOMERNUMBER),'null')||coalesce(char(TRXSTATBIZTYPE.DISPLAYNAME),'null')||coalesce(char(TRXSTATTRXTYPE.NAME),'null')||coalesce(char(DAILYTRXSTAT.ORDERTYPE),'null')||coalesce(char(fc.channelname),'null')||coalesce(char(DAILYTRXSTAT.MONTH),'null')||coalesce(char(pe.NAME),'null')||coalesce(char(tsg.NAME),'null')||coalesce(char(payer.SIGNEDNAME),'null')||coalesce(char(payer.CUSTOMERNUMBER),'null')||coalesce(char(TB.NAME),'null')||coalesce(char(RECEIVER.SIGNEDNAME),'null')||coalesce(char(payer.FULLNAME),'null') as IDNOUSE,
sum(DAILYTRXSTAT.TRXCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as trx_count,
sum(DAILYTRXSTAT.TRXAMOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.REFUNDAMOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as net_amount,
sum(DAILYTRXSTAT.TRXAMOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as trx_amount,
sum(DAILYTRXSTAT.REFUNDCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as refund_count,
sum(DAILYTRXSTAT.TRXFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.REFUNDFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.ACCOUNTINGCOST*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)+DAILYTRXSTAT.REFUNDFRPCOST*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as net_profit,
sum(DAILYTRXSTAT.REFUNDAMOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as refund_amount,
sum(CASE WHEN DAILYTRXSTAT.BIZTYPEID IN (29,129) THEN (DAILYTRXSTAT.TRXFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.REFUNDFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.ACCOUNTINGCOST*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)+DAILYTRXSTAT.REFUNDFRPCOST*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) ELSE (DAILYTRXSTAT.TRXFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.REFUNDFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) END) as net_income,
sum(DAILYTRXSTAT.TRXSOURCEFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as  payer_income,
sum(DAILYTRXSTAT.WHOLEORDERCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as all_trx_count,
sum(DAILYTRXSTAT.TRXCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.REFUNDCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as net_trx_count,
DAILYTRXSTAT.TRXDATE as trx_date,
RECEIVER.FULLNAME as customer_name,
EMP.NAME as saler_name,
DAILYTRXSTAT.TRXCHANNELID as trx_channel_id,
ex.NAME as achievement_type,
fc.bankname as bank_name,
RECEIVER.CUSTOMERNUMBER as customer_number,
(case when TRXSTATBIZTYPE.DISPLAYNAME = 'ä¼____' and (DAILYTRXSTAT.ORDERTYPE='DEBIT_PAYER' or DAILYTRXSTAT.ORDERTYPE='DEBIT_RECEIVER') then '___åº' ELSE TRXSTATBIZTYPE.DISPLAYNAME end) as bussiness_type,
TRXSTATTRXTYPE.NAME as trx_name,
DAILYTRXSTAT.ORDERTYPE as order_type,
fc.channelname as channel_name,
DAILYTRXSTAT.MONTH as trx_month,
pe.NAME as payer_saler_name,
tsg.NAME as second_level_product,
payer.SIGNEDNAME as payer_singedname,
payer.CUSTOMERNUMBER as payer_number,
RECEIVER.SIGNEDNAME as customer_singedname,
payer.FULLNAME as payer_name,
(sum(DAILYTRXSTAT.WHOLEORDERCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1))-sum(DAILYTRXSTAT.TRXCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1))) as fail_trx_count,
(sum(DAILYTRXSTAT.TRXCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1))/
case when sum(DAILYTRXSTAT.WHOLEORDERCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1))=0 then 1 else sum(DAILYTRXSTAT.WHOLEORDERCOUNT*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) end) as success_rate,
(sum(CASE WHEN DAILYTRXSTAT.BIZTYPEID IN (29,129) THEN (DAILYTRXSTAT.TRXFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.REFUNDFEE*coalesce(E2C.				SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.ACCOUNTINGCOST*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)+DAILYTRXSTAT.REFUNDFRPCOST*coalesce(E2C.						SHARESCALE,1)*coalesce(c2a.PERCENT,1)) ELSE (DAILYTRXSTAT.TRXFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.REFUNDFEE*coalesce(E2C.						SHARESCALE,1)*coalesce(c2a.PERCENT,1)) END)-sum(DAILYTRXSTAT.TRXFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-DAILYTRXSTAT.REFUNDFEE*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)-              DAILYTRXSTAT.				ACCOUNTINGCOST*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1)+DAILYTRXSTAT.REFUNDFRPCOST*coalesce(E2C.SHARESCALE,1)*coalesce(c2a.PERCENT,1))) as cost
from DAILYTRXSTAT
left join TRXSTATBIZTYPE on 1=1 and DAILYTRXSTAT.BIZTYPEID=TRXSTATBIZTYPE.ID 
left join CUSTOMERINFO AS RECEIVER on 1=1 and DAILYTRXSTAT.RECEIVERID=RECEIVER.ID 
left join TRXSTATCUSTOMERAREA AS AREA on 1=1 and RECEIVER.AREAID=AREA.ID 
left join TRXSTATCUSTOMERPRODUCTLINE AS PRODUCTLINE on 1=1 and RECEIVER.PRODUCTLINEID=PRODUCTLINE.ID 
left join CUSTOMERRELATIONSHIP AS E2C on 1=1 and RECEIVER.ID=E2C.CUSTOMERID 
left join EMPLOYEEINFO AS EMP on 1=1 and E2C.EMPLOYEEID=EMP.ID 
left join PRODUCTGROUPTYPE on 1=1 and RECEIVER.PRODUCTGROUP=PRODUCTGROUPTYPE.ID 
left join TRXSTATTRXTYPE on 1=1 and DAILYTRXSTAT.TYPE=TRXSTATTRXTYPE.ID 
left join TRXSTATBUSINESSCATEGORIE AS TB on 1=1 and RECEIVER.BUSSINESSCATID=TB.ID 
left join TRXSTATCUSTOMERAREA AS BRA on 1=1 and EMP.BRANCHCOMPANY=BRA.AREAID 
left join TRXSTATACCMARK AS acc on 1=1 and RECEIVER.ACCMARK=acc.CODE 
left join PRODUCTCODE AS P on 1=1 and DAILYTRXSTAT.PRODUCT_CODE=P.PRODUCTCODE and P.PRODUCTTYPE=2 
left join PRODUCTCODE AS P1 on 1=1 and DAILYTRXSTAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE and P1.PRODUCTTYPE=1 
left join TRXSTATBIZTYPE_PROFILE AS BP on 1=1 and DAILYTRXSTAT.BIZTYPEID=BP.BIZTYPEID 
left join productcode_profile AS PP on 1=1 and DAILYTRXSTAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE and DAILYTRXSTAT.PRODUCT_CODE=PP.PRODUCT_CODE 
left join frpchannel AS fc on 1=1 and DAILYTRXSTAT.trxchannelid=fc.trxchannelid 
left join customer2achievement AS c2a on 1=1 and RECEIVER.customernumber=c2a.customer_number 
left join EXISTENCE AS ex on 1=1 and c2a.ACHIEVEMENT_ID=ex.ID and ex.CLASSTYPE='Department' 
left join TRXSTATSUBBUSINESSCATEGORIE AS tsg on 1=1 and RECEIVER.SUBBUSINESSCAT=tsg.CODE 
left join PRODUCTCODE2PRODUCTGROUP AS p2pg on 1=1 and DAILYTRXSTAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE and DAILYTRXSTAT.PRODUCT_CODE=p2pg.PRODUCT_CODE 
left join cfg_bank_info AS cbi on 1=1 and DAILYTRXSTAT.BANK_CODE=cbi.CODE 
left join CUSTOMERRELATIONSHIP AS pr on 1=1 and DAILYTRXSTAT.PAYERID=pr.CUSTOMERID 
left join EMPLOYEEINFO AS pe on 1=1 and pr.EMPLOYEEID=pe.ID 
left join CUSTOMERINFO AS payer on 1=1 and DAILYTRXSTAT.PAYERID=payer.ID 
where 1=1 
and RECEIVER.PRODUCTLINE in ('__äº___','__è¡__çº')
and DAILYTRXSTAT.TRXDATE>=${START} and DAILYTRXSTAT.TRXDATE<${STOP}
group by
DAILYTRXSTAT.TRXDATE,
RECEIVER.FULLNAME,
EMP.NAME,
DAILYTRXSTAT.TRXCHANNELID,
ex.NAME,
fc.bankname,
RECEIVER.CUSTOMERNUMBER,
TRXSTATBIZTYPE.DISPLAYNAME,
TRXSTATTRXTYPE.NAME,
DAILYTRXSTAT.ORDERTYPE,
fc.channelname,
DAILYTRXSTAT.MONTH,
pe.NAME,
tsg.NAME,
payer.SIGNEDNAME,
payer.CUSTOMERNUMBER,
TB.NAME,
RECEIVER.SIGNEDNAME,
payer.FULLNAME",reportdb_read
paperordertzttrx,tzttrxpay,"select  
   COALESCE(CHAR(t.BIZ_SYSTEM_CODE),'null')||
   COALESCE(CHAR(date(t.LAST_UPDATE_TIME)),'null')||
   COALESCE(CHAR(t.MERCHANT_NO),'null')||
   COALESCE(CHAR(t.BANK_CODE),'null')||
   COALESCE(CHAR((CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END)),'null')||
   COALESCE(CHAR((CASE WHEN t.PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE  t.PAY_TOOL_TYPE END)),'null')||
   COALESCE(CHAR((CASE WHEN c.CHARGE_MODE='realTimeDue' THEN 'å®__' WHEN c.CHARGE_MODE='afterDue' THEN '___' WHEN c.CHARGE_MODE='preDue' THEN 'é¢__å®__' ELSE c.CHARGE_MODE END)),'null')||
   COALESCE(CHAR(p.FRP_CODE),'null')||
   COALESCE(CHAR(p.PAY_WAY),'null')||
   COALESCE(CHAR(t.ERROR_CODE),'null')||
   COALESCE(CHAR(t.ERROR_MSG),'null')||'tztgroupdailytrx' as IDNOUSE,
   '____' as BIZ_GROUP,
   t.BIZ_SYSTEM_CODE as BIZ_SYSTEM_CODE,
   date(t.LAST_UPDATE_TIME) as TRADE_TIME,
   t.MERCHANT_NO as MERCHANT_NO,
   t.BANK_CODE as BANK_CODE,
   (CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END) as CARD_TYPE,
   (CASE WHEN t.PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE  t.PAY_TOOL_TYPE END) as PAY_TOOL_TYPE,
   (CASE WHEN c.CHARGE_MODE='realTimeDue' THEN 'å®__' WHEN c.CHARGE_MODE='afterDue' THEN '___' WHEN c.CHARGE_MODE='preDue' THEN 'é¢__å®__' ELSE c.CHARGE_MODE END) as CHARGE_MODE,
   p.FRP_CODE as FRP_CODE,
   p.PAY_WAY as PAY_WAY,
   t.ERROR_CODE as ERROR_CODE,
   t.ERROR_MSG as ERROR_MSG,
   SUM(CASE WHEN t.STATUS = 'PAY_SUCCESS' THEN 1 ELSE 0 END) as SUCCESS_COUNT,
   SUM(CASE WHEN t.STATUS = 'PAY_SUCCESS' THEN t.AMOUNT ELSE 0 END) as SUCCESS_AMOUNT,
   SUM(CASE WHEN t.STATUS = 'PAY_FAIL' 
             OR t.STATUS = 'TIME_OUT'
             OR(t.STATUS = 'ACCEPT' AND (f.STATUS = 'PAY_FAIL' OR f.STATUS = 'TIME_OUT'))
         THEN 1 ELSE 0 END) as FAIL_COUNT,
   SUM(CASE WHEN t.STATUS = 'PAY_FAIL' 
             OR t.STATUS = 'TIME_OUT'
             OR(t.STATUS = 'ACCEPT' AND (f.STATUS = 'PAY_FAIL' OR f.STATUS = 'TIME_OUT'))
         THEN t.AMOUNT ELSE 0 END) as FAIL_AMOUNT,	
   COUNT(t.ID) as TOTAL_COUNT,
   SUM(t.AMOUNT) as TOTAL_AMOUNT,
   SUM(t.CS_FEE) as TOTAL_INCOME,
   SUM(p.NCPAY_COST) as TOTAL_COST
   from TZT.TZT_PAYMENT_ORDER  t
   left join JMC.MC_MERCHANT_CONFIG c on c.MERCHANT_NO=t.MERCHANT_NO and c.DELETE_FLAG=0
   left join PAPERTRADE.PAPERTRADE_PAYMENT_ORDER p on p.MERCHANT_NO=t.MERCHANT_NO and p.CUSTOMER_ORDER_ID=t.REQUEST_NO
   left join TZT.TZT_PAYMENT_FIRST_ORDER f ON t.ID = f.PAYMENT_ORDER_ID
   where  t.LAST_UPDATE_TIME>= ${START}  AND t.LAST_UPDATE_TIME < ${STOP}
	group by date(t.LAST_UPDATE_TIME),
	t.MERCHANT_NO,
	t.BIZ_SYSTEM_CODE,
	t.ERROR_CODE,
	t.ERROR_MSG,
	t.BANK_CODE,
	p.FRP_CODE,
	p.PAY_WAY,
	(CASE WHEN t.CARD_TYPE='DEBIT' THEN '___' WHEN t.CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE t.CARD_TYPE END),
	(CASE WHEN t.PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE  t.PAY_TOOL_TYPE END),
	(CASE WHEN c.CHARGE_MODE='realTimeDue' THEN 'å®__' WHEN c.CHARGE_MODE='afterDue' THEN '___' WHEN c.CHARGE_MODE='preDue' THEN 'é¢__å®__' ELSE c.CHARGE_MODE END)
	with ur;",INNO_STANBY
QAMissRateHJ,QAMissRateHJe,"SELECT
    ${START} || o.MERCHANT_NO || o.FRP_CODE || o.BANK_CODE AS IDNOUSE,
    ${START} AS DATA_PERIOD,
    o.MERCHANT_NO AS MERCHANT_NUMBER,
    o.MERCHANT_NAME AS MERCHANT_NAME,
    o.FRP_CODE AS FRP_CODE,
    o.BANK_CODE AS BANK_CODE,
    SUM(
        CASE
            WHEN o.STATE IN ('REVERSE',
                             'FAULT_REFUND')
            THEN 1
            ELSE 0
        END) AS MISSED_NUMBER,
    SUM(
        CASE
            WHEN o.BANK_STATE = 'SUCCESS'
            THEN 1
            ELSE 0
        END) AS SUCCEED_NUMBER,
    COUNT(*) AS TOTAL_NUMBER
FROM
    ncc.TBL_NC_PAY_ORDER o
WHERE
    o.BIZ = 11 AND
    CREATE_TIME >= ${START}
AND CREATE_TIME < ${STOP}
GROUP BY
    o.MERCHANT_NO,
    o.MERCHANT_NAME,
    o.BIZ,
    o.FRP_CODE,
    o.BANK_CODE 
WITH ur",INNO_STANBY
customerinfoyangeproductgroup,customerid,"select id,customernumber,productGroup from customer where customerType='ENTERPRISE' and customerNumber is not null with ur",COPY2
customerinfoyangeproductgroup,customerinfoyangeproductgroupzgt,"select CUSTOMERNUMBER, 'ZGT' as PRODUCTGROUP from customerext c left join customer cu on c.id=cu.id where c.zgt=1 and customernumber is not null with ur",COPY2
customerinfoyangeproductgroup,customerinfoyangeproductgrouptzt,"select MERCHANT_ACCOUNT_CODE as CUSTOMERNUMBER, 'TOUZITONG' as PRODUCTGROUP from EWALLET.merchant_to_goods where goods_id in(18,30) and MERCHANT_ACCOUNT_CODE is not null with ur",INNO
customerinfoyangeproductgroup,customerinfoyangeproductgroupskb,"select distinct(MAINCUSTOMERNUMBER) as CUSTOMERNUMBER, 'SHOUKUANBAO' as PRODUCTGROUP from SKB.TBL_SKB_REGISTER union all select LEDGECUSTOMERNUMBER as CUSTOMERNUMBER, 'SHOUKUANBAO' as PRODUCTGROUP from SKB.TBL_SKB_REGISTER with ur",accnt
paperordertzttrxpaydetail,paperordertrxpaydetail,"SELECT COALESCE(CHAR(BIZ_SYSTEM_CODE),'null') || COALESCE(CHAR(MERCHANT_NO),'null') || COALESCE(CHAR(REQUEST_NO),'null') || 
	COALESCE(CHAR(LAST_UPDATE_TIME),'null') || COALESCE(CHAR(BANK_CODE),'null') || COALESCE(CHAR(STATUS),'null') || 
	COALESCE(CHAR((CASE WHEN CARD_TYPE='DEBIT' THEN '___' WHEN CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE CARD_TYPE end)),'null') || 
	COALESCE(CHAR((CASE WHEN PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE PAY_TOOL_TYPE end)),'null') || 
	COALESCE(CHAR((case when PAY_TYPE='3' then 'é¦___' when PAY_TYPE='1' then 'ç»____' when PAY_TYPE='0' then 'ä¸´æ__¡æ_ä»' else '_¹æ_' end)),'null') || 
	COALESCE(AMOUNT,0) || 
	COALESCE(CHAR(ERROR_CODE),'null') || COALESCE(CHAR(ERROR_MSG),'null') ||
	'paperordertrxpaydetail' as IDNOUSE,
        MERCHANT_NO AS CONFIG_KEY,
	MERCHANT_NO||REQUEST_NO AS TRADE_KEY,
	'____£æ' AS BIZ_GROUP,BIZ_SYSTEM_CODE,MERCHANT_NO,REQUEST_NO,LAST_UPDATE_TIME AS TRADE_TIME,BANK_CODE,STATUS,
	(CASE WHEN CARD_TYPE='DEBIT' THEN '___' WHEN CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE CARD_TYPE end) AS CARD_TYPE,
	(CASE WHEN PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE PAY_TOOL_TYPE end) AS PAY_TOOL_TYPE,
	(case when PAY_TYPE='3' then 'é¦___' when PAY_TYPE='1' then 'ç»____' when PAY_TYPE='0' then 'ä¸´æ__¡æ_ä»' else '_¹æ_' end) AS PAY_TYPE,
	AMOUNT,ERROR_CODE,ERROR_MSG
	FROM PAPERORDER.PO_PAYMENT_ORDER
        where LAST_UPDATE_TIME>= CURRENT_DATE -1 days and LAST_UPDATE_TIME < CURRENT_DATE",dzh_standby
paperordertzttrxpaydetail,tzttrxpaydetail,"SELECT COALESCE(CHAR(BIZ_SYSTEM_CODE),'null') || COALESCE(CHAR(MERCHANT_NO),'null') || COALESCE(CHAR(REQUEST_NO),'null') || 
	COALESCE(CHAR(LAST_UPDATE_TIME),'null') || COALESCE(CHAR(BANK_CODE),'null') || COALESCE(CHAR(STATUS),'null') || 
	COALESCE(CHAR((CASE WHEN CARD_TYPE='DEBIT' THEN '___' WHEN CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE CARD_TYPE end)),'null') || 
	COALESCE(CHAR((CASE WHEN PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE PAY_TOOL_TYPE end)),'null') || 
	COALESCE(AMOUNT,0) || 
	COALESCE(CHAR(ERROR_CODE),'null') || COALESCE(CHAR(ERROR_MSG),'null') ||
	'tzttrxpaydetail' as IDNOUSE,
        MERCHANT_NO AS CONFIG_KEY,
	MERCHANT_NO||REQUEST_NO AS TRADE_KEY,
	'____' AS BIZ_GROUP,BIZ_SYSTEM_CODE,MERCHANT_NO,REQUEST_NO,LAST_UPDATE_TIME AS TRADE_TIME,BANK_CODE,STATUS,
	(CASE WHEN CARD_TYPE='DEBIT' THEN '___' WHEN CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE CARD_TYPE end) AS CARD_TYPE,
	(CASE WHEN PAY_TOOL_TYPE='NOCARD' THEN 'å¿___' ELSE PAY_TOOL_TYPE end) AS PAY_TOOL_TYPE,AMOUNT,ERROR_CODE,ERROR_MSG 
	FROM TZT.TZT_PAYMENT_ORDER
      where LAST_UPDATE_TIME>= CURRENT_DATE -1 days and LAST_UPDATE_TIME < CURRENT_DATE",tztDB
paperordertzttrxpaydetail,merchantconfig,"SELECT 
	MERCHANT_NO AS CONFIG_KEY,
	(CASE WHEN CHARGE_MODE='realTimeDue' THEN 'å®__' WHEN CHARGE_MODE='afterDue' THEN '___' WHEN CHARGE_MODE='preDue' THEN 'é¢__å®__' ELSE CHARGE_MODE end) AS CHARGE_MODE
	FROM JMC.MC_MERCHANT_CONFIG 
        WHERE DELETE_FLAG=0",INNO_STANBY
paperordertzttrxpaydetail,tradetrxdetail,"SELECT 
	MERCHANT_NO||CUSTOMER_ORDER_ID AS TRADE_KEY,
	FRP_CODE
	FROM PAPERTRADE.PAPERTRADE_PAYMENT_ORDER
	where LAST_UPDATE_TIME>= CURRENT_DATE -2 days and LAST_UPDATE_TIME < CURRENT_DATE",tztDB
paperordertztdailytrxpay,paperordertztreport,"SELECT COALESCE(CHAR(BIZ_GROUP),'null')||COALESCE(CHAR(BIZ_SYSTEM_CODE),'null')||COALESCE(CHAR(MERCHANT_NO),'null')|| COALESCE(CHAR(DATE(TRADE_TIME)),'null')||COALESCE(CHAR(BANK_CODE),'null')||COALESCE(CHAR(CARD_TYPE),'null')|| 
COALESCE(CHAR(PAY_TOOL_TYPE),'null')||COALESCE(CHAR(PAY_TYPE),'null')||COALESCE(CHAR(ERROR_CODE),'null')|| 
COALESCE(CHAR(ERROR_MSG),'null')||COALESCE(CHAR(PAY_TYPE_H5),'null')||COALESCE(CHAR(CHARGE_MODE),'null')|| 
COALESCE(CHAR(FRP_CODE),'null')||COALESCE(CHAR(PAY_WAY),'null')||'paperordertztreport' as IDNOUSE,
	BIZ_GROUP,BIZ_SYSTEM_CODE,MERCHANT_NO,DATE(TRADE_TIME) AS TRADE_TIME,BANK_CODE,CARD_TYPE,PAY_TOOL_TYPE,
	PAY_TYPE,ERROR_CODE,ERROR_MSG,PAY_TYPE_H5,CHARGE_MODE,FRP_CODE,PAY_WAY,
	sum(case when STATUS = 'PAY_SUCCESS' then 1 else 0 end) AS SUCCESS_COUNT,
    sum(case when STATUS = 'PAY_SUCCESS' then AMOUNT else 0 end) AS SUCCESS_AMOUNT,
    sum(case when STATUS = 'PAY_FAIL' or STATUS = 'TIME_OUT' then 1 else 0 end) AS FAIL_COUNT,
    sum(case when STATUS = 'PAY_FAIL' or STATUS = 'TIME_OUT' then AMOUNT else 0 end) AS FAIL_AMOUNT,
    sum(1) AS TOTAL_COUNT,
    sum(AMOUNT) AS TOTAL_AMOUNT,
    sum(CS_FEE) AS TOTAL_INCOME,
    sum(NCPAY_COST) AS TOTAL_COST 
	FROM ybzfdm.PAPERORDER_TZT_PAY_REPORT_TEMP
        where  TRADE_TIME>= ${START}  AND TRADE_TIME < ${STOP}
	GROUP BY BIZ_GROUP,BIZ_SYSTEM_CODE,MERCHANT_NO,TRADE_TIME,
	BANK_CODE,CARD_TYPE,PAY_TOOL_TYPE,PAY_TYPE,ERROR_CODE,
	ERROR_MSG,PAY_TYPE_H5,CHARGE_MODE,FRP_CODE,PAY_WAY
",reportdb_standby
paperordertzttrxpaydetail,tradetrxdetail2,"SELECT 
	MERCHANT_NO||CUSTOMER_ORDER_ID AS TRADE_KEY,PAY_WAY
	FROM PAPERTRADE.PAPERTRADE_PAYMENT_ORDER
	where LAST_UPDATE_TIME>= CURRENT_DATE -2 days and LAST_UPDATE_TIME < CURRENT_DATE",tztDB
paperordertzttrxpaydetail,tradetrxdetail3,"SELECT 
	MERCHANT_NO||CUSTOMER_ORDER_ID AS TRADE_KEY,NCPAY_COST 
	FROM PAPERTRADE.PAPERTRADE_PAYMENT_ORDER
	where LAST_UPDATE_TIME>= CURRENT_DATE -2 days and LAST_UPDATE_TIME < CURRENT_DATE",tztDB
paperordertzttrxbinddetail,paperorderbinddetail,"SELECT COALESCE(CHAR(BIZ_SYSTEM_CODE),'null') || COALESCE(CHAR(MERCHANT_NO),'null') || COALESCE(CHAR(REQUEST_NO),'null') || COALESCE(CHAR(DATE(LAST_UPDATE_TIME)),'null') || 
	COALESCE(CHAR(STATUS),'null') || COALESCE(CHAR(BANK_CODE),'null') || COALESCE(CHAR(BANK_NAME),'null') || 
	COALESCE(CHAR((CASE WHEN AUTH_MODE='COMMON_AUTH' THEN '____' WHEN AUTH_MODE='ENHANCED_AUTH' THEN 'å¼ºå__´æ_' ELSE AUTH_MODE END)),'null') || 
	COALESCE(CHAR((CASE WHEN CARD_TYPE='DEBIT' THEN '___' WHEN CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE CARD_TYPE END)),'null') || 
	COALESCE(CHAR(ERROR_CODE),'null') || COALESCE(CHAR(ERROR_MSG),'null') || 'paperorderbinddetail' as IDNOUSE, 
	MERCHANT_NO||REQUEST_NO AS KEY,
	'____£æ' AS BIZ_GROUP,BIZ_SYSTEM_CODE,MERCHANT_NO,DATE(LAST_UPDATE_TIME) AS TRADE_TIME,STATUS,
	BANK_CODE,BANK_NAME,(CASE WHEN AUTH_MODE='COMMON_AUTH' THEN '____' WHEN AUTH_MODE='ENHANCED_AUTH' THEN 'å¼ºå__´æ_' ELSE AUTH_MODE END) AS AUTH_MODE,
	(CASE WHEN CARD_TYPE='DEBIT' THEN '___' WHEN CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE CARD_TYPE END) AS CARD_TYPE,ERROR_CODE,ERROR_MSG 
	FROM PAPERORDER.PO_BINDCARD_ORDER
	where LAST_UPDATE_TIME>= CURRENT_DATE -1 days and LAST_UPDATE_TIME < CURRENT_DATE",dzh_standby
paperordertzttrxbinddetail,tztbinddetail,"SELECT COALESCE(CHAR(BIZ_SYSTEM_CODE),'null') || COALESCE(CHAR(MERCHANT_NO),'null') || COALESCE(CHAR(REQUEST_NO),'null') || COALESCE(CHAR(DATE(LAST_UPDATE_TIME)),'null') || 
	COALESCE(CHAR(STATUS),'null') || COALESCE(CHAR(BANK_CODE),'null') || COALESCE(CHAR(BANK_NAME),'null') || 
	COALESCE(CHAR((CASE WHEN AUTH_MODE='COMMON_AUTH' THEN '____' WHEN AUTH_MODE='ENHANCED_AUTH' THEN 'å¼ºå__´æ_' ELSE AUTH_MODE END)),'null') || 
	COALESCE(CHAR((CASE WHEN CARD_TYPE='DEBIT' THEN '___' WHEN CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE CARD_TYPE END)),'null') || 
	COALESCE(CHAR(ERROR_CODE),'null') || COALESCE(CHAR(ERROR_MSG),'null') || 'tztbinddetail' as IDNOUSE,
	MERCHANT_NO||REQUEST_NO AS KEY,
	'____' AS BIZ_GROUP,BIZ_SYSTEM_CODE,MERCHANT_NO,LAST_UPDATE_TIME TRADE_TIME,STATUS,
	BANK_CODE,BANK_NAME,(CASE WHEN AUTH_MODE='COMMON_AUTH' THEN '____' WHEN AUTH_MODE='ENHANCED_AUTH' THEN 'å¼ºå__´æ_' ELSE AUTH_MODE END) AS AUTH_MODE,
	(CASE WHEN CARD_TYPE='DEBIT' THEN '___' WHEN CARD_TYPE='CREDIT' THEN 'è´·è_' ELSE CARD_TYPE END) AS CARD_TYPE,ERROR_CODE,ERROR_MSG 
	FROM TZT.TZT_BINDCARD_ORDER
	where LAST_UPDATE_TIME>= CURRENT_DATE -1 days and LAST_UPDATE_TIME < CURRENT_DATE",tztDB
paperordertzttrxbinddetail,tradebinddetail,"SELECT 
	MERCHANT_NO||CUSTOMER_ORDER_ID AS KEY,CS_FEE
	FROM PAPERTRADE.PAPERTRADE_BINDCARD_ORDER
	where LAST_UPDATE_TIME>= CURRENT_DATE -2 days and LAST_UPDATE_TIME < CURRENT_DATE",tztDB
paperordertzttrxbinddetail,tradebinddetail2,"SELECT 
	MERCHANT_NO||CUSTOMER_ORDER_ID AS KEY,NCAUTH_COST 
	FROM PAPERTRADE.PAPERTRADE_BINDCARD_ORDER
	where LAST_UPDATE_TIME>= CURRENT_DATE -2 days and LAST_UPDATE_TIME < CURRENT_DATE",tztDB
accountPayRefund,memberRefundStat,"select 
    char(date(p.confirmOrCancel))||'memberOrder' as IDNOUSE, 
    date(p.confirmOrCancel) as TRX_TIME, 
    count(*) as COUNT_G2, 
    sum(r.AMOUNT) as AMOUNT_G2
from MOBILEBE.refundrequest r 
left join MOBILEBE.refundRecord rr on rr.ID = r.REFUNDRECORD_ID 
left join MOBILEBE.payment p on p.id=r.paymentId 
where r.HANDLESTATUS = 'HANDLED' 
and r.FRPID = 1000001 
and r.USE3G = 1 
and p.confirmOrCancel >= ${START}  
and p.confirmOrCancel < ${STOP}  
group by date(p.confirmOrCancel) 
with ur",COPY2
accountPayRefund,accountPayRefundStat,"select 
    char(date(trx_time))||'memberRefundStat' as IDNOUSE,  
    date(trx_time) AS TRX_TIME,  
    count(*) as COUNT_ACCOUNTPAY,  
    sum(amount) as AMOUNT_ACCOUNTPAY 
from 
    ACCNTPAY.tbl_refund_order 
where 
    remark like '%G2""%' and operator='REFUND' ",
"    and trx_time>=${START}   and trx_time<${STOP}  and status='SUCCESS' group by date(trx_time) """,dzh_standby,,
accountPayRefund,memberAllRefundStat,"select 
    char(date(p.confirmOrCancel))||'memberRefundStat' as IDNOUSE, 
    date(p.confirmOrCancel) as TRX_TIME, count(*) as TOTAL_COUNT_G2, sum(r.AMOUNT) as TOTAL_AMOUNT_G2
from MOBILEBE.refundrequest r
left join MOBILEBE.refundRecord rr on rr.ID = r.REFUNDRECORD_ID
left join MOBILEBE.payment p on p.id=r.paymentId
where r.HANDLESTATUS = 'HANDLED'
and r.FRPID = 1000001
and p.confirmOrCancel >= ${START}
and p.confirmOrCancel <= ${STOP}
group by date(p.confirmOrCancel)
with ur",COPY2
financedailyreportinit,financedailyreportinite,"select 
TRANS_DATE
,MERCHANT_NO
,MERCHANT_NAME
,AMOUNT
,TRANS_NUM
,INCOME
,COST
,PROFIT
,PAYMENT_BANK_NAME
,INDUSTRY_ATTR
,case when  MERCHANT_NO is null then '' else MERCHANT_NO end || case when MERCHANT_NAME is null then '' else MERCHANT_NAME end  || case when PAYMENT_BANK_NAME is null then '' else PAYMENT_BANK_NAME end || case when INDUSTRY_ATTR is null then '' else INDUSTRY_ATTR end  AS UNIQUE_NO
,VERSION_NO
,CREATE_TIME
,LAST_UPDATE_TIME
from BIA.FINANCE_DAILY_REPORT   
where TRANS_DATE  >= ${START} and TRANS_DATE < ${STOP}",feedb
paperordertztdailytrxbind,paperordertztbindreport,"SELECT COALESCE(CHAR(BIZ_GROUP),'null') || COALESCE(CHAR(BIZ_SYSTEM_CODE),'null') || COALESCE(CHAR(MERCHANT_NO),'null') || 
	COALESCE(CHAR(DATE(TRADE_TIME)),'null')  || COALESCE(CHAR(BANK_CODE),'null') || COALESCE(CHAR(BANK_NAME),'null') ||
    COALESCE(CHAR(ERROR_CODE),'null') || COALESCE(CHAR(ERROR_MSG),'null') || 
    COALESCE(CHAR(CARD_TYPE),'null') || 
    COALESCE(CHAR(AUTH_MODE),'null') || 
    'paperordertztbindreport' as IDNOUSE, 
	BIZ_GROUP,BIZ_SYSTEM_CODE,MERCHANT_NO,DATE(TRADE_TIME) AS TRADE_TIME,BANK_CODE,BANK_NAME,ERROR_CODE,ERROR_MSG,CARD_TYPE,AUTH_MODE,
	sum(case when STATUS = 'BIND_SUCCESS' or STATUS = 'authSuccess' then 1 else 0 end) AS SUCCESS_COUNT,
	sum(case when STATUS = 'BIND_ERROR' or STATUS = 'BIND_FAIL' or STATUS = 'TIME_OUT'  then 1 else 0 end) AS FAIL_COUNT, 
	sum(1) AS TOTAL_COUNT,
	sum(CS_FEE) AS TOTAL_INCOME,
	sum(NCAUTH_COST) AS TOTAL_COST
	FROM ybzfdm.PAPERORDER_TZT_BIND_REPORT_TEMP
	where  TRADE_TIME>= ${START}  AND TRADE_TIME < ${STOP}
	GROUP BY BIZ_GROUP,BIZ_SYSTEM_CODE,MERCHANT_NO,TRADE_TIME,BANK_CODE,BANK_NAME,ERROR_CODE,ERROR_MSG,CARD_TYPE,AUTH_MODE
	WITH ur",reportdb_standby
paperordertzttrxpaydetail,tradetrxdetail4,"SELECT 
	MERCHANT_NO||CUSTOMER_ORDER_ID AS TRADE_KEY,CS_FEE 
	FROM PAPERTRADE.PAPERTRADE_PAYMENT_ORDER
	where LAST_UPDATE_TIME>= CURRENT_DATE -2 days and LAST_UPDATE_TIME < CURRENT_DATE",tztDB
QATrxTotal,QATrxTotale,"select
tmp.PRODUCTLINE || tmp.DATA_PERIOD AS IDNOUSE,
tmp.DATA_PERIOD,
tmp.PRODUCTLINE,
sum(tmp.ACCOUNTINGPROFIT*coalesce(tmp.YEJISCALE,1)) AS PROFIT,
sum(tmp.NEWINCOME*coalesce(tmp.YEJISCALE,1)+tmp.MANAGEFEEPREDICT*coalesce(tmp.YEJISCALE,1)-(tmp.NEWCOST*coalesce(tmp.YEJISCALE,1)+tmp.EXTERNALCOSTPREDICT*coalesce(tmp.YEJISCALE,1)))  AS MANAGER_PROFIT,
sum(CASE WHEN (tmp.BIZTYPEID IN (29,129) and tmp.TRXTYPEID not in ('POSRENT','POSSALES')) THEN tmp.ACCOUNTINGPROFIT*coalesce(tmp.YEJISCALE,1) ELSE tmp.INNERINCOME*coalesce(tmp.YEJISCALE,1) END) AS INCOME,
sum(tmp.TRXCOUNT*coalesce(tmp.YEJISCALE,1)) AS TRX_COUNT,
sum(CASE WHEN (tmp.BIZTYPEID IN (29,129) and tmp.TRXTYPEID not in ('POSRENT','POSSALES')) THEN 0 ELSE tmp.ACCOUNTINGCOST*coalesce(tmp.YEJISCALE,1) END) AS ACCOUNT_COST,
sum(tmp.TRXAMOUNT*coalesce(tmp.YEJISCALE,1)) AS TRX_AMOUNT
from (
select 
        p.NEWINCOME,
        P.MANAGEFEEPREDICT,
P.NEWCOST,
P.EXTERNALCOSTPREDICT,
        C.SIGNEDNAME AS SIGNED_NAME, 
        P.TRXDATE AS DATA_PERIOD,
        P.ACCOUNTINGPROFIT,
        P.ACCOUNTINGCOST,
        P.YEJISCALE,
        P.BIZTYPEID,
        P.TRXTYPEID,
        P.INNERINCOME,
        P.TRXCOUNT,
        P.TRXAMOUNT,
        CASE WHEN C.PRODUCTLINE is null THEN (
          CASE WHEN SPC.PRODUCTNAME IN ('_¶æå®','_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸'
          WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____'
          ELSE (
            CASE WHEN PP.ACCOUNTCLASS IN('ç§»å_','çº¿ä_') THEN '_£æ_ä¸__'
            WHEN PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸'
            END
          ) END
        ) ELSE C.PRODUCTLINE END AS PRODUCTLINE
         from DB2INST1.PUBLISHEDDAILYTRX AS P
          left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
          left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
         left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
        left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID
          where P.TRXDATE = ${START} and (PP.ACCOUNTCLASS != '___è¡__'  OR PP.ACCOUNTCLASS IS NULL)
and (C.CUSTOMERNUMBER != '10000460331' or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
) tmp
 group by tmp.PRODUCTLINE,tmp.DATA_PERIOD",reportdb_yjkh
QATrxIndustry,QATrxIndustrye,"select
T.TRXDATE || COALESCE(T.PRODUCTLINE,'ç©') AS IDNOUSE,
T.TRXDATE AS DATA_PERIOD,
T.PRODUCTLINE AS  HANGYEYEJISHUXING,
sum(T.ACCOUNTINGPROFIT*coalesce(T.YEJISCALE,1)) AS PROFIT,
sum(T.NEWINCOME*coalesce(T.YEJISCALE,1)+T.MANAGEFEEPREDICT*coalesce(T.YEJISCALE,1)-(T.NEWCOST*coalesce(T.YEJISCALE,1)+T.EXTERNALCOSTPREDICT*coalesce(T.YEJISCALE,1)))  AS MANAGER_PROFIT,
sum(CASE WHEN (T.BIZTYPEID IN (29,129) and T.TRXTYPEID not in ('POSRENT','POSSALES')) THEN T.ACCOUNTINGPROFIT*coalesce(T.YEJISCALE,1) ELSE T.INNERINCOME*coalesce(T.YEJISCALE,1) END) AS INCOME,
sum(T.TRXCOUNT*coalesce(T.YEJISCALE,1)) AS TRX_COUNT,
sum(CASE WHEN (T.BIZTYPEID IN (29,129) and T.TRXTYPEID not in ('POSRENT','POSSALES')) THEN 0 ELSE T.ACCOUNTINGCOST*coalesce(T.YEJISCALE,1) END) AS ACCOUNT_COST,
sum(T.TRXAMOUNT*coalesce(T.YEJISCALE,1)) AS TRX_AMOUNT
from (
	select 
	P.ACCOUNTINGPROFIT,
        p.NEWINCOME,
        P.MANAGEFEEPREDICT,
P.NEWCOST,
P.EXTERNALCOSTPREDICT,
	P.TRXAMOUNT,
	P.YEJISCALE,
	P.BIZTYPEID,
	P.TRXTYPEID,
	P.INNERINCOME,
	P.TRXCOUNT,
	P.ACCOUNTINGCOST,
	P.TRXDATE,
	CASE WHEN C.PRODUCTLINE IS NOT NULL THEN C.PRODUCTLINE
		WHEN SPC.PRODUCTNAME IN ('_¶æå®', '_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸' 
		WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____' 
		WHEN (SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') OR SPC.PRODUCTNAME IS NULL) AND (PP.ACCOUNTCLASS IN ('ç§»å_', 'çº¿ä_') OR PP.ACCOUNTCLASS IS NULL) THEN '_£æ_ä¸__'
		WHEN (SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____')  OR SPC.PRODUCTNAME IS NULL) AND PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸' ELSE null END AS PRODUCTLINE
	from DB2INST1.PUBLISHEDDAILYTRX AS P
	left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
	left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
	left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
        left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID
	where P.TRXDATE = ${START} and (PP.ACCOUNTCLASS != '___è¡__' or PP.ACCOUNTCLASS is null)
and (C.CUSTOMERNUMBER != '10000460331' or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)

) T
group by
T.TRXDATE,
T.PRODUCTLINE
with ur",reportdb_yjkh
QATrxMerchant,QATrxMerchante,"SELECT 
SIGNED_NAME || PRODUCTLINE || DATA_PERIOD    AS IDNOUSE,
SIGNED_NAME,
DATA_PERIOD,
PRODUCTLINE,
LISTAGG(SALESNAME) AS SALESNAME,
SUM(PROFIT) AS PROFIT,
SUM(MANAGER_PROFIT) AS MANAGER_PROFIT,
SUM(INCOME) AS INCOME,
SUM(TRX_COUNT) AS TRX_COUNT,
SUM(ACCOUNT_COST) AS ACCOUNT_COST,
SUM(TRX_AMOUNT) AS TRX_AMOUNT
FROM
(select
tmp.SIGNED_NAME,
tmp.DATA_PERIOD,
tmp.PRODUCTLINE,
tmp.SALESNAME,
sum(tmp.ACCOUNTINGPROFIT*coalesce(tmp.YEJISCALE,1)) AS PROFIT,
sum(tmp.NEWINCOME*coalesce(tmp.YEJISCALE,1)+tmp.MANAGEFEEPREDICT*coalesce(tmp.YEJISCALE,1)-(tmp.NEWCOST*coalesce(tmp.YEJISCALE,1)+tmp.EXTERNALCOSTPREDICT*coalesce(tmp.YEJISCALE,1)))  AS MANAGER_PROFIT,
sum(CASE WHEN (tmp.BIZTYPEID IN (29,129) and tmp.TRXTYPEID not in ('POSRENT','POSSALES')) THEN tmp.ACCOUNTINGPROFIT*coalesce(tmp.YEJISCALE,1) ELSE tmp.INNERINCOME*coalesce(tmp.YEJISCALE,1) END) AS INCOME,
sum(tmp.TRXCOUNT*coalesce(tmp.YEJISCALE,1)) AS TRX_COUNT,
sum(CASE WHEN (tmp.BIZTYPEID IN (29,129) and tmp.TRXTYPEID not in ('POSRENT','POSSALES')) THEN 0 ELSE tmp.ACCOUNTINGCOST*coalesce(tmp.YEJISCALE,1) END) AS ACCOUNT_COST,
sum(tmp.TRXAMOUNT*coalesce(tmp.YEJISCALE,1)) AS TRX_AMOUNT
from (
select 
        p.NEWINCOME,
        P.MANAGEFEEPREDICT,
P.NEWCOST,
P.EXTERNALCOSTPREDICT,
        C.SIGNEDNAME AS SIGNED_NAME, 
        P.TRXDATE AS DATA_PERIOD,
        P.ACCOUNTINGPROFIT,
        P.ACCOUNTINGCOST,
        P.YEJISCALE,
        P.BIZTYPEID,
        P.TRXTYPEID,
        P.INNERINCOME,
        P.TRXCOUNT,
        P.TRXAMOUNT,
        P.SALESNAME,
        CASE WHEN C.PRODUCTLINE is null THEN (
          CASE WHEN SPC.PRODUCTNAME IN ('_¶æå®','_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸'
          WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____'
          ELSE (
            CASE WHEN PP.ACCOUNTCLASS = 'ç§»å___º¿ä¸' THEN '_£æ_ä¸__'
            WHEN PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸'
            END
          ) END
        ) ELSE C.PRODUCTLINE END AS PRODUCTLINE
         from DB2INST1.PUBLISHEDDAILYTRX AS P
          left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
          left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
         left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
        left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID
          where  P.TRXDATE = ${START} and (PP.ACCOUNTCLASS != '___è¡__' OR PP.ACCOUNTCLASS IS NULL)
and (C.CUSTOMERNUMBER != '10000460331' or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
 ) tmp
 group by tmp.SIGNED_NAME, tmp.PRODUCTLINE,tmp.DATA_PERIOD,tmp.SALESNAME
)
GROUP BY SIGNED_NAME, DATA_PERIOD, PRODUCTLINE",reportdb_yjkh
cashStat,cashStat,"select char(date(CREATE_TIME))||'cashStat' as IDNOUSE, date(CREATE_TIME) as CREATE_TIME,
BANK_CODE, BANK_NAME, sum(REMIT_AMOUNT) as TOTAL_AMOUNT, count(*) as TOTAL_COUNT from BAC.tbl_balance_request_detail where REQUEST_SYSTEM='CASH' AND REQUEST_BIZ = 'D1' and BANK_STATUS='SUCCESS' and CREATE_TIME>=${START}  and CREATE_TIME<${STOP}  group by date(CREATE_TIME), BANK_CODE, BANK_NAME ",dzh_standby
fundtxSpeed,fundtxSpeede,"SELECT
    COUNT(1) AS CUSTOMER_ID
FROM
    TBL_REMIT_REQUEST
where 
	CREATE_DATE>='2017-12-18' and CREATE_DATE<='2017-12-18'
	and REMIT_TYPE=_1'",fundtx
fundtxspeedcount,fundtxspeedcounte,"SELECT
    CURRENT DATE - 1 DAYS AS STATISTIC_TIME,
    t1.SEC_COUNT,
    t2.MIN_COUNT,
    t3.HOUR_COUNT,
    t4.TOTAL_COUNT,
    CURRENT TIMESTAMP AS CREATE_TIME
FROM
    (
        SELECT
            COUNT(1) AS SEC_COUNT
        FROM
            REMIT.TBL_REMIT_REQUEST
        WHERE
            CREATE_DATE >=(${START} || ' 00:00:00') AND  CREATE_DATE <= (${START}  || ' 23:59:59')
        AND REMIT_TYPE='1'
        AND PROCESS_DATE-CREATE_DATE <=2) t1
LEFT JOIN
    (
        SELECT
            COUNT(1) AS MIN_COUNT
        FROM
             REMIT.TBL_REMIT_REQUEST
        WHERE
            CREATE_DATE >=(${START} || ' 00:00:00') AND  CREATE_DATE <= (${START}  || ' 23:59:59')
        AND REMIT_TYPE='1'
        AND PROCESS_DATE-CREATE_DATE <=500) t2
ON
    1=1
LEFT JOIN
    (
        SELECT
            COUNT(1) AS HOUR_COUNT
        FROM
             REMIT.TBL_REMIT_REQUEST
        WHERE
            CREATE_DATE >=(${START} || ' 00:00:00') AND  CREATE_DATE <= (${START}  || ' 23:59:59')
        AND REMIT_TYPE='1'
        AND PROCESS_DATE-CREATE_DATE <=10000) t3
ON
    1=1
LEFT JOIN(
 SELECT
            COUNT(1)  AS TOTAL_COUNT
        FROM
             REMIT.TBL_REMIT_REQUEST
        WHERE
            CREATE_DATE >=(${START} || ' 00:00:00') AND  CREATE_DATE <= (${START}  || ' 23:59:59')
        AND REMIT_TYPE='1'
) t4
on
    1=1",fundtx
QATrxProductlineMerchant,QATrxProductlineMerchante,"select TRXDATE,PRODUCTLINE,count(1) AS MERCHANT_COUNT,CURRENT TIMESTAMP AS CREATE_TIME from(
select
   C.SIGNEDNAME,
P.TRXDATE,
CASE WHEN C.PRODUCTLINE IS NOT NULL THEN C.PRODUCTLINE
		WHEN SPC.PRODUCTNAME IN ('_¶æå®', '_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸' 
		WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____' 
		WHEN (SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') or SPC.PRODUCTNAME is null)AND (PP.ACCOUNTCLASS IN ('ç§»å_', 'çº¿ä_') OR PP.ACCOUNTCLASS IS NULL) THEN '_£æ_ä¸__'
		WHEN (SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') OR SPC.PRODUCTNAME IS NULL) AND PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸' ELSE null END AS PRODUCTLINE
  from DB2INST1.PUBLISHEDDAILYTRX AS P
    left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
    left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
    left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  where 
  (PP.ACCOUNTCLASS != '___è¡__' OR PP.ACCOUNTCLASS IS NULL)
and P.TRXDATE =${START}
group by C.SIGNEDNAME,P.TRXDATE,
CASE WHEN C.PRODUCTLINE IS NOT NULL THEN C.PRODUCTLINE
		WHEN SPC.PRODUCTNAME IN ('_¶æå®', '_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸' 
		WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____' 
		WHEN (SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') or SPC.PRODUCTNAME is null)AND (PP.ACCOUNTCLASS IN ('ç§»å_', 'çº¿ä_') OR PP.ACCOUNTCLASS IS NULL) THEN '_£æ_ä¸__'
		WHEN (SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') OR SPC.PRODUCTNAME IS NULL) AND PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸' ELSE null END
) group by TRXDATE,PRODUCTLINE",reportdb_yjkh
customeryange2,cuyange2,"select c.id as id,c.active,c.customerNumber,c.fullname,c.groupId,c.shortname,c.createDate,bc.name as businessCat,subBusinessCat,c.area,pf1.value as linkman,pf2.value as webUrl,pf.value as signedName,a.balance as accountBalance,ca.balance as creditBalance,ca.creditLimit,c.bindMobile as mobile,c.phone,date(si.lastsettledate) as lastsettledate, pf3.value as netSigned, c.productGroup,pf4.value as address,bc.id as bussinessCatId,pf5.value as province,si.cycleType as cycletype,si.reserveDays,coalesce(cg.grade,'') as gradelevel, 'NETSIGNED' as customertype,c.customerNumber as MERCHANTNO,a.balancelastupdatedate,cd.DOCUMENTNUMBER as legal_idcard,cd.DESCRIPTION as legal_name,pf6.value as audit_Status,a.status as account_status,r.BANKACTID as settle_bankaccount,r.province as settle_bankprovince,r.city as settle_bankcity,r.branchName as settle_bankbranch,ba.fullname as settle_bankname,r.accountName as settle_accountname,pf7.value as icp,c.customertype as signed_type   from Customer c left join profile pf on c.ID=pf.customer_id and pf.name='p_signedName'  left join profile pf1 on c.id=pf1.customer_id and pf1.name='p_linkman'  left join profile pf2 on c.id=pf2.customer_id and pf2.name='p_customerSiteUrl'  left join profile pf3 on c.id=pf3.customer_id and pf3.name='p_signed'  left join profile pf4 on c.id=pf4.customer_id and pf4.name='p_address'  left join profile pf5 on c.id=pf5.customer_id and pf5.name='p_province'  left join profile pf6 on c.id=pf6.customer_id and pf6.name='p_auditStatus' left join profile pf7 on c.ID=pf7.CUSTOMER_ID and pf7.NAME='p_icp' left join account a on (c.id=a.customer_id and a.classtype='LocalAccount' and a.localAccountType='SVA')  left join CreditAccount ca on (c.id=ca.customerId)  left join settlementinfo si on c.id=si.customer_id left join account r on si.bankAccount_id=r.id and r.classtype='RemoteAccount' left join bank ba on r.bank_id=ba.id left join BusinessCategorie  bc on bc.id=c.businessCat  left join customergradeinfo cg on c.id=cg.customerid and cg.status in ('WAITRESCORE','COMPLETE','NOQUESSCORE') left join customerdocinfo  cd on  (c.CUSTOMERNUMBER=cd.CUSTOMERNUMBER and  cd.DOCUMENTNAME='æ³_ººèº»½è¯')  where 'etlnokill123123123'='etlnokill123123123' and c.customerType='ENTERPRISE' and c.customerNumber is not null and c.createdate>=current timestamp -10 days with ur",COPY2
customerinfoyangeprofile,customerinfoyangeprofile,"select  CUSTOMER_NUMBER as key , case when CUSTOMER_LABEL_VALUE='SVIP' then 2 else 1 end as value 
from SIGNING.TBL_CUSTOMER_LABEL_ATTRIBUTE 
where CUSTOMER_LABEL='customer_vip_level' and status=1 
with ur",BOSS
fpfeemonthtrx,empstaticties,"(select '______' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from TBL_USER user left join TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '016%' and user.USERSTATUS!='DELETED')
UNION
(select '______' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from TBL_USER user left join TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '017%' and user.USERSTATUS!='DELETED')
UNION
(select '_____' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from TBL_USER user left join TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '003%' and user.USERSTATUS!='DELETED')
UNION
(select '__º«__' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from TBL_USER user left join TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '775%' and user.USERSTATUS!='DELETED')
UNION
(select '_¨æ_ä»+' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from TBL_USER user left join TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '903%' and user.USERSTATUS!='DELETED')
UNION
(select '__¸¸åº' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from TBL_USER user left join TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '020%' and user.USERSTATUS!='DELETED')
UNION
(select 'å¤©å_' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from TBL_USER user left join TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '009%' and user.USERSTATUS!='DELETED')
UNION
(select '______' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from TBL_USER user left join TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '019%' and user.USERSTATUS!='DELETED')
",BOSS
fpfeemonthtrx,opstaticties,"(select '______' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT from tbl_WF_main where ORG_NO like '016%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select '______' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from tbl_WF_main where ORG_NO like '017%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select '_____' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from tbl_WF_main where ORG_NO like '003%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select '__º«__' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from tbl_WF_main where ORG_NO like '775%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select '_¨æ_ä»+' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from tbl_WF_main where ORG_NO like '903%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select '__¸¸åº' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from tbl_WF_main where ORG_NO like '020%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select 'å¤©å_' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from tbl_WF_main where ORG_NO like '009%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select '______' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT from tbl_WF_main where ORG_NO like '019%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})",OPDB
fpfeemonthtrx,notifierstaticties,"select ceil(count(*)*0.553) as ______°é_,ceil(count(*)*0.553)*0.00025 as _______,ceil(count(*)*0.05) as _______°é_,ceil(count(*)*0.05)*0.00025 as ________,ceil(count(*)*0.397) as __¸¸_·æ__,ceil(count(*)*0.397)*0.00025 as __¸¸_·é_é¢ from STNO.TBL_NOTIFY_HIS WHERE CREATE_TIME CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})",basedb
accountcostjingfen,jianquancost0007,"select COALESCE(
    CHAR(clear_date) ,
    'null'
) || COALESCE(
    CHAR(CUSTOMER_NO) ,
    'null'
) || COALESCE(
    CHAR(ACCOUNTING_PRODUCT_CODE) ,
    'null'
) || COALESCE(
    CHAR(MARKETING_PRODUCT_CODE) ,
    'null'
) ||coalesce(char(bi_code),'null')||coalesce(char(accounting_product_code),'null')|| 'accostjianquan' AS IDNOUSE ,
clear_date AS TRXDATE ,
bi_code as trxchannelid,
CUSTOMER_NO as customernumber ,
 CUSTOMER_NO AS RECEIVERID ,
ACCOUNTING_PRODUCT_CODE AS PRODUCT_CODE ,
 MARKETING_PRODUCT_CODE AS SALES_PRODUCT_CODE ,
'CARDJIANQUAN' as type,
 sum(cost) as accountingcost,
count(*) as trxcount,
sum(cost) as externalcost 
 from charge.actual_0007 where clear_date = ${START}  
group by clear_date ,
customer_no ,
marketing_product_code ,bi_code,
accounting_product_code with ur",checkdb
empfeemonthtrx,emp_staticties,"(select char(YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE))||'______' AS IDNOUSE,'______' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT,YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE) AS MONTH from EMP.TBL_USER user left join EMP.TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '016%' and user.USERSTATUS!='DELETED')
UNION
(select char(YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE))||'______' AS IDNOUSE,'______' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT,YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE) AS MONTH from EMP.TBL_USER user left join EMP.TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '017%' and user.USERSTATUS!='DELETED')
UNION
(select char(YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE))||'_____' AS IDNOUSE,'_____' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT,YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE) AS MONTH from EMP.TBL_USER user left join EMP.TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '003%' and user.USERSTATUS!='DELETED')
UNION
(select char(YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE))||'__º«__' AS IDNOUSE,'__º«__' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT,YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE) AS MONTH from EMP.TBL_USER user left join EMP.TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '775%' and user.USERSTATUS!='DELETED')
UNION
(select char(YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE))||'_¨æ_ä»+' AS IDNOUSE,'_¨æ_ä»+' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT,YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE) AS MONTH from EMP.TBL_USER user left join EMP.TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '903%' and user.USERSTATUS!='DELETED')
UNION
(select char(YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE))||'__¸¸åº' AS IDNOUSE,'__¸¸åº' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT,YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE) AS MONTH from EMP.TBL_USER user left join EMP.TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '020%' and user.USERSTATUS!='DELETED')
UNION
(select char(YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE))||'å¤©å_' AS IDNOUSE,'å¤©å_' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT,YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE) AS MONTH from EMP.TBL_USER user left join EMP.TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '009%' and user.USERSTATUS!='DELETED')
UNION
(select char(YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE))||'______' AS IDNOUSE,'______' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT,YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE) AS MONTH from EMP.TBL_USER user left join EMP.TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '019%' and user.USERSTATUS!='DELETED')
UNION
(select char(YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE))||'___' AS IDNOUSE,'___' AS COMPANY,count(*) AS COUNTS,count(*)*17 AS AMOUNT,YEAR(CURRENT DATE)*100+MONTH(CURRENT DATE) AS MONTH from EMP.TBL_USER user left join EMP.TBL_ORGANIZATION org on user.org_id=org.ORG_ID where org.ORG_NO like '904%' and user.USERSTATUS!='DELETED')",BOSS
opfeemonthtrx,op_staticties,"(select char(YEAR(${START})*100+MONTH(${START}))||'______' AS IDNOUSE,'______' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT,year(${START})*100+month(${START}) AS MONTH from OP.tbl_WF_main where ORG_NO like '016%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select char(YEAR(${START})*100+MONTH(${START}))||'______' AS IDNOUSE,'______' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT,year(${START})*100+month(${START}) AS MONTH from OP.tbl_WF_main where ORG_NO like '017%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select char(YEAR(${START})*100+MONTH(${START}))||'_____' AS IDNOUSE,'_____' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT,year(${START})*100+month(${START}) AS MONTH from OP.tbl_WF_main where ORG_NO like '003%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select char(YEAR(${START})*100+MONTH(${START}))||'__º«__' AS IDNOUSE,'__º«__' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT,year(${START})*100+month(${START}) AS MONTH from OP.tbl_WF_main where ORG_NO like '775%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select char(YEAR(${START})*100+MONTH(${START}))||'_¨æ_ä»+' AS IDNOUSE,'_¨æ_ä»+' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT,year(${START})*100+month(${START}) AS MONTH from OP.tbl_WF_main where ORG_NO like '903%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select char(YEAR(${START})*100+MONTH(${START}))||'UNION' AS IDNOUSE,'__¸¸åº' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT,year(${START})*100+month(${START}) AS MONTH from OP.tbl_WF_main where ORG_NO like '020%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select char(YEAR(${START})*100+MONTH(${START}))||'å¤©å_' AS IDNOUSE,'å¤©å_' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT,year(${START})*100+month(${START}) AS MONTH from OP.tbl_WF_main where ORG_NO like '009%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select char(YEAR(${START})*100+MONTH(${START}))||'______' AS IDNOUSE,'______' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT,year(${START})*100+month(${START}) AS MONTH from OP.tbl_WF_main where ORG_NO like '019%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})
UNION
(select char(YEAR(${START})*100+MONTH(${START}))||'___' AS IDNOUSE,'___' AS COMPANY,count(*) AS COUNTS,count(*)*2 AS AMOUNT,year(${START})*100+month(${START}) AS MONTH from OP.tbl_WF_main where ORG_NO like '019%' and CREATE_TIME >= ${START} and CREATE_TIME < ${STOP})",OPDB
notifierfeedaytrx,notifier_staticties_daily,"select ${START} AS TRXDATE,ceil(count(*)*0.553) AS YPCOUNTS,ceil(count(*)*0.553)*0.00025 AS YPAMOUNT,ceil(count(*)*0.05) AS LMCOUNTS,ceil(count(*)*0.05)*0.00025 AS LMAMOUNT,ceil(count(*)*0.397) AS YYKCOUNTS,ceil(count(*)*0.397)*0.00025 AS YYKAMOUNT, year(${START})*100+month(${START}) AS MONTH from STNO.TBL_NOTIFY_HIS WHERE CREATE_TIME >= ${START} and CREATE_TIME < ${STOP}",basedb
notifierfeemonthtrx,notifier_staticties_monthly,"select year(${START})*100+month(${START}) AS MONTH,sum(YPCOUNTS) AS YPCOUNTS,sum(YPAMOUNT) AS YPAMOUNT,sum(LMCOUNTS) AS LMCOUNTS,sum(LMAMOUNT) AS LMAMOUNT,sum(YYKCOUNTS) AS YYKCOUNTS,sum(YYKAMOUNT) AS YYKAMOUNT from ybzfdm.notifier_staticties_daily WHERE TRXDATE >= ${START} and TRXDATE < ${STOP}",reportdb_standby
QATrxYejishuxing,QATrxYejishuxinge,"select
tmp.YEJISHUXING || tmp.DATA_PERIOD AS IDNOUSE,
tmp.YEJISHUXING,
tmp.DATA_PERIOD,
sum(tmp.ACCOUNTINGPROFIT*coalesce(tmp.YEJISCALE,1)) AS PROFIT,
sum(CASE WHEN (tmp.BIZTYPEID IN (29,129) and tmp.TRXTYPEID not in ('POSRENT','POSSALES')) THEN tmp.ACCOUNTINGPROFIT*coalesce(tmp.YEJISCALE,1) ELSE tmp.INNERINCOME*coalesce(tmp.YEJISCALE,1) END) AS INCOME,
sum(tmp.TRXCOUNT*coalesce(tmp.YEJISCALE,1)) AS TRX_COUNT,
sum(CASE WHEN (tmp.BIZTYPEID IN (29,129) and tmp.TRXTYPEID not in ('POSRENT','POSSALES')) THEN 0 ELSE tmp.ACCOUNTINGCOST*coalesce(tmp.YEJISCALE,1) END) AS ACCOUNT_COST,
sum(tmp.TRXAMOUNT*coalesce(tmp.YEJISCALE,1)) AS TRX_AMOUNT,
tmp2.MERCHANT_COUNT
from (
select 
        C.SIGNEDNAME AS SIGNED_NAME, 
        P.TRXDATE AS DATA_PERIOD,
        P.ACCOUNTINGPROFIT,
        P.ACCOUNTINGCOST,
        P.YEJISCALE,
        P.BIZTYPEID,
        P.TRXTYPEID,
        P.INNERINCOME,
        P.TRXCOUNT,
        P.TRXAMOUNT,
		COALESCE(E.NAME,'_¨å_') AS YEJISHUXING,
        CASE WHEN C.PRODUCTLINE is null THEN (
          CASE WHEN SPC.PRODUCTNAME IN ('_¶æå®','_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸'
          WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____'
          ELSE (
            CASE WHEN PP.ACCOUNTCLASS in('ç§»å_','çº¿ä_') THEN '_£æ_ä¸__'
            WHEN PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸'
            END
          ) END
        ) ELSE C.PRODUCTLINE END AS PRODUCTLINE
         from DB2INST1.PUBLISHEDDAILYTRX AS P
          left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
          left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
         left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
		 LEFT JOIN DB2INST1.EXISTENCE AS E ON P.YEJISHUXING=E.ID
        left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID
          where P.TRXDATE = ${START} and PP.ACCOUNTCLASS != '___è¡__'
and (C.CUSTOMERNUMBER != '10015005792' or C.CUSTOMERNUMBER IS NULL or T.NAME != 'OPè°_´¦' or T.NAME is null)
 ) tmp
left join(
select 
        count(C.SIGNEDNAME) AS MERCHANT_COUNT, 
        P.TRXDATE AS DATA_PERIOD,
		COALESCE(E.NAME,'_¨å_') AS YEJISHUXING
         from DB2INST1.PUBLISHEDDAILYTRX AS P
          left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
          left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
         left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
		 LEFT JOIN DB2INST1.EXISTENCE AS E ON P.YEJISHUXING=E.ID
          where P.TRXDATE = ${START} and (PP.ACCOUNTCLASS != '___è¡__' OR PP.ACCOUNTCLASS IS NULL)
        and (C.PRODUCTLINE != 'ä¸_å¾__' OR C.PRODUCTLINE IS NULL)
GROUP BY  P.TRXDATE,E.NAME
) tmp2
on tmp.YEJISHUXING = tmp2.YEJISHUXING 
where tmp.PRODUCTLINE != 'ä¸_å¾__' OR tmp.PRODUCTLINE IS NULL
 group by tmp.YEJISHUXING, tmp.DATA_PERIOD,tmp2.MERCHANT_COUNT
",reportdb_yjkh
QATrxDaqu,QATrxDaque,"SELECT
t.TRXDATE|| COALESCE(t.yejishuxing,'ç©')||COALESCE(T.ACCOUNTTINGTYPE,'ç©')||COALESCE(T.PRODUCTLINE,'ç©') AS IDNOUSE,
    t.yejishuxing,
    t.TRXDATE AS DATA_PERIOD,
    t.trxprofit AS PROFIT,
t.MANAGER_PROFIT,
    t.trxamount AS TRX_AMOUNT,
T.ACCOUNTTINGTYPE,
T.PRODUCTLINE,
    c.MERCHANT_COUNT,
    CASE
        WHEN s.total=0
        THEN 0
        ELSE (1.000000*t.trxprofit/s.total)
    END AS rate
FROM
    (
        SELECT
            P.TRXDATE,
C.PRODUCTLINE,
            E.NAME AS yejishuxing,
           case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end as ACCOUNTTINGTYPE, 
            CASE
                WHEN E.NAME IN ('__º¬____',
                                'ä¸_µ·____',
                                'å±±è¥¿____',
                                'æ²³å_____',
                                '__¥¿____',
                                'å¤©æ´¥____',
                                '_______',
'__º¬äº____',
'__º¬ä¸____' )
                THEN '_¼å_'
                WHEN E.NAME IN ('å±±ä_____',
                                'æµ______',
                                'æ±______')
                THEN '___'
                WHEN E.NAME = 'ç¦_»º____'
                THEN 'ç¦_»º'
                WHEN E.NAME = 'å¹¿ä_____'
                THEN 'å¹¿ä_'
                ELSE E.NAME
            END                                             AS DAQU,
            SUM(P.ACCOUNTINGPROFIT*COALESCE(P.YEJISCALE,1)) AS trxprofit,
sum(P.NEWINCOME*coalesce(P.YEJISCALE,1)+P.MANAGEFEEPREDICT*coalesce(P.YEJISCALE,1)-(P.NEWCOST*coalesce(P.YEJISCALE,1)+P.EXTERNALCOSTPREDICT*coalesce(P.YEJISCALE,1)))  AS MANAGER_PROFIT,
            SUM(P.TRXAMOUNT*COALESCE(P.YEJISCALE,1)) AS trxamount
        FROM
            DB2INST1.PUBLISHEDDAILYTRX AS P
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS B
        ON
            1=1
        AND P.BUSINESSCATID=B.ID
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S
        ON
            1=1
        AND P.SUBBUSINESSCAT=S.CODE
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND P.RECEIVERID=C.ID
        LEFT JOIN
            DB2INST1.PRODUCTCODE_PROFILE AS PP
        ON
            1=1
        AND P.PRODUCT_CODE=PP.PRODUCT_CODE
        AND P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS PC
        ON
            1=1
        AND P.PRODUCT_CODE=PC.PRODUCTCODE
        AND PC.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS SPC
        ON
            1=1
        AND P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE
        AND SPC.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EXISTENCE AS E
        ON
            1=1
        AND P.YEJISHUXING=E.ID
        AND E.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS T
        ON
            1=1
        AND P.TRXTYPEID=T.ID
        WHERE
            P.TRXDATE =${START}
        AND (
                CASE
                    WHEN PP.ACCOUNTCLASS IS NULL
                    THEN 'çº¿ä_'
                    ELSE PP.ACCOUNTCLASS
                END) NOT IN('___è¡__')
        AND E.NAME IN ('__º¬____',
                       'ä¸_µ·____',
                       'å±±è¥¿____',
                       'æ²³å_____',
                       '__¥¿____',
                       'å¤©æ´¥____',
                       '_______',
                       'å±±ä_____',
                       'æµ______',
                       'æ±______',
                       'ç¦_»º____',
                       'å¹¿ä_____',
'__º¬äº____',
'__º¬ä¸____' )
        AND (
            C.PRODUCTLINE NOT IN ('ä¸_å¾__')
            OR C.PRODUCTLINE IS NULL)
        GROUP BY
            E.NAME,
            p.TRXDATE,
C.PRODUCTLINE,
case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end ) t
LEFT JOIN
    (
        SELECT
            DATA_PERIOD ,
            CAST(SUM(PROFIT) AS DECIMAL(18,4)) total
        FROM
            TBL_OPERATION_ANALYSIS_TRX_TOTAL
        WHERE
            DATA_PERIOD =${START}
        GROUP BY
            DATA_PERIOD ) s
ON
    t.TRXDATE = s.DATA_PERIOD
LEFT JOIN
    (
        SELECT
            COUNT(C.SIGNEDNAME) AS MERCHANT_COUNT,
           case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end as ACCOUNTTINGTYPE, 
C.PRODUCTLINE,
            P.TRXDATE           AS DATA_PERIOD,
            E.NAME              AS YEJISHUXING
        FROM
            DB2INST1.PUBLISHEDDAILYTRX AS P
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS B
        ON
            1=1
        AND P.BUSINESSCATID=B.ID
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S
        ON
            1=1
        AND P.SUBBUSINESSCAT=S.CODE
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND P.RECEIVERID=C.ID
        LEFT JOIN
            DB2INST1.PRODUCTCODE_PROFILE AS PP
        ON
            1=1
        AND P.PRODUCT_CODE=PP.PRODUCT_CODE
        AND P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS PC
        ON
            1=1
        AND P.PRODUCT_CODE=PC.PRODUCTCODE
        AND PC.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS SPC
        ON
            1=1
        AND P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE
        AND SPC.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EXISTENCE AS E
        ON
            1=1
        AND P.YEJISHUXING=E.ID
        AND E.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS T
        ON
            1=1
        AND P.TRXTYPEID=T.ID
        WHERE
            P.TRXDATE = ${START}
        AND (
                CASE
                    WHEN PP.ACCOUNTCLASS IS NULL
                    THEN 'çº¿ä_'
                    ELSE PP.ACCOUNTCLASS
                END) NOT IN('___è¡__')
        AND E.NAME IN ('__º¬____',
                       'ä¸_µ·____',
                       'å±±è¥¿____',
                       'æ²³å_____',
                       '__¥¿____',
                       'å¤©æ´¥____',
                       '_______',
                       'å±±ä_____',
                       'æµ______',
                       'æ±______',
                       'ç¦_»º____',
                       'å¹¿ä_____',
'__º¬äº____',
'__º¬ä¸____' )
        AND (
                C.PRODUCTLINE NOT IN ('ä¸_å¾__')
            OR C.PRODUCTLINE IS NULL)
        GROUP BY
            P.TRXDATE,
            E.NAME,
            C.PRODUCTLINE,
           case when PP.ACCOUNTINGTYPE is null then 'çº¿ä_-__' else PP.ACCOUNTINGTYPE end 
 ) c
ON
    t.TRXDATE = c.DATA_PERIOD
AND T.PRODUCTLINE=C.PRODUCTLINE
AND T.ACCOUNTTINGTYPE= C.ACCOUNTTINGTYPE
AND t.yejishuxing = c.YEJISHUXING",reportdb_yjkh
QATrxIndustryXinLingShou,QATrxIndustryXinLingShoue,"select
T.TRXDATE AS IDNOUSE,
T.TRXDATE AS DATA_PERIOD,
'_°é__ä¸_º¿' AS  HANGYEYEJISHUXING,
sum(T.ACCOUNTINGPROFIT*coalesce(T.YEJISCALE,1)) AS PROFIT,
sum(T.NEWINCOME*coalesce(T.YEJISCALE,1)+T.MANAGEFEEPREDICT*coalesce(T.YEJISCALE,1)-(T.NEWCOST*coalesce(T.YEJISCALE,1)+T.EXTERNALCOSTPREDICT*coalesce(T.YEJISCALE,1)))  AS MANAGER_PROFIT,
sum(CASE WHEN (T.BIZTYPEID IN (29,129) and T.TRXTYPEID not in ('POSRENT','POSSALES')) THEN T.ACCOUNTINGPROFIT*coalesce(T.YEJISCALE,1) ELSE T.INNERINCOME*coalesce(T.YEJISCALE,1) END) AS INCOME,
sum(T.TRXCOUNT*coalesce(T.YEJISCALE,1)) AS TRX_COUNT,
sum(CASE WHEN (T.BIZTYPEID IN (29,129) and T.TRXTYPEID not in ('POSRENT','POSSALES')) THEN 0 ELSE T.ACCOUNTINGCOST*coalesce(T.YEJISCALE,1) END) AS ACCOUNT_COST,
sum(T.TRXAMOUNT*coalesce(T.YEJISCALE,1)) AS TRX_AMOUNT,
t2.MERCHANT_COUNT AS MERCHANT_COUNT
from (
	select 
P.ACCOUNTINGPROFIT,
        p.NEWINCOME,
        P.MANAGEFEEPREDICT,
P.NEWCOST,
P.EXTERNALCOSTPREDICT,
	P.TRXAMOUNT,
	P.YEJISCALE,
	P.BIZTYPEID,
	P.TRXTYPEID,
	P.INNERINCOME,
	P.TRXCOUNT,
	P.ACCOUNTINGCOST,
	P.TRXDATE,
        B.NAME as lishihangyexian,
        CASE WHEN C.PRODUCTLINE IS NOT NULL THEN C.PRODUCTLINE
		WHEN SPC.PRODUCTNAME IN ('_¶æå®', '_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸' 
		WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____' 
		WHEN (SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') OR  SPC.PRODUCTNAME IS NULL)AND (PP.ACCOUNTCLASS IN ('ç§»å_', 'çº¿ä_') OR PP.ACCOUNTCLASS IS NULL) THEN '_£æ_ä¸__'
		WHEN (SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') OR SPC.PRODUCTNAME IS NULL) AND PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸' ELSE null END AS PRODUCTLINE
	from DB2INST1.PUBLISHEDDAILYTRX AS P
        left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on  P.BUSINESSCATID=B.ID 
	left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
	left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
	left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
	where P.TRXDATE = ${START} and PP.ACCOUNTCLASS != '___è¡__' 
) T
left join
(
	select 
count(1)
 AS MERCHANT_COUNT
	 from(
select distinct SIGNEDNAME from(
select
   C.SIGNEDNAME,
           B.NAME as lishihangyexian,
CASE WHEN C.PRODUCTLINE IS NOT NULL THEN C.PRODUCTLINE
		WHEN SPC.PRODUCTNAME IN ('_¶æå®', '_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸' 
		WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____' 
		WHEN SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') AND (PP.ACCOUNTCLASS IN ('ç§»å_', 'çº¿ä_') OR PP.ACCOUNTCLASS IS NULL) THEN '_£æ_ä¸__'
		WHEN SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') AND PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸' ELSE null END AS PRODUCTLINE
  from DB2INST1.PUBLISHEDDAILYTRX AS P
        left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on  P.BUSINESSCATID=B.ID 
    left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
    left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
    left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  where 
  (PP.ACCOUNTCLASS != '___è¡__' OR PP.ACCOUNTCLASS IS NULL)
and P.TRXDATE =${START}
group by C.SIGNEDNAME,P.TRXDATE,B.NAME,
CASE WHEN C.PRODUCTLINE IS NOT NULL THEN C.PRODUCTLINE
		WHEN SPC.PRODUCTNAME IN ('_¶æå®', '_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸' 
		WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____' 
		WHEN SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') AND (PP.ACCOUNTCLASS IN ('ç§»å_', 'çº¿ä_') OR PP.ACCOUNTCLASS IS NULL) THEN '_£æ_ä¸__'
		WHEN SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') AND PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸' ELSE null END
)
where PRODUCTLINE in('_°é__ä¸_º¿____','_°é__ä¸_º¿__º¿ä¸') 
group by SIGNEDNAME
) tmp2
)  t2 on 1=1
where t.PRODUCTLINE in('_°é__ä¸_º¿____','_°é__ä¸_º¿__º¿ä¸') 
group by
T.TRXDATE,t2.MERCHANT_COUNT
with ur",reportdb_yjkh
QATrxMerchantYejishuxing,QATrxMerchantYejishuxing,"SELECT
    DA.TRXDATE AS DATA_PERIOD,
    RECEIVER.SIGNEDNAME  AS SIGNED_NAME,
    RECEIVER.PRODUCTLINE AS PRODUCTLINE,
    ex.NAME              AS yejishuxing,
    CASE
        WHEN ex.NAME IN ('__º¬____',
                         'ä¸_µ·____',
                         'å±±è¥¿____',
                         'æ²³å_____',
                         '__¥¿____',
                         'å¤©æ´¥____',
                         '_______')
        THEN '_¼å_'
        WHEN ex.NAME IN ('å±±ä_____',
                         'æµ______',
                         'æ±______')
        THEN '___'
        WHEN ex.NAME = 'ç¦_»º____'
        THEN 'ç¦_»º'
        WHEN ex.NAME = 'å¹¿ä_____'
        THEN 'å¹¿ä_'
        ELSE ex.NAME
    END                 AS DAQU,
    SUM(DA.INNERPROFIT) AS profit
FROM
    DB2INST1.PUBLISHEDDAILYTRX AS DA
LEFT JOIN
    DB2INST1.CUSTOMERINFO AS RECEIVER
ON
    1=1
AND DA.RECEIVERID=RECEIVER.ID
LEFT JOIN
    DB2INST1.CUSTOMERRELATIONSHIP AS E2C
ON
    1=1
AND RECEIVER.ID=E2C.CUSTOMERID
LEFT JOIN
    DB2INST1.customer2achievement AS c2a
ON
    1=1
AND RECEIVER.customernumber=c2a.customer_number
LEFT JOIN
    DB2INST1.EXISTENCE AS ex
ON
    1=1
AND c2a.ACHIEVEMENT_ID=ex.ID
AND ex.CLASSTYPE='Department'
LEFT JOIN
    DB2INST1.productcode_profile AS PP
ON
    1=1
AND DA.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
AND DA.PRODUCT_CODE=PP.PRODUCT_CODE
WHERE
    DA.TRXDATE = ${START}
AND (
        CASE
            WHEN PP.ACCOUNTCLASS IS NULL
            THEN 'çº¿ä_'
            ELSE PP.ACCOUNTCLASS
        END) NOT IN('___è¡__')
AND ex.name IN ('__º¬____',
                'ä¸_µ·____',
                'å±±è¥¿____',
                'æ²³å_____',
                '__¥¿____',
                'å¤©æ´¥____',
                '_______',
                'å±±ä_____',
                'æµ______',
                'æ±______',
                'å¹¿ä_____',
                'ç¦_»º____')
AND (
        RECEIVER.PRODUCTLINE NOT IN ('ä¸_å¾ä¸_º¿',
                                     'ä¸_å¾__',
                                     'çº¿ä_V-')
    OR  RECEIVER.PRODUCTLINE IS NULL)
GROUP BY
    RECEIVER.SIGNEDNAME,
    ex.NAME,
    RECEIVER.PRODUCTLINE,
    DA.TRXDATE",reportdb_yjkh
QATrxMerchantSalesCenter,QATrxMerchantSalesCentere,"SELECT
    RECEIVER.SIGNEDNAME  AS SIGNED_NAME,
    DA.TRXDATE AS DATA_PERIOD,
    RECEIVER.PRODUCTLINE AS PRODUCTLINE,
    ex.NAME              AS yejishuxing,
    CASE
        WHEN ex.NAME IN ('__º¬____',
                         'ä¸_µ·____',
                         'å±±è¥¿____',
                         'æ²³å_____',
                         '__¥¿____',
                         'å¤©æ´¥____',
                         '_______')
        THEN '_¼å_'
        WHEN ex.NAME IN ('å±±ä_____',
                         'æµ______',
                         'æ±______')
        THEN '___'
        WHEN ex.NAME = 'ç¦_»º____'
        THEN 'ç¦_»º'
        WHEN ex.NAME = 'å¹¿ä_____'
        THEN 'å¹¿ä_'
        ELSE ex.NAME
    END                 AS DAQU,
sum(DA.NEWINCOME*coalesce(DA.YEJISCALE,1)+DA.MANAGEFEEPREDICT*coalesce(DA.YEJISCALE,1)-(DA.NEWCOST*coalesce(DA.YEJISCALE,1)+DA.EXTERNALCOSTPREDICT*coalesce(DA.YEJISCALE,1)))  AS MANAGER_PROFIT,
SUM(DA.ACCOUNTINGPROFIT*COALESCE(DA.YEJISCALE,1)) AS profit
FROM
    DB2INST1.PUBLISHEDDAILYTRX AS DA
LEFT JOIN
    DB2INST1.CUSTOMERINFO AS RECEIVER
ON
    1=1
AND DA.RECEIVERID=RECEIVER.ID
LEFT JOIN
    DB2INST1.customer2achievement AS c2a
ON
    1=1
AND RECEIVER.customernumber=c2a.customer_number
LEFT JOIN
    DB2INST1.EXISTENCE AS ex
ON
    1=1
AND c2a.ACHIEVEMENT_ID=ex.ID
AND ex.CLASSTYPE='Department'
LEFT JOIN
    DB2INST1.productcode_profile AS PP
ON
    1=1
AND DA.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
AND DA.PRODUCT_CODE=PP.PRODUCT_CODE
WHERE
    DA.TRXDATE = ${START}
AND (
        CASE
            WHEN PP.ACCOUNTCLASS IS NULL
            THEN 'çº¿ä_'
            ELSE PP.ACCOUNTCLASS
        END) NOT IN('___è¡__')
AND ex.name IN ('__º¬____',
                'ä¸_µ·____',
                'å±±è¥¿____',
                'æ²³å_____',
                '__¥¿____',
                'å¤©æ´¥____',
                '_______',
                'å±±ä_____',
                'æµ______',
                'æ±______',
                'å¹¿ä_____',
                'ç¦_»º____')
AND (
        RECEIVER.PRODUCTLINE NOT IN ('ä¸_å¾ä¸_º¿',
                                     'ä¸_å¾__',
                                     'çº¿ä_V-')
    OR  RECEIVER.PRODUCTLINE IS NULL)
GROUP BY
    RECEIVER.SIGNEDNAME,
    ex.NAME,
    RECEIVER.PRODUCTLINE,
    DA.TRXDATE",reportdb_yjkh
PublishedMonthlyTrxStatcostcenter,costcenter,"select 
'1601'||'201804'||coalesce(char(c.id),'null')||coalesce(char(d.CUSTOMERNUMBER ),'null')||coalesce(char(c.FULLNAME),'null')||coalesce(char(em.id),'null')||coalesce(char(c.areaid ),'null')||coalesce(char(d.biztypeid ),'null')||coalesce(char(d.type),'null')||coalesce(char(r.SHARESCALE),'null')||coalesce(char(r.isshare),'null')||coalesce(char(r.isself),'null')||coalesce(char(r.transfdate),'null')||coalesce(char(c.productgroup),'null')||coalesce(char(c.BUSSINESSCATID),'null')||coalesce(char(c.branchcompany),'null')||coalesce(char(d.product_code),'null')||coalesce(char(d.sales_product_code),'null')||coalesce(char(c2a.achievement_id ),'null')||coalesce(char(c2a.PERCENT ),'null')||coalesce(char(d.payerid),'null')||coalesce(char(c.productline),'null')||'costcenter' as idnouse,
1601 as timeLatitudeId, year(${START})*100+month(${START}) as MONTH,year(${START})*100+month(${START}) as true_month,c.id as CUSTOMERID,d.CUSTOMERNUMBER,c.FULLNAME as customerName, 
em.id as SALEID,0 as teamId,c.areaid,0 as productLineId,d.biztypeid,d.type as trxTypeId,r.SHARESCALE as salesscale,r.isshare as isShareCustomer,r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID as businesscatid,c.branchcompany,d.product_code,d.sales_product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline as hangyeyejishuxing, 'RECEIVER' as GROUPTYPE,
sum(coalesce(d.ACCOUNTINGCOST,0)*coalesce(r.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as NEWCOST 
from db2inst1.jingfen_dailytrx d 
left join db2inst1.CustomerInfo c on d.customernumber=c.customernumber
left join db2inst1.CustomerRelationship r on r.customerid=c.id 
left join db2inst1.employeeinfo em on r.EMPLOYEEID=em.ID 
left join db2inst1.customer2achievement c2a on c.customernumber=c2a.customer_number 
where  d.trxdate>=${START} and d.trxdate<${STOP}  and d.etltaskid like 'accountcostjingfen%' and (d.trxchannelid not in ('UPOP_POS_YLBMZ9010','UPOP_POS_YLBM9010(DH)','ICBC_POS_GHXY9010N') or d.trxchannelid is null)
group by c.id,d.CUSTOMERNUMBER,c.FULLNAME,em.id,c.areaid,d.biztypeid,d.type,r.SHARESCALE,r.isshare,r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID,c.branchcompany,d.product_code,d.sales_product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline with ur",reportdb
QATrxMerchantResult,QATrxMerchantResulte,"SELECT
    t.DATA_PERIOD ||  T.PROFIT ||  row_number() over(ORDER BY t.PROFIT DESC) || T.SIGNED_NAME AS IDN,
    t.DATA_PERIOD,
    row_number() over(ORDER BY t.PROFIT DESC) AS RANK,
    CASE
        WHEN TMP.BEFORE_RANK- row_number() over(ORDER BY t.PROFIT DESC) = 0
        THEN '-'
        WHEN TMP.BEFORE_RANK- row_number() over(ORDER BY t.PROFIT DESC) < 0
        THEN '_'
        ELSE '_'
    END AS RANK_CHANGE,
    CASE
        WHEN T1.SHORT_NAME IS NULL
        THEN T.SIGNED_NAME
        ELSE T1.SHORT_NAME
    END AS SIGNED_NAME,
T.SIGNED_NAME AS SIGNED_FULLNAME,
    T.PROFIT,
    T.TRX_AMOUNT AS TRXAMOUNT,
    T.SALESNAME AS SALES_NAME,
    CASE
        WHEN T2.SHORT_NAME IS NULL
        THEN T.PRODUCTLINE
        ELSE T2.SHORT_NAME
    END AS PRODUCTLINE
FROM
(
SELECT 
DATA_PERIOD,
SIGNED_NAME,
PRODUCTLINE,
LISTAGG(SALESNAME) AS SALESNAME,
SUM(PROFIT) AS PROFIT,
SUM(TRX_AMOUNT) AS TRX_AMOUNT
FROM
(
SELECT 
DATA_PERIOD,
SIGNED_NAME,
SALESNAME,
PRODUCTLINE,
SUM(PROFIT) AS PROFIT,
SUM(TRX_AMOUNT) AS TRX_AMOUNT
FROM
    TBL_OPERATION_ANALYSIS_TRX_MERCHANT 
WHERE
    DATA_PERIOD = ${START}
GROUP BY DATA_PERIOD,SIGNED_NAME,SALESNAME,PRODUCTLINE)
GROUP BY DATA_PERIOD,SIGNED_NAME,PRODUCTLINE
) t
LEFT JOIN
    (
        SELECT
            row_number() over(ORDER BY sum(PROFIT) DESC) AS BEFORE_RANK,
            SIGNED_NAME,
PRODUCTLINE
        FROM
            TBL_OPERATION_ANALYSIS_TRX_MERCHANT
        WHERE
            DATA_PERIOD = date(${START}) -1 day 
GROUP BY   SIGNED_NAME,PRODUCTLINE
) TMP
ON
    T.SIGNED_NAME= TMP.SIGNED_NAME
AND T.PRODUCTLINE = TMP.PRODUCTLINE
LEFT JOIN
    TBL_OPERATION_ANALYSIS_TOOL T1
ON
    T1.FULL_NAME=T.SIGNED_NAME
LEFT JOIN
    TBL_OPERATION_ANALYSIS_TOOL T2
ON
    T2.FULL_NAME=T.PRODUCTLINE
ORDER BY
    t.PROFIT DESC
FETCH
    FIRST 30 row only",reportdb_yjkh
customersigningtrans,customersigningtranse," select 
SIGNING_NO, SIGNING_NAME, LINKMAN, DEPARTMENT, POST, PHONE, MOBILE, QQ, MSN, NO_URL_FLAG, URL, DOMAIN, REMARK, USER_ID, USER_NAME, STATUS, EXPIRE_TIME, VERSION, CREATE_TIME, LAST_MODIFY_TIME, CUSTOMER_NO, BIZ_TYPE, ISOFFLINEAGENT, SIMPLE_NAME, COMPLETE_BASENUMBER, USER_ORGANIZATION, IS_AGREE, CUSTMR_PROVINCE, LAST_STATUS_MODIFY_TIME, INDUSTRY_LINE_TYPE
from SIGNING.TBL_CUSTOMER_SIGNING WHERE CREATE_TIME>='2016-01-01' AND STATUS='COMPLETED'",BOSS_standby
publisheddailytrxstat,3gauthcost,"select 
 coalesce(char(TRXDATE),'null')||coalesce(char(MEMO),'null')||'3gauthcost' AS idnouse,
trxdate as TRXDATE,
true_trxdate as TRUE_DATE,
sum(trxcount) as TRXCOUNT,
sum(cost) as INNERCOST,
sum(accountingcost) as ACCOUNTINGCOST,
product_code as PRODUCT_CODE,
sales_product_code as SALES_PRODUCT_CODE,
yejishuxing as YEJISHUXING,
biztypeid as BIZTYPEID,
type as TRXTYPEID,
businesscatid as BUSINESSCATID, 
'CHN' as BRANCHCOMPANY,
MEMO as MEMO 
from db2inst1.trxstatadditionalstatfee 
where trxdate>=${START} and trxdate<${STOP} and type='3gauthcost' 
group by trxdate,MEMO,true_trxdate,product_code, sales_product_code,yejishuxing,biztypeid,type,businesscatid with ur
",reportdb
publisheddailytrxstat,3gsmscost,"select coalesce(char(TRXDATE),'null')||coalesce(char(MEMO),'null')||'3gsmscost' AS idnouse,
trxdate as TRXDATE,
true_trxdate as TRUE_DATE,
sum(trxcount) as TRXCOUNT,
sum(cost) as INNERCOST,
sum(accountingcost) as ACCOUNTINGCOST,
product_code as PRODUCT_CODE,
sales_product_code as SALES_PRODUCT_CODE,
yejishuxing as YEJISHUXING,
biztypeid as BIZTYPEID,
type as TRXTYPEID,
businesscatid as BUSINESSCATID, 
'CHN' as BRANCHCOMPANY,
MEMO as MEMO 
from db2inst1.trxstatadditionalstatfee 
where trxdate>=${START} and trxdate<${STOP} and type='SMS_COST' 
group by trxdate,MEMO,true_trxdate,product_code, sales_product_code,yejishuxing,biztypeid,type,businesscatid with ur",reportdb
publisheddailytrxstat,pbnewcost,"select coalesce(char(RECEIVERID),'null')||coalesce(char(CUSTOMERNUMBER),'null')||coalesce(char(TRXDATE),'null')||coalesce(char(SALES_PRODUCT_CODE),'null')||coalesce(char(PRODUCT_CODE),'null')||coalesce(char(TYPE),'null')||'pbnewcost' as IDNOUSE,CUSTOMERNUMBER as custnum,TRXDATE,SALES_PRODUCT_CODE,PRODUCT_CODE,TYPE as TRXTYPEID,sum(ACCOUNTINGCOST) as NEWCOST 
from db2inst1.jingfen_dailytrx d
where   d.TRXDATE >= ${START} AND d.TRXDATE < ${STOP} 
group by RECEIVERID,CUSTOMERNUMBER,TRXDATE,SALES_PRODUCT_CODE,PRODUCT_CODE,TYPE with ur",reportdb
customersigninghistory,customersigninghistorye,"select 
SIGNING_NO, SIGNING_NAME, LINKMAN, DEPARTMENT, POST, PHONE, MOBILE, QQ, MSN, NO_URL_FLAG, URL, DOMAIN, REMARK, USER_ID, USER_NAME, STATUS, EXPIRE_TIME, VERSION, CREATE_TIME, LAST_MODIFY_TIME, CUSTOMER_NO, BIZ_TYPE, ISOFFLINEAGENT, SIMPLE_NAME, COMPLETE_BASENUMBER, USER_ORGANIZATION, IS_AGREE, CUSTMR_PROVINCE, LAST_STATUS_MODIFY_TIME, INDUSTRY_LINE_TYPE
from SIGNING.TBL_CUSTOMER_SIGNING WHERE CREATE_TIME>='2016-01-01 00:00:00' AND STATUS='COMPLETED' with ur",BOSS_standby
QATrxIndustrySmallMerchant,QATrxIndustrySmallMerchante,"select
T.TRXDATE || T.PRODUCTLINE|| T.YEJISHUXING AS IDNOUSE,
T.TRXDATE AS DATA_PERIOD,
T.PRODUCTLINE ,
T.YEJISHUXING,
t.PROFIT,
T.TRX_AMOUNT,
T2.MERCHANT_COUNT
from (
	select 
	P.TRXDATE,
	 E.NAME AS YEJISHUXING,
	 sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1)) AS TRX_AMOUNT,
	 sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) AS PROFIT,
	 C.PRODUCTLINE AS PRODUCTLINE
	from DB2INST1.PUBLISHEDDAILYTRX AS P
	left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
	left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
	left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
	left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
	where P.TRXDATE = ${START} AND C.PRODUCTLINE='ä¸_å¾__' AND (PP.ACCOUNTINGTYPE IS NULL OR PP.ACCOUNTINGTYPE IN('çº¿ä_-__','çº¿ä_-__å¢_','çº¢çº¿-__','çº¢çº¿-__å¢_'))
	GROUP BY P.TRXDATE,E.NAME, C.PRODUCTLINE
) T
LEFT JOIN
(
	select 
	 E.NAME AS YEJISHUXING,
	COUNT(distinct C.SIGNEDNAME) AS MERCHANT_COUNT
	from DB2INST1.PUBLISHEDDAILYTRX AS P
	left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
	left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
	left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
	left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
	where P.TRXDATE =${START} AND C.PRODUCTLINE='ä¸_å¾__' AND (PP.ACCOUNTINGTYPE IS NULL OR PP.ACCOUNTINGTYPE IN('çº¿ä_-__','çº¿ä_-__å¢_','çº¢çº¿-__','çº¢çº¿-__å¢_'))
        group by E.NAME
)  t2
on t.YEJISHUXING=T2.YEJISHUXING
with ur",reportdb_yjkh
QATrxIndustryMerchantSmall,QATrxIndustryMerchantSmalle,"select
T.TRXDATE || T.PRODUCTLINE|| T.YEJISHUXING AS IDNOUSE,
T.TRXDATE AS DATA_PERIOD,
T.PRODUCTLINE ,
T.YEJISHUXING,
t.PROFIT,
T.TRX_AMOUNT,
T2.MERCHANT_COUNT
from (
	select 
	P.TRXDATE,
	 E.NAME AS YEJISHUXING,
	 sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1)) AS TRX_AMOUNT,
	 sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) AS PROFIT,
	 C.PRODUCTLINE AS PRODUCTLINE
	from DB2INST1.PUBLISHEDDAILYTRX AS P
	left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
	left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
	left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
	left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
	where P.TRXDATE = ${START} AND C.PRODUCTLINE='ä¸_å¾__' AND (PP.ACCOUNTINGTYPE IS NULL OR PP.ACCOUNTINGTYPE IN('çº¿ä_-__','çº¿ä_-__å¢_','çº¢çº¿-__','çº¢çº¿-__å¢_'))
	GROUP BY P.TRXDATE,E.NAME, C.PRODUCTLINE
) T
LEFT JOIN
(
	select 
	 E.NAME AS YEJISHUXING,
	COUNT(distinct C.SIGNEDNAME) AS MERCHANT_COUNT
	from DB2INST1.PUBLISHEDDAILYTRX AS P
	left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
	left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
	left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
	left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
	where P.TRXDATE =${START} AND C.PRODUCTLINE='ä¸_å¾__' AND (PP.ACCOUNTINGTYPE IS NULL OR PP.ACCOUNTINGTYPE IN('çº¿ä_-__','çº¿ä_-__å¢_','çº¢çº¿-__','çº¢çº¿-__å¢_'))
        group by E.NAME
)  t2
on t.YEJISHUXING=T2.YEJISHUXING
with ur",reportdb_yjkh
QATrxIndustryMerchantTiny,QATrxIndustryMerchantTinye,"select
T.TRXDATE || T.PRODUCTLINE|| T.YEJISHUXING AS IDNOUSE,
T.TRXDATE AS DATA_PERIOD,
T.PRODUCTLINE,
T.YEJISHUXING,
t.PROFIT,
t.MANAGER_PROFIT,
T.TRX_AMOUNT,
T2.MERCHANT_COUNT
from (
	select 
	P.TRXDATE,
	 coalesce(E.NAME,'_¨å_') AS YEJISHUXING,
	 sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1)) AS TRX_AMOUNT,
	 sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) AS PROFIT,
sum(P.NEWINCOME*coalesce(P.YEJISCALE,1)+P.MANAGEFEEPREDICT*coalesce(P.YEJISCALE,1)-(P.NEWCOST*coalesce(P.YEJISCALE,1)+P.EXTERNALCOSTPREDICT*coalesce(P.YEJISCALE,1)))  AS MANAGER_PROFIT,
	 C.PRODUCTLINE AS PRODUCTLINE
	from DB2INST1.PUBLISHEDDAILYTRX AS P
	left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
	left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
	left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
	left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
	where P.TRXDATE = ${START} AND C.PRODUCTLINE='ä¸_å¾__' AND (PP.ACCOUNTINGTYPE IS NULL OR PP.ACCOUNTINGTYPE IN('çº¿ä_-__','çº¿ä_-__å¢_','çº¢çº¿-__','çº¢çº¿-__å¢_'))
	GROUP BY P.TRXDATE,coalesce(E.NAME,'_¨å_'), C.PRODUCTLINE
) T
LEFT JOIN
(
	select 
	 coalesce(E.NAME,'_¨å_') AS YEJISHUXING,
	COUNT(distinct C.SIGNEDNAME) AS MERCHANT_COUNT
	from DB2INST1.PUBLISHEDDAILYTRX AS P
	left join DB2INST1.CUSTOMERINFO AS C on P.RECEIVERID=C.ID 
	left join DB2INST1.PRODUCTCODE_PROFILE AS PP on P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
	left join DB2INST1.PRODUCTCODE AS SPC on P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1
	left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
	where P.TRXDATE =${START} AND C.PRODUCTLINE='ä¸_å¾__' AND (PP.ACCOUNTINGTYPE IS NULL OR PP.ACCOUNTINGTYPE IN('çº¿ä_-__','çº¿ä_-__å¢_','çº¢çº¿-__','çº¢çº¿-__å¢_'))
        group by coalesce(E.NAME,'_¨å_')
)  t2
on t.YEJISHUXING=T2.YEJISHUXING
with ur",reportdb_yjkh
customersigningother,customersigningothere,"
select 
SIGNING_NO, SIGNING_NAME, LINKMAN, DEPARTMENT, POST, PHONE, MOBILE, QQ, MSN, NO_URL_FLAG, URL, DOMAIN, REMARK, USER_ID, USER_NAME, STATUS, EXPIRE_TIME, VERSION, CREATE_TIME, LAST_MODIFY_TIME, CUSTOMER_NO, BIZ_TYPE, ISOFFLINEAGENT, SIMPLE_NAME, COMPLETE_BASENUMBER, USER_ORGANIZATION, IS_AGREE, CUSTMR_PROVINCE, LAST_STATUS_MODIFY_TIME, INDUSTRY_LINE_TYPE
from SIGNING.TBL_CUSTOMER_SIGNING WHERE CREATE_TIME>='2016-01-01' AND STATUS='COMPLETED' AND CUSTOMER_NO IS NULL WITH UR",BOSS_standby
publisheddailytrxstatfinal,pbdailytrxstat,"select COALESCE(CHAR(d.trxdate),'null')||COALESCE(CHAR(i.transfdate),'null')||COALESCE(CHAR(d.trxdate),'null')||
COALESCE(CHAR(d.receiverid),'null')||COALESCE(CHAR(d.payerid),'null')||COALESCE(CHAR(d.biztypeid),'null')||
COALESCE(CHAR(d.type),'null')||COALESCE(CHAR(d.product_code),'null')||COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(i.custnum),'null')||COALESCE(CHAR(i.custname),'null')||COALESCE(CHAR(i.salesid),'null')||
COALESCE(CHAR(i.salesname),'null')||COALESCE(CHAR(i.isself),'null')||COALESCE(CHAR(i.isshare),'null')||
COALESCE(CHAR(i.salesscale),'null')||COALESCE(CHAR(i.yejishuxing),'null')||COALESCE(CHAR(i.yejiscale),'null')||
COALESCE(CHAR(i.vmark),'null')||COALESCE(CHAR(i.vipmark),'null')||COALESCE(CHAR(i.branchcompany),'null')||
COALESCE(CHAR(i.businesscatid),'null')||COALESCE(CHAR(i.subbusinesscat),'null')||'pbdailytrxstat' as IDNOUSE,
d.trxdate as trxdate,
i.transfdate as transfdate,
d.trxdate as true_date,
d.receiverid as receiverid,
d.payerid as payerid,
d.biztypeid as biztypeid,
d.type as trxtypeid,
d.product_code as product_code,
d.sales_product_code as sales_product_code,
i.custnum as custnum,
i.custname as custname,
i.salesid as salesid,
i.salesname as salesname,
i.isself as isself,
i.isshare as isshare,
i.salesscale as salesscale,
i.yejishuxing as yejishuxing,
i.yejiscale as yejiscale,
i.vmark as vmark,
i.vipmark as vipmark,
i.branchcompany as branchcompany,
i.businesscatid as businesscatid,
i.subbusinesscat as subbusinesscat,
SUM(d.accountingcost * i.salesscale * i.yejiscale) as accountingcost,
SUM(d.trxfee * i.salesscale* i.yejiscale - d.refundfee * i.salesscale * i.yejiscale - d.accountingcost * i.salesscale * i.yejiscale + d.refundfrpcost * i.salesscale * i.yejiscale) as accountingprofit,
SUM(d.accountingcost * i.salesscale * i.yejiscale) as innercost,
SUM(d.trxfee * i.salesscale * i.yejiscale- d.refundfee * i.salesscale * i.yejiscale) as innerincome,
SUM(d.trxfee * i.salesscale* i.yejiscale - d.refundfee * i.salesscale * i.yejiscale - d.accountingcost * i.salesscale * i.yejiscale + d.refundfrpcost * i.salesscale * i.yejiscale) as innerprofit,
SUM(d.trxamount * i.salesscale * i.yejiscale- d.refundamount * i.salesscale * i.yejiscale) as trxamount,
SUM(d.trxcount * i.salesscale * i.yejiscale- d.refundcount * i.salesscale * i.yejiscale) as trxcount 
from db2inst1.dailytrxstat d 
left join db2inst1.publisheddailyinfo i on d.receiverid=i.custid and i.trxdate=d.trxdate 
where d.receiverid is not null 
and d.receiverid not in (524857,980067,11219567) 
AND d.ISCOMPUTEPROFIT = 1 
AND d.type NOT IN('SettleTransf') 
AND i.trxdate >= ${START} AND i.trxdate < ${STOP} 
group by 
d.trxdate,
i.transfdate,
d.trxdate,
d.receiverid,
d.payerid,
d.biztypeid,
d.type,
d.product_code,
d.sales_product_code,
i.custnum,
i.custname,
i.salesid,
i.salesname,
i.isself,
i.isshare,
i.salesscale,
i.yejishuxing,
i.yejiscale,
i.vmark,
i.vipmark,
i.branchcompany,
i.businesscatid,
i.subbusinesscat 
with ur",reportdb
publisheddailytrxstatfinal,pb3gauthcost,"select 
 coalesce(char(TRXDATE),'null')||coalesce(char(MEMO),'null')||'pb3gauthcost' AS idnouse,
trxdate as TRXDATE,
true_trxdate as TRUE_DATE,
sum(trxcount) as TRXCOUNT,
sum(cost) as INNERCOST,
sum(accountingcost) as ACCOUNTINGCOST,
product_code as PRODUCT_CODE,
sales_product_code as SALES_PRODUCT_CODE,
yejishuxing as YEJISHUXING,
biztypeid as BIZTYPEID,
type as TRXTYPEID,
businesscatid as BUSINESSCATID, 
'CHN' as BRANCHCOMPANY,
MEMO as MEMO 
from db2inst1.trxstatadditionalstatfee 
where trxdate>=${START} and trxdate<${STOP} and type='3gauthcost' 
group by trxdate,MEMO,true_trxdate,product_code, sales_product_code,yejishuxing,biztypeid,type,businesscatid with ur
",reportdb
publisheddailytrxstatfinal,pb3gsmscost,"select coalesce(char(TRXDATE),'null')||coalesce(char(MEMO),'null')||'pb3gsmscost' AS idnouse,
trxdate as TRXDATE,
true_trxdate as TRUE_DATE,
sum(trxcount) as TRXCOUNT,
sum(cost) as INNERCOST,
sum(accountingcost) as ACCOUNTINGCOST,
product_code as PRODUCT_CODE,
sales_product_code as SALES_PRODUCT_CODE,
yejishuxing as YEJISHUXING,
biztypeid as BIZTYPEID,
type as TRXTYPEID,
businesscatid as BUSINESSCATID, 
'CHN' as BRANCHCOMPANY,
MEMO as MEMO 
from db2inst1.trxstatadditionalstatfee 
where trxdate>=${START} and trxdate<${STOP} and type='SMS_COST' 
group by trxdate,MEMO,true_trxdate,product_code, sales_product_code,yejishuxing,biztypeid,type,businesscatid with ur",reportdb
publisheddailytrxstatfinal,pbfnewcost,"select coalesce(char(RECEIVERID),'null')||coalesce(char(CUSTOMERNUMBER),'null')||coalesce(char(TRXDATE),'null')||coalesce(char(SALES_PRODUCT_CODE),'null')||coalesce(char(PRODUCT_CODE),'null')||coalesce(char(TYPE),'null')||'pbfnewcost' as IDNOUSE,CUSTOMERNUMBER as custnum,TRXDATE,SALES_PRODUCT_CODE,PRODUCT_CODE,TYPE as TRXTYPEID,sum(ACCOUNTINGCOST) as NEWCOST 
from db2inst1.jingfen_dailytrx d
where   d.TRXDATE >= ${START} AND d.TRXDATE < ${STOP} 
group by RECEIVERID,CUSTOMERNUMBER,TRXDATE,SALES_PRODUCT_CODE,PRODUCT_CODE,TYPE with ur",reportdb
bankcodepair,bankcodepair,"select bp.id,bp.BANK_CODE,bp.bank_msg,bp.BIZ_CODE,bp.GROUP_ID from BANK.TBL_BANK_BIZ_TO_BANK_CODE_PAIR bp with ur
",cashier_bank_standby
zgtyjzfcost,zgtyjzfcost1,"SELECT COALESCE(
    CHAR(merchant_account_code) ,
    'null'
) || COALESCE(
    CHAR(a.product_catalog) ,
    'null'
) || COALESCE(
    CHAR(a.pay_type) ,
    'null'
) || COALESCE(
    CHAR(a.fee_type) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(a.PAY_TIME)
    ) ,
    'null'
) || COALESCE(
    a.CARD_TYPE_ID ,
    'null'
) || COALESCE(
    a.bank_code ,
    'null'
) || COALESCE(
    b.frp_code ,
    'null'
) || 'zgtpayTrade3011004004001' as IDNOUSE ,
'ZGT' as dataorigin ,
'3011004004001'  as product_code ,
'3011004001003A' as  SALES_PRODUCT_CODE, 
merchant_account_code as RECEIVERID ,
SUM( a.ORDER_AMOUNT / 100.00 ) AS trxamount ,
0   AS trxfee ,
COUNT(*) AS trxcount ,
SUM(
    a.BANK_COST / 100.00
) AS accountingcost ,
SUM(
    a.BANK_COST / 100.00
) AS frpcost ,
a.product_catalog as goodscate ,
'WECHAT_SALES' as ordertype ,
CASE a.fee_type
 WHEN 1 THEN 'POSTPAID' ELSE 'PAID'
END AS feetype ,
DATE(a.PAY_TIME) AS trxdate ,
case a.CARD_TYPE_ID when 1 then 'CREDITCARD' when '2' then 'DEBITCARD' else 'UNKNOWN' end as cardtype ,
a.bank_code ,
b.frp_code as trxchannelid ,
year(a.PAY_TIME) * 100 + month(a.PAY_TIME) as month FROM EWALLET.DATA_PAY_SUCCESS a 
left join ewallet.pay_biz_order b on a.order_id = b.order_id WHERE a.PAY_TIME >= ${START} AND a.PAY_TIME < ${STOP}
and a.order_origin  in(11) 
and a.pay_type IN (19,20,54)
and a.merchant_account_code not like 'YB%' GROUP BY 
    merchant_account_code ,
    a.product_catalog ,
    a.pay_type,
    a.fee_type ,
    DATE(a.PAY_TIME) ,
    a.CARD_TYPE_ID ,
    a.bank_code ,
    b.frp_code ,
    MONTH(a.PAY_TIME) ,
    YEAR(a.PAY_TIME)  with ur ",INNO_STANBY
zgtyjzfcost,zgtyjzfcost2,"SELECT COALESCE(
    CHAR(merchant_account_code) ,
    'null'
) || COALESCE(
    CHAR(a.product_catalog) ,
    'null'
) || COALESCE(
    CHAR(a.pay_type) ,
    'null'
) || COALESCE(
    CHAR(a.fee_type) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(a.PAY_TIME)
    ) ,
    'null'
) || COALESCE(
    a.CARD_TYPE_ID ,
    'null'
) || COALESCE(
    a.bank_code ,
    'null'
) || COALESCE(
    b.frp_code ,
    'null'
) || 'zgtpayTrade6001' as IDNOUSE ,
'ZGT' as dataorigin ,
'3011001006001'  as product_code ,
'3011004001003A' as  SALES_PRODUCT_CODE, 
merchant_account_code as RECEIVERID ,
SUM( a.ORDER_AMOUNT / 100.00 ) AS trxamount ,
0   AS trxfee ,
COUNT(*) AS trxcount ,
SUM(
    a.BANK_COST / 100.00
) AS accountingcost ,
SUM(
    a.BANK_COST / 100.00
) AS frpcost ,
a.product_catalog as goodscate ,
case when a.pay_type in (21,30,31 )
then 'WECHAT_SALES'
else 'ALIPAY_SALES' end as ordertype ,
CASE a.fee_type
 WHEN 1 THEN 'POSTPAID' ELSE 'PAID'
END AS feetype ,
DATE(a.PAY_TIME) AS trxdate ,
case a.CARD_TYPE_ID when 1 then 'CREDITCARD' when '2' then 'DEBITCARD' else 'UNKNOWN' end as cardtype ,
a.bank_code ,
b.frp_code as trxchannelid ,
year(a.PAY_TIME) * 100 + month(a.PAY_TIME) as month FROM EWALLET.DATA_PAY_SUCCESS a 
left join ewallet.pay_biz_order b on a.order_id = b.order_id WHERE a.PAY_TIME >= ${START} AND a.PAY_TIME < ${STOP}
and a.order_origin  in(11) 
and a.pay_type IN (21,28,29,30,31)
and a.merchant_account_code not like 'YB%' GROUP BY 
    merchant_account_code ,
    a.product_catalog ,
    a.pay_type,
    a.fee_type ,
    DATE(a.PAY_TIME) ,
    a.CARD_TYPE_ID ,
    a.bank_code ,
    b.frp_code ,
    MONTH(a.PAY_TIME) ,
    YEAR(a.PAY_TIME)  with ur",INNO_STANBY
zgtyjzfcost,zgtyjzfcost3,"SELECT COALESCE(
    CHAR(merchant_account_code) ,
    'null'
) || COALESCE(
    CHAR(a.product_catalog) ,
    'null'
) || COALESCE(
     CHAR(a.pay_type) ,
    'null'
) || COALESCE(
    CHAR(a.fee_type) ,
    'null'
) || COALESCE(
    CHAR(
        DATE(a.PAY_TIME)
    ) ,
    'null'
) || COALESCE(
    a.CARD_TYPE_ID ,
    'null'
) || COALESCE(
    a.bank_code ,
    'null'
) || COALESCE(
    b.frp_code ,
    'null'
) || 'zgtpayTrade3001' as IDNOUSE ,
'ZGT' as dataorigin ,
'3011001003001'  as product_code ,
'3011004001003A' as  SALES_PRODUCT_CODE, 
merchant_account_code as RECEIVERID ,
SUM( a.ORDER_AMOUNT / 100.00 ) AS trxamount ,
0   AS trxfee ,
COUNT(*) AS trxcount ,
SUM(
    a.BANK_COST / 100.00
) AS accountingcost ,
SUM(
    a.BANK_COST / 100.00
) AS frpcost ,
a.product_catalog as goodscate ,
'YJZF' as ordertype ,
CASE a.fee_type
 WHEN 1 THEN 'POSTPAID' ELSE 'PAID'
END AS feetype ,
DATE(a.PAY_TIME) AS trxdate ,
case a.CARD_TYPE_ID when 1 then 'CREDITCARD' when '2' then 'DEBITCARD' else 'UNKNOWN' end as cardtype ,
a.bank_code ,
b.frp_code as trxchannelid ,
year(a.PAY_TIME) * 100 + month(a.PAY_TIME) as month FROM EWALLET.DATA_PAY_SUCCESS a 
left join ewallet.pay_biz_order b on a.order_id = b.order_id WHERE a.PAY_TIME >= ${START} AND a.PAY_TIME < ${STOP}
and a.order_origin  in(11) 
and a.pay_type IN (23)
and a.merchant_account_code not like 'YB%' GROUP BY 
    merchant_account_code ,
    a.product_catalog ,
    a.pay_type,
    a.fee_type ,
    DATE(a.PAY_TIME) ,
    a.CARD_TYPE_ID ,
    a.bank_code ,
    b.frp_code ,
    MONTH(a.PAY_TIME) ,
    YEAR(a.PAY_TIME)  with ur ",INNO_STANBY
xiaojinbankinterfacereport,xiaojinbankinterfacereport,"SELECT
COALESCE(CHAR(YEEPAY_MERCHANT_NO),'null') || COALESCE(CHAR(TRADE_INTERFACE),'null') || COALESCE(CHAR(BANK_CHANNEL_NAME),'null') || 
COALESCE(CHAR(BANKID),'null') || COALESCE(CHAR(CARD_TYPE),'null') || COALESCE(CHAR(TRADE_DATE),'null') || 
COALESCE(CHAR(REQUEST_TYPE),'null') || COALESCE(CHAR(DEAL_STATUS),'null') || COALESCE(CHAR(BANK_RETURN_CODE),'null') ||'xiaojinbankinterfacedetail' AS IDNOUSE, 
o.YEEPAY_MERCHANT_NO AS MERCHANT_NO,
o.TRADE_INTERFACE AS TRADE_INTERFACE,
c.BANK_CHANNEL_NAME AS BANK_CHANNEL_NAME,
o.BANKID AS BANK,
o.CARD_TYPE AS CARD_TYPE,
o.TRADE_DATE AS TRADE_DATE,
o.REQUEST_TYPE AS REQUEST_TYPE,
o.DEAL_STATUS AS DEAL_STATUS,
o.BANK_RETURN_CODE AS BANK_RETURN_CODE,
o.BANK_RETURN_MSG AS BANK_RETURN_MSG,
count(o.ID) AS TRADE_COUNT,
sum(nvl(o.TRADE_AMOUNT,0)) AS TRADE_AMOUNT
FROM
BANK.TBL_BANK_NOCARD_ORDER AS o
LEFT JOIN BANK.TBL_BANK_BASIC_CHANNEL AS c ON o.TRADE_INTERFACE=c.BANK_CHANNEL_CODE
WHERE o.CREATE_TIME>=${START} AND o.CREATE_TIME<=${STOP}
GROUP BY o.YEEPAY_MERCHANT_NO,o.TRADE_INTERFACE,c.BANK_CHANNEL_NAME,o.BANKID,o.CARD_TYPE,
		 o.TRADE_DATE,o.REQUEST_TYPE,o.DEAL_STATUS,o.BANK_RETURN_CODE,o.BANK_RETURN_MSG",cashier_bank
customeryangespark,cuyangespark1,"select 'baiweioutkill20161125' as baiweioutkill20161125,c.id as id,c.active,c.customerNumber,c.fullname,c.groupId,c.shortname,c.createDate,bc.name as businessCat,subBusinessCat,c.area,pf1.value as linkman,pf2.value as webUrl,pf.value as signedName,a.balance as accountBalance,ca.balance as creditBalance,ca.creditLimit,c.bindMobile as mobile,c.phone,date(si.lastsettledate) as lastsettledate, pf3.value as netSigned, c.productGroup,pf4.value as address,bc.id as bussinessCatId,pf5.value as province,si.cycleType as cycletype,si.reserveDays,coalesce(cg.grade,'') as gradelevel, 'NETSIGNED' as customertype,c.customerNumber as MERCHANTNO,a.balancelastupdatedate,cd.DOCUMENTNUMBER as legal_idcard,cd.DESCRIPTION as legal_name,pf6.value as audit_Status,a.status as account_status,r.BANKACTID as settle_bankaccount,r.province as settle_bankprovince,r.city as settle_bankcity,r.branchName as settle_bankbranch,ba.fullname as settle_bankname,r.accountName as settle_accountname,pf7.value as icp,c.customertype as signed_type   from Customer c left join profile pf on c.ID=pf.customer_id and pf.name='p_signedName'  left join profile pf1 on c.id=pf1.customer_id and pf1.name='p_linkman'  left join profile pf2 on c.id=pf2.customer_id and pf2.name='p_customerSiteUrl'  left join profile pf3 on c.id=pf3.customer_id and pf3.name='p_signed'  left join profile pf4 on c.id=pf4.customer_id and pf4.name='p_address'  left join profile pf5 on c.id=pf5.customer_id and pf5.name='p_province'  left join profile pf6 on c.id=pf6.customer_id and pf6.name='p_auditStatus' left join profile pf7 on c.ID=pf7.CUSTOMER_ID and pf7.NAME='p_icp' left join account a on (c.id=a.customer_id and a.classtype='LocalAccount' and a.localAccountType='SVA')  left join CreditAccount ca on (c.id=ca.customerId)  left join settlementinfo si on c.id=si.customer_id left join account r on si.bankAccount_id=r.id and r.classtype='RemoteAccount' left join bank ba on r.bank_id=ba.id left join BusinessCategorie  bc on bc.id=c.businessCat  left join customergradeinfo cg on c.id=cg.customerid and cg.status in ('WAITRESCORE','COMPLETE','NOQUESSCORE') left join customerdocinfo  cd on  (c.CUSTOMERNUMBER=cd.CUSTOMERNUMBER and  cd.DOCUMENTNAME='æ³_ººèº»½è¯')  where c.customerType='ENTERPRISE' and c.customerNumber  is not null  fetch first 10000 rows only   with ur",COPY2
customeryangespark,cuyangevmarkspark,"select CUSTOMERNUMBER CUSTOMERNUMBER, coalesce(CUSTOMERLEVEL,'V') as VMARK from CUSTOMERGRADELEVEL where CUSTOMERNUMBER is not null with ur",COPY2
customeryangespark,yangeaccmarkspark,"select customerExt.CUSTOMERNUMBER as CUSTOMERNUMBER,customerExt.PERFORMANCE_ATTRIBUTE as ACCMARK from SIGNING.TBL_CUSTOMER_EXT customerExt,SIGNING.TBL_PERFORMANCE_ATTRIBUTE attribute  where customerExt.PERFORMANCE_ATTRIBUTE=attribute.ATTRIBUTE_CODE and customerExt.customernumber is not null and customerExt.PERFORMANCE_ATTRIBUTE != '5' with ur",BOSS
customeryangespark,yangesigndatespark,"select  customernumber as CUSTOMERNUMBER, min(STARTDATE) as SIGNED_DATE
from mobilebe.CONTRACTMANAGER 
group by customernumber
having  min(STARTDATE) >='1990-01-01' AND min(STARTDATE) <='2018-02-01'
with ur",COPY2
customeryangespark,yangesalesnamespark,"select  e.cust_id as ID,em.name as SALESNAME,em.id as SALESID 
from db2inst1.employee2customer e 
left join db2inst1.employeeinfo em on e.emp_id=em.id ",reportdb
customeryangespark,yangevipmarkspark,"select  CUSTOMER_NUMBER as CUSTOMERNUMBER , case when CUSTOMER_LABEL_VALUE='SVIP' then 2 else 1 end as vipmark 
from SIGNING.TBL_CUSTOMER_LABEL_ATTRIBUTE 
where CUSTOMER_LABEL='customer_vip_level' and status=1 
with ur",BOSS
customeryangespark,yangehangyeyejispark,"select NUMBER as CUSTOMERNUMBER,TAG as PRODUCTLINE from CUSCENTER.TBL_TAG",dzh_standby
customeryangespark,yangepostpaidzhangqispark,"SELECT 
CUSTOMER_NUMBER as CUSTOMERNUMBER,
integer(PAYMENT_PERIOD) as PRODUCTLINEID
FROM FEE.TBL_FRONT_FEE_CUSTOMER WHERE PAYMENT_PERIOD IS NOT NULL with ur",feedb
customeryangespark,customeryangezizhispark,"select c.customernumber as CUSTOMERNUMBER,cd5.DOCUMENTNUMBER as business_licence,cd5.AVAILABDATA as business_licence_AVAILABDATE,cd4.DOCUMENTNUMBER as Unified_credit_no,cd4.AVAILABDATA as  Unified_credit_no_AVAILABDATE,cd7.DOCUMENTNUMBER as organization_no,cd7.AVAILABDATA as organization_no_AVAILABDATE,cd8.DOCUMENTNUMBER as tax_regist_no,ca.auditPassTime as audit_date,c.email as email
from mobilebe.CUSTOMER c 
left join mobilebe.customerdocinfo cd4 on cd4.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd4.DOCUMENTNAME='ç»__ç¤¾ä_ä¿¡ç_ä»£ç_' 
left join mobilebe.customerdocinfo cd5 on cd5.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd5.DOCUMENTNAME='_¥ä__§ç_' 
left join mobilebe.customerdocinfo cd7 on cd7.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd7.DOCUMENTNAME='ç»___ºæ_ä»£ç_è¯' 
left join mobilebe.customerdocinfo cd8 on cd8.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd8.DOCUMENTNAME='ç¨___»èè¯' 
left join mobilebe.CustomerAptitudeAduit ca on c.id=ca.customerid
with ur",COPY2
customeryangespark,netagentyangespark,"select customer_num as CUSTOMERNUMBER,num as AGENTCODE,name as AGENTNAME,'NET' as AGENTTYPE from agentfr.tbl_agency_relation ar left join agentfr.tbl_agent a on a.id = ar.agent_id where ar.state='ENABLE' and a.agency_state!='STOP' and customer_num is not null with ur",agentfr
COMMISSIONMT,COMMISSIONMTE,"select COALESCE(CHAR(p.CUSTOMER_NUMBER),'null')||COALESCE(CHAR(p.PRODUCT_CODE),'null')||COALESCE(CHAR(p.sales_product_code),'null')||COALESCE(CHAR(p.MONTH),'null')||'COMMISSIONMT' as IDNOUSE,
0 as biztypeid,
'SUBCOMPANYCOMMISSION'  as type,
0 as trxcount,
0 as trxamount,
sum(-P.MITANG_PROFIT_AMT) as trxfee,
0 as ACCOUNTINGCOST,
0 as frpcost,
CONCAT(p.MONTH,'ç»______»£___10018126689____©å_æ¶') as MEMO,
0 as iscomputebonus,
1 as iscomputeprofit,
p.PRODUCT_CODE as product_code,
p.sales_product_code as sales_product_code,
'2018-04-30' as trxdate,
p.CUSTOMER_NUMBER as receiverid,
p.MONTH as month
from YMF.YMF_PROFIT p
where 
p.MONTH>= '201804' and p.MONTH<'201805'  and p.CALCULATE_STATUS ='SUCCESS'
group by 
p.CUSTOMER_NUMBER,
p.PRODUCT_CODE,
p.sales_product_code,
p.MONTH
with ur",dzh_standby
QAErrorCodeHJEnd,QAErrorCodeHJEnde,"SELECT
            tmp1.ORDER_TYPE || coalesce(tmp1.MERCHANT_NUMBER, '-') || coalesce(tmp1.BANK_CODE, '-') || coalesce(tmp1.ERROR_CODE, '-') || ${START} AS IDNOUSE,
            tmp1.ORDER_TYPE,
            ${START} AS TX_DATE,
            tmp1.MERCHANT_NUMBER,
            tmp1.BANK_CODE,
            tmp1.ERROR_CODE AS ERROR_CODE,
            tmp1.ERROR_MSG AS ERROR_MSG,
            tmp1.ERROR_NUMBER AS ERROR_NUMBER,
            tmp1.TOTAL_TRADE_NUMBER AS TOTAL_TRADE_NUMBER,
            tmp2.TOTAL_ERROR_NUMBER AS TOTAL_ERROR_NUMBER,
            tmp1.TRX_RATE,
            cast(tmp1.ERROR_NUMBER as double)/tmp2.TOTAL_ERROR_NUMBER*100 AS ERROR_RATE
        FROM
TBL_QUALITY_ANALYSIS_ERRORCODE tmp1
LEFT JOIN
    DB2INST1.CUSTOMERINFO CU1
ON
    tmp1.MERCHANT_NUMBER = CU1.CUSTOMERNUMBER
INNER JOIN
    DB2INST1.TRXSTATSUBBUSINESSCATEGORIE STG1
ON
    CU1.SUBBUSINESSCAT=STG1.CODE
AND STG1.NAME IS NOT NULL
AND STG1.NAME != ''
AND STG1.NAME NOT IN ('å°_´·/___',
                     'æ¶_´¹___')
left join
(
SELECT
t.ORDER_TYPE,
sum(t.ERROR_NUMBER) AS TOTAL_ERROR_NUMBER
FROM
    TBL_QUALITY_ANALYSIS_ERRORCODE T
LEFT JOIN
    DB2INST1.CUSTOMERINFO CU
ON
    T.MERCHANT_NUMBER = CU.CUSTOMERNUMBER
INNER JOIN
    DB2INST1.TRXSTATSUBBUSINESSCATEGORIE STG
ON
    CU.SUBBUSINESSCAT=STG.CODE
AND STG.NAME IS NOT NULL
AND STG.NAME != ''
AND STG.NAME NOT IN ('å°_´·/___',
                     'æ¶_´¹___')
LEFT JOIN
    TBL_BANK_INFO BI
ON
    T.BANK_CODE=BI.BANK_CODE
WHERE
T.TX_DATE=${START}
group by T.ORDER_TYPE) tmp2
ON TMP1.ORDER_TYPE=TMP2.ORDER_TYPE
 WHERE
            tmp1.TX_DATE = ${START}",reportdb_yjkh
customerinfospark,customerinfo32spark,"select 'baiweioutkill20161125' as baiweioutkill20161125,c.id as id,c.active,c.customerNumber,c.fullname,c.groupId,c.shortname,c.createDate,bc.name as businessCat,subBusinessCat,c.area,pf1.value as linkman,pf2.value as webUrl,pf.value as signedName,a.balance as accountBalance,ca.balance as creditBalance,ca.creditLimit,c.bindMobile as mobile,c.phone,date(si.lastsettledate) as lastsettledate, pf3.value as netSigned, c.productGroup,pf4.value as address,bc.id as bussinessCatId,pf5.value as province,si.cycleType as cycletype,si.reserveDays,coalesce(cg.grade,'') as gradelevel, 'NETSIGNED' as customertype,c.customerNumber as MERCHANTNO,a.balancelastupdatedate,cd.DOCUMENTNUMBER as legal_idcard,cd.DESCRIPTION as legal_name,pf6.value as audit_Status,a.status as account_status,r.BANKACTID as settle_bankaccount,r.province as settle_bankprovince,r.city as settle_bankcity,r.branchName as settle_bankbranch,ba.fullname as settle_bankname,r.accountName as settle_accountname,pf7.value as icp,c.customertype as signed_type   from Customer c left join profile pf on c.ID=pf.customer_id and pf.name='p_signedName'  left join profile pf1 on c.id=pf1.customer_id and pf1.name='p_linkman'  left join profile pf2 on c.id=pf2.customer_id and pf2.name='p_customerSiteUrl'  left join profile pf3 on c.id=pf3.customer_id and pf3.name='p_signed'  left join profile pf4 on c.id=pf4.customer_id and pf4.name='p_address'  left join profile pf5 on c.id=pf5.customer_id and pf5.name='p_province'  left join profile pf6 on c.id=pf6.customer_id and pf6.name='p_auditStatus' left join profile pf7 on c.ID=pf7.CUSTOMER_ID and pf7.NAME='p_icp' left join account a on (c.id=a.customer_id and a.classtype='LocalAccount' and a.localAccountType='SVA')  left join CreditAccount ca on (c.id=ca.customerId)  left join settlementinfo si on c.id=si.customer_id left join account r on si.bankAccount_id=r.id and r.classtype='RemoteAccount' left join bank ba on r.bank_id=ba.id left join BusinessCategorie  bc on bc.id=c.businessCat  left join customergradeinfo cg on c.id=cg.customerid and cg.status in ('WAITRESCORE','COMPLETE','NOQUESSCORE') left join customerdocinfo  cd on  (c.CUSTOMERNUMBER=cd.CUSTOMERNUMBER and  cd.DOCUMENTNAME='æ³_ººèº»½è¯')  where c.customerType='ENTERPRISE' and c.customerNumber is not null with ur",COPY2
customerinfospark,posagentspark,"select b.customer_number as CUSTOMERNUMBER,a.code as AGENTCODE,a.name as AGENTNAME,bt.type as AGENTTYPE from tbl_daili_agent a left join tbl_daili_agentrelation b on a.id=b.agent_id left join TBL_DAILI_AGENTBIZTYPE bt  on a.id=bt.AGENT_ID where b.status='ACTIVE' and b.customer_number is not null",opendb
customerinfospark,netagentspark,"select customer_num as CUSTOMERNUMBER,num as AGENTCODE,name as AGENTNAME,'NET' as AGENTTYPE from agentfr.tbl_agency_relation ar left join agentfr.tbl_agent a on a.id = ar.agent_id where ar.state='ENABLE' and a.agency_state!='STOP' and customer_num is not null with ur",agentfr
customerinfospark,posareaspark,"select c.CUSTOMER_NUMBER as CUSTOMERNUMBER,sheng.NAME as PROVINCE,shi.NAME as CITY from poswrite.TBL_POS_CUSTOMER c left join poswrite.TBL_POS_ORGANIZATION shi on c.ORG_CODE=shi.CODE left join poswrite.TBL_POS_ORGANIZATION sheng on shi.PARENT_CODE=sheng.CODE where c.CUSTOMER_NUMBER is not null ",opendb
customerinfospark,poscountspark,"select b.customer_number as CUSTOMERNUMBER, count(*) as POSCOUNT from tbl_pos_pos a, tbl_pos_customer b where a.CUSTOMER_ID=b.id group by b.customer_number having b.customer_number is not null ",opendb
customerinfospark,vmarkspark,"select CUSTOMERNUMBER CUSTOMERNUMBER, coalesce(CUSTOMERLEVEL,'V') as VMARK from CUSTOMERGRADELEVEL where CUSTOMERNUMBER is not null with ur",COPY2
customerinfospark,accmarkspark,"select customerExt.CUSTOMERNUMBER as CUSTOMERNUMBER,customerExt.PERFORMANCE_ATTRIBUTE as ACCMARK from SIGNING.TBL_CUSTOMER_EXT customerExt,SIGNING.TBL_PERFORMANCE_ATTRIBUTE attribute  where customerExt.PERFORMANCE_ATTRIBUTE=attribute.ATTRIBUTE_CODE and customerExt.customernumber is not null and customerExt.PERFORMANCE_ATTRIBUTE != '5' with ur",BOSS
customerinfospark,merchantnospark,"SELECT b.MERCHANT_NO as CUSTOMERNUMBER,a.sn as MERCHANTNO from SIGNING.tbl_yp_cus_info a , SIGNING.TBL_YP_CUS_MER_RELATION b where a.ID=b.TBL_YP_CUS_INFOID",BOSS
customerinfospark,productgroupzgtspark,"select CUSTOMERNUMBER, 'ZGT' as PRODUCTGROUP from customerext c left join customer cu on c.id=cu.id where c.zgt=1 and customernumber is not null with ur",COPY2
customerinfospark,productgrouptouzitongspark,"select MERCHANT_ACCOUNT_CODE as CUSTOMERNUMBER, 'TOUZITONG' as PRODUCTGROUP from EWALLET.merchant_to_goods where goods_id in(18,30) and MERCHANT_ACCOUNT_CODE is not null with ur",INNO
customerinfospark,productgroupshoukuanbaospark,"select distinct(MAINCUSTOMERNUMBER) as CUSTOMERNUMBER, 'SHOUKUANBAO' as PRODUCTGROUP from SKB.TBL_SKB_REGISTER union all select LEDGECUSTOMERNUMBER as CUSTOMERNUMBER, 'SHOUKUANBAO' as PRODUCTGROUP from SKB.TBL_SKB_REGISTER with ur",accnt
customerinfospark,branchcompanyspark,"SELECT s.cust_id as CUSTOMERID, e.branchcompany as BRANCHCOMPANY FROM EmployeeInfo e LEFT JOIN employee2customer s ON e.id = s.emp_id WHERE s.cust_id IN(SELECT customerid FROM customerrelationship) ",reportdb
customerinfospark,relegationspark,"select CUSTOMER_NUMBER as CUSTOMERNUMBER, 'OFFLINE' as RELEGATION from poswrite.tbl_pos_customer ",opendb
customerinfospark,customertypespark,"select CUSTOMER_ID,'ENTERPRISE' as CUSTOMERTYPE from PROFILE where name = 'p_signed' and value = '1' and value is not null with ur",COPY2
customerinfospark,customercredentiallevelspark,"select  CUSTOMER_NUMBER as CUSTOMERNUMBER , CUSTOMER_LABEL_VALUE as CUSTOMER_CREDENTIAL_LEVEL 
from SIGNING.TBL_CUSTOMER_LABEL_ATTRIBUTE 
where CUSTOMER_LABEL='customer_credential_level'   
with ur",BOSS
customerinfospark,customerinfomanage1spark,"select c.customernumber as CUSTOMERNUMBER,cd5.DOCUMENTNUMBER as business_licence,cd5.AVAILABDATA as business_licence_AVAILABDATE,cd4.DOCUMENTNUMBER as Unified_credit_no,cd4.AVAILABDATA as  Unified_credit_no_AVAILABDATE,cd7.DOCUMENTNUMBER as organization_no,cd7.AVAILABDATA as organization_no_AVAILABDATE,cd8.DOCUMENTNUMBER as tax_regist_no,ca.auditPassTime as audit_date,c.email as email
from mobilebe.CUSTOMER c 
left join mobilebe.customerdocinfo cd4 on cd4.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd4.DOCUMENTNAME='ç»__ç¤¾ä_ä¿¡ç_ä»£ç_' 
left join mobilebe.customerdocinfo cd5 on cd5.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd5.DOCUMENTNAME='_¥ä__§ç_' 
left join mobilebe.customerdocinfo cd7 on cd7.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd7.DOCUMENTNAME='ç»___ºæ_ä»£ç_è¯' 
left join mobilebe.customerdocinfo cd8 on cd8.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd8.DOCUMENTNAME='ç¨___»èè¯' 
left join mobilebe.CustomerAptitudeAduit ca on c.id=ca.customerid
with ur",COPY2
customerinfospark,signeddate1spark,"select  customernumber as CUSTOMERNUMBER, min(STARTDATE) as SIGNED_DATE
from mobilebe.CONTRACTMANAGER 
group by customernumber
with ur",COPY2
customerinfospark,customersalesnamespark,"select  e.cust_id as ID,em.name as SALESNAME,em.id as SALESID 
from db2inst1.employee2customer e 
left join db2inst1.employeeinfo em on e.emp_id=em.id ",reportdb
customerinfospark,customervipmarkspark,"select  CUSTOMER_NUMBER as CUSTOMERNUMBER , case when CUSTOMER_LABEL_VALUE='SVIP' then 2 else 1 end as vipmark 
from SIGNING.TBL_CUSTOMER_LABEL_ATTRIBUTE 
where CUSTOMER_LABEL='customer_vip_level' and status=1 
with ur",BOSS
customerinfospark,productgroupewalletspark,"select customer_identity_no as customernumber,'EWALLET' as productgroup from zgt.TBL_CUSTOMER_CONFIG where BELONG = 'WALLET' with ur",dzh
customerinfospark,skbagentspark,"SELECT LEDGECUSTOMERNUMBER as CUSTOMERNUMBER,MAINCUSTOMERNUMBER as AGENTCODE,'SKB' as AGENTTYPE FROM SKB.TBL_SKB_REGISTER WITH UR",accnt
customerinfospark,nobankcardcustspark,"select merchant_no as ID,merchant_no as CUSTOMERNUMBER,merchant_name as FULLNAME,'YEEYK' as PRODUCTGROUP from MERCHANT.T_MERCHANT_REGISTE",agentfr_mysql
customerinfospark,postpaid_payment_periodspark,"SELECT 
CUSTOMER_NUMBER as CUSTOMERNUMBER,
integer(PAYMENT_PERIOD) as PRODUCTLINEID
FROM FEE.TBL_FRONT_FEE_CUSTOMER WHERE PAYMENT_PERIOD IS NOT NULL with ur",feedb
COMMISSIONMT,customernumber2idmt,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from customerinfo  with ur",reportdb
customerinfoyangehangyeyejishuxing,customerinfoyangehangyeyejishuxing,"select NUMBER as key,TAG as value from CUSCENTER.TBL_TAG where 'etlnokill123123123'='etlnokill123123123' ",dzh_standby
customerinfoyangeauditdate,customerinfoyangeauditdate,"SELECT MERCHANT_NO as key,AUDIT_TIME as value FROM CUSCENTER.TBL_MERCHANT WHERE 'etlnokill123123123'='etlnokill123123123' and AUDIT_STATUS='PASSED' AND AUDIT_TIME is not null with ur",dzh
opemployeeinfo,opemployeeinfo,select * from report.TBL_REPORT_GROUP_USER with ur,BOSS_standby
wwxtesttask,wwxtask,"select 'baiweioutkill20161125' as baiweioutkill20161125,c.id as id,c.active,c.customerNumber,c.fullname,c.groupId,c.shortname,c.createDate,bc.name as businessCat,subBusinessCat,c.area,pf1.value as linkman,pf2.value as webUrl,pf.value as signedName,a.balance as accountBalance,ca.balance as creditBalance,ca.creditLimit,c.bindMobile as mobile,c.phone,date(si.lastsettledate) as lastsettledate, pf3.value as netSigned, c.productGroup,pf4.value as address,bc.id as bussinessCatId,pf5.value as province,si.cycleType as cycletype,si.reserveDays,coalesce(cg.grade,'') as gradelevel, 'NETSIGNED' as customertype,c.customerNumber as MERCHANTNO,a.balancelastupdatedate,cd.DOCUMENTNUMBER as legal_idcard,cd.DESCRIPTION as legal_name,pf6.value as audit_Status,a.status as account_status,r.BANKACTID as settle_bankaccount,r.province as settle_bankprovince,r.city as settle_bankcity,r.branchName as settle_bankbranch,ba.fullname as settle_bankname,r.accountName as settle_accountname,pf7.value as icp,c.customertype as signed_type   from Customer c left join profile pf on c.ID=pf.customer_id and pf.name='p_signedName'  left join profile pf1 on c.id=pf1.customer_id and pf1.name='p_linkman'  left join profile pf2 on c.id=pf2.customer_id and pf2.name='p_customerSiteUrl'  left join profile pf3 on c.id=pf3.customer_id and pf3.name='p_signed'  left join profile pf4 on c.id=pf4.customer_id and pf4.name='p_address'  left join profile pf5 on c.id=pf5.customer_id and pf5.name='p_province'  left join profile pf6 on c.id=pf6.customer_id and pf6.name='p_auditStatus' left join profile pf7 on c.ID=pf7.CUSTOMER_ID and pf7.NAME='p_icp' left join account a on (c.id=a.customer_id and a.classtype='LocalAccount' and a.localAccountType='SVA')  left join CreditAccount ca on (c.id=ca.customerId)  left join settlementinfo si on c.id=si.customer_id left join account r on si.bankAccount_id=r.id and r.classtype='RemoteAccount' left join bank ba on r.bank_id=ba.id left join BusinessCategorie  bc on bc.id=c.businessCat  left join customergradeinfo cg on c.id=cg.customerid and cg.status in ('WAITRESCORE','COMPLETE','NOQUESSCORE') left join customerdocinfo  cd on  (c.CUSTOMERNUMBER=cd.CUSTOMERNUMBER and  cd.DOCUMENTNAME='æ³_ººèº»½è¯')  where c.customerType='ENTERPRISE' and c.customerNumber is not null  fetch first 10000 rows only   with ur",COPY2
PublishedMonthlyTrxStatcostcenter,trxaddrealnamemsg,"select 
'1601'||coalesce(char(d.month),'null')||coalesce(char(d.biztypeid),'null')||coalesce(char(d.type),'null')||coalesce(char(d.product_code),'null')||coalesce(char(d.sales_product_code),'null')||coalesce(char(d.hangyeyejishuxing),'null')||'trxaddrealnamemsg' as idnouse,
1601 as timeLatitudeId, d.month as MONTH,d.month as true_month,0 as teamId,0 as productLineId,d.biztypeid,d.type as trxTypeId,d.product_code,d.sales_product_code,d.hangyeyejishuxing,'RECEIVER' as GROUPTYPE,
sum(coalesce(d.ACCOUNTINGCOST,0)) as NEWCOST 
from db2inst1.trxstatadditionalstatfee d 
where  d.trxdate>=${START} and d.trxdate<${STOP}  and d.ACCOUNTINGCOST<>0
group by d.month,d.biztypeid,d.type,d.product_code,d.sales_product_code,d.hangyeyejishuxing with ur",reportdb
PublishedMonthlyTrxStatcostcenter,dailymanualcost,"select '1601'||coalesce(char(d.month),'null')||
coalesce(char(d.receiverid),'null')||
coalesce(char(c.CUSTOMERNUMBER),'null')||
coalesce(char(c.FULLNAME),'null')||
coalesce(char(em.id),'null')||
coalesce(char(c.areaid),'null')||
coalesce(char(d.biztypeid),'null')||
coalesce(char(d.type),'null')||
coalesce(char(r.SHARESCALE),'null')||
coalesce(char(r.isshare),'null')||
coalesce(char(r.isself),'null')||
coalesce(char(r.transfdate),'null')||
coalesce(char(c.productgroup),'null')||
coalesce(char(c.BUSSINESSCATID),'null')||
coalesce(char(c.branchcompany),'null')||
coalesce(char(d.product_code),'null')||
coalesce(char(d.sales_product_code),'null')||
coalesce(char(c2a.achievement_id),'null')||
coalesce(char(c2a.PERCENT),'null')||
coalesce(char(d.payerid),'null')||
coalesce(char(c.productline),'null')||'dailymanualcost' as idnouse,1601 as timeLatitudeId,d.month as MONTH,d.month as true_month,d.receiverid as CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME as customerName,
em.id as SALEID,0 as teamId,c.areaid,0 as productLineId,d.biztypeid,d.type as trxTypeId,r.SHARESCALE as salesscale,r.isshare as isShareCustomer,
r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID as businesscatid,c.branchcompany,d.product_code,d.sales_product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline as hangyeyejishuxing,
'MANUAL' as managemark,'RECEIVER' as GROUPTYPE,
sum( coalesce(d.ACCOUNTINGCOST,0)* coalesce(r.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as NEWCOST
from db2inst1.dailytrxstat d 
left join db2inst1.CustomerInfo c on d.receiverid=c.id
left join db2inst1.CustomerRelationship r on r.customerid=c.id 
left join db2inst1.employeeinfo em on r.EMPLOYEEID=em.ID 
left join db2inst1.customer2achievement c2a on c.customernumber=c2a.customer_number 
where  d.trxdate>=${START} and d.trxdate<${STOP} and d.USETYPE='MANUAL' and d.accountingcost<>0  and d.type not in ('CARDJIANQUAN')
group by d.month,
d.receiverid,
c.CUSTOMERNUMBER,
c.FULLNAME,
em.id,
c.areaid,
d.biztypeid,
d.type,
r.SHARESCALE,
r.isshare,
r.isself,
r.transfdate,
c.productgroup,
c.BUSSINESSCATID,
c.branchcompany,
d.product_code,
d.sales_product_code,
c2a.achievement_id,
c2a.PERCENT,
d.payerid,
c.productline
 with ur
",reportdb
PublishedMonthlyTrxStatNewIncome,PublishedMonthlyTrxStatNewIncome,"select 
'1601'||'201804'||coalesce(char(c.id),'null')||coalesce(char(d.CUSTOMERNUMBER ),'null')||coalesce(char(c.FULLNAME),'null')||coalesce(char(em.id),'null')||coalesce(char(c.areaid ),'null')||coalesce(char(d.biztypeid ),'null')||coalesce(char(d.type),'null')||coalesce(char(r.SHARESCALE),'null')||coalesce(char(r.isshare),'null')||coalesce(char(r.isself),'null')||coalesce(char(r.transfdate),'null')||coalesce(char(c.productgroup),'null')||coalesce(char(c.BUSSINESSCATID),'null')||coalesce(char(c.branchcompany),'null')||coalesce(char(d.product_code),'null')||coalesce(char(d.sales_product_code),'null')||coalesce(char(c2a.achievement_id ),'null')||coalesce(char(c2a.PERCENT ),'null')||coalesce(char(d.payerid),'null')||coalesce(char(c.productline),'null')||'PublishedMonthlyTrxStatNewIncome' as idnouse,
1601 as timeLatitudeId, year(${START})*100+month(${START}) as MONTH,year(${START})*100+month(${START}) as true_month,c.id as CUSTOMERID,d.CUSTOMERNUMBER,c.FULLNAME as customerName, 
em.id as SALEID,0 as teamId,c.areaid,0 as productLineId,d.biztypeid,d.type as trxTypeId,r.SHARESCALE as salesscale,r.isshare as isShareCustomer,r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID as businesscatid,c.branchcompany,d.product_code as sales_product_code,d.sales_product_code as product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline as hangyeyejishuxing, 'RECEIVER' as GROUPTYPE,
sum(coalesce(d.trxfee-d.refundfee,0)*coalesce(r.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as newincome 
from db2inst1.jingfen_dailytrx d 
left join db2inst1.CustomerInfo c on d.customernumber=c.customernumber
left join db2inst1.CustomerRelationship r on r.customerid=c.id 
left join db2inst1.employeeinfo em on r.EMPLOYEEID=em.ID 
left join db2inst1.customer2achievement c2a on c.customernumber=c2a.customer_number 
where  d.trxdate>=${START} and d.trxdate<${STOP}  and (d.etltaskid like 'trxfeejingfen%' or d.etltaskid like 'aaaa%')
group by c.id,d.CUSTOMERNUMBER,c.FULLNAME,em.id,c.areaid,d.biztypeid,d.type,r.SHARESCALE,r.isshare,r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID,c.branchcompany,d.product_code,d.sales_product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline with ur",reportdb
PublishedMonthlyTrxStatNewIncome,PublishedMonthlyTrxStatNewIncomepostpaid,"select '1601'||coalesce(char(d.month),'null')||
coalesce(char(d.receiverid),'null')||
coalesce(char(c.CUSTOMERNUMBER),'null')||
coalesce(char(c.FULLNAME),'null')||
coalesce(char(em.id),'null')||
coalesce(char(c.areaid),'null')||
coalesce(char(d.biztypeid),'null')||
coalesce(char(d.type),'null')||
coalesce(char(r.SHARESCALE),'null')||
coalesce(char(r.isshare),'null')||
coalesce(char(r.isself),'null')||
coalesce(char(r.transfdate),'null')||
coalesce(char(c.productgroup),'null')||
coalesce(char(c.BUSSINESSCATID),'null')||
coalesce(char(c.branchcompany),'null')||
coalesce(char(d.product_code),'null')||
coalesce(char(d.sales_product_code),'null')||
coalesce(char(c2a.achievement_id),'null')||
coalesce(char(c2a.PERCENT),'null')||
coalesce(char(d.payerid),'null')||
coalesce(char(c.productline),'null')||'PublishedMonthlyTrxStatNewIncomepostpaid' as idnouse,1600 as timeLatitudeId,d.month as MONTH,d.month as true_month,d.receiverid as CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME as customerName,
em.id as SALEID,0 as teamId,c.areaid,0 as productLineId,d.biztypeid,d.type as trxTypeId,r.SHARESCALE as salesscale,r.isshare as isShareCustomer,
r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID as businesscatid,c.branchcompany,d.product_code,d.sales_product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline as hangyeyejishuxing,'RECEIVER' as GROUPTYPE,
sum( coalesce(d.TRXFEE-d.refundfee,0)* coalesce(r.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as NEWINCOME
from db2inst1.dailytrxstat d 
left join db2inst1.CustomerInfo c on d.receiverid=c.id
left join db2inst1.CustomerRelationship r on r.customerid=c.id 
left join db2inst1.employeeinfo em on r.EMPLOYEEID=em.ID 
left join db2inst1.customer2achievement c2a on c.customernumber=c2a.customer_number 
where  d.trxdate>=${START} and d.trxdate<${STOP} and d.type in ('POSTPAID') and d.ETLTASKID is not null
group by d.month,
d.receiverid,
c.CUSTOMERNUMBER,
c.FULLNAME,
em.id,
c.areaid,
d.biztypeid,
d.type,
r.SHARESCALE,
r.isshare,
r.isself,
r.transfdate,
c.productgroup,
c.BUSSINESSCATID,
c.branchcompany,
d.product_code,
d.sales_product_code,
c2a.achievement_id,
c2a.PERCENT,
d.payerid,
c.productline
 with ur
",reportdb
PublishedMonthlyTrxStatNewIncome,PublishedMonthlyTrxStatNewIncomemanual,"select '1601'||coalesce(char(d.month),'null')||
coalesce(char(d.receiverid),'null')||
coalesce(char(c.CUSTOMERNUMBER),'null')||
coalesce(char(c.FULLNAME),'null')||
coalesce(char(em.id),'null')||
coalesce(char(c.areaid),'null')||
coalesce(char(d.biztypeid),'null')||
coalesce(char(d.type),'null')||
coalesce(char(r.SHARESCALE),'null')||
coalesce(char(r.isshare),'null')||
coalesce(char(r.isself),'null')||
coalesce(char(r.transfdate),'null')||
coalesce(char(c.productgroup),'null')||
coalesce(char(c.BUSSINESSCATID),'null')||
coalesce(char(c.branchcompany),'null')||
coalesce(char(d.product_code),'null')||
coalesce(char(d.sales_product_code),'null')||
coalesce(char(c2a.achievement_id),'null')||
coalesce(char(c2a.PERCENT),'null')||
coalesce(char(d.payerid),'null')||
coalesce(char(c.productline),'null')||'PublishedMonthlyTrxStatNewIncomemanual' as idnouse,1601 as timeLatitudeId,d.month as MONTH,d.month as true_month,d.receiverid as CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME as customerName,
em.id as SALEID,0 as teamId,c.areaid,0 as productLineId,d.biztypeid,d.type as trxTypeId,r.SHARESCALE as salesscale,r.isshare as isShareCustomer,
r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID as businesscatid,c.branchcompany,d.product_code,d.sales_product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline as hangyeyejishuxing,
'MANUAL' as managemark,'RECEIVER' as GROUPTYPE,
sum( coalesce(d.trxfee-d.refundfee,0)* coalesce(r.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as NEWINCOME
from db2inst1.dailytrxstat d 
left join db2inst1.CustomerInfo c on d.receiverid=c.id
left join db2inst1.CustomerRelationship r on r.customerid=c.id 
left join db2inst1.employeeinfo em on r.EMPLOYEEID=em.ID 
left join db2inst1.customer2achievement c2a on c.customernumber=c2a.customer_number 
where  d.trxdate>=${START} and d.trxdate<${STOP} and d.USETYPE='MANUAL' and d.trxfee<>0  
group by d.month,
d.receiverid,
c.CUSTOMERNUMBER,
c.FULLNAME,
em.id,
c.areaid,
d.biztypeid,
d.type,
r.SHARESCALE,
r.isshare,
r.isself,
r.transfdate,
c.productgroup,
c.BUSSINESSCATID,
c.branchcompany,
d.product_code,
d.sales_product_code,
c2a.achievement_id,
c2a.PERCENT,
d.payerid,
c.productline
 with ur
",reportdb
QATrxAreaMerchantCount,QATrxAreaMerchantCountE,"select 
    max(TRXDATE)||'_¨å_'||count(SIGNEDNAME) AS IDNOUSE,
    '_¨å_' AS AREA,
    count(SIGNEDNAME) AS MERCHANT_COUNT ,
    max(TRXDATE) AS DATA_PERIOD,
    CURRENT_TIMESTAMP AS CREATE_TIME from (
SELECT
        C.SIGNEDNAME,
        P.TRXDATE
        FROM
            DB2INST1.PUBLISHEDDAILYTRX AS P
        LEFT JOIN
            DB2INST1.TRXSTATBUSINESSCATEGORIE AS B
        ON
            1=1
        AND P.BUSINESSCATID=B.ID
        LEFT JOIN
            DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S
        ON
            1=1
        AND P.SUBBUSINESSCAT=S.CODE
        LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND P.RECEIVERID=C.ID
        LEFT JOIN
            DB2INST1.PRODUCTCODE_PROFILE AS PP
        ON
            1=1
        AND P.PRODUCT_CODE=PP.PRODUCT_CODE
        AND P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS PC
        ON
            1=1
        AND P.PRODUCT_CODE=PC.PRODUCTCODE
        AND PC.PRODUCTTYPE=2
        LEFT JOIN
            DB2INST1.PRODUCTCODE AS SPC
        ON
            1=1
        AND P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE
        AND SPC.PRODUCTTYPE=1
        LEFT JOIN
            DB2INST1.EXISTENCE AS E
        ON
            1=1
        AND P.YEJISHUXING=E.ID
        AND E.CLASSTYPE='Department'
        LEFT JOIN
            DB2INST1.TRXSTATTRXTYPE AS T
        ON
            1=1
        AND P.TRXTYPEID=T.ID
        WHERE
            P.TRXDATE = ${START}
        AND (
                CASE
                    WHEN PP.ACCOUNTCLASS IS NULL
                    THEN 'çº¿ä_'
                    ELSE PP.ACCOUNTCLASS
                END) NOT IN('___è¡__')
        AND E.NAME IN ('__º¬____',
                       'ä¸_µ·____',
                       'å±±è¥¿____',
                       'æ²³å_____',
                       '__¥¿____',
                       'å¤©æ´¥____',
                       '_______',
                       'å±±ä_____',
                       'æµ______',
                       'æ±______',
                       'ç¦_»º____',
                       'å¹¿ä_____',
'__º¬äº____',
'__º¬ä¸____' )
        AND (
                C.PRODUCTLINE NOT IN ('ä¸_å¾__')
            OR C.PRODUCTLINE IS NULL)
        GROUP BY
            C.SIGNEDNAME,
            P.TRXDATE
           )",reportdb_yjkh
PublishedMonthlyTrxStatNewIncome,PublishedMonthlyTrxStatNewIncomepostrxcost,"select 
'1601'||'201802'||coalesce(char(c.id),'null')||coalesce(char(d.CUSTOMERNUMBER ),'null')||coalesce(char(c.FULLNAME),'null')||coalesce(char(em.id),'null')||coalesce(char(c.areaid ),'null')||coalesce(char(d.biztypeid ),'null')||coalesce(char(d.type),'null')||coalesce(char(r.SHARESCALE),'null')||coalesce(char(r.isshare),'null')||coalesce(char(r.isself),'null')||coalesce(char(r.transfdate),'null')||coalesce(char(c.productgroup),'null')||coalesce(char(c.BUSSINESSCATID),'null')||coalesce(char(c.branchcompany),'null')||coalesce(char(d.product_code),'null')||coalesce(char(d.sales_product_code),'null')||coalesce(char(c2a.achievement_id ),'null')||coalesce(char(c2a.PERCENT ),'null')||coalesce(char(d.payerid),'null')||coalesce(char(c.productline),'null')||'costcenter' as idnouse,
1601 as timeLatitudeId, year(${START})*100+month(${START}) as MONTH,year(${START})*100+month(${START}) as true_month,c.id as CUSTOMERID,d.CUSTOMERNUMBER,c.FULLNAME as customerName, 
em.id as SALEID,0 as teamId,c.areaid,0 as productLineId,d.biztypeid,d.type as trxTypeId,r.SHARESCALE as salesscale,r.isshare as isShareCustomer,r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID as businesscatid,c.branchcompany,d.product_code,d.sales_product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline as hangyeyejishuxing, 'RECEIVER' as GROUPTYPE,
-sum(coalesce(d.ACCOUNTINGCOST,0)*coalesce(r.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as NEWINCOME 
from db2inst1.jingfen_dailytrx d 
left join db2inst1.CustomerInfo c on d.customernumber=c.customernumber
left join db2inst1.CustomerRelationship r on r.customerid=c.id 
left join db2inst1.employeeinfo em on r.EMPLOYEEID=em.ID 
left join db2inst1.customer2achievement c2a on c.customernumber=c2a.customer_number 
where  d.trxdate>=${START} and d.trxdate<${STOP}  and d.etltaskid like 'accountcostjingfen%' and d.trxchannelid in ('UPOP_POS_YLBMZ9010','UPOP_POS_YLBM9010(DH)','ICBC_POS_GHXY9010N') 
group by c.id,d.CUSTOMERNUMBER,c.FULLNAME,em.id,c.areaid,d.biztypeid,d.type,r.SHARESCALE,r.isshare,r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID,c.branchcompany,d.product_code,d.sales_product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline with ur",reportdb
trxfeejingfen,trxfeejf2grefund,"SELECT
    COALESCE(CHAR(DATE(AH.CREATEDATEONLY)),'null')||COALESCE(CHAR(C.CUSTOMERNUMBER),'null')||'null'
    ||'null'||'trxfeejf2grefund' AS IDNOUSE,'trxfeejf2grefund' AS DATAORIGIN,
    AH.CREATEDATEONLY       AS TRXDATE,
    C.CUSTOMERNUMBER        AS RECEIVERID,
    C.CUSTOMERNUMBER        AS CUSTOMERNUMBER,
    'Sales'                 AS type,
    SUM(ABS(AH.FEE))        AS refundfee
FROM
    MOBILEBE.accounthistory AH
LEFT JOIN
    MOBILEBE.ACCOUNT A
ON
    AH.ACCOUNT_ID = A.ID
LEFT JOIN
    MOBILEBE.CUSTOMER C
ON
    A.CUSTOMER_ID = C.ID
WHERE
'etlnokill123123123'='etlnokill123123123' and 
    AH.CREATEDATEONLY = ${START}
AND AH.DESC IS NULL
AND AH.HISTORYTYPE IN('EPOS_REVOCATIONDEBIT',
                      'REFUND',
                      'REFUNDEXT')
AND AH.FEE<0
GROUP BY
    AH.CREATEDATEONLY,
    C.CUSTOMERNUMBER WITH ur",COPY2
sparktest,customerinfo32sparktest,"select 'baiweioutkill20161125' as baiweioutkill20161125,c.id as id,c.active,c.customerNumber,c.fullname,c.groupId,c.shortname,c.createDate,bc.name as businessCat,subBusinessCat,c.area,pf1.value as linkman,pf2.value as webUrl,pf.value as signedName,a.balance as accountBalance,ca.balance as creditBalance,ca.creditLimit,c.bindMobile as mobile,c.phone,date(si.lastsettledate) as lastsettledate, pf3.value as netSigned, c.productGroup,pf4.value as address,bc.id as bussinessCatId,pf5.value as province,si.cycleType as cycletype,si.reserveDays,coalesce(cg.grade,'') as gradelevel, 'NETSIGNED' as customertype,c.customerNumber as MERCHANTNO,a.balancelastupdatedate,cd.DOCUMENTNUMBER as legal_idcard,cd.DESCRIPTION as legal_name,pf6.value as audit_Status,a.status as account_status,r.BANKACTID as settle_bankaccount,r.province as settle_bankprovince,r.city as settle_bankcity,r.branchName as settle_bankbranch,ba.fullname as settle_bankname,r.accountName as settle_accountname,pf7.value as icp,c.customertype as signed_type   from Customer c left join profile pf on c.ID=pf.customer_id and pf.name='p_signedName'  left join profile pf1 on c.id=pf1.customer_id and pf1.name='p_linkman'  left join profile pf2 on c.id=pf2.customer_id and pf2.name='p_customerSiteUrl'  left join profile pf3 on c.id=pf3.customer_id and pf3.name='p_signed'  left join profile pf4 on c.id=pf4.customer_id and pf4.name='p_address'  left join profile pf5 on c.id=pf5.customer_id and pf5.name='p_province'  left join profile pf6 on c.id=pf6.customer_id and pf6.name='p_auditStatus' left join profile pf7 on c.ID=pf7.CUSTOMER_ID and pf7.NAME='p_icp' left join account a on (c.id=a.customer_id and a.classtype='LocalAccount' and a.localAccountType='SVA')  left join CreditAccount ca on (c.id=ca.customerId)  left join settlementinfo si on c.id=si.customer_id left join account r on si.bankAccount_id=r.id and r.classtype='RemoteAccount' left join bank ba on r.bank_id=ba.id left join BusinessCategorie  bc on bc.id=c.businessCat  left join customergradeinfo cg on c.id=cg.customerid and cg.status in ('WAITRESCORE','COMPLETE','NOQUESSCORE') left join customerdocinfo  cd on  (c.CUSTOMERNUMBER=cd.CUSTOMERNUMBER and  cd.DOCUMENTNAME='æ³_ººèº»½è¯')  where c.customerType='ENTERPRISE' and c.customerNumber is not null  fetch first 10000 rows only  with ur",COPY2
PublishedMonthlyTrxStatNewIncome,PublishedMonthlyTrxStatNewIncomeCommission,"select '1601'||coalesce(char(d.month),'null')||
coalesce(char(d.receiverid),'null')||
coalesce(char(c.CUSTOMERNUMBER),'null')||
coalesce(char(c.FULLNAME),'null')||
coalesce(char(em.id),'null')||
coalesce(char(c.areaid),'null')||
coalesce(char(d.biztypeid),'null')||
coalesce(char(d.type),'null')||
coalesce(char(r.SHARESCALE),'null')||
coalesce(char(r.isshare),'null')||
coalesce(char(r.isself),'null')||
coalesce(char(r.transfdate),'null')||
coalesce(char(c.productgroup),'null')||
coalesce(char(c.BUSSINESSCATID),'null')||
coalesce(char(c.branchcompany),'null')||
coalesce(char(d.product_code),'null')||
coalesce(char(d.sales_product_code),'null')||
coalesce(char(c2a.achievement_id),'null')||
coalesce(char(c2a.PERCENT),'null')||
coalesce(char(d.payerid),'null')||
coalesce(char(c.productline),'null')||'PublishedMonthlyTrxStatNewIncomepostpaid' as idnouse,1601 as timeLatitudeId,d.month as MONTH,d.month as true_month,d.receiverid as CUSTOMERID,c.CUSTOMERNUMBER,c.FULLNAME as customerName,
em.id as SALEID,0 as teamId,c.areaid,0 as productLineId,d.biztypeid,d.type as trxTypeId,r.SHARESCALE as salesscale,r.isshare as isShareCustomer,
r.isself,r.transfdate,c.productgroup, 
c.BUSSINESSCATID as businesscatid,c.branchcompany,d.product_code,d.sales_product_code,c2a.achievement_id,c2a.PERCENT,d.payerid,c.productline as hangyeyejishuxing,'RECEIVER' as GROUPTYPE,
sum( coalesce(d.TRXFEE-d.refundfee,0)* coalesce(r.SHARESCALE,1)*coalesce(c2a.PERCENT,1)) as NEWINCOME
from db2inst1.dailytrxstat d 
left join db2inst1.CustomerInfo c on d.receiverid=c.id
left join db2inst1.CustomerRelationship r on r.customerid=c.id 
left join db2inst1.employeeinfo em on r.EMPLOYEEID=em.ID 
left join db2inst1.customer2achievement c2a on c.customernumber=c2a.customer_number 
where  d.trxdate>=${START} and d.trxdate<${STOP} 
and d.ETLTASKID is not null and d.type in ('COMMISSION','COMMISSION_HK','POSSHARECOST','COMMISSION_LIKER','COMMISSION_RJT','SUBCOMPANYCOMMISSION')
group by d.month,
d.receiverid,
c.CUSTOMERNUMBER,
c.FULLNAME,
em.id,
c.areaid,
d.biztypeid,
d.type,
r.SHARESCALE,
r.isshare,
r.isself,
r.transfdate,
c.productgroup,
c.BUSSINESSCATID,
c.branchcompany,
d.product_code,
d.sales_product_code,
c2a.achievement_id,
c2a.PERCENT,
d.payerid,
c.productline
 with ur
",reportdb
PublishedMonthlyTrxStatNewIncome,PublishedMonthlyTrxStatNewIncomeadditon,"select char(coalesce(salesid,0))||char(coalesce(bizTypeId,0))||char(coalesce(salesid,0))||char(coalesce(productlineid,0))||char(coalesce(t.areaid,0))||coalesce(type,'')||coalesce(productGroup,'')||coalesce(businessCatId,'')||coalesce(a.AREAID,'')||coalesce(product_code,'')||coalesce(sales_product_code,'')||char(coalesce(t.yejishuxing,0))||'RECEIVER'||char(COALESCE(t.memomonth,0))||char(coalesce(t.hangyeyejishuxing,'')) as IDNOUSE,1601 as timeLatitudeId,201804 as MONTH,t.memomonth as true_month,salesid,bizTypeId,salesid as saleid,0 as teamId,productlineid,t.areaid,type as trxTypeId,productGroup,businessCatId,a.AREAID as branchcompany,product_code,sales_product_code,'RECEIVER' as grouptype,t.hangyeyejishuxing,sum(income) as newincome,t.yejishuxing as ACHIEVEMENT_ID,1 as PERCENT from TrxStatAdditionalStatFee t left join trxstatcustomerarea a on t.branchid=a.id where  month=201804 and iscomputeprofit=1 group by salesid,bizTypeId,salesid,productlineid,t.areaid,type,productGroup,businessCatId,a.AREAID,product_code,sales_product_code,t.yejishuxing,t.memomonth,t.hangyeyejishuxing  with ur",reportdb
customeryangespark2,cuyangespark12,"select 'baiweioutkill20161125' as baiweioutkill20161125,c.id as id,c.active,c.customerNumber,c.fullname,c.groupId,c.shortname,c.createDate,bc.name as businessCat,subBusinessCat,c.area,pf1.value as linkman,pf2.value as webUrl,pf.value as signedName,a.balance as accountBalance,ca.balance as creditBalance,ca.creditLimit,c.bindMobile as mobile,c.phone,date(si.lastsettledate) as lastsettledate, pf3.value as netSigned, c.productGroup,pf4.value as address,bc.id as bussinessCatId,pf5.value as province,si.cycleType as cycletype,si.reserveDays,coalesce(cg.grade,'') as gradelevel, 'NETSIGNED' as customertype,c.customerNumber as MERCHANTNO,a.balancelastupdatedate,cd.DOCUMENTNUMBER as legal_idcard,cd.DESCRIPTION as legal_name,pf6.value as audit_Status,a.status as account_status,r.BANKACTID as settle_bankaccount,r.province as settle_bankprovince,r.city as settle_bankcity,r.branchName as settle_bankbranch,ba.fullname as settle_bankname,r.accountName as settle_accountname,pf7.value as icp,c.customertype as signed_type   from Customer c left join profile pf on c.ID=pf.customer_id and pf.name='p_signedName'  left join profile pf1 on c.id=pf1.customer_id and pf1.name='p_linkman'  left join profile pf2 on c.id=pf2.customer_id and pf2.name='p_customerSiteUrl'  left join profile pf3 on c.id=pf3.customer_id and pf3.name='p_signed'  left join profile pf4 on c.id=pf4.customer_id and pf4.name='p_address'  left join profile pf5 on c.id=pf5.customer_id and pf5.name='p_province'  left join profile pf6 on c.id=pf6.customer_id and pf6.name='p_auditStatus' left join profile pf7 on c.ID=pf7.CUSTOMER_ID and pf7.NAME='p_icp' left join account a on (c.id=a.customer_id and a.classtype='LocalAccount' and a.localAccountType='SVA')  left join CreditAccount ca on (c.id=ca.customerId)  left join settlementinfo si on c.id=si.customer_id left join account r on si.bankAccount_id=r.id and r.classtype='RemoteAccount' left join bank ba on r.bank_id=ba.id left join BusinessCategorie  bc on bc.id=c.businessCat  left join customergradeinfo cg on c.id=cg.customerid and cg.status in ('WAITRESCORE','COMPLETE','NOQUESSCORE') left join customerdocinfo  cd on  (c.CUSTOMERNUMBER=cd.CUSTOMERNUMBER and  cd.DOCUMENTNAME='æ³_ººèº»½è¯')  where c.customerType='ENTERPRISE' and c.customerNumber  is not null  fetch first 10000 rows only   with ur",COPY2
customeryangespark2,cuyangevmarkspark2,"select CUSTOMERNUMBER CUSTOMERNUMBER, coalesce(CUSTOMERLEVEL,'V') as VMARK from CUSTOMERGRADELEVEL where CUSTOMERNUMBER is not null  fetch first 10000 rows only  with ur",COPY2
customerinfoyangeagentcode,custinfoyangeposagent,"select b.customer_number as CUSTOMERNUMBER,a.code as AGENTCODE,a.name as AGENTNAME,bt.type as AGENTTYPE from tbl_daili_agent a left join tbl_daili_agentrelation b on a.id=b.agent_id left join TBL_DAILI_AGENTBIZTYPE bt  on a.id=bt.AGENT_ID where 'etlnokill123123123'='etlnokill123123123' and b.status='ACTIVE' and b.customer_number is not null with ur",opendb
customerinfoyangeagentcode,custinfoyangenetagent,"select customer_num as CUSTOMERNUMBER,num as AGENTCODE,name as AGENTNAME,'NET' as AGENTTYPE from agentfr.tbl_agency_relation ar left join agentfr.tbl_agent a on a.id = ar.agent_id where 'etlnokill123123123'='etlnokill123123123' and ar.state='ENABLE' and a.agency_state!='STOP' and customer_num is not null with ur",agentfr
customerinfoyangeagentcode,custinfoyangeskbagent,"SELECT LEDGECUSTOMERNUMBER as CUSTOMERNUMBER,MAINCUSTOMERNUMBER as AGENTCODE,'SKB' as AGENTTYPE FROM SKB.TBL_SKB_REGISTER where 'etlnokill123123123'='etlnokill123123123'  WITH UR",accnt
bxpiccdailyreport,bxpiccdailyreport,"select
o.ID AS ID ,
c.CUSTOMER_NUMBER AS CUSTOMER_NO,  
c.CUSTOMER_NAME AS CUSTOMER_NAME,
  s.SHOP_NUMBER AS SHOP_NO,
  s.SHOP_NAME AS SHOP_NAME,
  s.PROVINCE AS PROVINCE_NAME,
  o.CUSTOMER_ORDER_ID AS CUSTOMER_ORDER_ID,
  p.YEEPAY_ORDER_ID AS YEEPAY_ORDER_ID,
  q.QR_ID AS QR_ID,
  p.REAL_AMT AS REAL_AMT,
  p.PAY_STATUS AS PAY_STATUS,
  p.PAY_TIME AS PAY_TIME,
  p.PAY_SOURCE AS PAY_SOURCE,
  o.EXTERNAL_ID AS EXTERNAL_ID,
  p.TRX_TYPE AS BALANCE_TYPE,
  p.CARD_TYPE AS BANK_TYPE
FROM YMF.YMF_ORDER o
  left join YMF.YMF_PAYMENT p on o.id = p.ORDER_ID
  left join YMF.YMF_CUSTOMER c on o.CUSTOMER_NUMBER = c.CUSTOMER_NUMBER
  left join YMF.YMF_SHOP s on o.SHOP_NUMBER =  s.SHOP_NUMBER
  left join YMF.YMF_QRCODE q on o.SAN_CODE=q.QR_ID
where  c.CUSTOMER_NUMBER = '10015662327'
  and o.COMPLETE_TIME>= ${START} and o.COMPLETE_TIME <= ${STOP} 
with ur",dzh_standby
proqualityNCPAY,proqualityNCPAY_total,"SELECT
TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,
COUNT( PAYMENT_NO ) AS TRADE_COUNT
FROM
	NCC.TBL_NC_PAY_ORDER
WHERE
	CREATE_TIME >= ${START} AND CREATE_TIME <${STOP} 
        group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')
 WITH UR",INNO_STANBY
proqualityNCPAY,proqualityNCPAY_succ,"SELECT
TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,COUNT(PAYMENT_NO) as SUCCESS_COUNT
FROM
	NCC.TBL_NC_PAY_ORDER
WHERE
	CREATE_TIME >= ${START} AND CREATE_TIME <${STOP} and STATE = 'SUCCESS'
        group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')
 WITH UR",INNO_STANBY
proqualityNCPAY,excep_proqualityNCPAY,"SELECT
TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,COUNT( PAYMENT_NO ) as  CARDHOLDER_COUNT
FROM
	NCC.TBL_NC_PAY_ORDER
WHERE
	CREATE_TIME >= ${START} AND CREATE_TIME <${STOP} and ERROR_CODE IN(
	'400141', '400079', '499004', '411054', '400118', '400121', '411138', '411151', '411152', '411155', '411056', '400117')
        group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')
 WITH UR",INNO_STANBY
proqualityWalletNet,proqualityWalletNet_total,"SELECT
TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,
COUNT( ID) AS  TRADE_COUNT
FROM
	frontend.TBL_FRONTEND_PAY_ORDER_NET
WHERE
	 CREATE_TIME >= ${START} AND CREATE_TIME < ${STOP}
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
proqualityWalletNet,proqualityWalletNet_succ,"SELECT
TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,
COUNT( ID) AS   SUCCESS_COUNT
FROM
	frontend.TBL_FRONTEND_PAY_ORDER_NET
WHERE
 CREATE_TIME >= ${START} AND CREATE_TIME < ${STOP} and  PAY_STATUS = 'SUCCESS'
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
proqualityWalletNet,excep_proqualityWalletNet,"select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT from frontend.TBL_FRONTEND_PAY_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
checktrxprofitbycustomernumber,checktrxprofitbycustomernumbere,"SELECT
COALESCE(tmp.TRXDATE, '-') || COALESCE(tmp.PRODUCTLINE, '-') || COALESCE(tmp.PRODUCTNAME, '-') || COALESCE(tmp.CUSTOMERNUMBER, '-') || COALESCE(tmp.SIGNEDNAME, '-') AS IDNOUSE,
        tmp.TRXDATE                                         AS DATA_PERIOD,
    tmp.CUSTOMERNUMBER                                  AS MERCHANT_NUMBER,
    tmp.SIGNEDNAME                                      AS SIGNED_NAME,
    tmp.PRODUCTLINE                                             AS INDUSTRY,
    tmp.PRODUCTNAME                                              AS BASIC_PRODUCT,
    SUM(tmp.trxprofit)                                       AS TRX_PROFIT
FROM
    (
        SELECT
            t.TRXDATE,
            t.PRODUCTLINE,
            t.PRODUCTNAME,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            t.JIAOYILEIXING,
            (SUM(t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*COALESCE
            (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE(t.SHARESCALE,1)*
            COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)))
            AS trxprofit,
            (SUM(
                CASE
                    WHEN t.BIZTYPEID IN (29,129)
                    THEN (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                    ELSE (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                END)) AS trxfee
        FROM
            (
                SELECT
                    DA.TRXDATE,
                    DA.BIZTYPEID,
                    DA.TRXFEE,
                    E2C.SHARESCALE,
                    c2a.PERCENT,
                    DA.REFUNDFEE,
                    DA.ACCOUNTINGCOST,
                    DA.REFUNDFRPCOST,
                    RECEIVER.CUSTOMERNUMBER,
                    RECEIVER.SIGNEDNAME,
                    RECEIVER.PRODUCTLINE,
                    P.PRODUCTNAME,
TST.NAME AS JIAOYILEIXING
                FROM
                    DB2INST1.DAILYTRXSTAT AS DA
                LEFT JOIN
                    DB2INST1.CUSTOMERINFO AS RECEIVER
                ON
                    1=1
                AND DA.RECEIVERID=RECEIVER.ID
                LEFT JOIN
                    DB2INST1.CUSTOMERRELATIONSHIP AS E2C
                ON
                    1=1
                AND RECEIVER.ID=E2C.CUSTOMERID
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS P
                ON
                    1=1
                AND DA.PRODUCT_CODE=P.PRODUCTCODE
                AND P.PRODUCTTYPE=2
                LEFT JOIN
                    DB2INST1.customer2achievement AS c2a
                ON
                    1=1
                AND RECEIVER.customernumber=c2a.customer_number
                left join DB2INST1.TRXSTATTRXTYPE TST 
                on 1=1 and DA.TYPE=TST.ID
                WHERE
                    RECEIVER.PRODUCTLINE in ('_µä¿¡è¡__çº', 'ä¿__è¡__çº', '__äº___', '_±éº¦äº___')
                AND P.PRODUCTNAME in ('___è´¦æ_', '_±å___', 'Cç½__ä»_', 'ä¼__è´¦æ_', 'EPOS', '_±å___', 'ä¸__ä»', 'POS__', 'ä¸ººç½____ï¼_2Cï¼','ä¼__ç½____ï¼_2Bï¼')
                AND DA.TRXDATE = ${START}) t
        GROUP BY
            t.TRXDATE,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            t.PRODUCTLINE,
            t.PRODUCTNAME,
            t.JIAOYILEIXING) tmp

GROUP BY
           tmp.TRXDATE,
    tmp.CUSTOMERNUMBER,
    tmp.SIGNEDNAME,
    tmp.PRODUCTLINE,
    tmp.PRODUCTNAME having SUM(tmp.trxprofit)<0",reportdb_read
checktrxprofitbybank,checktrxprofitbybanke,"SELECT
    tmp.TRXDATE || COALESCE(tmp.BANK_CODE, '-') || COALESCE(tmp.BANK_NAME, '-') || COALESCE(tmp.CUSTOMERNUMBER, '-') || COALESCE(tmp.PRODUCTNAME, '-') || COALESCE(tmp.PRODUCTLINE, '-') AS IDNOUSE,
    tmp.TRXDATE                AS DATA_PERIOD,
    tmp.BANK_CODE                AS BANK_CODE,
    tmp.BANK_NAME                AS BANK_NAME,
    tmp.CUSTOMERNUMBER AS MERCHANT_NUMBER,
    tmp.PRODUCTLINE             AS INDUSTRY,
    tmp.PRODUCTNAME           AS BASIC_PRODUCT,
    tmp.SIGNEDNAME               AS SIGNED_NAME,
    SUM(tmp.trxprofit)                AS TRX_PROFIT
FROM
    (
        SELECT
            t.TRXDATE,
            t.BANK_CODE,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            t.BANK_NAME,
            t.PRODUCTLINE,
            t.PRODUCTNAME,
            (SUM(t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*COALESCE
            (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE(t.SHARESCALE,1)*
            COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)))
            AS trxprofit,
            (SUM(
                CASE
                    WHEN t.BIZTYPEID IN (29,129)
                    THEN (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                    ELSE (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                END)) AS trxfee
        FROM
            (
                SELECT
                    DA.TRXDATE,
                    DA.BANK_CODE,
                    cbi.name AS BANK_NAME,
                    DA.BIZTYPEID,
                    DA.TRXFEE,
                    E2C.SHARESCALE,
                    c2a.PERCENT,
                    DA.REFUNDFEE,
                    DA.ACCOUNTINGCOST,
                    DA.REFUNDFRPCOST,
                    RECEIVER.CUSTOMERNUMBER,
                    RECEIVER.SIGNEDNAME,
                    RECEIVER.PRODUCTLINE,
                    P.PRODUCTNAME
                FROM
                    DB2INST1.DAILYTRXSTAT AS DA
                LEFT JOIN
                    DB2INST1.CUSTOMERINFO AS RECEIVER
                ON
                    1=1
                AND DA.RECEIVERID=RECEIVER.ID
                LEFT JOIN
                    DB2INST1.CUSTOMERRELATIONSHIP AS E2C
                ON
                    1=1
                AND RECEIVER.ID=E2C.CUSTOMERID
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS P
                ON
                    1=1
                AND DA.PRODUCT_CODE=P.PRODUCTCODE
                AND P.PRODUCTTYPE=2
                LEFT JOIN
                    DB2INST1.customer2achievement AS c2a
                ON
                    1=1
                AND RECEIVER.customernumber=c2a.customer_number
                LEFT JOIN
                    DB2INST1.cfg_bank_info cbi
                ON
                    DA.BANK_CODE=cbi.CODE
                WHERE
                    RECEIVER.PRODUCTLINE in ('_µä¿¡è¡__çº', 'ä¿__è¡__çº', '__äº___', '_±éº¦äº___')
AND DA.TRXDATE = ${START}
                AND P.PRODUCTNAME in ('___è´¦æ_', '_±å___', 'Cç½__ä»_', 'ä¼__è´¦æ_', 'EPOS', '_±å___', 'ä¸__ä»', 'POS__', 'ä¸ººç½____ï¼_2Cï¼','ä¼__ç½____ï¼_2Bï¼')
                AND DA.RECEIVERID not in (select distinct RECEIVERID from DAILYTRXSTAT where TYPE='POSTPAID')) t
        GROUP BY
            t.TRXDATE,
            t.BANK_CODE,
            t.CUSTOMERNUMBER,
	    t.SIGNEDNAME,
            t.BANK_NAME,
            t.PRODUCTLINE,
            t.PRODUCTNAME ) tmp
GROUP BY
    tmp.TRXDATE,
    tmp.BANK_CODE,
    tmp.BANK_NAME,
    tmp.CUSTOMERNUMBER,
    tmp.PRODUCTLINE,
    tmp.PRODUCTNAME,
    tmp.SIGNEDNAME having SUM(tmp.trxprofit)<0",reportdb_read
posOrderMessageQuery,posOrderTrxDataSource,"select c.signedName as Self_acc_name,c.SHORT_NAME as Self_acc_name1,c.CUSTOMER_NUMBER as Join_code,
TO_CHAR(o.create_time, 'YYYYMMDD') as Date,TO_CHAR(o.create_time, 'HH24:MI:SS') as Time,
'156' as Cur,o.trx_amount as Amt,'10' as Lend_flag,o.PAN as Part_acc_no,
case when ca.CARD_TYPE='DEBIT_CARD' then '___'
when ca.CARD_TYPE='CREDIT_CARD' then 'è´·è_'
when ca.CARD_TYPE='PREPAID_CARD' then '___'
when ca.CARD_TYPE='CREDIT_CARD' then 'è´·è_'
else '___'
end as Acc_flag,
b.SHORT_NAME as Part_bank_name,'æ¶_´¹' as Purpose,o.external_id as Trans_no,
po.SERIAL_NUMBER as Trans_no
from tbl_pos_order o
left join tbl_pos_payment p on o.id=p.order_id
left join tbl_pos_customer c on o.customer_number=c.customer_number
left join TBL_POS_CARDINFO ca on o.cardinfo_id=ca.id
left join tbl_pos_bank b on ca.ISSUER=b.bank_code
left join tbl_pos_pos po on o.pos_cati=po.pos_cati
where 1=1
and o.ORDER_STATUS in('SUCCESS','SETTLED')
and p.TRX_TYPE in ('PURCHASE','PRE_AUTHORIZATION_COMPLETION')
and p.status='SUCCESS'
and p.trx_time>=char(timestamp(${START})) and p.trx_time< ${STOP}
with ur",poscopy1
wwxrowreplacespark,rowkey_econf," SELECT SOURCEID,TASKID,EXTRACTORTYPE FROM bigdata_etl.etl_econf",bigdata_report
wwxrowreplacespark,rowkey_taskconf,"SELECT ID, `DESC` AS DCOMMNET FROM bigdata_etl.etl_taskconf",bigdata_report
proqualityChukuan1,proqualityChukuan1_total,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,count(*) TRADE_COUNT
from bac.TBL_BALANCE_REQUEST_DETAIL 
where URGENCY=1 and CREATE_TIME>=${START}  and CREATE_TIME<${STOP}
and BANK_STATUS in ('SUCCESS','FAIL') 
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",dzh_standby
proqualityChukuan1,proqualityChukuan1_succ,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,count(*) SUCCESS_COUNT
from bac.TBL_BALANCE_REQUEST_DETAIL 
where URGENCY=1 and CREATE_TIME>=${START}  and CREATE_TIME<${STOP} and BANK_STATUS in ('SUCCESS','FAIL') 
and timestampdiff(4,char(FINISH_TIME-CREATE_TIME))<=60 and BANK_STATUS in ('SUCCESS','FAIL')
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",dzh_standby
proqualityChukuan1,excep_proqualityChukuan1,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT 
from bac.TBL_BALANCE_REQUEST_DETAIL
where CREATE_TIME >= ${START} and CREATE_TIME < ${STOP}
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
proqualityChukuan2,proqualityChukuan2_total,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,count(*) TRADE_COUNT
 from bac.tbl_balance_request_detail 
where CREATE_TIME>=${START}  and CREATE_TIME<${STOP}
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",dzh_standby
proqualityChukuan2,proqualityChukuan2_succ,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,count(*) SUCCESS_COUNT
from bac.tbl_balance_request_detail 
where  CREATE_TIME>=${START}  and CREATE_TIME<${STOP} and bank_status in ('SUCCESS','FAIL')
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",dzh_standby
proqualityChukuan2,excep_proqualityChukuan2,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,0 CARDHOLDER_COUNT
from bac.tbl_balance_request_detail 
where  CREATE_TIME>=${START}  and CREATE_TIME<${STOP}
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",dzh_standby
proqualityAccountPay,proqualityAccountPay_total,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,count(id) TRADE_COUNT
 from accntpay.TBL_PAY_ORDER_1801
where CREATE_TIME>=${START}  and CREATE_TIME<${STOP}
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur
",dzh_standby
proqualityAccountPay,proqualityAccountPay_succ,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,count(id) SUCCESS_COUNT
from accntpay.TBL_PAY_ORDER_1801
where CREATE_TIME>=${START}  and CREATE_TIME<${STOP} and STATUS='SUCCESS'
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur
",dzh_standby
proqualityAccountPay,excep_proqualityAccountPay,"select TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') as HAPPEN_DATE,count(id) CARDHOLDER_COUNT
from accntpay.TBL_PAY_ORDER_1801
where  CREATE_TIME>=${START}  and CREATE_TIME<${STOP} and exception_code='0021'
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD HH24:MI') with ur",dzh_standby
remitcompletedrate,remitcompletedratee,"SELECT
    date AS CREATE_DATE,
    remittype AS REMIT_TYPE,
    sum(t_n) AS T_N,
    sum(t_60_n) AS T_60_N,
    CAST((sum(t_60_n)*100.0)/sum(t_n) AS DECIMAL(10,2))  AS T_60_RATE,
    sum(t_30_n) AS T_30_N,
    CAST((sum(t_30_n)*100.0)/sum(t_n) AS DECIMAL(10,2))  AS T_30_RATE,
    sum(t_10_n) AS T_10_N,
    CAST((sum(t_10_n)*100.0)/sum(t_n) AS DECIMAL(10,2))  AS T_10
FROM (
    SELECT date(a.create_date) date,
        a.remittype,
        count(1) t_n,
        SUM(CASE WHEN mint >=0 and mint <=60 THEN 1 ELSE 0 END) t_60_n,
        SUM(CASE WHEN mint >=0 and mint <=30 THEN 1 ELSE 0 END) t_30_n,
        SUM(CASE WHEN mint >=0 and mint <=10 THEN 1 ELSE 0 END) t_10_n
    FROM (
        SELECT req.create_date,
            timestampdiff(4, CHAR(DECODE(req.process_date,NULL,CURRENT TIMESTAMP, req.process_date)
                        - DECODE(req.remit_appointment_date,NULL,req.create_date, req.remit_appointment_date))) mint,
            req.amount,
            req.status,
            CASE WHEN (req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null)) THEN '__'
             WHEN req.REMIT_TYPE = '1' THEN 'ç§__'
             ELSE '_¶ä_' END remittype
        FROM remit.tbl_remit_request req
        LEFT JOIN remit.tbl_remit_process pro ON req.remit_request_no=pro.remit_request_no
        LEFT JOIN remit.tbl_remit_batch bat ON pro.remit_batch_no=bat.remit_batch_no
        LEFT JOIN remit.tbl_remit_channel cha ON bat.remit_channel_no=cha.remit_channel_no
        WHERE
            req.status in('REMIT_SUCCESS','REMIT_FAILURE')
            AND ((req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null))
            OR req.REMIT_TYPE = '1')
            AND (pro.remit_channel_no in ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB') and time(req.create_date) between '06:00:00' and '23:00:00'
              OR pro.remit_channel_no in ('BOC_YBT_PRI', 'BOC_YBT_PUB') and time(req.create_date) between '05:00:00' and '21:00:00'
              OR pro.remit_channel_no in ('BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB','BCCB_SUPER_PRI') and time(req.create_date) between '06:00:00' and '23:30:00'
              OR pro.remit_channel_no IN ('CCB_YBT_PRI','CCB_YBT_BATCH_PUB','CCB_YBT_PUB') and time(req.create_date) between '07:00:00' and '20:30:00'
              OR pro.remit_channel_no in ('EGBC_YBT_D0_PRI','EGBC_YBT_S0_PRI','CBHB_YBT_T1_PRI','CBHB_YBT_D0_PRI',
                                      'ICBC_YBT_PRI_NEW','ICBC_YBT_PUB_NEW','CGB_YBT_PRI','CGB_YBT_PUB',
                                      'CIB_PRI_YBT','CIB_PUB_YBT','HX_YBT_PRI','HX_YBT_PUB','CMBC_YBT_NEW_PRI',
                                      'CMBC_YBT_NEW_PUB','SPDB_YBT_PRI','SPDB_YBT_PUB','CEB_YBT_NEW_PRI',
                                      'CEB_YBT_NEW_PUB','PINGAN_YBT_PRI','PINGAN_YBT_PUB','ECITIC_YBT_PRI_NEW','ECITIC_YBT_PUB')
            and time(req.create_date) between '00:15:00' and '23:45:00')
    UNION ALL
        SELECT req.create_date,
            timestampdiff(4, CHAR(DECODE(req.process_date,NULL,CURRENT TIMESTAMP, req.process_date)
                            - DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE))) mint,
            req.amount,
            req.status,
            CASE WHEN (req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null)) THEN '__'
             WHEN req.REMIT_TYPE = '1' THEN 'ç§__'
             ELSE '_¶ä_' END remittype
        FROM remit.tbl_remit_request req
        LEFT JOIN remit.tbl_remit_process pro ON req.remit_request_no=pro.remit_request_no
        LEFT JOIN remit.tbl_remit_batch bat ON pro.remit_batch_no=bat.remit_batch_no
        LEFT JOIN remit.tbl_remit_channel cha ON bat.remit_channel_no=cha.remit_channel_no
        WHERE
            req.status in('REMIT_SUCCESS','REMIT_FAILURE')
            AND ((req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null))
            OR req.REMIT_TYPE = '1')
            AND (pro.remit_channel_no in ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB') and (time(req.create_date) < '06:00:00' or time(req.create_date) > '23:00:00')
              OR pro.remit_channel_no in ('BOC_YBT_PRI', 'BOC_YBT_PUB') and (time(req.create_date) < '05:00:00' or time(req.create_date) > '21:00:00')
              OR pro.remit_channel_no in ('BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB','BCCB_SUPER_PRI') and (time(req.create_date) < '06:00:00' or time(req.create_date) > '23:30:00')
              OR pro.remit_channel_no IN ('CCB_YBT_PRI','CCB_YBT_BATCH_PUB','CCB_YBT_PUB') and (time(req.create_date) < '07:00:00' or time(req.create_date) > '20:30:00')
              OR pro.remit_channel_no in ('EGBC_YBT_D0_PRI','EGBC_YBT_S0_PRI','CBHB_YBT_T1_PRI','CBHB_YBT_D0_PRI',
                                      'ICBC_YBT_PRI_NEW','ICBC_YBT_PUB_NEW','CGB_YBT_PRI','CGB_YBT_PUB',
                                      'CIB_PRI_YBT','CIB_PUB_YBT','HX_YBT_PRI','HX_YBT_PUB','CMBC_YBT_NEW_PRI',
                                      'CMBC_YBT_NEW_PUB','SPDB_YBT_PRI','SPDB_YBT_PUB','CEB_YBT_NEW_PRI',
                                      'CEB_YBT_NEW_PUB','PINGAN_YBT_PRI','PINGAN_YBT_PUB','ECITIC_YBT_PRI_NEW','ECITIC_YBT_PUB')
          and (time(req.create_date) < '00:15:00' or time(req.create_date) > '23:45:00'))
    ) a
    WHERE a.create_date >= ${START}
      AND a.create_date < timestamp(${START}) + 1 days
    GROUP BY date(a.create_date), a.remittype
) b
GROUP BY b.date, b.remittype",fundtx
customerinfoyangePRODUCTLINEID,customerinfoyangepostpaidzhangqi,"SELECT 
CUSTOMER_NUMBER as CUSTOMERNUMBER,
integer(PAYMENT_PERIOD) as PRODUCTLINEID
FROM FEE.TBL_FRONT_FEE_CUSTOMER WHERE PAYMENT_PERIOD IS NOT NULL with ur",feedb
posOrderMessageQuery01,posOrderTrxDataSource01,"select c.signedName as Self_acc_name,c.SHORT_NAME as Self_acc_name1,
'1' as Self_acc_no,'1' as Bank_acc_name,c.CUSTOMER_NUMBER as Join_code,
TO_CHAR(o.create_time, 'YYYYMMDD') as Date,TO_CHAR(o.create_time, 'HH24MISS') as Time,
'RMB' as Cur,o.trx_amount as Amt,0.00 as Usd_amt,'10' as Lend_flag,
'null' as Part_acc_name,o.PAN as Part_acc_no,
case when ca.CARD_TYPE='DEBIT_CARD' then '11'
when ca.CARD_TYPE='CREDIT_CARD' then '12'
when ca.CARD_TYPE='PREPAID_CARD' then '11'
when ca.CARD_TYPE='CREDIT_CARD' then '12'
else '11'
end as Acc_flag,
b.SHORT_NAME as Part_bank_name,'æ¶_´¹' as Purpose,o.external_id as Trans_no,
po.SERIAL_NUMBER as Trans_no
from tbl_pos_order o
left join tbl_pos_payment p on o.id=p.order_id
left join tbl_pos_customer c on o.customer_number=c.customer_number
left join TBL_POS_CARDINFO ca on o.cardinfo_id=ca.id
left join tbl_pos_bank b on ca.ISSUER=b.bank_code
left join tbl_pos_pos po on o.pos_cati=po.pos_cati
where 1=1
and o.ORDER_STATUS in('SUCCESS','SETTLED')
and p.TRX_TYPE in ('PURCHASE','PRE_AUTHORIZATION_COMPLETION')
and p.status='SUCCESS'
and p.trx_time>=char(timestamp(${START})) and p.trx_time< ${STOP}
with ur",poscopy1
posOrderMessageQuery01,2GSettleDataSource01,"SELECT
      C.CUSTOMERNUMBER as Join_code,
      A.BANKACTID as Self_acc_no,
      A.ACCOUNTNAME as Bank_acc_name
    FROM
        ACCOUNT A
    LEFT JOIN SETTLEMENTINFO S ON
        A.ID = S.BANKACCOUNT_ID
LEFT JOIN CUSTOMER C ON
A.CUSTOMER_ID = C.ID 
    WHERE 1=1
    AND A.STATUS = 'ACTIVATION'
    AND S.ID IS NOT NULL",COPY2
tbConHisImport,tbConHisImportcopy2,"SELECT MOBILEBE.CUSTOMER.CUSTOMERNUMBER AS Join_code,
MOBILEBE.CUSTOMERDOCINFO.DOCUMENTNUMBER AS Acc_name,
CASE MOBILEBE.CUSTOMERDOCINFO.DOCUMENTNAME WHEN 'èº»½è¯' THEN '11' WHEN 'æ³_ººèº»½è¯' THEN '11' ELSE '19' end as Id_type2,
MOBILEBE.CUSTOMERDOCINFO.DOCUMENTNUMBER AS Id_no2,
MOBILEBE.CUSTOMERDOCINFO.DESCRIPTION AS Rep_legal,
VARCHAR_FORMAT(DATE(MOBILEBE.CUSTOMERDOCINFO.AVAILABDATA), 'YYYYMMDD') AS Id_deadline2,
(SELECT MOBILEBE.profile.value FROM MOBILEBE.profile WHERE MOBILEBE.profile.customer_id = MOBILEBE.CUSTOMER.ID AND MOBILEBE.profile.name = 'p_signedName') AS Acc_name1,
CASE MOBILEBE.CUSTOMERDOCINFO.DOCUMENTNAME WHEN 'èº»½è¯' THEN '11' WHEN 'æ³_ººèº»½è¯' THEN '11' ELSE '12' end as Acc_type,
(SELECT MOBILEBE.profile.value FROM MOBILEBE.profile WHERE MOBILEBE.profile.customer_id = MOBILEBE.CUSTOMER.ID AND MOBILEBE.profile.name = 'p_customerSiteUrl') AS Web_info,
'11' AS Bord_flag,
VARCHAR_FORMAT(DATE(MOBILEBE.CUSTOMER.CREATEDATE), 'YYYYMMDD') AS Open_time
FROM MOBILEBE.CUSTOMER  
LEFT JOIN MOBILEBE.CUSTOMERDOCINFO ON MOBILEBE.CUSTOMER.CUSTOMERNUMBER = MOBILEBE.CUSTOMERDOCINFO.CUSTOMERNUMBER  fetch first 500 rows only with ur
",COPY2
remitcompletedrate,remitcompletedratee2,"SELECT
    date AS CREATE_DATE,
    remittype AS REMIT_TYPE,
    sum(t_n) AS T_N,
    sum(t_60_n) AS T_60_N,
    CAST((sum(t_60_n)*100.0)/sum(t_n) AS DECIMAL(10,2)) AS T_60_RATE,
    sum(t_30_n) AS T_30_N,
    CAST((sum(t_30_n)*100.0)/sum(t_n) AS DECIMAL(10,2)) AS T_30_RATE,
    sum(t_10_n) AS T_10_N,
    CAST((sum(t_10_n)*100.0)/sum(t_n) AS DECIMAL(10,2)) AS T_10
FROM (
        SELECT date(a.create_date) date,
               a.remittype,
                count(1) t_n,
                SUM(CASE WHEN mint >=0 and mint <=60 THEN 1 ELSE 0 END) t_60_n,
                SUM(CASE WHEN mint >=0 and mint <=30 THEN 1 ELSE 0 END) t_30_n,
                SUM(CASE WHEN mint >=0 and mint <=10 THEN 1 ELSE 0 END) t_10_n
        FROM (
            SELECT req.create_date, '__·¥ä½___' ta,
                timestampdiff(4, CHAR(DECODE(req.process_date,NULL,CURRENT TIMESTAMP, req.process_date)
                            - DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE))) mint,
                req.amount,
                req.status,
                '____' remittype
            FROM remit.tbl_remit_request req
            LEFT JOIN remit.tbl_remit_process pro ON req.remit_request_no=pro.remit_request_no
            LEFT JOIN remit.tbl_remit_batch bat ON pro.remit_batch_no=bat.remit_batch_no
            LEFT JOIN remit.tbl_remit_channel cha ON bat.remit_channel_no=cha.remit_channel_no
            WHERE
                req.status in('REMIT_SUCCESS','REMIT_FAILURE')
                AND ((req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
                           OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
                           OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null))
                AND hour(bat.CREATE_DATE) = 9
        UNION ALL
            SELECT req.create_date, 'å·¥ä__¶é___æ¬' ta,
                    timestampdiff(4, CHAR(DECODE(req.process_date,NULL,CURRENT TIMESTAMP, req.process_date)
                                    - DECODE(req.remit_appointment_date,NULL,req.create_date, req.remit_appointment_date))) mint,
                    req.amount,
                    req.status,
                    '____' remittype
            FROM remit.tbl_remit_request req
            LEFT JOIN remit.tbl_remit_process pro ON req.remit_request_no=pro.remit_request_no
            LEFT JOIN remit.tbl_remit_batch bat ON pro.remit_batch_no=bat.remit_batch_no
            LEFT JOIN remit.tbl_remit_channel cha ON bat.remit_channel_no=cha.remit_channel_no
            WHERE
                req.status in('REMIT_SUCCESS','REMIT_FAILURE')
                AND hour(bat.CREATE_DATE) >= 10
                AND ((req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
                           OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
                           OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null))
                AND (pro.remit_channel_no in ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB') and time(req.create_date) between '06:00:00' and '23:00:00'
              OR pro.remit_channel_no in ('BOC_YBT_PRI', 'BOC_YBT_PUB') and time(req.create_date) between '05:00:00' and '21:00:00'
              OR pro.remit_channel_no in ('BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB','BCCB_SUPER_PRI') and time(req.create_date) between '06:00:00' and '23:30:00'
              OR pro.remit_channel_no IN ('CCB_YBT_PRI','CCB_YBT_BATCH_PUB','CCB_YBT_PUB') and time(req.create_date) between '07:00:00' and '20:30:00'
              OR pro.remit_channel_no in ('EGBC_YBT_D0_PRI','EGBC_YBT_S0_PRI','CBHB_YBT_T1_PRI','CBHB_YBT_D0_PRI',
                                          'ICBC_YBT_PRI_NEW','ICBC_YBT_PUB_NEW','CGB_YBT_PRI','CGB_YBT_PUB',
                                          'CIB_PRI_YBT','CIB_PUB_YBT','HX_YBT_PRI','HX_YBT_PUB','CMBC_YBT_NEW_PRI',
                                          'CMBC_YBT_NEW_PUB','SPDB_YBT_PRI','SPDB_YBT_PUB','CEB_YBT_NEW_PRI',
                                          'CEB_YBT_NEW_PUB','PINGAN_YBT_PRI','PINGAN_YBT_PUB','ECITIC_YBT_PRI_NEW','ECITIC_YBT_PUB')
              and time(req.create_date) between '00:15:00' and '23:45:00')
          UNION ALL
              SELECT req.create_date, 'å·¥ä__¶é_ä¸____' ta,
                    timestampdiff(4, CHAR(DECODE(req.process_date,NULL,CURRENT TIMESTAMP, req.process_date)
                                    - DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE))) mint,
                    req.amount,
                    req.status,
                    '____' remittype
                FROM remit.tbl_remit_request req
                LEFT JOIN remit.tbl_remit_process pro ON req.remit_request_no=pro.remit_request_no
                LEFT JOIN remit.tbl_remit_batch bat ON pro.remit_batch_no=bat.remit_batch_no
                LEFT JOIN remit.tbl_remit_channel cha ON bat.remit_channel_no=cha.remit_channel_no
                WHERE
                    req.status in('REMIT_SUCCESS','REMIT_FAILURE')
                    AND hour(bat.CREATE_DATE) >= 10
                    AND ((req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
                           OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
                           OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null))
                    AND (pro.remit_channel_no in ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB') and (time(req.create_date) < '06:00:00' or time(req.create_date) > '23:00:00')
                  OR pro.remit_channel_no in ('BOC_YBT_PRI', 'BOC_YBT_PUB') and (time(req.create_date) < '05:00:00' or time(req.create_date) > '21:00:00')
                  OR pro.remit_channel_no in ('BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB','BCCB_SUPER_PRI') and (time(req.create_date) < '06:00:00' or time(req.create_date) > '23:30:00')
                  OR pro.remit_channel_no IN ('CCB_YBT_PRI','CCB_YBT_BATCH_PUB','CCB_YBT_PUB') and (time(req.create_date) < '07:00:00' or time(req.create_date) > '20:30:00')
                  OR pro.remit_channel_no in ('EGBC_YBT_D0_PRI','EGBC_YBT_S0_PRI','CBHB_YBT_T1_PRI','CBHB_YBT_D0_PRI',
                                              'ICBC_YBT_PRI_NEW','ICBC_YBT_PUB_NEW','CGB_YBT_PRI','CGB_YBT_PUB',
                                              'CIB_PRI_YBT','CIB_PUB_YBT','HX_YBT_PRI','HX_YBT_PUB','CMBC_YBT_NEW_PRI',
                                              'CMBC_YBT_NEW_PUB','SPDB_YBT_PRI','SPDB_YBT_PUB','CEB_YBT_NEW_PRI',
                                              'CEB_YBT_NEW_PUB','PINGAN_YBT_PRI','PINGAN_YBT_PUB','ECITIC_YBT_PRI_NEW','ECITIC_YBT_PUB')
                  and (time(req.create_date) < '00:15:00' or time(req.create_date) > '23:45:00'))
              ) a
          where a.create_date >= ${START} 
            AND a.create_date < timestamp(${START}) + 1 days
          GROUP BY date(a.create_date), a.remittype
     ) b
GROUP BY b.date, b.remittype",fundtx
remitcollectlater,remitcollectlatere,"SELECT
	a.UQ_INDEX,
	a.customer_no,
	a.customer_name,
	a.remit_request_no,
	a.process_id,
	a.remit_batch_no,
	a.bank_name,
	a.remit_status,
	a.TRADE_INITIATOR,
	a.remit_channel_name,
	a.amount,
	a.remit_type,
	a.create_time,
	a.atime,
	a.ptime,
	a.btime,
	a.ztime,
	a.alltime,
	a.protime,
	a.battime,
	a.chatime
	FROM (
	SELECT 
		req.REMIT_REQUEST_NO || pro.REMIT_BATCH_NO || pro.amount AS UQ_INDEX,
		req.CUSTOMER_NO AS customer_no,
		req.CUSTOMER_NAME AS customer_name,
		req.REMIT_REQUEST_NO AS remit_request_no,
		pro.id AS process_id,
		pro.REMIT_BATCH_NO AS remit_batch_no,
		req.BANK_NAME AS bank_name,
		req.STATUS AS remit_status,
	    req.TRADE_INITIATOR AS TRADE_INITIATOR,
	    cha.REMIT_CHANNEL_NAME AS remit_channel_name,
	    pro.AMOUNT AS amount,
	    CASE WHEN (req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null)) THEN 'realtime'
		 WHEN (req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
		       OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
		       OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null) THEN 'normal'
		 WHEN req.REMIT_TYPE = '1' THEN 'seconds'
		 ELSE 'other' END AS remit_type,
	    req.CREATE_DATE AS create_time,
	    TO_CHAR(req.remit_appointment_date, 'YYYY-MM-DD HH24:Mi:SS') atime,
	    TO_CHAR(bat.CREATE_DATE, 'YYYY-MM-DD HH24:Mi:SS') ptime,
	    TO_CHAR(bat.ACCEPT_DATE, 'YYYY-MM-DD HH24:Mi:SS') btime,
	    TO_CHAR(req.PROCESS_DATE, 'YYYY-MM-DD HH24:Mi:SS') ztime,
	    timestampdiff(4, CHAR(DECODE(req.process_date,NULL,CURRENT TIMESTAMP, req.process_date)
	        - DECODE(req.remit_appointment_date,NULL,req.create_date, req.remit_appointment_date))) alltime,
	    timestampdiff(4, CHAR(DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE)
	            - DECODE(req.remit_appointment_date,NULL,req.create_date, req.remit_appointment_date))) protime,
	    timestampdiff(4, CHAR(DECODE(bat.ACCEPT_DATE,NULL,CURRENT TIMESTAMP, bat.ACCEPT_DATE)
	            - DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE))) battime,
	    timestampdiff(4, CHAR(DECODE(req.PROCESS_DATE,NULL,CURRENT TIMESTAMP, req.PROCESS_DATE)
	        - DECODE(bat.ACCEPT_DATE,NULL,CURRENT TIMESTAMP, bat.ACCEPT_DATE))) chatime
	FROM remit.tbl_remit_request req
	LEFT JOIN remit.tbl_remit_process pro ON req.remit_request_no=pro.remit_request_no
	LEFT JOIN remit.tbl_remit_batch bat ON pro.remit_batch_no=bat.remit_batch_no
	LEFT JOIN remit.tbl_remit_channel cha ON bat.remit_channel_no=cha.remit_channel_no
	WHERE ( (req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null) )
	        OR req.REMIT_TYPE = '1' ) 
               AND cha.bank_info_id not in ('BANK60010052','BANK60010053','BANK60010058','BANK60011115')
               AND instr(pro.REMIT_CHANNEL_NO,'CROSSBORDER') <= 0
               AND pro.REMIT_CHANNEL_NO not in 
       ('BCCB_KRBH_PRI','BCCB_KRBH_PUB','BCCB_KRKH_PRI','BCCB_KRKH_PRI_MAX','BCCB_KRKH_PUB','BCCB_KRKH_PUB_MAX',
       'CMBCHINA_YBT_BJ_PUB','GDBIB_PRI', 'NXY')
	AND ((pro.remit_channel_no in ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB') and time(req.create_date) between '06:00:00' and '23:00:00'
	      OR pro.remit_channel_no in ('BOC_YBT_PRI', 'BOC_YBT_PUB') and time(req.create_date) between '05:00:00' and '21:00:00'
	      OR pro.remit_channel_no in ('BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB','BCCB_SUPER_PRI') and time(req.create_date) between '06:00:00' and '23:30:00'
	      OR pro.remit_channel_no IN ('CCB_YBT_PRI','CCB_YBT_BATCH_PUB','CCB_YBT_PUB') and time(req.create_date) between '07:00:00' and '20:30:00'
              OR pro.remit_channel_no IN ('PINGAN_YBT_PRI') and time(req.create_date) between '02:00:00' and '22:00:00')
	OR (pro.remit_channel_no NOT IN ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB', 'BOC_YBT_PRI', 
                              'ABC_YBT_BJ_PUB', 'BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB', 'BCCB_SUPER_PRI',
                              'CCB_YBT_PRI', 'CCB_YBT_BATCH_PUB', 'CCB_YBT_PUB', 'PINGAN_YBT_PRI')
                AND  time(req.create_date) between '00:15:00' and '23:45:00'))
	UNION ALL
	SELECT 
		req.REMIT_REQUEST_NO || pro.REMIT_BATCH_NO || pro.amount AS UQ_INDEX,
		req.CUSTOMER_NO AS customer_no,
		req.CUSTOMER_NAME AS customer_name,
		req.REMIT_REQUEST_NO AS remit_request_no,
		pro.id AS process_id,
		pro.REMIT_BATCH_NO AS remit_batch_no,
		req.BANK_NAME AS bank_name,
		req.STATUS AS remit_status,
	    req.TRADE_INITIATOR AS TRADE_INITIATOR,
	    cha.REMIT_CHANNEL_NAME AS remit_channel_name,
	    pro.AMOUNT AS amount,
	    CASE WHEN (req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null)) THEN 'realtime'
		 WHEN (req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
		       OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
		       OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null) THEN 'normal'
		 WHEN req.REMIT_TYPE = '1' THEN 'seconds'
		 ELSE 'other' END AS remit_type,
	    req.CREATE_DATE AS create_time,
	    TO_CHAR(req.remit_appointment_date, 'YYYY-MM-DD HH24:Mi:SS') atime,
	    TO_CHAR(bat.CREATE_DATE, 'YYYY-MM-DD HH24:Mi:SS') ptime,
	    TO_CHAR(bat.ACCEPT_DATE, 'YYYY-MM-DD HH24:Mi:SS') btime,
	    TO_CHAR(req.PROCESS_DATE, 'YYYY-MM-DD HH24:Mi:SS') ztime,
	    timestampdiff(4, CHAR(DECODE(req.process_date,NULL,CURRENT TIMESTAMP, req.process_date)
	            - DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE))) alltime,
	    0 protime,
	    timestampdiff(4, CHAR(DECODE(bat.ACCEPT_DATE,NULL,CURRENT TIMESTAMP, bat.ACCEPT_DATE)
	            - DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE))) battime,
	    timestampdiff(4, CHAR(DECODE(req.PROCESS_DATE,NULL,CURRENT TIMESTAMP, req.PROCESS_DATE)
	        - DECODE(bat.ACCEPT_DATE,NULL,CURRENT TIMESTAMP, bat.ACCEPT_DATE))) chatime
	FROM remit.tbl_remit_request req
	LEFT JOIN remit.tbl_remit_process pro ON req.remit_request_no=pro.remit_request_no
	LEFT JOIN remit.tbl_remit_batch bat ON pro.remit_batch_no=bat.remit_batch_no
	LEFT JOIN remit.tbl_remit_channel cha ON bat.remit_channel_no=cha.remit_channel_no
	WHERE hour(bat.CREATE_DATE) = 9
	      AND ( (req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
	           OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
	           OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null) )
		AND cha.bank_info_id not in ('BANK60010052','BANK60010053','BANK60010058','BANK60011115')
               AND instr(pro.REMIT_CHANNEL_NO,'CROSSBORDER') <= 0
               AND pro.REMIT_CHANNEL_NO not in 
       ('BCCB_KRBH_PRI','BCCB_KRBH_PUB','BCCB_KRKH_PRI','BCCB_KRKH_PRI_MAX','BCCB_KRKH_PUB','BCCB_KRKH_PUB_MAX',
       'CMBCHINA_YBT_BJ_PUB','GDBIB_PRI', 'NXY')
	AND ((pro.remit_channel_no in ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB') and time(req.create_date) between '06:00:00' and '23:00:00'
	      OR pro.remit_channel_no in ('BOC_YBT_PRI', 'BOC_YBT_PUB') and time(req.create_date) between '05:00:00' and '21:00:00'
	      OR pro.remit_channel_no in ('BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB','BCCB_SUPER_PRI') and time(req.create_date) between '06:00:00' and '23:30:00'
	      OR pro.remit_channel_no IN ('CCB_YBT_PRI','CCB_YBT_BATCH_PUB','CCB_YBT_PUB') and time(req.create_date) between '07:00:00' and '20:30:00'
              OR pro.remit_channel_no IN ('PINGAN_YBT_PRI') and time(req.create_date) between '02:00:00' and '22:00:00')
	OR (pro.remit_channel_no NOT IN ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB', 'BOC_YBT_PRI', 
                              'ABC_YBT_BJ_PUB', 'BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB', 'BCCB_SUPER_PRI',
                              'CCB_YBT_PRI', 'CCB_YBT_BATCH_PUB', 'CCB_YBT_PUB', 'PINGAN_YBT_PRI')
                AND  time(req.create_date) between '00:15:00' and '23:45:00'))
	UNION ALL
	SELECT 
		req.REMIT_REQUEST_NO || pro.REMIT_BATCH_NO || pro.amount AS UQ_INDEX,
		req.CUSTOMER_NO AS customer_no,
		req.CUSTOMER_NAME AS customer_name,
		req.REMIT_REQUEST_NO AS remit_request_no,
		pro.id AS process_id,
		pro.REMIT_BATCH_NO AS remit_batch_no,
		req.BANK_NAME AS bank_name,
		req.STATUS AS remit_status,
	    req.TRADE_INITIATOR AS TRADE_INITIATOR,
	    cha.REMIT_CHANNEL_NAME AS remit_channel_name,
	    pro.AMOUNT AS amount,
	    CASE WHEN (req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null)) THEN 'realtime'
		 WHEN (req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
		       OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
		       OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null) THEN 'normal'
		 WHEN req.REMIT_TYPE = '1' THEN 'seconds'
		 ELSE 'other' END AS remit_type,
	    req.CREATE_DATE AS create_time,
	    TO_CHAR(req.remit_appointment_date, 'YYYY-MM-DD HH24:Mi:SS') atime,
	    TO_CHAR(bat.CREATE_DATE, 'YYYY-MM-DD HH24:Mi:SS') ptime,
	    TO_CHAR(bat.ACCEPT_DATE, 'YYYY-MM-DD HH24:Mi:SS') btime,
	    TO_CHAR(req.PROCESS_DATE, 'YYYY-MM-DD HH24:Mi:SS') ztime,
	    timestampdiff(4, CHAR(DECODE(req.process_date,NULL,CURRENT TIMESTAMP, req.process_date)
	            - DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE))) alltime,
	    0 protime,
	    timestampdiff(4, CHAR(DECODE(bat.ACCEPT_DATE,NULL,CURRENT TIMESTAMP, bat.ACCEPT_DATE)
	            - DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE))) battime,
	    timestampdiff(4, CHAR(DECODE(req.PROCESS_DATE,NULL,CURRENT TIMESTAMP, req.PROCESS_DATE)
	        - DECODE(bat.ACCEPT_DATE,NULL,CURRENT TIMESTAMP, bat.ACCEPT_DATE))) chatime
	FROM remit.tbl_remit_request req
	LEFT JOIN remit.tbl_remit_process pro ON req.remit_request_no=pro.remit_request_no
	LEFT JOIN remit.tbl_remit_batch bat ON pro.remit_batch_no=bat.remit_batch_no
	LEFT JOIN remit.tbl_remit_channel cha ON bat.remit_channel_no=cha.remit_channel_no
	WHERE hour(bat.CREATE_DATE) >= 10
	      AND ( (req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
	           OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
	           OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null) )
		AND cha.bank_info_id not in ('BANK60010052','BANK60010053','BANK60010058','BANK60011115')
               AND instr(pro.REMIT_CHANNEL_NO,'CROSSBORDER') <= 0
               AND pro.REMIT_CHANNEL_NO not in 
       ('BCCB_KRBH_PRI','BCCB_KRBH_PUB','BCCB_KRKH_PRI','BCCB_KRKH_PRI_MAX','BCCB_KRKH_PUB','BCCB_KRKH_PUB_MAX',
       'CMBCHINA_YBT_BJ_PUB','GDBIB_PRI', 'NXY')
	AND ((pro.remit_channel_no in ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB') and time(req.create_date) between '06:00:00' and '23:00:00'
	      OR pro.remit_channel_no in ('BOC_YBT_PRI', 'BOC_YBT_PUB') and time(req.create_date) between '05:00:00' and '21:00:00'
	      OR pro.remit_channel_no in ('BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB','BCCB_SUPER_PRI') and time(req.create_date) between '06:00:00' and '23:30:00'
	      OR pro.remit_channel_no IN ('CCB_YBT_PRI','CCB_YBT_BATCH_PUB','CCB_YBT_PUB') and time(req.create_date) between '07:00:00' and '20:30:00'
              OR pro.remit_channel_no IN ('PINGAN_YBT_PRI') and time(req.create_date) between '02:00:00' and '22:00:00')
	OR (pro.remit_channel_no NOT IN ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB', 'BOC_YBT_PRI', 
                              'ABC_YBT_BJ_PUB', 'BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB', 'BCCB_SUPER_PRI',
                              'CCB_YBT_PRI', 'CCB_YBT_BATCH_PUB', 'CCB_YBT_PUB', 'PINGAN_YBT_PRI')
                AND  time(req.create_date) between '00:15:00' and '23:45:00'))
) a
WHERE a.create_time >= ${START}
  AND a.create_time < TIMESTAMP(${START}) + 1 DAYS
 WITH ur",fundtx
tbConHisImport,tbConHisImportcopy3,"SELECT 
MOBILEBE.customer.CUSTOMERNUMBER AS Join_code,
'12' AS Acc_type1,
MOBILEBE.ACCOUNT.BANKACTID AS Self_acc_no,
MOBILEBE.ACCOUNT.ACCOUNTNAME AS Bank_acc_name 
FROM 
MOBILEBE.ACCOUNT 
LEFT JOIN MOBILEBE.customer ON MOBILEBE.ACCOUNT.CUSTOMER_ID = MOBILEBE.customer.ID 
LEFT JOIN MOBILEBE.SETTLEMENTINFO  ON MOBILEBE.ACCOUNT.ID = MOBILEBE.SETTLEMENTINFO.BANKACCOUNT_ID 
WHERE MOBILEBE.ACCOUNT.CLASSTYPE = 'RemoteAccount' 
AND MOBILEBE.ACCOUNT.STATUS = 'ACTIVATION' 
AND MOBILEBE.SETTLEMENTINFO.ID IS NOT NULL 
",COPY2
tbConHisImport,tbConHisImportcopy4,"SELECT 
CUSCENTER.TBL_MERCHANT.MERCHANT_NO AS Join_code,
'11' AS Id_type,
CUSCENTER.TBL_CORPORATION.LICENSE_NO_ENCRYPT AS Id_no,
VARCHAR_FORMAT(DATE(CUSCENTER.TBL_CORPORATION.EXPIRY_DATE), 'YYYYMMDD') AS Id_deadline,
'CHN' AS Nation1,
CASE CUSCENTER.TBL_CORPORATION.SEX WHEN 'male' THEN '11' ELSE '12' END AS Cst_sex,
CUSCENTER.TBL_CORPORATION.CONTACT_PHONE_ENCRYPT AS contact,
CUSCENTER.TBL_CORPORATION.ADDRESS_ENCRYPT AS Address,
CUSCENTER.TBL_MERCHANT.BIZCAT_NAME AS Operate,
CUSCENTER.TBL_ORGANIZATION.NUMBER"" AS Org_no",
CUSCENTER.tbl_bizlicense.BIZ_CAPITAL AS Reg_amt,,,
CASE CUSCENTER.TBL_MERCHANT.SIGN_TYPE WHEN 'PERSON' THEN VARCHAR_FORMAT(DATE(CUSCENTER.TBL_CORPORATION.EXPIRY_DATE), 'YYYYMMDD') ,,
"									WHEN 'INDIVIDUAL' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_bizlicense.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									WHEN 'ENTERPRISE' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_unicrdcodecert.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									WHEN 'INSTITUTION' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_qualification.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									WHEN 'COMMUNITY' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_qualification.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									WHEN 'PEOPLE_RUN_NON_ENTERPRISE' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_qualification.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									end as License_deadline",,,
CASE CUSCENTER.TBL_MERCHANT.SIGN_TYPE WHEN 'PERSON' THEN CUSCENTER.TBL_CORPORATION.LICENSE_NO_ENCRYPT ,,,
"									  WHEN 'INDIVIDUAL' THEN CUSCENTER.tbl_bizlicense.REGIST_NO",,,
"									  WHEN 'ENTERPRISE' THEN CUSCENTER.tbl_unicrdcodecert.""NUMBER""",,,
"									  WHEN 'INSTITUTION' THEN CUSCENTER.tbl_qualification.""NUMBER""",,,
"									  WHEN 'COMMUNITY' THEN CUSCENTER.tbl_qualification.""NUMBER""",,,
"									  WHEN 'PEOPLE_RUN_NON_ENTERPRISE' THEN CUSCENTER.tbl_qualification.""NUMBER""",,,
"									  end as License",,,
CASE CUSCENTER.TBL_MERCHANT.SIGN_TYPE WHEN 'PERSON' THEN  '12'  ,,,
"									WHEN 'INDIVIDUAL' THEN  '11'",,,
"									 WHEN 'ENTERPRISE' THEN  '12'",,,
"									 WHEN 'INSTITUTION' THEN  '12'",,,
"									 WHEN 'COMMUNITY' THEN  '12'",,,
"									 WHEN 'PEOPLE_RUN_NON_ENTERPRISE' THEN  '12'",,,
"									END AS Set_file",,,
FROM CUSCENTER.TBL_CORPORATION ,,,
LEFT JOIN CUSCENTER.TBL_MERCHANT ON CUSCENTER.TBL_CORPORATION.CUSTOMER_NO = CUSCENTER.TBL_MERCHANT.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.TBL_ORGANIZATION ON CUSCENTER.TBL_MERCHANT.CUSTOMER_NO = CUSCENTER.TBL_ORGANIZATION.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.tbl_qualification ON CUSCENTER.tbl_merchant.CUSTOMER_NO = CUSCENTER.tbl_qualification.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.tbl_bizlicense ON CUSCENTER.tbl_bizlicense.CUSTOMER_NO = CUSCENTER.tbl_merchant.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.tbl_taxregcert ON CUSCENTER.tbl_taxregcert.CUSTOMER_NO = CUSCENTER.tbl_merchant.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.tbl_acclicense ON CUSCENTER.tbl_acclicense.CUSTOMER_NO = CUSCENTER.tbl_merchant.CUSTOMER_NO ,,,
"LEFT JOIN CUSCENTER.tbl_unicrdcodecert ON CUSCENTER.tbl_unicrdcodecert.CUSTOMER_NO = CUSCENTER.tbl_merchant.CUSTOMER_NO""",dzh_standby,,
customerinfoyangesalesname,customerinfoyangesalesname,"select  cu.customernumber as key,em.name as value  
from mobilebe.customer cu 
left join mobilebe.employee2customer e   on e.cust_id=cu.id
left join mobilebe.employee em on e.emp_id=em.id 
with ur",COPY2
remitcollectstat,remitcollectstate,"SELECT
    dt || cname ||  remittype || TRADE_INITIATOR AS UQ_INDEX,
    dt AS CREATE_DATE,
    cname AS CHANNEL_NAME,
    remittype AS REMIT_TYPE,
    case when TRADE_INITIATOR = 'TRANSFEXT'  then 'ä»£ä_ä»£å_'
    when TRADE_INITIATOR = 'WITHDRAW' then  'èµ__äº¤æ_'
    when TRADE_INITIATOR = 'MERCHANT_SETTLE' then   '___ç»__'
    when TRADE_INITIATOR = 'CASH' then  '______'
    when TRADE_INITIATOR = 'TRANSFEXT_INDAY' then   '_¥ç__'
    when TRADE_INITIATOR = 'REFUND_COMMON' then '_¨çº¿_æ¬'
    when TRADE_INITIATOR = 'REFUND_EPOS' then   'EPOS_æ¬'
    when TRADE_INITIATOR = 'REFUND_POS' then    'POS_æ¬'
    when TRADE_INITIATOR = 'REFUND_DEBITNOCARD' then    'ä»£æ__æ¬'
    when TRADE_INITIATOR = 'REFUND_KUAI_PAY' then   'å¿__æ¬'
    when TRADE_INITIATOR = 'CROSSBORDER' then   'è´_ç»__'
    when TRADE_INITIATOR = 'TRANSFEXT_ZZY' then 'å§__ç»____¨è½¬_'
    when TRADE_INITIATOR = 'TRANSFEXT_ZZYP' then    'å§__ç»____¨è½¬_+'
    when TRADE_INITIATOR = 'EXCHANGESETTLEMENT-SETTLE' then 'ç»__ç»__'
    when TRADE_INITIATOR = 'CROSSBORDER_CNY' then   'äººæ_å¸_·¨å¢'
    when TRADE_INITIATOR = 'REFUND_MOBILEPAY' then  'ç§»å____æ¬'
    when TRADE_INITIATOR = 'REFUND_NOCARD_MOBILEPAY' then   '______æ¬'
    when TRADE_INITIATOR = 'REFUND_WAP_SM' then 'ç§»å______æ¬'
    when TRADE_INITIATOR = 'LMPORTAL' then  '___å¹³å_'
    when TRADE_INITIATOR = 'POST0D0' then   'çº¿ä__¥ç__'
    when TRADE_INITIATOR = 'LMZJTG' then    '___èµ____'
    when TRADE_INITIATOR = 'fundPaySys' then    '_ºé___'
    when TRADE_INITIATOR = 'superSettle' then   '_°å__·ç_ç®'
    else '_¶ä_' end AS TRADE_INITIATOR,
    cn AS T_COUNT,
    an AS T_AMOUNT
    FROM (
    SELECT date(a.create_date) dt, a.TRADE_INITIATOR, a.remittype, a.REMIT_CHANNEL_NAME cname, count(1) cn, sum(a.amount) an FROM (
        SELECT req.CREATE_DATE, req.TRADE_INITIATOR, cha.REMIT_CHANNEL_NAME, pro.amount,
            CASE WHEN (req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null)) THEN '__'
             WHEN (req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
                   OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
                   OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null) THEN '____'
             WHEN req.REMIT_TYPE = '1' THEN 'ç§__'
             ELSE '_¶ä_' END remittype
        FROM remit.TBL_REMIT_REQUEST req
        LEFT JOIN remit.TBL_REMIT_PROCESS pro ON req.REMIT_REQUEST_NO = pro.REMIT_REQUEST_NO
        LEFT JOIN remit.TBL_REMIT_CHANNEL cha ON pro.REMIT_CHANNEL_NO = cha.REMIT_CHANNEL_NO
        WHERE req.CREATE_DATE >= ${START}
        AND req.CREATE_DATE < TIMESTAMP(${START}) + 1 day
    ) a
    GROUP BY a.remittype, a.TRADE_INITIATOR, date(a.create_date), a.REMIT_CHANNEL_NAME
)",fundtx
customerinfoyangevmark,customerinfoyangevmark,"select CUSTOMERNUMBER CUSTOMERNUMBER, coalesce(CUSTOMERLEVEL,'V') as VMARK from CUSTOMERGRADELEVEL where CUSTOMERNUMBER is not null with ur",COPY2
customerinfoyangesigneddate,customerinfoyangesigneddate,"select  customernumber as CUSTOMERNUMBER, min(STARTDATE) as SIGNED_DATE
from mobilebe.CONTRACTMANAGER 
group by customernumber
with ur",COPY2
customerinfoyangesalesid,customerinfoyangesalesid,"select  cu.customernumber as customernumber,em.id as SALESID 
from db2inst1.employee2customer e 
left join db2inst1.employeeinfo em on e.emp_id=em.id 
left join db2inst1.customerinfo cu on e.cust_id=cu.id
with ur",reportdb
fanxiqian1,ncpay-order-success,"SELECT 
    CARD_ID  																	AS Self_acc_no ,
    '11' 																			AS Acc_type  ,
    VARCHAR_FORMAT(CONFIRM_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(CONFIRM_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																		AS Cur  ,
    REAL_AMOUNT  															AS Amt  ,
    '11' 																			AS Lend_flag  ,
    MERCHANT_NO  															AS Part_acc_name  ,
    '11' 																			AS Acc_flag  ,
    '10' 																			AS Txn_flag  ,
    PRODUCT  																	AS Purpose  ,
    '12'  																		AS Bord_flag  ,
    PAYMENT_NO 															  AS Trans_no 
FROM 
		NCC.TBL_NC_PAY_ORDER
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		STATE ='SUCCESS' ",INNO_STANBY
fanxiqian,ncpay_order_success,"SELECT 
    CARD_ID  																	AS Card_id ,
    ACCOUNT_NO																AS Self_acc_no ,
    '11' 																			AS Acc_type  ,
    VARCHAR_FORMAT(CONFIRM_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(CONFIRM_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																		AS Cur  ,
    REAL_AMOUNT  															AS Amt  ,
    '11' 																			AS Lend_flag  ,
    MERCHANT_NO  															AS Customer_no  ,
    '11' 																			AS Acc_flag  ,
    '10' 																			AS Txn_flag  ,
    PRODUCT  																	AS Purpose  ,
    '12'  																		AS Bord_flag  ,
    PAYMENT_NO 															  AS Trans_no 
FROM 
		NCC.TBL_NC_PAY_ORDER
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		STATE ='SUCCESS' 
		",INNO_STANBY
fanxiqian,frontend_net_order_success,"SELECT 
 		CASE
      WHEN LOCATE('B2C', PAY_INTERFACE) > 0  THEN '11'
      ELSE            														'12'
    END 																					AS Acc_type  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																				AS Cur  ,
    TOTAL_AMOUNT  																AS Amt  ,
    '11' 																					AS Lend_flag  ,
    CUSTOMER_NUMBER  															AS Customer_no  ,
    '11' 																					AS Acc_flag  ,
    '10' 																					AS Txn_flag  ,
    GOODS_DESCRIPTION  														AS Purpose  ,
    PAYER_IP    																	AS Ip_code  ,
    DEVICE_INFO    																AS Mac_info  ,
    '12'  																				AS Bord_flag  ,
    CONCAT('NET_',ID) 														AS Trans_no 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_NET
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
fanxiqian,frontend_zfb_order_success,"SELECT 
 		'11'																					AS Acc_type  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																				AS Cur  ,
    TOTAL_AMOUNT  																AS Amt  ,
    '11' 																					AS Lend_flag  ,
    CUSTOMER_NUMBER  															AS Customer_no  ,
    '11' 																					AS Acc_flag  ,
    '10' 																					AS Txn_flag  ,
    GOODS_DESCRIPTION  														AS Purpose  ,
    PAYER_IP    																	AS Ip_code  ,
    DEVICE_INFO    															  AS Mac_info  ,
    '12'  																				AS Bord_flag  ,
    CONCAT('ZFB_',ID) 														AS Trans_no 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_ZFB
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
fanxiqian,frontend_wechat_order_success,"SELECT 
 		'11'																					AS Acc_type  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																				AS Cur  ,
    TOTAL_AMOUNT  																AS Amt  ,
    '11' 																					AS Lend_flag  ,
    CUSTOMER_NUMBER  															AS Customer_no  ,
    '11' 																					AS Acc_flag  ,
    '10' 																					AS Txn_flag  ,
    GOODS_DESCRIPTION  														AS Purpose  ,
    PAYER_IP    																	AS Ip_code  ,
    DEVICE_INFO    															  AS Mac_info  ,
    '12'  																				AS Bord_flag  ,
    CONCAT('WECHAT_',ID) 													AS Trans_no 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
fanxiqian,frontend_jd_order_success,"SELECT 
 		'11'																					AS Acc_type  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																				AS Cur  ,
    TOTAL_AMOUNT  																AS Amt  ,
    '11' 																					AS Lend_flag  ,
    CUSTOMER_NUMBER  															AS Customer_no  ,
    '11' 																					AS Acc_flag  ,
    '10' 																					AS Txn_flag  ,
    GOODS_DESCRIPTION  														AS Purpose  ,
    PAYER_IP    																	AS Ip_code  ,
    DEVICE_INFO    															  AS Mac_info  ,
    '12'  																				AS Bord_flag  ,
    CONCAT('JD_',ID) 		 													AS Trans_no 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_JD
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
fanxiqian,frontend_upop_order_success,"SELECT 
 		'11'																					AS Acc_type  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																				AS Cur  ,
    TOTAL_AMOUNT  																AS Amt  ,
    '11' 																					AS Lend_flag  ,
    CUSTOMER_NUMBER  															AS Customer_no  ,
    '11' 																					AS Acc_flag  ,
    '10' 																					AS Txn_flag  ,
    GOODS_DESCRIPTION  														AS Purpose  ,
    PAYER_IP    																	AS Ip_code  ,
    DEVICE_INFO    															  AS Mac_info  ,
    '12'  																				AS Bord_flag  ,
    CONCAT('UPOP_',ID) 		 												AS Trans_no 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_UPOP
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
fanxiqian,frontend_cfl_order_success,"SELECT 
 		'11'																					AS Acc_type  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																				AS Cur  ,
    TOTAL_AMOUNT  																AS Amt  ,
    '11' 																					AS Lend_flag  ,
    CUSTOMER_NUMBER  															AS Customer_no  ,
    '11' 																					AS Acc_flag  ,
    '10' 																					AS Txn_flag  ,
    GOODS_DESCRIPTION  														AS Purpose  ,
    PAYER_IP    																	AS Ip_code  ,
    DEVICE_INFO    															  AS Mac_info  ,
    '12'  																				AS Bord_flag  ,
    CONCAT('CFL_',ID) 	 													AS Trans_no 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_CFL
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
fanxiqian,frontend_qq_order_success,"SELECT 
 		'11'																					AS Acc_type  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																				AS Cur  ,
    TOTAL_AMOUNT  																AS Amt  ,
    '11' 																					AS Lend_flag  ,
    CUSTOMER_NUMBER  															AS Customer_no  ,
    '11' 																					AS Acc_flag  ,
    '10' 																					AS Txn_flag  ,
    GOODS_DESCRIPTION  														AS Purpose  ,
    PAYER_IP    																	AS Ip_code  ,
    DEVICE_INFO    															  AS Mac_info  ,
    '12'  																				AS Bord_flag  ,
    CONCAT('QQ_',ID) 															AS Trans_no 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_QQ
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'	",dzh_standby
fanxiqian,cwh_bank_card,"SELECT 
	ID               AS Card_id,
	OWNER						 AS Self_acc_name,
	IDCARD_TYPE			 AS Id_type,
	IDCARD           AS Id_no,
	BANK_NAME				 AS Bank_name
FROM
	MEMBER.TBL_CWH_BANK_CARD_INFO
WHERE
       CREATE_TIME >'2018-02-01'
AND
      CREATE_TIME <'2018-03-08'
",member_standby
fanxiqian,customer_bank_card,"SELECT
  C.CUSTOMERNUMBER AS Customer_no,
  A.BRANCHNAME     AS Part_bank_name,
  A.ACCOUNTNAME    AS Part_acc_name,
  A.BANKACTID      AS Part_acc_no
  
FROM
    MOBILEBE.ACCOUNT A
LEFT JOIN MOBILEBE.CUSTOMER C ON
			A.CUSTOMER_ID = C.ID 
LEFT JOIN MOBILEBE.SETTLEMENTINFO S ON
    	A.ID = S.BANKACCOUNT_ID
WHERE
     	A.STATUS = 'ACTIVATION'
 AND 
 			S.ID IS NOT NULL",COPY2
memberTrans,fundtrans-primary2,"select
t3.SRC_ACCOUNT_NO AS Self_acc_no,
t2.ACCOUNT_TYPE AS Acc_type,
t3.TRANS_DATE AS Date,
t3.TRANS_DATE AS Time,
t3.CURRENCY AS Cur,
t3.AMOUNT AS Amt,
'' AS Usd_amt,
'' AS Balance,
t2.DIRECTION AS Lend_flag,
'' AS Part_acc_name,
t3.TAR_ACCOUNT_NO AS Part_acc_no,
t3.BANK_NO AS Acc_flag,
t3.BANK_NAME AS Part_bank_name,
'' AS Ip_code,
t3.TRANS_TYPE AS Purpose,
'' AS Mac_info,
t2.REMARK AS Cust_mess,
'' AS Bord_flag,
t3.TRANS_FLOW_ID AS Trans_no
from fundtx.TBL_FUND_TRANS_INFO t2 join fundtx.TBL_FUND_TRANS t3 on t2.TRANS_FLOW_ID=t3.TRANS_FLOW_ID",fundtx
memberTrans,member-info,"select  
REAL_NAME_CIPHER AS Self_acc_name,
CREDENTIALS_NO_CIPHER AS Id_no from
member.TBL_MEMBER",member_standby
tbclitxn,tbclitxn-fundtrans,"select
t2.INITIATOR AS MEMBER_NO,
t3.SRC_ACCOUNT_NO AS SELF_ACC_NO,
'11' AS ACC_TYPE,
 VARCHAR_FORMAT(t3.TRANS_DATE,'YYYYMMDD')    AS DATE,
VARCHAR_FORMAT( t3.TRANS_DATE,'HHMMSS')   AS TIME,
t3.CURRENCY AS CUR,
t3.AMOUNT AS AMT,
t2.DIRECTION AS LEND_FLAG,
'' AS PART_ACC_NAME,
t3.TAR_ACCOUNT_NO AS PART_ACC_NO,

case t2.TRANS_TYPE
when 'WITHDRAW' then '11'
when 'RECHARGE' then '11'
else '12'
end AS ACC_FLAG,

t3.BANK_NAME AS PART_BANK_NAME,
'' AS IP_CODE,
t3.TRANS_TYPE AS PURPOSE,
'' AS MAC_INFO,
t2.REMARK AS CUST_MESS,
'' AS BORD_FLAG,
t3.TRANS_FLOW_ID AS TRANS_NO
from fundtx.TBL_FUND_TRANS_INFO t2 join fundtx.TBL_FUND_TRANS t3 on t2.TRANS_FLOW_ID=t3.TRANS_FLOW_ID
and t2.id < 10000",fundtx
tbclitxn,tbclitxn-member-info,"select  
MEMBER_NO AS MEMBER_NO,
REAL_NAME_CIPHER AS SELF_ACC_NAME,
CREDENTIALS_NO_CIPHER AS ID_NO from
member.TBL_MEMBER
where ca_status='VERIFIED'",member_standby
settleAccountDataTask,yp2g,"SELECT
    C.FULLNAME                    AS Self_acc_name,
    LA.accountNumber              AS Self_acc_no,
    BA.accountName                AS Bank_acc_name,
    C.CUSTOMERNUMBER              AS Join_code,
    TO_CHAR(H.TRXDATE,'YYYYMMDD') AS DATE,
    TO_CHAR(H.TRXDATE,'HH24MISS') AS TIME,
    'RMB'                         AS Cur,
    ABS(H.TRXAMOUNT)              AS Amt,
    CASE
        WHEN H.TRXAMOUNT>=0
        THEN '10'
        ELSE '11'
    END            AS Lend_flag,
    'NULL'     AS Prof_type,
    P.payerActName AS Part_acc_name,
    P.payerActId   AS Part_acc_no,
    'NULL'           AS Acc_flag,
    'NULL'           AS Tran_flag,
    'NULL'          AS Open_bank_name,
    'NULL'           AS Ip_code,
    'NULL'           AS Purpose,
    'NULL'          AS Bord_flag,
    T.requestId    AS Trade_order,
    T.externalId   AS Trans_no 
FROM
    ACCOUNTHISTORY H
LEFT JOIN
    ACCOUNT LA
ON
    H.ACCOUNT_ID=LA.ID
LEFT JOIN
    CUSTOMER C
ON
    LA.CUSTOMER_ID=C.ID
LEFT JOIN
    SETTLEMENTINFO I
ON  C.ID=I.ID
LEFT JOIN ACCOUNT BA
ON  I.BANKACCOUNT_ID=BA.ID
LEFT JOIN
    PAYMENT P
ON
    H.TRXID=P.ID
LEFT JOIN
    TRXORDER T
ON
    P.TRXORDER_ID=T.ID
WHERE
    H.TRXDATE>=char(timestamp(${START}))
AND H.TRXDATE<${STOP} WITH UR",COPY2
settleAccountDataTask,yp2gdatasourse,"SELECT
    C.FULLNAME AS Self_acc_name,
    LA.accountNumber AS Self_acc_no,
    BA.accountName AS Bank_acc_name,
    C.CUSTOMERNUMBER AS Join_code,
    TO_CHAR(H.TRXDATE,'YYYYMMDD') AS Date,
    TO_CHAR(H.TRXDATE,'HH24MISS')  AS Time,
    'RMB' AS Cur,
    ABS(H.TRXAMOUNT) AS Cur,
    CASE WHEN H.TRXAMOUNT>=0 THEN '10' ELSE '11' END AS Lend_flag,
    H.HISTORYTYPE AS Prof_type,
    P.payerActName AS Part_acc_name,
    P.payerActId  AS Part_acc_no,
    NULL AS Acc_flag,
    NULL AS Tran_flag,
    NULL AS Open_bank_name,
    NULL AS Ip_code,
    NULL AS Purpose,
    NULL AS Bord_flag,
    T.requestId AS Trade_order,
    T.externalId AS Trans_no    
FROM
    ACCOUNTHISTORY H
LEFT JOIN
    ACCOUNT LA
ON
    H.ACCOUNT_ID=LA.ID
LEFT JOIN
    CUSTOMER C
ON
    LA.CUSTOMER_ID=C.ID
LEFT JOIN
    SETTLEMENTINFO I
ON  C.ID=I.ID
LEFT JOIN ACCOUNT BA
ON  I.BANKACCOUNT_ID=BA.ID
LEFT JOIN
    PAYMENT P
ON
    H.TRXID=P.ID
LEFT JOIN
    TRXORDER T
ON
    P.TRXORDER_ID=T.ID
WHERE
    H.TRXDATE>=char(timestamp(${START}))
AND H.TRXDATE<${STOP} WITH UR",COPY2
tbNocliTxn,ncpay_success_order,"SELECT 
    CARD_ID  																	AS CARD_ID ,
    ACCOUNT_NO																AS SELF_ACC_NO ,
    '11' 																			AS ACC_TYPE  ,
    VARCHAR_FORMAT(CONFIRM_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(CONFIRM_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																		AS CUR  ,
    REAL_AMOUNT  															AS AMT  ,
    '11' 																			AS LEND_FLAG  ,
    MERCHANT_NO  															AS CUSTOMER_NO  ,
    '11' 																			AS ACC_FLAG  ,
    '10' 																			AS TXN_FLAG  ,
    PRODUCT  																	AS PURPOSE  ,
    '12'  																		AS BORD_FLAG  ,
    PAYMENT_NO 															  AS TRANS_NO 
FROM 
		NCC.TBL_NC_PAY_ORDER
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		STATE ='SUCCESS' ",INNO_STANBY
tbNocliTxn,frontend_net_success_order,"SELECT 
 		CASE
      WHEN LOCATE('B2C', PAY_INTERFACE) > 0  THEN '11'
      ELSE            														'12'
    END 																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('NET_',ID) 														AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_NET
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxn,frontend_zfb_success_order,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('ZFB_',ID) 														AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_ZFB
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxn,frontend_wechat_success_order,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('WECHAT_',ID) 													AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxn,frontend_jd_success_order,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('JD_',ID) 													AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_JD
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxn,frontend_upop_success_order,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('UPOP_',ID) 													AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_UPOP
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxn,frontend_cfl_success_order,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('CFL_',ID) 	 													AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_CFL
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxn,frontend_qq_success_order,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('QQ_',ID) 															AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_QQ
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxn,cwh_bank_card_info,"SELECT 
	ID               AS CARD_ID,
	OWNER						 AS SELF_ACC_NAME,
	IDCARD_TYPE			 AS ID_TYPE,
	IDCARD           AS ID_NO,
	BANK_NAME				 AS BANK_NAME 
FROM
	MEMBER.TBL_CWH_BANK_CARD_INFO",member_standby
tbNocliTxn,customer_bank_card_info,"SELECT
  C.CUSTOMERNUMBER AS CUSTOMER_NO,
  A.BRANCHNAME     AS PART_BANK_NAME,
  A.ACCOUNTNAME    AS PART_ACC_NAME,
  A.BANKACTID      AS PART_ACC_NO 
  
FROM
    MOBILEBE.ACCOUNT A
LEFT JOIN MOBILEBE.CUSTOMER C ON
			A.CUSTOMER_ID = C.ID 
LEFT JOIN MOBILEBE.SETTLEMENTINFO S ON
    	A.ID = S.BANKACCOUNT_ID
WHERE
     	A.STATUS = 'ACTIVATION'
 AND 
 			S.ID IS NOT NULL",COPY2
TbNocliTxnTest,TbNocliTxnTest_ncpay_order,"SELECT 
    CARD_ID  																	AS CARD_ID ,
    ACCOUNT_NO																AS SELF_ACC_NO ,
    '11' 																			AS ACC_TYPE  ,
    VARCHAR_FORMAT(CONFIRM_TIME,'YYYYMMDD')  	AS Date ,
    VARCHAR_FORMAT(CONFIRM_TIME,'HHMMSS')  		AS Time ,
    'RMB'  																		AS CUR  ,
    REAL_AMOUNT  															AS AMT  ,
    '11' 																			AS LEND_FLAG  ,
    MERCHANT_NO  															AS CUSTOMER_NO  ,
    '11' 																			AS ACC_FLAG  ,
    '10' 																			AS TXN_FLAG  ,
    PRODUCT  																	AS PURPOSE  ,
    '12'  																		AS BORD_FLAG  ,
    PAYMENT_NO 															  AS TRANS_NO 
FROM 
		NCC.TBL_NC_PAY_ORDER
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		STATE ='SUCCESS' ",INNO_STANBY
TbNocliTxnTest,TbNocliTxnTest_cwh_bankcard,"SELECT 
    ID               AS CARD_ID,
    OWNER                        AS SELF_ACC_NAME,
    IDCARD_TYPE          AS ID_TYPE,
    IDCARD           AS ID_NO,
    BANK_NAME                AS BANK_NAME
FROM
    MEMBER.TBL_CWH_BANK_CARD_INFO
WHERE
        CREATE_TIME >'2018-02-01'",member_standby
proqualityOneMinRecordPA,proqualityOneMinRecordPA_total,"SELECT COUNT(*) as TRADE_COUNT, TO_CHAR(TIMESTAMP(CREATE_DATE), 'YYYY-MM-DD HH24:MI') as HAPPEN_DATE
                   FROM
                    CS.TBL_PROCESS_TRXORDER_1804 t
                   WHERE t.CREATE_DATE>= ${START} and t.CREATE_DATE < ${STOP} AND 
                    BIZ_SYSTEM ='ACCOUNTPAY'
                   GROUP BY
                    TO_CHAR(TIMESTAMP(CREATE_DATE), 'YYYY-MM-DD HH24:MI') with ur",zxdb_standby
proqualityOneMinRecordPA,proqualityOneMinRecordPA_succ,"SELECT COUNT(*) as SUCCESS_COUNT,TO_CHAR(TIMESTAMP(CREATE_DATE), 'YYYY-MM-DD HH24:MI') as HAPPEN_DATE
                   FROM
                    CS.TBL_PROCESS_TRXORDER_1803 t
                   WHERE t.CREATE_DATE>= ${START} and t.CREATE_DATE < ${STOP} AND 
                   ORDER_STATUS = 'SUCCESS'
                    AND UPDATE_DATE - CREATE_DATE < 60
                    AND BIZ_SYSTEM ='ACCOUNTPAY'
                   GROUP BY TO_CHAR(TIMESTAMP(CREATE_DATE), 'YYYY-MM-DD HH24:MI') with ur",zxdb_standby
proqualityOneMinRecordPA,excep_proqualityOneMinRecordPA,"select TO_CHAR(t.CREATE_DATE,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT from CS.TBL_PROCESS_TRXORDER_1803 as t
where t.CREATE_DATE>= ${START} and t.CREATE_DATE < ${STOP}
group by TO_CHAR(t.CREATE_DATE,'YYYY-MM-DD HH24:MI')
with ur",zxdb_standby
proqualityRecordedAvaratePA,proqualityRecordedAvaratePA_total,"select 'RZRATE2PA' AS PRODUCT_TYPE,a.HAPPEN_DATE,a.TRADE_COUNT,b.SUCCESS_COUNT,ROUND(cast(nvl(b.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from 
                    (SELECT date(create_date) as HAPPEN_DATE,count(*) AS TRADE_COUNT FROM cs.tbl_process_trxorder_1805 WHERE create_date >=${START} AND create_date < ${STOP} AND order_status='SUCCESS' AND BIZ_SYSTEM ='ACCOUNTPAY'  GROUP BY  date(create_date)) AS a left join 
                    (SELECT date(create_date) as HAPPEN_DATE,count(*) AS SUCCESS_COUNT FROM cs.tbl_process_trxorder_1805 WHERE (update_date-create_date) < 60 AND BIZ_SYSTEM ='ACCOUNTPAY' and create_date >=${START} AND create_date <  ${STOP} AND order_status='SUCCESS' GROUP BY  date(create_date) )as b  on a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR",zxdb_standby
tbclitxn2,tbclitxn_fundtrans,"select
t2.INITIATOR AS MEMBER_NO,
t3.SRC_ACCOUNT_NO AS SELF_ACC_NO,
'11' AS ACC_TYPE,
 VARCHAR_FORMAT(t3.TRANS_DATE,'YYYYMMDD')    AS DATE,
VARCHAR_FORMAT( t3.TRANS_DATE,'HHMMSS')   AS TIME,
t3.CURRENCY AS CUR,
t3.AMOUNT AS AMT,
t2.DIRECTION AS LEND_FLAG,
'' AS PART_ACC_NAME,
t3.TAR_ACCOUNT_NO AS PART_ACC_NO,

case t2.TRANS_TYPE
when 'WITHDRAW' then '11'
when 'RECHARGE' then '11'
else '12'
end AS ACC_FLAG,

t3.BANK_NAME AS PART_BANK_NAME,
'' AS IP_CODE,
t3.TRANS_TYPE AS PURPOSE,
'' AS MAC_INFO,
t2.REMARK AS CUST_MESS,
'' AS BORD_FLAG,
t3.TRANS_FLOW_ID AS TRANS_NO
from fundtx.TBL_FUND_TRANS_INFO t2 join fundtx.TBL_FUND_TRANS t3 on t2.TRANS_FLOW_ID=t3.TRANS_FLOW_ID
AND
INITIATOR_DATE >= ${START} 
AND
INITIATOR_DATE <  ${STOP}
",fundtx
tbclitxn2,tbclitxn_member_info,"select  
MEMBER_NO AS MEMBER_NO,
REAL_NAME_CIPHER AS SELF_ACC_NAME,
CREDENTIALS_NO_CIPHER AS ID_NO from
member.TBL_MEMBER
where ca_status = 'VERIFIED'",member_standby
newcostdaily,newcostdaily,"select coalesce(char(cu.id),'null')||coalesce(char(TRXDATE),'null')||coalesce(char(SALES_PRODUCT_CODE),'null')||coalesce(char(PRODUCT_CODE),'null')||coalesce(char(d.TYPE),'null')||coalesce(char(d.trxchannelid),'null')||'newcostdaily' as IDNOUSE,cu.id as RECEIVERID,TRXDATE,year(TRXDATE)*100+month(TRXDATE) as month,'SYSTEM' as usetype,SALES_PRODUCT_CODE,PRODUCT_CODE,d.TYPE,d.trxchannelid,sum(ACCOUNTINGCOST) as NEWCOST ,
sum(coalesce(d.externalcost,0)-coalesce(d.ACCOUNTINGCOST,0)) as externalcost 
from db2inst1.jingfen_dailytrx d
left join customerinfo cu on d.CUSTOMERNUMBER=cu.CUSTOMERNUMBER
where   d.TRXDATE >= ${START} AND d.TRXDATE < ${STOP}  and d.ETLTASKID like '%accountcostjingfen%'  
group by cu.id,TRXDATE,SALES_PRODUCT_CODE,PRODUCT_CODE,d.TYPE,d.trxchannelid with ur ",reportdb
newtrxfeedaily,newtrxfeejingfen,"select coalesce(char(c.id),'null')||coalesce(char(RECEIVERID),'null')||coalesce(char(TRXDATE),'null')||coalesce(char(SALES_PRODUCT_CODE),'null')||coalesce(char(PRODUCT_CODE),'null')||coalesce(char(d.TYPE),'null')||'newtrxfeejingfen' as IDNOUSE,coalesce(c.id,RECEIVERID) as RECEIVERID,TRXDATE,year(TRXDATE)*100+month(TRXDATE) as month,'SYSTEM' as usetype,SALES_PRODUCT_CODE,PRODUCT_CODE,d.TYPE,sum(TRXFEE) as NEWTRXFEE,SUM(REFUNDFEE) AS NEWREFUNDFEE  
from db2inst1.jingfen_dailytrx d
left join db2inst1.CustomerInfo c on d.customernumber=c.customernumber
where   d.TRXDATE >= ${START} AND d.TRXDATE < ${STOP}  and (d.ETLTASKID like '%trxfeejingfen%'  or d.ETLTASKID like 'aaaa%')
group by c.id,RECEIVERID,TRXDATE,SALES_PRODUCT_CODE,PRODUCT_CODE,d.TYPE with ur ",reportdb
proqualityRecordedAvarateWC,proqualityRecordedAvarateWC_E,"select 'AP_WECHAT' AS PRODUCT_TYPE,a.HAPPEN_DATE,a.TRADE_COUNT,b.SUCCESS_COUNT,ROUND(cast(nvl(b.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS TRADE_COUNT FROM cs.tbl_process_trxorder_1805 WHERE create_date >=${START} AND create_date < ${STOP} AND order_status='SUCCESS' AND BIZ_SYSTEM ='WECHAT'  GROUP BY  date(create_date)) AS a left join
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS SUCCESS_COUNT FROM cs.tbl_process_trxorder_1805 WHERE (update_date-create_date) < 60 AND BIZ_SYSTEM ='WECHAT' and create_date >=${START} AND create_date <  ${STOP} AND order_status='SUCCESS' GROUP BY  date(create_date) )as b  on a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR",zxdb_standby
proqualityRecordedAvarateYJZF,proqualityRecordedAvarateYJZF_E,"select 'AP_YJZF' AS PRODUCT_TYPE,a.HAPPEN_DATE,a.TRADE_COUNT,b.SUCCESS_COUNT,ROUND(cast(nvl(b.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS TRADE_COUNT FROM cs.tbl_process_trxorder_1805 WHERE create_date >=${START} AND create_date < ${STOP} AND order_status='SUCCESS' AND BIZ_SYSTEM ='YJZF'  GROUP BY  date(create_date)) AS a left join
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS SUCCESS_COUNT FROM cs.tbl_process_trxorder_1805 WHERE (update_date-create_date) < 60 AND BIZ_SYSTEM ='YJZF' and create_date >=${START} AND create_date <  ${STOP} AND order_status='SUCCESS' GROUP BY  date(create_date) )as b  on a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR",zxdb_standby
proqualityRecordedAvaratePA2NET,proqualityRecordedAvaratePA2NET_E,"select 'AP_2NET' AS PRODUCT_TYPE,a.HAPPEN_DATE,a.TRADE_COUNT,b.SUCCESS_COUNT,ROUND(cast(nvl(b.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS TRADE_COUNT FROM cs.tbl_process_trxorder_1805 WHERE create_date >=${START} AND create_date < ${STOP} AND order_status='SUCCESS' AND BIZ_SYSTEM ='2GTRADE'  GROUP BY  date(create_date)) AS a left join
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS SUCCESS_COUNT FROM cs.tbl_process_trxorder_1805 WHERE (update_date-create_date) < 60 AND BIZ_SYSTEM ='2GTRADE' and create_date >=${START} AND create_date <  ${STOP} AND order_status='SUCCESS' GROUP BY  date(create_date) )as b  on a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR
",zxdb_standby
proqualityRecordedAvarateOTHER,proqualityRecordedAvarateOTHER_e,"select 'AP_OTHERS' AS PRODUCT_TYPE,a.HAPPEN_DATE,a.TRADE_COUNT,b.SUCCESS_COUNT,ROUND(cast(nvl(b.SUCCESS_COUNT,0) as double)/a.TRADE_COUNT,4) as SERVICE_SUCCESS_RATE from
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS TRADE_COUNT FROM cs.tbl_process_trxorder_1805 WHERE create_date >=${START} AND create_date < ${STOP} AND order_status='SUCCESS' AND BIZ_SYSTEM not in ('2GTRADE','ACCOUNTPAY','YJZF','WECHAT')  GROUP BY  date(create_date)) AS a left join
(SELECT date(create_date) as HAPPEN_DATE,count(*) AS SUCCESS_COUNT FROM cs.tbl_process_trxorder_1805 WHERE (update_date-create_date) < 60 AND BIZ_SYSTEM not in ('2GTRADE','ACCOUNTPAY','YJZF','WECHAT') and create_date >=${START} AND create_date <  ${STOP} AND order_status='SUCCESS' GROUP BY  date(create_date) )as b  on a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR
",zxdb_standby
RecordedProportion,RecordedProportion_E,"SELECT 'WL_RP' AS PRODUCT_TYPE,a.HAPPEN_DATE, a.TRADE_COUNT, b.SUCCESS_COUNT, ROUND(CAST(NVL(b.SUCCESS_COUNT,0) AS DOUBLE)/a.TRADE_COUNT,4) AS SERVICE_SUCCESS_RATE FROM ( SELECT DATE(CREATE_TIME) AS HAPPEN_DATE, COUNT(*) AS TRADE_COUNT FROM ACCTG.tbl_ACQUIRING_TRX_REQUEST_1802 WHERE CREATE_TIME >=${START} AND CREATE_TIME < ${STOP} AND CREDIT_STATUS='SUCCESS' GROUP BY DATE(CREATE_TIME)) AS a LEFT JOIN ( SELECT DATE(CREATE_TIME) AS HAPPEN_DATE, COUNT(*) AS SUCCESS_COUNT FROM ACCTG.tbl_ACQUIRING_TRX_REQUEST_1802 WHERE ( LAST_MODIFY_TIME-CREATE_TIME) <= 10 AND CREATE_TIME >=${START} AND CREATE_TIME < ${STOP} AND CREDIT_STATUS='SUCCESS' GROUP BY DATE(CREATE_TIME))AS b ON a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR",billdb_standby
PayMoneyReception,PayMoneyReception_E,"SELECT 'WL_PMR' AS PRODUCT_TYPE, a.HAPPEN_DATE, a.TRADE_COUNT, b.SUCCESS_COUNT, ROUND(CAST(NVL(b.SUCCESS_COUNT,0) AS DOUBLE)/a.TRADE_COUNT,4) AS SERVICE_SUCCESS_RATE FROM ( SELECT DATE(CREATE_TIME) AS HAPPEN_DATE, COUNT(*) AS TRADE_COUNT FROM ACCTG.tbl_ACC_REQUEST_1802 WHERE CREATE_TIME >=${START} AND CREATE_TIME < ${STOP} AND ACC_TYPE ='REMIT' AND STATUS='SUCCESS' GROUP BY DATE(CREATE_TIME)) AS a LEFT JOIN ( SELECT DATE(CREATE_TIME) AS HAPPEN_DATE, COUNT(*) AS SUCCESS_COUNT FROM ACCTG.tbl_ACC_REQUEST_1802 WHERE LAST_MODIFY_TIME-CREATE_TIME <= 1 AND CREATE_TIME >=${START} AND CREATE_TIME < ${STOP} AND ACC_TYPE ='REMIT' AND STATUS='SUCCESS' GROUP BY DATE(CREATE_TIME))AS b ON a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR",billdb_standby
DeductSuccRate,DeductSuccRate_E,"SELECT 'WL_SUCCRATE' AS PRODUCT_TYPE,a.HAPPEN_DATE, a.TRADE_COUNT, b.SUCCESS_COUNT, ROUND(CAST(NVL(b.SUCCESS_COUNT,0) AS DOUBLE)/a.TRADE_COUNT,4) AS SERVICE_SUCCESS_RATE FROM ( SELECT DATE(CREATE_TIME) AS HAPPEN_DATE, COUNT(*) AS TRADE_COUNT FROM ACCTG.tbl_ACC_REQUEST_DETAIL_1804 WHERE CREATE_TIME >=${START} AND CREATE_TIME < ${STOP} AND ACC_DIRECTION ='DEBIT' AND ( REMARK NOT LIKE 'è´¦æ_ä½_ä¸_¶³%' OR REMARK IS NULL) GROUP BY DATE(CREATE_TIME)) AS a LEFT JOIN ( SELECT DATE(CREATE_TIME) AS HAPPEN_DATE, COUNT(*) AS SUCCESS_COUNT FROM ACCTG.tbl_ACC_REQUEST_DETAIL_1804 WHERE CREATE_TIME >=${START} AND CREATE_TIME < ${STOP} AND ACC_DIRECTION ='DEBIT' AND STATUS='SUCCESS' GROUP BY DATE(CREATE_TIME))AS b ON a.HAPPEN_DATE=b.HAPPEN_DATE WITH UR",billdb_standby
WeeklyReportNewMerchantsgorup,WeeklyReportNewMerchantsgorupe,"SELECT
HANGYEYEJISHUXING || YIJIHANGYE || ERJIHANGYE AS IDNOUSE,
DATE(${START})- 6 DAY AS PERIOD,
    HANGYEYEJISHUXING,
    YIJIHANGYE,
    ERJIHANGYE,
    COUNT(1) AS AMOUNT
FROM
    TBL_ZZYXZB_MERCHANTS T
WHERE
    PERIOD = DATE(${START}) - 6 day 
GROUP BY
    HANGYEYEJISHUXING,
    YIJIHANGYE,
    ERJIHANGYE",reportdb_yjkh
agentfrdata1,agentfrdata1e,"SELECT  D.ID,D.RECEIVERID,D.TRXAMOUNT,D.TRXCOUNT ,D.REFUNDAMOUNT,D.REFUNDCOUNT ,D.TRXDATE ,D.TRXCHANNELID ,D.TRXFEE as TRXTARGETFEE,D.FRPCOST,B.NAME AS BANKCODE,D.SALES_PRODUCT_CODE,SP.PRODUCTNAME  FROM TBL_AGENT_CUSTOMER AC,DAILYTRXSTAT D LEFT JOIN PRODUCTCODE SP ON D.SALES_PRODUCT_CODE=SP.PRODUCTCODE  LEFT JOIN TRXSTATBIZTYPE B ON D.BIZTYPEID = B.ID  WHERE AC.CUSTOMER_ID=d.RECEIVERID AND D.TYPE NOT IN('COMMISSION', 'COMMISSION_HK', 'POSSHARECOST', 'COMMISSION_RJT', 'COMMISSION_RJTFUND') AND D.TRXDATE >= TRUNC(DATE(${START})-1 MONTHS,'MM') and TRXDATE  <= (TRUNC(DATE(${START}),'MM') - 1 days) AND SALES_PRODUCT_CODE in ('3011001009001A','3011001009001B') AND PRODUCT_CODE='3011001002001' ",reportdb_standby
tbNocliTxnWwx,ncpay_success_orderwwx,"SELECT 
    CARD_ID  																	AS CARD_ID ,
    ACCOUNT_NO																AS SELF_ACC_NO ,
    '11' 																			AS ACC_TYPE  ,
    VARCHAR_FORMAT(CONFIRM_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(CONFIRM_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																		AS CUR  ,
    REAL_AMOUNT  															AS AMT  ,
    '11' 																			AS LEND_FLAG  ,
    MERCHANT_NO  															AS CUSTOMER_NO  ,
    '11' 																			AS ACC_FLAG  ,
    '10' 																			AS TXN_FLAG  ,
    PRODUCT  																	AS PURPOSE  ,
    '12'  																		AS BORD_FLAG  ,
    PAYMENT_NO 															  AS TRANS_NO 
FROM 
		NCC.TBL_NC_PAY_ORDER
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		STATE ='SUCCESS' ",INNO_STANBY
tbNocliTxnWwx,frontend_net_success_orderwwx,"SELECT 
 		CASE
      WHEN LOCATE('B2C', PAY_INTERFACE) > 0  THEN '11'
      ELSE            														'12'
    END 																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('NET_',ID) 														AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_NET
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxnWwx,frontend_zfb_success_orderwwx,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('ZFB_',ID) 														AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_ZFB
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxnWwx,frontend_wechat_success_orderwwx,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('WECHAT_',ID) 													AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxnWwx,frontend_jd_success_orderwwx,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('JD_',ID) 													AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_JD
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxnWwx,frontend_upop_success_orderwwx,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('UPOP_',ID) 													AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_UPOP
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxnWwx,frontend_cfl_success_orderwwx,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('CFL_',ID) 	 													AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_CFL
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxnWwx,frontend_qq_success_orderwwx,"SELECT 
 		'11'																					AS ACC_TYPE  ,     																			    
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'YYYYMMDD')  	AS DATE ,
    VARCHAR_FORMAT(PAY_SUCCESS_TIME,'HHMMSS')  		AS TIME ,
    'RMB'  																				AS CUR  ,
    TOTAL_AMOUNT  																AS AMT  ,
    '11' 																					AS LEND_FLAG  ,
    CUSTOMER_NUMBER  															AS CUSTOMER_NO  ,
    '11' 																					AS ACC_FLAG  ,
    '10' 																					AS TXN_FLAG  ,
    GOODS_DESCRIPTION  														AS PURPOSE  ,
    PAYER_IP    																	AS IP_CODE  ,
    DEVICE_INFO    																AS MAC_INFO  ,
    '12'  																				AS BORD_FLAG  ,
    CONCAT('QQ_',ID) 															AS TRANS_NO 
FROM 
		FRONTEND.TBL_FRONTEND_PAY_ORDER_QQ
WHERE
		CREATE_TIME >= ${START} 
AND
		CREATE_TIME <  ${STOP}
AND
		PAY_STATUS ='SUCCESS' 
AND
		REFUND_STATUS = 'NONE'",dzh_standby
tbNocliTxnWwx,cwh_bank_card_infowwx,"SELECT 
	ID               AS CARD_ID,
	OWNER						 AS SELF_ACC_NAME,
	IDCARD_TYPE			 AS ID_TYPE,
	IDCARD           AS ID_NO,
	BANK_NAME				 AS BANK_NAME 
FROM
	MEMBER.TBL_CWH_BANK_CARD_INFO",member_standby
tbNocliTxnWwx,customer_bank_card_infowwx,"SELECT
  C.CUSTOMERNUMBER AS CUSTOMER_NO,
  A.BRANCHNAME     AS PART_BANK_NAME,
  A.ACCOUNTNAME    AS PART_ACC_NAME,
  A.BANKACTID      AS PART_ACC_NO 
  
FROM
    MOBILEBE.ACCOUNT A
LEFT JOIN MOBILEBE.CUSTOMER C ON
			A.CUSTOMER_ID = C.ID 
LEFT JOIN MOBILEBE.SETTLEMENTINFO S ON
    	A.ID = S.BANKACCOUNT_ID
WHERE
     	A.STATUS = 'ACTIVATION'
 AND 
 			S.ID IS NOT NULL",COPY2
checktrxratebybank,checktrxratebybanke,"SELECT
    tmp.TRXDATE || COALESCE(tmp.BANK_CODE, '-') || COALESCE(tmp.BANK_NAME, '-') || COALESCE(tmp.CUSTOMERNUMBER, '-') || COALESCE(tmp.PRODUCTNAME, '-') || COALESCE(tmp.PRODUCTLINE, '-') AS IDNOUSE,
    tmp.TRXDATE                AS DATA_PERIOD,
    tmp.BANK_CODE                AS BANK_CODE,
    tmp.BANK_NAME                AS BANK_NAME,
    tmp.CUSTOMERNUMBER AS MERCHANT_NUMBER,
    tmp.PRODUCTLINE             AS INDUSTRY,
    tmp.PRODUCTNAME           AS BASIC_PRODUCT,
    tmp.SIGNEDNAME               AS SIGNED_NAME,
    SUM(tmp.trxprofit)                AS TRX_PROFIT,
    SUM(tmp.trxfee)                AS TRX_FEE,
    CASE
        WHEN SUM(tmp.trxprofit) != 0
        AND SUM(tmp.trxfee)  != 0
        THEN CAST(SUM(tmp.trxprofit) AS DECIMAL(18,4)) / SUM(tmp.trxfee) 
        ELSE 0
    END AS PROFIT_RATE
FROM
    (
        SELECT
            t.TRXDATE,
            t.BANK_CODE,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            t.BANK_NAME,
            t.PRODUCTLINE,
            t.PRODUCTNAME,
            (SUM(t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*COALESCE
            (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE(t.SHARESCALE,1)*
            COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)))
            AS trxprofit,
            (SUM(
                CASE
                    WHEN t.BIZTYPEID IN (29,129)
                    THEN (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                    ELSE (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                END)) AS trxfee
        FROM
            (
                SELECT
                    DA.TRXDATE,
                    DA.BANK_CODE,
                    cbi.name AS BANK_NAME,
                    DA.BIZTYPEID,
                    DA.TRXFEE,
                    E2C.SHARESCALE,
                    c2a.PERCENT,
                    DA.REFUNDFEE,
                    DA.ACCOUNTINGCOST,
                    DA.REFUNDFRPCOST,
                    RECEIVER.CUSTOMERNUMBER,
                    RECEIVER.SIGNEDNAME,
                    RECEIVER.PRODUCTLINE,
                    P.PRODUCTNAME
                FROM
                    DB2INST1.DAILYTRXSTAT AS DA
                LEFT JOIN
                    DB2INST1.CUSTOMERINFO AS RECEIVER
                ON
                    1=1
                AND DA.RECEIVERID=RECEIVER.ID
                LEFT JOIN
                    DB2INST1.CUSTOMERRELATIONSHIP AS E2C
                ON
                    1=1
                AND RECEIVER.ID=E2C.CUSTOMERID
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS P
                ON
                    1=1
                AND DA.PRODUCT_CODE=P.PRODUCTCODE
                AND P.PRODUCTTYPE=2
                LEFT JOIN
                    DB2INST1.customer2achievement AS c2a
                ON
                    1=1
                AND RECEIVER.customernumber=c2a.customer_number
                LEFT JOIN
                    DB2INST1.cfg_bank_info cbi
                ON
                    DA.BANK_CODE=cbi.CODE
                WHERE
                    RECEIVER.PRODUCTLINE in ('_µä¿¡è¡__çº', 'ä¿__è¡__çº', '__äº___')
AND DA.TRXDATE = ${START}
                AND P.PRODUCTNAME in ('___è´¦æ_', '_±å___', 'Cç½__ä»_', 'ä¼__è´¦æ_', 'EPOS', '_±å___', 'ä¸__ä»', 'POS__', 'ä¸ººç½____ï¼_2Cï¼','ä¼__ç½____ï¼_2Bï¼')
                AND DA.RECEIVERID not in (select distinct RECEIVERID from DAILYTRXSTAT where TYPE='POSTPAID')) t
        GROUP BY
            t.TRXDATE,
            t.BANK_CODE,
            t.CUSTOMERNUMBER,
	    t.SIGNEDNAME,
            t.BANK_NAME,
            t.PRODUCTLINE,
            t.PRODUCTNAME ) tmp
GROUP BY
    tmp.TRXDATE,
    tmp.BANK_CODE,
    tmp.BANK_NAME,
    tmp.CUSTOMERNUMBER,
    tmp.PRODUCTLINE,
    tmp.PRODUCTNAME,
    tmp.SIGNEDNAME",reportdb_read
checktrxratebycustomernumber,checktrxratebycustomernumber,"SELECT
COALESCE(tmp.TRXDATE, '-') || COALESCE(tmp.PRODUCTLINE, '-') || COALESCE(tmp.PRODUCTNAME, '-') || COALESCE(tmp.CUSTOMERNUMBER, '-') || COALESCE(tmp.SIGNEDNAME, '-') AS IDNOUSE,
        tmp.TRXDATE                                         AS DATA_PERIOD,
    tmp.CUSTOMERNUMBER                                  AS MERCHANT_NUMBER,
    tmp.SIGNEDNAME                                      AS SIGNED_NAME,
    tmp.PRODUCTLINE                                             AS INDUSTRY,
    tmp.PRODUCTNAME                                              AS BASIC_PRODUCT,
    SUM(tmp.trxprofit)                                       AS TRX_PROFIT,
    SUM(tmp.trxfee)                AS TRX_FEE,
    CASE
        WHEN SUM(tmp.trxprofit) != 0
        AND SUM(tmp.trxfee)  != 0
        THEN CAST(SUM(tmp.trxprofit) AS DECIMAL(18,4)) / SUM(tmp.trxfee) 
        ELSE 0
    END AS PROFIT_RATE
FROM
    (
        SELECT
            t.TRXDATE,
            t.PRODUCTLINE,
            t.PRODUCTNAME,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            (SUM(t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*COALESCE
            (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE(t.SHARESCALE,1)*
            COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)))
            AS trxprofit,
            (SUM(
                CASE
                    WHEN t.BIZTYPEID IN (29,129)
                    THEN (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                    ELSE (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                END)) AS trxfee
        FROM
            (
                SELECT
                    DA.TRXDATE,
                    DA.BIZTYPEID,
                    DA.TRXFEE,
                    E2C.SHARESCALE,
                    c2a.PERCENT,
                    DA.REFUNDFEE,
                    DA.ACCOUNTINGCOST,
                    DA.REFUNDFRPCOST,
                    RECEIVER.CUSTOMERNUMBER,
                    RECEIVER.SIGNEDNAME,
                    RECEIVER.PRODUCTLINE,
                    P.PRODUCTNAME
                FROM
                    DB2INST1.DAILYTRXSTAT AS DA
                LEFT JOIN
                    DB2INST1.CUSTOMERINFO AS RECEIVER
                ON
                    1=1
                AND DA.RECEIVERID=RECEIVER.ID
                LEFT JOIN
                    DB2INST1.CUSTOMERRELATIONSHIP AS E2C
                ON
                    1=1
                AND RECEIVER.ID=E2C.CUSTOMERID
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS P
                ON
                    1=1
                AND DA.PRODUCT_CODE=P.PRODUCTCODE
                AND P.PRODUCTTYPE=2
                LEFT JOIN
                    DB2INST1.customer2achievement AS c2a
                ON
                    1=1
                AND RECEIVER.customernumber=c2a.customer_number
                WHERE
                    RECEIVER.PRODUCTLINE in ('_µä¿¡è¡__çº', 'ä¿__è¡__çº', '__äº___')
                AND P.PRODUCTNAME in ('___è´¦æ_', '_±å___', 'Cç½__ä»_', 'ä¼__è´¦æ_', 'EPOS', '_±å___', 'ä¸__ä»', 'POS__', 'ä¸ººç½____ï¼_2Cï¼','ä¼__ç½____ï¼_2Bï¼')
                AND DA.TRXDATE = ${START}) t
        GROUP BY
            t.TRXDATE,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            t.PRODUCTLINE,
            t.PRODUCTNAME) tmp

GROUP BY
           tmp.TRXDATE,
    tmp.CUSTOMERNUMBER,
    tmp.SIGNEDNAME,
    tmp.PRODUCTLINE,
    tmp.PRODUCTNAME",reportdb_read
checktrxratebycustomernumber,checktrxratebycustomernumbere,"SELECT
COALESCE(tmp.TRXDATE, '-') || COALESCE(tmp.PRODUCTLINE, '-') || COALESCE(tmp.PRODUCTNAME, '-') || COALESCE(tmp.CUSTOMERNUMBER, '-') || COALESCE(tmp.SIGNEDNAME, '-') AS IDNOUSE,
        tmp.TRXDATE                                         AS DATA_PERIOD,
    tmp.CUSTOMERNUMBER                                  AS MERCHANT_NUMBER,
    tmp.SIGNEDNAME                                      AS SIGNED_NAME,
    tmp.PRODUCTLINE                                             AS INDUSTRY,
    tmp.PRODUCTNAME                                              AS BASIC_PRODUCT,
    SUM(tmp.trxprofit)                                       AS TRX_PROFIT,
    SUM(tmp.trxfee)                AS TRX_FEE,
    CASE
        WHEN SUM(tmp.trxprofit) != 0
        AND SUM(tmp.trxfee)  != 0
        THEN CAST(SUM(tmp.trxprofit) AS DECIMAL(18,4)) / SUM(tmp.trxfee) 
        ELSE 0
    END AS PROFIT_RATE
FROM
    (
        SELECT
            t.TRXDATE,
            t.PRODUCTLINE,
            t.PRODUCTNAME,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            t.JIAOYILEIXING,
            (SUM(t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*COALESCE
            (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE(t.SHARESCALE,1)*
            COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)))
            AS trxprofit,
            (SUM(
                CASE
                    WHEN t.BIZTYPEID IN (29,129)
                    THEN (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.ACCOUNTINGCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1)+t.REFUNDFRPCOST*COALESCE
                        (t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                    ELSE (t.TRXFEE*COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1)-t.REFUNDFEE*
                        COALESCE(t.SHARESCALE,1)*COALESCE(t.PERCENT,1))
                END)) AS trxfee
        FROM
            (
                SELECT
                    DA.TRXDATE,
                    DA.BIZTYPEID,
                    DA.TRXFEE,
                    E2C.SHARESCALE,
                    c2a.PERCENT,
                    DA.REFUNDFEE,
                    DA.ACCOUNTINGCOST,
                    DA.REFUNDFRPCOST,
                    RECEIVER.CUSTOMERNUMBER,
                    RECEIVER.SIGNEDNAME,
                    RECEIVER.PRODUCTLINE,
                    P.PRODUCTNAME,
TST.NAME AS JIAOYILEIXING
                FROM
                    DB2INST1.DAILYTRXSTAT AS DA
                LEFT JOIN
                    DB2INST1.CUSTOMERINFO AS RECEIVER
                ON
                    1=1
                AND DA.RECEIVERID=RECEIVER.ID
                LEFT JOIN
                    DB2INST1.CUSTOMERRELATIONSHIP AS E2C
                ON
                    1=1
                AND RECEIVER.ID=E2C.CUSTOMERID
                LEFT JOIN
                    DB2INST1.PRODUCTCODE AS P
                ON
                    1=1
                AND DA.PRODUCT_CODE=P.PRODUCTCODE
                AND P.PRODUCTTYPE=2
                LEFT JOIN
                    DB2INST1.customer2achievement AS c2a
                ON
                    1=1
                AND RECEIVER.customernumber=c2a.customer_number
                left join DB2INST1.TRXSTATTRXTYPE TST 
                on 1=1 and DA.TYPE=TST.ID
                WHERE
                    RECEIVER.PRODUCTLINE in ('_µä¿¡è¡__çº', 'ä¿__è¡__çº', '__äº___')
                AND P.PRODUCTNAME in ('___è´¦æ_', '_±å___', 'Cç½__ä»_', 'ä¼__è´¦æ_', 'EPOS', '_±å___', 'ä¸__ä»', 'POS__', 'ä¸ººç½____ï¼_2Cï¼','ä¼__ç½____ï¼_2Bï¼')
                AND DA.TRXDATE = ${START}) t
        GROUP BY
            t.TRXDATE,
            t.CUSTOMERNUMBER,
            t.SIGNEDNAME,
            t.PRODUCTLINE,
            t.PRODUCTNAME,
            t.JIAOYILEIXING) tmp

GROUP BY
           tmp.TRXDATE,
    tmp.CUSTOMERNUMBER,
    tmp.SIGNEDNAME,
    tmp.PRODUCTLINE,
    tmp.PRODUCTNAME",reportdb_read
lastfiveweekprofitcompare,lastfiveweekprofitcomparee,"select
t.PRODUCTLINE AS  PRODUCT_LINE,
t.PRODUCTLINE || CURRENT DATE AS PRODUCT_LINE_KEY,
sum(t.trxamount) AS CURR_TRXAMOUNT,
sum(t.trxprofit) AS CURR_PROFIT,
CURRENT_DATE AS CREATE_DATE
from (
select
  CASE WHEN C.PRODUCTLINE IS NOT NULL THEN C.PRODUCTLINE 
  WHEN SPC.PRODUCTNAME IN ('_¶æå®', '_¥å____') THEN '_°é__ä¸_º¿__º¿ä¸' 
  WHEN SPC.PRODUCTNAME IN ('____') THEN '_°é__ä¸_º¿____' 
  WHEN SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') AND (PP.ACCOUNTCLASS IN ('ç§»å_', 'çº¿ä_') OR PP.ACCOUNTCLASS IS NULL) THEN '_£æ_ä¸__'
  WHEN SPC.PRODUCTNAME NOT IN ('_¶æå®', '_¥å____', '____') AND PP.ACCOUNTCLASS = 'çº¿ä_' THEN '_°é__ä¸_º¿__º¿ä¸' 
  ELSE null END AS PRODUCTLINE,
  case when C.SIGNEDNAME = '__º¬_£è_¶å_ç§_______' then sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1))*0.0052 - sum(ACCOUNTINGCOST) 
  when SPC.PRODUCTNAME in ('_¶æå®','_¥å____','_________') then sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1))*0.6 
  else sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) end AS trxprofit,
  sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1)) as trxamount
  from DB2INST1.PUBLISHEDDAILYTRX AS P
  left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
  left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
  left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
  left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
  left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
  left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department' 
  left join DB2INST1.TRXSTATTRXTYPE AS TRXS on 1=1 and P.TRXTYPEID=TRXS.ID 
  where 
        P.TRXDATE between current date -7 day and current date -1 day
  and e.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
  and (C.PRODUCTLINE not in ('ä¸_å¾ä¸_º¿','ä¸_å¾__','çº¿ä_V-') or C.PRODUCTLINE is null)
  AND (PP.ACCOUNTCLASS is null OR PP.ACCOUNTCLASS != '___è¡__')
  and ((C.CUSTOMERNUMBER != '10000460331') or (TRXS.NAME != 'OPè°_´¦'))
  AND  (C.PRODUCTLINE IN ('_°é__ä¸_º¿__º¿ä¸','_°é__ä¸_º¿____','äº__è¡__çº','_£æ_ä¸__','è¡__ä¸___²èä¸_º¿','æ¶__è¡__çº') or C.PRODUCTLINE is null)
   group by C.PRODUCTLINE,C.SIGNEDNAME,SPC.PRODUCTNAME,PP.ACCOUNTCLASS
  ) t 
  group by t.PRODUCTLINE",reportdb_yjkh
branchprofitytdpercentrank,branchprofitytdpercentranke,"select row_number() over (order by r.YTD_REAL_PERCENT desc) AS RANK,
        r.AREA AS AREA,
        r.BRANCH AS BRANCH,
        r.his_profit AS YTD_PROFIT,
        r.TOTAL_BUDGET AS TOTAL_BUDGET,
        r.YTD_BUDGET AS YTD_BUDGET,
        r.YTD_PROFIT_PERCENT AS YTD_PROFIT_PERCENT,
        r.YTD_BUDGET_PERCENT AS YTD_BUDGET_PERCENT,
        r.YTD_REAL_PERCENT AS YTD_REAL_PERCENT,
        r.BRANCH_YTD_KEY AS BRANCH_KEY
  from( 
    select 
    t1.DAQU AS AREA,
        t1.yejishuxing AS BRANCH,
        t1.his_profit AS his_profit,
        t1.BUDGET_AMOUNT AS TOTAL_BUDGET,
        t1.YTD_BUDGET AS YTD_BUDGET,
        100*COALESCE(t1.his_profit/t1.BUDGET_AMOUNT,0) AS YTD_PROFIT_PERCENT,
        100*COALESCE(t1.YTD_BUDGET/t1.BUDGET_AMOUNT,0) AS YTD_BUDGET_PERCENT,
        100*COALESCE(t1.his_profit/t1.YTD_BUDGET,0) AS YTD_REAL_PERCENT,
        t1.yejishuxing||'YTD'||CURRENT DATE AS BRANCH_YTD_KEY 
        from (
    select 
    t.yejishuxing,
    case when t.yejishuxing in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______') then '_¼å_' when t.yejishuxing in ('å±±ä_____','æµ______','æ±______') then '___' when t.yejishuxing in ('ç¦_»º____','å¹¿ä_____') then 'é¾__' else t.yejishuxing end as DAQU,
    sum(t.trxprofit) as his_profit,
    max (budget.BUDGET_AMOUNT) as BUDGET_AMOUNT,
    cast(max(budget.BUDGET_AMOUNT)*0.4*(days(CURRENT DATE -1 day)-days('2018-01-01') + 1)/181 as decimal(18,4)) AS YTD_BUDGET
    from(
select  
        case 
        when ex.name in ('ä¸_µ·____','_______','æ±______','å±±ä_____','æµ______','ç¦_»º____','å¹¿ä_____') then ex.name 
        when ex.name in ('__¥¿____','å¤©æ´¥____','__º¬äº____') then '__º¬äº____' 
        when (ex.name='__º¬____' and P.SALESNAME in ('èµµæ_','å¼__-3','__','_¨ç__','å­_»¤é¡','å½_','é©_','èµµé_','_·ç_å¥','_°æ_','___','___-2','_¨æ__')) then '__º¬äº____' 
        else '__º¬ä¸____' end as yejishuxing,
        case when C.SIGNEDNAME = '__º¬_£è_¶å_ç§_______' then sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1))*0.0052 - sum(ACCOUNTINGCOST) 
        when SPC.PRODUCTNAME in ('_¶æå®','_¥å____','_________') then sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1))*0.6 
        else sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) end AS trxprofit
       FROM DB2INST1.PUBLISHEDDAILYTRX AS P
       left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
       left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
       left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
       left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
       left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
       left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
       left join DB2INST1.EXISTENCE AS ex on 1=1 and P.YEJISHUXING=ex.ID and ex.CLASSTYPE='Department' 
       left join DB2INST1.TRXSTATTRXTYPE AS TRXS on 1=1 and P.TRXTYPEID=TRXS.ID  
       where 
        P.TRXDATE BETWEEN '2018-05-01' AND  '2018-05-17'
        and (case when PP.ACCOUNTCLASS is null then 'çº¿ä_' else PP.ACCOUNTCLASS end) not in('___è¡__')
        and ex.NAME in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
        and (C.PRODUCTLINE not in ('ä¸_å¾ä¸_º¿','ä¸_å¾__','çº¿ä_V-') or C.PRODUCTLINE is null)
        and ((C.CUSTOMERNUMBER != '10000460331') or (TRXS.NAME != 'OPè°_´¦'))
        group by ex.NAME,P.SALESNAME,C.SIGNEDNAME,SPC.PRODUCTNAME

        UNION ALL 

 select
 coalesce(ex.NAME,ex1.name) as yejishuxing,
 sum(coalesce(STAT.NEWINCOME,0)*coalesce(c2a.PERCENT,1)-coalesce(STAT.NEWCOST,0)*coalesce(c2a.PERCENT,1)) AS trxprofit
 from DB2INST1.PUBLISHEDMONTHLYTRXSTAT AS STAT
 left join DB2INST1.TIMELATITUDE AS TIMELATITUDE on 1=1 and STAT.TIMELATITUDEID=TIMELATITUDE.ID 
 left join DB2INST1.TRXSTATCUSTOMERAREA AS AREA on 1=1 and STAT.AREAID=AREA.ID 
 left join DB2INST1.TRXSTATBIZTYPE AS BIZTYPE on 1=1 and STAT.BIZTYPEID=BIZTYPE.ID 
 left join DB2INST1.EMPLOYEEINFO AS EMPLOYEE on 1=1 and STAT.SALEID=EMPLOYEE.ID 
 left join DB2INST1.TRXSTATTRXTYPE AS TRXTYPE on 1=1 and STAT.TRXTYPEID=TRXTYPE.ID 
 left join DB2INST1.CUSTOMERINFO AS CUSTOMER on 1=1 and STAT.CUSTOMERID=CUSTOMER.ID 
 left join DB2INST1.PRODUCTGROUPTYPE AS PRODUCTGROUPTYPE on 1=1 and STAT.PRODUCTGROUP=PRODUCTGROUPTYPE.ID 
 left join DB2INST1.TRXSTATCUSTOMERAREA AS BRA on 1=1 and STAT.BRANCHCOMPANY=BRA.AREAID 
 left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS TB on 1=1 and STAT.BUSINESSCATID=TB.ID 
 left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS TBC on 1=1 and CUSTOMER.BUSSINESSCATID=TBC.ID 
 left join DB2INST1.TRXSTATBIZTYPE_PROFILE AS tp on 1=1 and STAT.BIZTYPEID=tp.BIZTYPEID 
 left join DB2INST1.TRXSTATACCMARK AS acc on 1=1 and CUSTOMER.ACCMARK=acc.CODE 
 left join DB2INST1.PRODUCTCODE AS P on 1=1 and STAT.PRODUCT_CODE=P.PRODUCTCODE and P.PRODUCTTYPE=2 
 left join DB2INST1.PRODUCTCODE AS P1 on 1=1 and STAT.SALES_PRODUCT_CODE=P1.PRODUCTCODE and P1.PRODUCTTYPE=1 
 left join DB2INST1.EMPLOYEEINFO AS EMPLOYEE1 on 1=1 and EMPLOYEE.SUPERIORID=EMPLOYEE1.ID 
 left join DB2INST1.productcode_profile AS PP on 1=1 and STAT.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE and STAT.PRODUCT_CODE=PP.PRODUCT_CODE 
 left join DB2INST1.customer2achievement AS c2a on 1=1 and CUSTOMER.customernumber=c2a.customer_number 
 left join DB2INST1.EXISTENCE AS ex on 1=1 and c2a.ACHIEVEMENT_ID=ex.ID and ex.CLASSTYPE='Department' 
 left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS tsb on 1=1 and CUSTOMER.SUBBUSINESSCAT=tsb.CODE 
 left join DB2INST1.PRODUCTCODE2PRODUCTGROUP AS p2pg on 1=1 and STAT.PRODUCT_CODE=p2pg.PRODUCT_CODE and STAT.SALES_PRODUCT_CODE=p2pg.SALES_PRODUCT_CODE 
 left join DB2INST1.EMPLOYEEYEJISHUXING_201601_201607 AS e on 1=1 and STAT.SALEID=e.SALESID 
 left join DB2INST1.EXISTENCE AS ex1  on 1=1 and e.YEJISHUXING=ex1   .id and ex1.CLASSTYPE='Department' 
 left join DB2INST1.CUSTOMERINFO AS PAYER on 1=1 and STAT.PAYERID=PAYER.ID 
 where 1=1
 and STAT.MONTH>='201801'
 and coalesce(ex.NAME,ex1.name) in ('__º¬ä¸____','__º¬äº____','__º¬____','ä¸_µ·____','å±±è¥¿____','æ²³å_____','__¥¿____','å¤©æ´¥____','_______','å±±ä_____','æµ______','æ±______','ç¦_»º____','å¹¿ä_____')
 and (CUSTOMER.PRODUCTLINE not in ('ä¸_å¾__') or CUSTOMER.PRODUCTLINE is null)
 group by coalesce(ex.NAME,ex1.name)
    ) t 
    left join yjkh.tbl_budget_info budget on 1=1 and t.yejishuxing = budget.DEP_NAME
        where budget.YEAR='2018'
        group by t.yejishuxing
        ) t1
        )r",reportdb_yjkh
remitcollectall,remitcollectalle,"SELECT 
	req.REMIT_REQUEST_NO || pro.REMIT_BATCH_NO || req.amount AS UQ_INDEX,
	req.CUSTOMER_NO AS customer_no,
	req.CUSTOMER_NAME AS customer_name,
	req.REMIT_REQUEST_NO AS remit_request_no,
	pro.id AS process_id,
	pro.REMIT_BATCH_NO AS remit_batch_no,
	req.BANK_NAME AS bank_name,
	req.STATUS AS remit_status,
    req.TRADE_INITIATOR AS TRADE_INITIATOR,
    cha.REMIT_CHANNEL_NAME AS remit_channel_name,
    req.AMOUNT AS amount,
    CASE WHEN (req.IS_URGENT ='1' AND req.IS_AUTO_REMIT = '1' AND (req.REMIT_TYPE = '2' or  req.REMIT_TYPE is null)) THEN 'realtime'
	 WHEN (req.IS_URGENT = '1' and req.IS_AUTO_REMIT = '1' AND req.REMIT_TYPE = '3')
	       OR (req.IS_URGENT = '1' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null)
	       OR (req.IS_URGENT = '0' AND req.IS_AUTO_REMIT = '0' AND req.REMIT_TYPE IS null) THEN 'normal'
	 WHEN req.REMIT_TYPE = '1' THEN 'seconds'
	 ELSE 'other' END AS remit_type,
    req.CREATE_DATE AS create_time,
    TO_CHAR(req.remit_appointment_date, 'YYYY-MM-DD HH24:Mi:SS') atime,
    TO_CHAR(bat.CREATE_DATE, 'YYYY-MM-DD HH24:Mi:SS') ptime,
    TO_CHAR(bat.ACCEPT_DATE, 'YYYY-MM-DD HH24:Mi:SS') btime,
    TO_CHAR(req.PROCESS_DATE, 'YYYY-MM-DD HH24:Mi:SS') ztime,
    timestampdiff(4, CHAR(DECODE(req.process_date,NULL,CURRENT TIMESTAMP, req.process_date)
        - DECODE(req.remit_appointment_date,NULL,req.create_date, req.remit_appointment_date))) alltime,
    timestampdiff(4, CHAR(DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE)
            - DECODE(req.remit_appointment_date,NULL,req.create_date, req.remit_appointment_date))) protime,
    timestampdiff(4, CHAR(DECODE(bat.ACCEPT_DATE,NULL,CURRENT TIMESTAMP, bat.ACCEPT_DATE)
            - DECODE(bat.CREATE_DATE,NULL,CURRENT TIMESTAMP, bat.CREATE_DATE))) battime,
    timestampdiff(4, CHAR(DECODE(req.PROCESS_DATE,NULL,CURRENT TIMESTAMP, req.PROCESS_DATE)
        - DECODE(bat.ACCEPT_DATE,NULL,CURRENT TIMESTAMP, bat.ACCEPT_DATE))) chatime
FROM remit.tbl_remit_request req
LEFT JOIN remit.tbl_remit_process pro ON req.remit_request_no=pro.remit_request_no
LEFT JOIN remit.tbl_remit_batch bat ON pro.remit_batch_no=bat.remit_batch_no
LEFT JOIN remit.tbl_remit_channel cha ON bat.remit_channel_no=cha.remit_channel_no
WHERE (pro.remit_channel_no in ('ABC_YBT_BJ_PRI', 'ABC_YBT_BJ_PUB') and time(req.create_date) between '06:00:00' and '23:00:00'
      OR pro.remit_channel_no in ('BOC_YBT_PRI', 'BOC_YBT_PUB') and time(req.create_date) between '05:00:00' and '21:00:00'
      OR pro.remit_channel_no in ('BCCB_YBT_PRI_NEW', 'BCCB_YBT_PUB','BCCB_SUPER_PRI') and time(req.create_date) between '06:00:00' and '23:30:00'
      OR pro.remit_channel_no IN ('CCB_YBT_PRI','CCB_YBT_BATCH_PUB','CCB_YBT_PUB') and time(req.create_date) between '07:00:00' and '20:30:00'
      OR pro.remit_channel_no in ('EGBC_YBT_D0_PRI','EGBC_YBT_S0_PRI','CBHB_YBT_T1_PRI','CBHB_YBT_D0_PRI',
                                          'ICBC_YBT_PRI_NEW','ICBC_YBT_PUB_NEW','CGB_YBT_PRI','CGB_YBT_PUB',
                                          'CIB_PRI_YBT','CIB_PUB_YBT','HX_YBT_PRI','HX_YBT_PUB','CMBC_YBT_NEW_PRI',
                                          'CMBC_YBT_NEW_PUB','SPDB_YBT_PRI','SPDB_YBT_PUB','CEB_YBT_NEW_PRI',
                                          'CEB_YBT_NEW_PUB','PINGAN_YBT_PRI','PINGAN_YBT_PUB','ECITIC_YBT_PRI_NEW','ECITIC_YBT_PUB')
      and time(req.create_date) between '00:15:00' and '23:45:00')
AND  req.create_date >= ${START}
  AND req.create_date < TIMESTAMP(${START}) + 1 days
with ur",fundtx
zgtnew,zgtnewyijianzhifu,"SELECT
	COALESCE(
		CHAR( p.CUSTOMERNUMBER ),
		'null'
	) || COALESCE(
		CHAR( DATE( p.CALLBACK_DATE ) ),
		'null'
	) || 'zgtnetsilverkey' || COALESCE(
		t.BANK_ID,
		''
	) || COALESCE(
		p.CARD_TYPE,
		''
	)||'zgtnewyijianzhifu' AS IDNOUSE,
	t.BANK_ID AS bank_code,
	p.CARD_TYPE AS cardtype,
	p.CUSTOMERNUMBER AS RECEIVERID,
	YEAR(
		DATE(p.CALLBACK_DATE)
	) * 100 + MONTH(
		DATE(p.CALLBACK_DATE)
	) AS MONTH,
	DATE(p.CALLBACK_DATE) AS trxdate,
	222 AS biztypeid,
	'SALES' AS ordertype,
	'Sales' AS TYPE,
	'YJZF-NET' AS payproduct,
	'3011001003001' AS PRODUCT_CODE,
	SUM( p.amount ) - SUM( p.real_amount ) AS trxfee,SUM(BANK_COST) AS frpcost,SUM(BANK_COST) AS accountingcost 

FROM
	zgt.tbl_payment p
LEFT JOIN zgt.tbl_trxorder t ON
	t.external_id = p.externalid
LEFT JOIN zgt.tbl_customer_config c ON
	c.customer_identity_no =(
		CASE
			WHEN t.agent_no IS NULL THEN t.customer_no
			ELSE t.agent_no
		END
	)
WHERE
	1 = 1
	AND t.status IN(
		'SUCCESS',
		'SETTLECONFIRM'
	)
	AND p.CALLBACK_DATE >= ${START}
	AND p.CALLBACK_DATE < ${STOP}
	AND c.belong != 'YEEPAY_SKB'
	AND p.PAY_PRODUCT IN(
		'ONEKEY_NORMAL',
		'WAP-ZHT',
		'4G_PAY',
		'4G_PAY_FIRST',
		'4G_PAY_BIND'
	)
GROUP BY
	p.CUSTOMERNUMBER,
	DATE(p.CALLBACK_DATE),
	t.BANK_ID,
	p.CARD_TYPE WITH ur
",zgt_standby
zgtnew,zgtnewwangyin,"SELECT
	COALESCE(
		CHAR( p.CUSTOMERNUMBER ),
		'null'
	) || COALESCE(
		CHAR( DATE( p.CALLBACK_DATE ) ),
		'null'
	)  || COALESCE(
		t.BANK_ID,
		''
	) || COALESCE(
		p.CARD_TYPE,
		''
	) || COALESCE(
		 p.PAY_PRODUCT,
		''
	)||'zgtnewwangyin' AS IDNOUSE,
	t.BANK_ID AS bank_code,
	p.CARD_TYPE AS cardtype,
	p.CUSTOMERNUMBER AS RECEIVERID,
	YEAR(
		DATE(p.CALLBACK_DATE)
	) * 100 + MONTH(
		DATE(p.CALLBACK_DATE)
	) AS MONTH,
	DATE(p.CALLBACK_DATE) AS trxdate,
	4 AS biztypeid,
	'SALES' AS ordertype,
	'Sales' AS TYPE,
	'SALES' AS payproduct,
	CASE
		WHEN p.PAY_PRODUCT = 'NET_B2C' THEN '3011001002001'
		ELSE '3011001002002'
	END AS PRODUCT_CODE,
	SUM( p.amount ) - SUM( p.real_amount ) AS trxfee,
	0 AS frpcost,0 as accountingcost 

FROM
	zgt.tbl_payment p
LEFT JOIN zgt.tbl_trxorder t ON
	t.external_id = p.externalid
LEFT JOIN zgt.tbl_customer_config c ON
	c.customer_identity_no =(
		CASE
			WHEN t.agent_no IS NULL THEN t.customer_no
			ELSE t.agent_no
		END
	)
WHERE
	1 = 1
	AND t.status IN(
		'SUCCESS',
		'SETTLECONFIRM'
	)
	AND p.CALLBACK_DATE >= ${START}
	AND p.CALLBACK_DATE < ${STOP}
	AND c.belong != 'YEEPAY_SKB'
	AND p.PAY_PRODUCT IN(
		'NET_B2B',
		'NET_B2C'
	)
GROUP BY
	p.CUSTOMERNUMBER,
	DATE(p.CALLBACK_DATE),
	t.BANK_ID,
	p.CARD_TYPE,p.PAY_PRODUCT 
	WITH ur",zgt_standby
zgtnew,zgtnewsaoma,"SELECT
	COALESCE(
		CHAR( p.CUSTOMERNUMBER ),
		'null'
	) || COALESCE(
		CHAR( DATE( p.CALLBACK_DATE ) ),
		'null'
	) || 'zgtnewsaoma' || COALESCE(
		t.BANK_ID,
		''
	) || COALESCE(
		p.CARD_TYPE,
		''
	) AS IDNOUSE,
	t.BANK_ID AS bank_code,
	p.CARD_TYPE AS cardtype,
	p.CUSTOMERNUMBER AS RECEIVERID,
	YEAR(
		DATE(p.CALLBACK_DATE)
	) * 100 + MONTH(
		DATE(p.CALLBACK_DATE)
	) AS MONTH,
	DATE(p.CALLBACK_DATE) AS trxdate,
	260 AS biztypeid,
	'SALES' AS ordertype,
	'Sales' AS TYPE,
	'SM' AS payproduct,
	'3011001006001'  AS PRODUCT_CODE,
	SUM( p.amount ) - SUM( p.real_amount ) AS trxfee,
	0 AS frpcost,0 as accountingcost 

FROM
	zgt.tbl_payment p
LEFT JOIN zgt.tbl_trxorder t ON
	t.external_id = p.externalid
LEFT JOIN zgt.tbl_customer_config c ON
	c.customer_identity_no =(
		CASE
			WHEN t.agent_no IS NULL THEN t.customer_no
			ELSE t.agent_no
		END
	)
WHERE
	1 = 1
	AND t.status IN(
		'SUCCESS',
		'SETTLECONFIRM'
	)
	AND p.CALLBACK_DATE >= ${START}
	AND p.CALLBACK_DATE < ${STOP}
	AND c.belong != 'YEEPAY_SKB'
	AND p.PAY_PRODUCT IN(
		'WECHATU',
		'WAP_SM'
	)
GROUP BY
	p.CUSTOMERNUMBER,
	DATE(p.CALLBACK_DATE),
	t.BANK_ID,
	p.CARD_TYPE WITH ur
",zgt_standby
zgtnew,zgtnewqianbao,"SELECT
	COALESCE(
		CHAR( DATE( p.CALLBACK_DATE ) ),
		'null'
	) || COALESCE(
		CHAR( p.CUSTOMERNUMBER ),
		'null'
	) || 'zgtnewqianbao' || COALESCE(
		t.BANK_ID,
		''
	) || COALESCE(
		p.CARD_TYPE,
		''
	) AS IDNOUSE,
	DATE(p.CALLBACK_DATE) AS TRXDATE,
	t.BANK_ID AS bank_code,
	p.CARD_TYPE AS cardtype,
	YEAR(
		DATE(p.CALLBACK_DATE)
	) * 100 + MONTH(
		DATE(p.CALLBACK_DATE)
	) AS MONTH,
	p.CUSTOMERNUMBER AS RECEIVERID,
	'3011004004001' AS PRODUCT_CODE,
	'3011004001003A' AS SALES_PRODUCT_CODE,
	'SALES' AS ORDERTYPE,
	'QB' AS PAYPRODUCT,
	260 AS BIZTYPEID,
	'Sales' AS TYPE,
	1 AS ISCOMPUTEPROFIT,
	1 AS ISCOMPUTEBONUS,
	'ONLINE' AS RELEGATION,
	'PAID' AS FEETYPE,
	'SYSTEM' AS USETYPE,
	'ZGT' AS DATAORIGIN,
	COUNT( p.id ) AS TRXCOUNT,
	SUM( p.amount ) AS TRXAMOUNT,
	SUM( p.amount ) - SUM( p.real_amount ) AS TRXFEE 
FROM
	zgt.tbl_payment p
LEFT JOIN zgt.tbl_trxorder t ON
	t.external_id = p.externalid
LEFT JOIN zgt.tbl_merchant m ON
	m.IDENTITY_NO = t.customer_no
WHERE
	1 = 1
	AND p.CALLBACK_DATE >= ${START}
	AND p.CALLBACK_DATE < ${STOP}
	AND p.PAY_PRODUCT IN(
		'WAP_ALIPAYAPP',
		'WAP_WECHATAPP',
		'ALIPAY_APP','WECHAT_APP_,__ECHATG','WAP_WECHATG'
	)
GROUP BY
	DATE(p.CALLBACK_DATE),
	p.CUSTOMERNUMBER,
	t.BANK_ID,
	p.CARD_TYPE WITH ur",zgt_standby
zgtnew,zgtnewhuiyuan,"SELECT
	COALESCE(
		CHAR( p.CUSTOMERNUMBER ),
		'null'
	) || COALESCE(
		CHAR( DATE( p.CALLBACK_DATE ) ),
		'null'
	) || 'zgtnewhuiyuan' || COALESCE(
		t.BANK_ID,
		''
	) || COALESCE(
		p.CARD_TYPE,
		''
	) AS IDNOUSE,
	t.BANK_ID AS bank_code,
	p.CARD_TYPE AS cardtype,
	p.CUSTOMERNUMBER AS RECEIVERID,
	YEAR(
		DATE(p.CALLBACK_DATE)
	) * 100 + MONTH(
		DATE(p.CALLBACK_DATE)
	) AS MONTH,
	DATE(p.CALLBACK_DATE) AS trxdate,
	18 AS biztypeid,
	'SALES' AS ordertype,
	'Sales' AS TYPE,
	'PERSONAL_ACCOUNT_PAY' AS payproduct,
	'3011001004001' AS PRODUCT_CODE,
	SUM( p.amount ) - SUM( p.real_amount ) AS trxfee,
	SUM( p.amount ) AS trxamount,
	COUNT( p.id ) AS trxcount,
	SUM(BANK_COST) AS frpcost,SUM(BANK_COST) AS accountingcost 

FROM
	zgt.tbl_payment p
LEFT JOIN zgt.tbl_trxorder t ON
	t.external_id = p.externalid
LEFT JOIN zgt.tbl_customer_config c ON
	c.customer_identity_no =(
		CASE
			WHEN t.agent_no IS NULL THEN t.customer_no
			ELSE t.agent_no
		END
	)
WHERE
	1 = 1
	AND t.status IN(
		'SUCCESS',
		'SETTLECONFIRM'
	)
	AND p.CALLBACK_DATE >= ${START}
	AND p.CALLBACK_DATE < ${STOP}
	AND c.belong != 'YEEPAY_SKB'
	AND t.pay_product_type = 'MEMBER'
GROUP BY
	p.CUSTOMERNUMBER,
	DATE(p.CALLBACK_DATE),
	t.BANK_ID,
	p.CARD_TYPE WITH ur",zgt_standby
zgtnew,zgtnewrenzheng,"select 
COALESCE(CHAR(date(UPDATE_DATE )),'null')||COALESCE(CHAR(identity_no),'null')||'zgtnewrenzheng' as IDNOUSE,
date(UPDATE_DATE ) AS TRXDATE,
year(date(UPDATE_DATE ))*100+month(date(UPDATE_DATE))  AS MONTH,
identity_no AS RECEIVERID,
'3011004003001' AS PRODUCT_CODE,
'3011004001003A' AS SALES_PRODUCT_CODE,
'REALNAMEAUTH' AS ORDERTYPE,
'ZGT_REALNAMEAUTH' AS PAYPRODUCT,
226  AS BIZTYPEID,
'RealNameAuth' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'ZGT' AS DATAORIGIN,
count(id) AS TRXCOUNT,
sum(fee) AS TRXFEE,
sum(cost) AS FRPCOST,
sum(cost) AS ACCOUNTINGCOST
from zgt.tbl_auth_fee_record
where FEE_STATUS = 'SUCCESS'
and UPDATE_DATE >= ${START}
and UPDATE_DATE < ${STOP}
and AUTH_TYPE in ('ENTERPRISE','IDCARD') 
GROUP BY date(UPDATE_DATE ),identity_no
with ur
",zgt_standby
zgtnew,zgtnewbangka,"select 
COALESCE(CHAR(date(UPDATE_DATE )),'null')||COALESCE(CHAR(identity_no),'null')||'zgtnewbangka' as IDNOUSE,
date(UPDATE_DATE ) AS TRXDATE,
year(date(UPDATE_DATE ))*100+month(date(UPDATE_DATE )) AS MONTH,
identity_no AS RECEIVERID,
'3011004003002' AS PRODUCT_CODE,
'3011004001003A' AS SALES_PRODUCT_CODE,
'CARDJIANQUAN' AS ORDERTYPE,
'ZGT_CARDJIANQUAN' AS PAYPRODUCT,
226  AS BIZTYPEID,
'CARDJIANQUAN' AS TYPE,
1 AS ISCOMPUTEPROFIT,
1 AS ISCOMPUTEBONUS,
'ONLINE' AS RELEGATION,
'PAID' AS FEETYPE,
'SYSTEM' AS USETYPE,
'ZGT' AS DATAORIGIN,
count(id) AS TRXCOUNT,
sum(fee) AS TRXFEE,
sum(cost) AS FRPCOST,
sum(cost) AS ACCOUNTINGCOST
from zgt.tbl_auth_fee_record
where FEE_STATUS = 'SUCCESS'
and UPDATE_DATE >= ${START}
and UPDATE_DATE < ${STOP}
and AUTH_TYPE in ('BANKCARD','VERIFY')
GROUP BY date(UPDATE_DATE ),identity_no
with ur
",zgt_standby
zgtnew,zgtnewidnum,"select CUSTOMERNUMBER as RECEIVERID, ID as CUSTOMERID from db2inst1.customerinfo  with ur",reportdb
cliHis,member2,"SELECT MOBILEBE.CUSTOMER.CUSTOMERNUMBER AS Cst_code,
MOBILEBE.CUSTOMERDOCINFO.DOCUMENTNUMBER AS Acc_name,
CASE MOBILEBE.CUSTOMERDOCINFO.DOCUMENTNAME WHEN 'èº»½è¯' THEN '11' WHEN 'æ³_ººèº»½è¯' THEN '11' ELSE '12' end as Acc_type,
'11' AS Acc_type1,
CASE MOBILEBE.CUSTOMERDOCINFO.DOCUMENTNAME WHEN 'èº»½è¯' THEN '11' WHEN 'æ³_ººèº»½è¯' THEN '11' ELSE '' end as Id_type,
VARCHAR_FORMAT(DATE(MOBILEBE.CUSTOMER.CREATEDATE), 'YYYYMMDD') AS Open_time,
CASE MOBILEBE.CUSTOMERDOCINFO.DOCUMENTNAME WHEN 'èº»½è¯' THEN '11' WHEN 'æ³_ººèº»½è¯' THEN '11' ELSE '19' end as Id_type2,
MOBILEBE.CUSTOMERDOCINFO.DOCUMENTNUMBER AS Id_no2,
MOBILEBE.CUSTOMERDOCINFO.DESCRIPTION AS Rep_legal,
VARCHAR_FORMAT(DATE(MOBILEBE.CUSTOMERDOCINFO.AVAILABDATA), 'YYYYMMDD') AS Id_deadline2
FROM MOBILEBE.CUSTOMER  
LEFT JOIN MOBILEBE.CUSTOMERDOCINFO ON MOBILEBE.CUSTOMER.CUSTOMERNUMBER = MOBILEBE.CUSTOMERDOCINFO.CUSTOMERNUMBER  fetch first 100 rows only with ur",COPY2
cliHis,member3,"SELECT 
MOBILEBE.customer.CUSTOMERNUMBER AS Cst_code,
MOBILEBE.ACCOUNT.BANKACTID AS Acc_no
FROM 
MOBILEBE.ACCOUNT 
LEFT JOIN MOBILEBE.customer ON MOBILEBE.ACCOUNT.CUSTOMER_ID = MOBILEBE.customer.ID 
LEFT JOIN MOBILEBE.SETTLEMENTINFO  ON MOBILEBE.ACCOUNT.ID = MOBILEBE.SETTLEMENTINFO.BANKACCOUNT_ID 
WHERE MOBILEBE.ACCOUNT.CLASSTYPE = 'RemoteAccount' 
AND MOBILEBE.ACCOUNT.STATUS = 'ACTIVATION' 
AND MOBILEBE.SETTLEMENTINFO.ID IS NOT NULL ",COPY2
cliHis,member4,"SELECT 
CUSCENTER.TBL_MERCHANT.MERCHANT_NO AS Cst_code,
CUSCENTER.TBL_CORPORATION.LICENSE_NO_ENCRYPT AS Id_no,
VARCHAR_FORMAT(DATE(CUSCENTER.TBL_CORPORATION.EXPIRY_DATE), 'YYYYMMDD') AS Id_deadline,
'CHN' AS Nation,
CASE CUSCENTER.TBL_CORPORATION.SEX WHEN 'male' THEN '11' ELSE '12' END AS Cst_sex,
CUSCENTER.TBL_CORPORATION.CONTACT_PHONE_ENCRYPT AS Contact1,
CUSCENTER.TBL_CORPORATION.ADDRESS_ENCRYPT AS Address,
CUSCENTER.TBL_MERCHANT.BIZCAT_NAME AS Operate,
CUSCENTER.TBL_ORGANIZATION.NUMBER"" AS Org_no",
CASE CUSCENTER.TBL_MERCHANT.SIGN_TYPE WHEN 'PERSON' THEN VARCHAR_FORMAT(DATE(CUSCENTER.TBL_CORPORATION.EXPIRY_DATE), 'YYYYMMDD') ,,
"									WHEN 'INDIVIDUAL' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_bizlicense.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									WHEN 'ENTERPRISE' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_unicrdcodecert.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									WHEN 'INSTITUTION' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_qualification.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									WHEN 'COMMUNITY' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_qualification.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									WHEN 'PEOPLE_RUN_NON_ENTERPRISE' THEN VARCHAR_FORMAT(DATE(CUSCENTER.tbl_qualification.EXPIRY_DATE)", 'YYYYMMDD') ,,
"									end as License_deadline",,,
CASE CUSCENTER.TBL_MERCHANT.SIGN_TYPE WHEN 'PERSON' THEN CUSCENTER.TBL_CORPORATION.LICENSE_NO_ENCRYPT ,,,
"									  WHEN 'INDIVIDUAL' THEN CUSCENTER.tbl_bizlicense.REGIST_NO",,,
"									  WHEN 'ENTERPRISE' THEN CUSCENTER.tbl_unicrdcodecert.""NUMBER""",,,
"									  WHEN 'INSTITUTION' THEN CUSCENTER.tbl_qualification.""NUMBER""",,,
"									  WHEN 'COMMUNITY' THEN CUSCENTER.tbl_qualification.""NUMBER""",,,
"									  WHEN 'PEOPLE_RUN_NON_ENTERPRISE' THEN CUSCENTER.tbl_qualification.""NUMBER""",,,
"									  end as License",,,
CASE CUSCENTER.TBL_MERCHANT.SIGN_TYPE WHEN 'PERSON' THEN  '12'  ,,,
"									WHEN 'INDIVIDUAL' THEN  '11'",,,
"									 WHEN 'ENTERPRISE' THEN  '12'",,,
"									 WHEN 'INSTITUTION' THEN  '12'",,,
"									 WHEN 'COMMUNITY' THEN  '12'",,,
"									 WHEN 'PEOPLE_RUN_NON_ENTERPRISE' THEN  '12'",,,
"									END AS Set_file",,,
FROM CUSCENTER.TBL_CORPORATION ,,,
LEFT JOIN CUSCENTER.TBL_MERCHANT ON CUSCENTER.TBL_CORPORATION.CUSTOMER_NO = CUSCENTER.TBL_MERCHANT.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.TBL_ORGANIZATION ON CUSCENTER.TBL_MERCHANT.CUSTOMER_NO = CUSCENTER.TBL_ORGANIZATION.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.tbl_qualification ON CUSCENTER.tbl_merchant.CUSTOMER_NO = CUSCENTER.tbl_qualification.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.tbl_bizlicense ON CUSCENTER.tbl_bizlicense.CUSTOMER_NO = CUSCENTER.tbl_merchant.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.tbl_taxregcert ON CUSCENTER.tbl_taxregcert.CUSTOMER_NO = CUSCENTER.tbl_merchant.CUSTOMER_NO ,,,
LEFT JOIN CUSCENTER.tbl_acclicense ON CUSCENTER.tbl_acclicense.CUSTOMER_NO = CUSCENTER.tbl_merchant.CUSTOMER_NO ,,,
"LEFT JOIN CUSCENTER.tbl_unicrdcodecert ON CUSCENTER.tbl_unicrdcodecert.CUSTOMER_NO = CUSCENTER.tbl_merchant.CUSTOMER_NO""",dzh_standby,,
proqualityWalletTotal,proqualityWalletTotal_total,"SELECT HAPPEN_DATE,SUM(TRADE_COUNT) AS TRADE_COUNT  
FROM
(SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS TRADE_COUNT FROM frontend.TBL_FRONTEND_PAY_ORDER AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') 
union all
SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS TRADE_COUNT FROM frontend.TBL_FRONTEND_PAY_RECORD_ZFB AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI'))
GROUP BY HAPPEN_DATE",dzh_standby
proqualityWalletTotal,proqualityWalletTotal_succ,"select HAPPEN_DATE,sum(SUCCESS_COUNT) as SUCCESS_COUNT
from 
(SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS SUCCESS_COUNT FROM frontend.TBL_FRONTEND_PAY_ORDER AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
AND PAY_STATUS='SUCCESS'
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
union all
SELECT TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,count(ID) AS TRADE_COUNT FROM frontend.TBL_FRONTEND_PAY_RECORD_ZFB AS t
WHERE t.CREATE_TIME >= ${START} AND t.CREATE_TIME < ${STOP}
GROUP BY TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI'))
group by HAPPEN_DATE
with ur",dzh_standby
proqualityWalletTotal,excep_proqualityWalletTotal,"select TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI') HAPPEN_DATE,0 CARDHOLDER_COUNT from frontend.TBL_FRONTEND_PAY_ORDER as t
where t.CREATE_TIME >= ${START} and t.CREATE_TIME < ${STOP}
group by TO_CHAR(t.CREATE_TIME,'YYYY-MM-DD HH24:MI')
with ur",dzh_standby
channelwuka,channelwuka,"SELECT
    COALESCE(TBLORDER.REPORT_MERCHANT_NO,'ç©') ||  COALESCE(TBLORDER.YEEPAY_MERCHANT_NO,'ç©')||COALESCE(PARAM.PARAM_CODE,'ç©')||COALESCE(PARAM.PARAM_NAME,'ç©')||
COALESCE(CHANNEL.CODE,'ç©')||COALESCE(CHANNEL.CODE,'ç©')||COALESCE(CHANNEL.NAME,'ç©')||
COALESCE(BASICCHANNEL.BANK_CHANNEL_CODE,'ç©')||COALESCE(BASICCHANNEL.BANK_CHANNEL_NAME,'ç©')||COALESCE(TBLORDER.DEAL_STATUS,'ç©')||COALESCE(TBLORDER.CARD_TYPE,'ç©') || COALESCE(TBLORDER.REQUEST_TYPE,'ç©') AS IDNOSE,
    ${START} AS TRX_DATE,
    TBLORDER.REPORT_MERCHANT_NO AS REPORT_MERCHANT_NO,
    TBLORDER.YEEPAY_MERCHANT_NO AS YEEPAY_MERCHANT_NO,
    NULL AS MERCHANT_NAME,
   NULL AS SIGNED_NAME,
    NULL AS PRODUCTLINE,
    NULL AS SEC_PRODUCTLINE,
    NULL AS NEW_PRODUCTLINE,
    TBLORDER.REQUEST_TYPE AS TRADE_TYPE,
    count(1) AS TOTAL_SUM,
    sum(COALESCE(TBLORDER.TRADE_AMOUNT,0.0000)) AS TOTAL_AMOUNT,
    sum(COALESCE(TBLORDER.ORDER_COST,0.0000)) AS TOTAL_COST,
    sum(COALESCE(TBLORDER.TRADE_AMOUNT,0.0000)-COALESCE(TBLORDER.ORDER_COST,0.0000)) AS TOTAL_PROFIT,
    COALESCE(count(T3.ID),0) AS SUCCESS_SUM,
    sum(COALESCE(T3.TRADE_AMOUNT,0.0000)) AS SUCCESS_AMOUNT,
    sum(COALESCE(T3.ORDER_COST,0.0000)) AS COST,
    sum(COALESCE(T3.TRADE_AMOUNT,0.0000)-COALESCE(TBLORDER.ORDER_COST,0.0000)) AS PROFIT,
    COALESCE(count(T4.ID),0) AS FAIL_SUM,
    sum(COALESCE(T4.TRADE_AMOUNT,0.0000)) AS FAIL_AMOUNT,
    sum(COALESCE(T4.ORDER_COST,0.0000)) AS FAIL_COST,
    sum(COALESCE(T4.TRADE_AMOUNT,0.0000)-COALESCE(T4.ORDER_COST,0.0000)) AS FAIL_PROFIT,
    PARAM.PARAM_CODE AS BANK_CODE,
    PARAM.PARAM_NAME AS BANK_NAME,
    CHANNEL.CODE AS CHANNEL_CODE,
    CHANNEL.NAME AS CHANNEL_NAME,
    BASICCHANNEL.BANK_CHANNEL_CODE AS BANK_CHANNEL_CODE,
    BASICCHANNEL.BANK_CHANNEL_NAME AS BANK_CHANNEL_NAME,
    TBLORDER.DEAL_STATUS AS ORDER_STATUS,
    TBLORDER.CARD_TYPE AS CARD_TYPE,
    '___' AS TYPE,
    CURRENT TIMESTAMP AS CREATE_TIME
FROM  BANK.TBL_BANK_NOCARD_ORDER TBLORDER
LEFT JOIN BANK.TBL_BANK_BASIC_CHANNEL BASICCHANNEL ON BASICCHANNEL.BANK_CHANNEL_CODE = TBLORDER.TRADE_INTERFACE
LEFT JOIN  ROUTER.TBL_BANK_CHANNEL CHANNEL ON CHANNEL.CODE = TBLORDER.ROUTER_INTERFACE_CODE
LEFT JOIN ROUTER.TBL_RULE_PARAM PARAM ON TBLORDER.BANKID = PARAM.PARAM_CODE AND PARAM.PARAM_KEY='BANK' 
LEFT JOIN (
SELECT
ID,TRADE_AMOUNT,ORDER_COST
FROM
BANK.TBL_BANK_NOCARD_ORDER
WHERE 
    CREATE_TIME >= CONCAT(${START},' 00:00:00') AND CREATE_TIME<CONCAT(date(${START})+1 day,' 00:00:00')
AND DEAL_STATUS='SUCCESS'
) T3
ON t3.id=TBLORDER.id
LEFT JOIN (
SELECT
  ID,TRADE_AMOUNT,ORDER_COST
FROM
BANK.TBL_BANK_NOCARD_ORDER
WHERE 
    CREATE_TIME >= CONCAT(${START},' 00:00:00') AND CREATE_TIME<CONCAT(date(${START})+1 day,' 00:00:00')
AND DEAL_STATUS='FAILED'
) T4
ON t4.id=TBLORDER.id
WHERE
    TBLORDER.CREATE_TIME >= CONCAT(${START},' 00:00:00') AND TBLORDER.CREATE_TIME<CONCAT(date(${START})+1 day,' 00:00:00')
group by TBLORDER.REPORT_MERCHANT_NO,TBLORDER.YEEPAY_MERCHANT_NO,TBLORDER.CARD_TYPE,TBLORDER.ROUTER_INTERFACE_CODE,CHANNEL.NAME,PARAM.PARAM_CODE,PARAM.PARAM_NAME,CHANNEL.CODE,CHANNEL.NAME,TBLORDER.DEAL_STATUS,BASICCHANNEL.BANK_CHANNEL_NAME,BASICCHANNEL.BANK_CHANNEL_CODE, TBLORDER.REQUEST_TYPE",cashier_bank_standby
cliHis,member5,"SELECT
  t1.MEMBER_NO                        AS CST_CODE,
  t1.REAL_NAME_CIPHER          AS ACC_NAME,
  '11'                                                AS ACC_TYPE,
CASE t1.MEMBER_CATEGORY
WHEN 'ONE_CATEGORY' THEN  '11'
WHEN'TWO_CATEGORY' THEN  '12'
WHEN'THREE_CATEGORY' THEN  '13'
ELSE '14'  END
                                                                           AS ACC_TYPE1,
  t2.ACCOUNT_NO                                       AS ACC_NO,
VARCHAR_FORMAT(t1.CREATE_DATE,'YYYYMMDD')  AS OPEN_TIME,
  ''                                                                                    AS CLOSE_TIME,
 case  t1.CREDENTIALS_TYPE                               
 when 'IDENTITY_CARD' then '11'
 else '19' end                                                              AS ID_TYPE,
  t1.CREDENTIALS_NO_CIPHER                            AS ID_NO,
 VARCHAR_FORMAT(t1.BIRTHDAY,'YYYYMMDD')      AS DATE_BIRTH,
  ''                                                  AS ID_DEADLINE,
  ''                                                  AS NATION,
  case t1.MAN  when '1' then '11' when '0' then '12' else '' end   AS CST_SEX,
  ''                                                  AS OCCUPATION,
  t1.BIND_MOBILE_NO_CIPHER                            AS CONTACT1,
  t3.TELEPHONE_CIPHER                                 AS CONTACT2,
  t1.BIND_EMAIL_CIPHER                                AS CONTACT3,
  addr.ADDRESS_CIPHER                                 AS ADDRESS,
  ''                                                  AS OPERATE,
  ''                                                  AS ORG_NO,
  '11'                                                AS SET_FILE,
  ''                                                  AS LICENSE,
  ''                                                  AS LICENSE_DEADLINE,
  ''                                                  AS REP_LEGAL,
  '11'                                                AS ID_TYPE2,
  t1.CREDENTIALS_NO_CIPHER                            AS ID_NO2,
  ''                                                  AS ID_DEADLINE2,
  ''                                                  AS HANDLER_NAME,
  ''                                                  AS ID_TYPE3,
  ''                                                  AS ID_NO3,
  ''                                                  AS ID_DEADLINE3,
case  t1.CA_BANKCARD_TAG  when '1' then '11' when '0' then '12' end                        AS BIND_CARD,
  t1.BIND_MOBILE_NO_CIPHER                            AS BIND_MOB,
  ''                                                  AS IP_CODE,
  ''                                                  AS MAC_INFO
FROM MEMBER.TBL_MEMBER t1
  JOIN MEMBER.TBL_MEMBER_ACCOUNT_R t2 ON t1.MEMBER_NO = t2.MEMBER_NO
  JOIN MEMBER.TBL_MEMBER_CONTACT_INFO t3 ON t1.MEMBER_NO = t3.MEMBER_NO
  JOIN MEMBER.TBL_MEMBER_ADDRESS AS addr ON t1.MEMBER_NO = addr.MEMBER_NO
WHERE t1.CA_STATUS='VERIFIED' AND t1.MEMBER_CATEGORY IN ('ONE_CATEGORY', 'TWO_CATEGORY', 'THREE_CATEGORY')



",member_standby
channelwuka,channelwukae," SELECT
C.CUSTOMERNUMBER AS YEEPAY_MERCHANT_NO,
C.FULLNAME AS MERCHANT_NAME,
C.SIGNEDNAME AS SIGNED_NAME,
TB.NAME AS PRODUCTLINE,
TSG.NAME AS SEC_PRODUCTLINE,
C.PRODUCTLINE AS NEW_PRODUCTLINE
from DB2INST1.CUSTOMERINFO C
LEFT JOIN DB2INST1.TRXSTATBUSINESSCATEGORIE TB
ON C.BUSSINESSCATID=TB.ID
LEFT JOIN DB2INST1. TRXSTATSUBBUSINESSCATEGORIE TSG
ON C.SUBBUSINESSCAT=TSG.CODE
",reportdb_read
kjcustomerinfo,kjcustomerinfo,"select 
CONCAT('999',id) as id,
'è·¨åè¡__çº' as PRODUCTLINE,
id as CUSTOMERNUMBER,
id as MERCHANTNO,
signed_name as SIGNEDNAME,
signed_name as FULLNAME,
address as ADDRESS,
phone as PHONE,
phone as MOBILE,
web_site as WEBURL,
agent as AGENTCODE,
sales_people as SALESNAME,
case 
when status='INIT' then 0
when status='NOTACTIVATE' then 0
when status='DELETED' then 0
when status='ACTIVATE' then 1
end as ACTIVE,
case 
when involved_industry='ehk200000' then 124
when involved_industry='ehk400000' then 129
when involved_industry='ehk300000' then 126
when involved_industry='ehk700000' then 121
when involved_industry='ehk999999' then 128
when involved_industry='ehk600000' then 129
when involved_industry='ehk500000' then 125
when involved_industry='ehk100000' then 120
end as BUSINESSCAT,
icp as ICP,
country_code as COUNTRY_CODE,
credentials_number as BUSINESS_LICENCE,
date(review_date_time) as AUDIT_DATE,
date(open_date_time) as SIGNED_DATE,
merchant_level as LEVEL,
'KJ' as PRODUCTGROUP,
signed_shorthand as SHORTNAME,
type as TYPE
from m_merchant",federated
channelwangyin,channelwangyine,"SELECT
 COALESCE(TBLORDER.REPORT_MERCHANT_NO,'ç©')||COALESCE(TBLORDER.YEEPAY_MERCHANT_NO,'ç©')||COALESCE(PARAM.PARAM_CODE,'ç©')||COALESCE(PARAM.PARAM_NAME,'ç©')||COALESCE(BASICCHANNEL.BANK_CHANNEL_CODE,'ç©')||COALESCE(BASICCHANNEL.BANK_CHANNEL_NAME,'ç©')||COALESCE(CHANNEL.CODE,'ç©')||COALESCE(CHANNEL.NAME,'ç©')||COALESCE(TBLORDER.STATUS,'ç©')||COALESCE(TBLORDER.CARD_TYPE,'ç©') AS IDNOSE,
    ${START} AS TRX_DATE,
    TBLORDER.REPORT_MERCHANT_NO AS REPORT_MERCHANT_NO,
    TBLORDER.YEEPAY_MERCHANT_NO AS YEEPAY_MERCHANT_NO,
    NULL AS MERCHANT_NAME,
   NULL AS SIGNED_NAME,
   NULL AS PRODUCTLINE,
    NULL AS SEC_PRODUCTLINE,
NULL AS NEW_PRODUCTLINE,
PARAM.PARAM_CODE AS BANK_CODE,
PARAM.PARAM_NAME AS BANK_NAME,
BASICCHANNEL.BANK_CHANNEL_CODE AS BANK_CHANNEL_CODE,
BASICCHANNEL.BANK_CHANNEL_NAME as BANK_CHANNEL_NAME,
    'PAY' AS TRADE_TYPE,
    count(1) AS TOTAL_SUM,
    sum(COALESCE(TBLORDER.PAY_AMOUNT,0.0000)) AS TOTAL_AMOUNT,
    sum(COALESCE(TBLORDER.ORDER_COST,0.0000)) AS TOTAL_COST,
    sum(COALESCE(TBLORDER.PAY_AMOUNT,0.0000)-COALESCE(TBLORDER.ORDER_COST,0.0000)) AS TOTAL_PROFIT,
    COALESCE(count(T3.id),0)  AS SUCCESS_SUM,
    SUM(COALESCE(T3.PAY_AMOUNT,0.0000)) AS SUCCESS_AMOUNT,
    SUM(COALESCE(T3.ORDER_COST,0.0000)) AS COST,
    SUM(COALESCE(T3.PAY_AMOUNT,0.0000)-COALESCE(TBLORDER.ORDER_COST,0.0000)) AS PROFIT,
 COALESCE(count(T4.ID),0) AS FAIL_SUM,
    sum(COALESCE(T4.PAY_AMOUNT,0.0000)) AS FAIL_AMOUNT,
    sum(COALESCE(T4.ORDER_COST,0.0000)) AS FAIL_COST,
    sum(COALESCE(T4.PAY_AMOUNT,0.0000)-COALESCE(T4.ORDER_COST,0.0000)) AS FAIL_PROFIT,
CHANNEL.CODE AS CHANNEL_CODE,
    CHANNEL.NAME      AS CHANNEL_NAME,
TBLORDER.STATUS AS ORDER_STATUS,
     TBLORDER.CARD_TYPE,
    'ç½__' AS TYPE,
    CURRENT TIMESTAMP AS CREATE_TIME
FROM  BANK.TBL_BANK_ORDER TBLORDER
LEFT JOIN BANK.TBL_BANK_BASIC_CHANNEL BASICCHANNEL ON BASICCHANNEL.BANK_CHANNEL_CODE = TBLORDER.PAY_INTERFACE
LEFT JOIN  ROUTER.TBL_BANK_CHANNEL CHANNEL ON CHANNEL.CODE = TBLORDER.ROUTER_INTERFACE_CODE
LEFT JOIN ROUTER.TBL_RULE_PARAM PARAM ON TBLORDER.BANK_CODE=PARAM.PARAM_CODE AND PARAM.PARAM_KEY='BANK'
LEFT JOIN (
SELECT
ID,PAY_AMOUNT,ORDER_COST
FROM
BANK.TBL_BANK_ORDER
WHERE 
    CREATE_TIME >= CONCAT(${START},' 00:00:00') AND CREATE_TIME<CONCAT(date(${START})+1 day,' 00:00:00')
AND STATUS='PAY'
) T3
ON t3.id=TBLORDER.id
LEFT JOIN (
SELECT
  ID,PAY_AMOUNT,ORDER_COST
FROM
BANK.TBL_BANK_ORDER
WHERE 
    CREATE_TIME >= CONCAT(${START},' 00:00:00') AND CREATE_TIME<CONCAT(date(${START})+1 day,' 00:00:00')
AND STATUS='FAILED'
) T4
ON t4.id=TBLORDER.id
WHERE
    TBLORDER.CREATE_TIME >= CONCAT(${START},' 00:00:00') AND TBLORDER.CREATE_TIME<CONCAT(date(${START})+1 day,' 00:00:00')
GROUP BY TBLORDER.REPORT_MERCHANT_NO,TBLORDER.YEEPAY_MERCHANT_NO,TBLORDER.ROUTER_INTERFACE_CODE,CHANNEL.NAME,TBLORDER.CARD_TYPE,PARAM.PARAM_CODE,PARAM.PARAM_NAME,BASICCHANNEL.BANK_CHANNEL_CODE,BASICCHANNEL.BANK_CHANNEL_NAME,CHANNEL.CODE,TBLORDER.STATUS",cashier_bank_standby
channelwangyin,channelwangyine2," SELECT
C.CUSTOMERNUMBER AS YEEPAY_MERCHANT_NO,
C.FULLNAME AS MERCHANT_NAME,
C.SIGNEDNAME AS SIGNED_NAME,
TB.NAME AS PRODUCTLINE,
TSG.NAME AS SEC_PRODUCTLINE,
c.productline AS NEW_PRODUCTLINE
from DB2INST1.CUSTOMERINFO C
LEFT JOIN DB2INST1.TRXSTATBUSINESSCATEGORIE TB
ON C.BUSSINESSCATID=TB.ID
LEFT JOIN DB2INST1. TRXSTATSUBBUSINESSCATEGORIE TSG
ON C.SUBBUSINESSCAT=TSG.CODE
",reportdb_read
crossborder,crossbordertrx,"SELECT
concat(source.trxdate,source.business_type,source.customernumber,'crossbordertrx') as IDNOUSE,
    CONCAT('999',source.customernumber) as RECEIVERID,
    source.business_type as ORDERTYPE,
	source.trxdate as TRXDATE,
        year(source.trxdate) * 100 + month(source.trxdate) as month,
	source.business_type as PAYPRODUCT,
	CASE source.business_type
WHEN 'GATEWAY_FOREIGN_EXCHANGE' THEN
 '3011001003001'
WHEN 'FOREIGN_EXCHANGE' THEN
 '3011001003001'
WHEN 'ONLINE_PAY' THEN
 '3011001003001'
WHEN 'TRANSFER_DOMESTIC' THEN
 '3011002001001'
WHEN 'RZ_AUTH_USER' THEN
 '3011004003001'
WHEN 'RECHARGE' THEN
 '3011001002002'
WHEN 'GATEWAY_FOREIGN_EXCHANGE_TRANSFER' THEN
 '3011005001001'
WHEN 'FOREIGN_EXCHANGE_TRANSFER' THEN
 '3011005001001'
WHEN 'TRANSFER_FOREIGN' THEN
 '3011005001001'
WHEN 'FOREIGNPAY_EXCHANGESETTLEMENT' THEN
 '3011005001002'
WHEN 'TRANSFER_FOREIGN_RMB' THEN
 '3011005001003'
WHEN 'TRANSFER_FOREIGN_CNY' THEN
 '3011005001003'
WHEN 'FOREIGNPAY_EXCHANGESETTLEMENT_CNY' THEN
 '3011005001004 '
WHEN 'HG_REPAYMENT' THEN
 '3011005002001'
WHEN 'HG_ORDER' THEN
 '3011005002001'
when 'TRANSFER_ACCOUNT' then
 '3011001004002'
END AS PRODUCT_CODE,
'3011005001001A' as SALES_PRODUCT_CODE,
'Sales' as TYPE,
CASE source.business_type
WHEN 'GATEWAY_FOREIGN_EXCHANGE' THEN
 0
WHEN 'ONLINE_PAY' THEN
 0
WHEN 'TRANSFER_DOMESTIC' THEN
 0
WHEN 'RECHARGE' THEN
 0
WHEN 'HG_REPAYMENT' THEN
 0
ELSE
 count(1)
END AS TRXCOUNT,
 CASE source.business_type
WHEN 'GATEWAY_FOREIGN_EXCHANGE' THEN
 0
WHEN 'ONLINE_PAY' THEN
 0
WHEN 'TRANSFER_DOMESTIC' THEN
 0
WHEN 'RECHARGE' THEN
 0
WHEN 'HG_REPAYMENT' THEN
 0
ELSE
 SUM(source.trxamount)
END AS TRXAMOUNT,
SUM(source.srcfee) AS TRXSOURCEFEE,
SUM(source.srcfee) AS TRXFEE,
SUM(source.srcfee) AS NEWTRXFEE,
 CASE source.business_type
WHEN 'GATEWAY_FOREIGN_EXCHANGE' THEN
	0
WHEN 'ONLINE_PAY' THEN
	0
WHEN 'TRANSFER_DOMESTIC' THEN
	0
WHEN 'RZ_AUTH_USER' THEN
	0
WHEN 'RECHARGE' THEN
	0
ELSE
	SUM(source.accountingcost)
END AS ACCOUNTINGCOST,
CASE source.business_type
WHEN 'GATEWAY_FOREIGN_EXCHANGE' THEN
	0
WHEN 'ONLINE_PAY' THEN
	0
WHEN 'TRANSFER_DOMESTIC' THEN
	0
WHEN 'RZ_AUTH_USER' THEN
	0
WHEN 'RECHARGE' THEN
	0
ELSE
	SUM(source.accountingcost)
END AS NEWCOST,
CASE source.business_type
WHEN 'GATEWAY_FOREIGN_EXCHANGE' THEN
	0
WHEN 'ONLINE_PAY' THEN
	0
WHEN 'TRANSFER_DOMESTIC' THEN
	0
WHEN 'RZ_AUTH_USER' THEN
	0
WHEN 'RECHARGE' THEN
	0
ELSE
	SUM(source.accountingcost)
END AS NEWCOSTPREDICT,
'CBP' AS DATAORIGIN
FROM
	(SELECT
			sb.merchant_id AS customernumber,
			DATE(sb.complete_date_time) AS trxdate,
			sb.business_type,
			IFNULL(sb.order_amount, 0) AS trxamount,
			IFNULL(sb.fee, 0) AS srcfee,
			IFNULL(sb.cost_amount, 0) AS accountingcost,
			IFNULL(exchange_differences,0) AS ed
		FROM
			statis_business sb
		WHERE
			sb.business_type NOT IN ('OTHER')
		AND sb.status = 'SUCCESS'
	) AS source
WHERE source.trxdate >= ${START} AND source.trxdate < ${STOP} and source.customernumber not in ('120180215','120180217','120180212','120180218','120180213','120180214','120180216','120180219','120180220','120180221','120180222','120180323','120180324','120180325','120180331')
GROUP BY
	source.trxdate,
	source.business_type,
	source.customernumber",federated
crossborder,crossborderrefund1,"SELECT
        concat(gferr.merchant_id,date(gferr.complete_date_time),'crossborderrefund1') as IDNOUSE,
	CONCAT('999',gferr.merchant_id) AS RECEIVERID,
	date(gferr.complete_date_time) AS TRXDATE,
	year(date(gferr.complete_date_time))*100+month(date(gferr.complete_date_time)) as MONTH,
	'3011001003001' AS PRODUCT_CODE,
	'3011005001001A' AS SALES_PRODUCT_CODE,
        'Sales' as TYPE,
	'GATEWAY_FOREIGN_EXCHANGE' AS ORDERTYPE,
	'CBP' AS DATAORIGIN,
	0 AS REFUNDCOUNT,
	0 AS REFUNDAMOUNT
FROM
	gateway_foreign_exchange_refund_record gferr
WHERE
	gferr. STATUS = 'SUCCESS'
	AND gferr.complete_date_time >= ${START} and gferr.complete_date_time < ${STOP} and gferr.merchant_id not in ('120180215','120180217','120180212','120180218','120180213','120180214','120180216','120180219','120180220','120180221','120180222','120180323','120180324','120180325','120180331')
	GROUP BY
	gferr.merchant_id,
	date(gferr.complete_date_time)",federated
crossborder,crossborderrefund2,"SELECT
concat(mm.id,date(gtro.complete_date_time),'crossborderrefund2') as IDNOUSE,
	CONCAT('999',mm.id ) AS RECEIVERID,
	date(gtro.complete_date_time) AS TRXDATE,
	year(date(gtro.complete_date_time))*100+month(date(gtro.complete_date_time)) as MONTH,
	'3011005001001' AS PRODUCT_CODE,
	'3011005001001A' AS SALES_PRODUCT_CODE,
        'Sales' as TYPE,
	'TRANSFER_FOREIGN' AS ORDERTYPE,
	COUNT(1) AS REFUNDCOUNT,
	sum(gtrrr.revenue_amount) AS REFUNDAMOUNT
FROM
	gateway_transfer_refund_order gtro
LEFT JOIN gateway_transfer_refund_reexchange_record gtrrr ON gtro.id = gtrrr.transfer_refund_order_id
LEFT JOIN m_merchant mm ON mm.member_id = gtro.member_id
WHERE
	gtro.refund_status = 'SUCCESS'
	AND gtro.complete_date_time >= ${START} and gtro.complete_date_time < ${STOP} and mm.id not in ('120180215','120180217','120180212','120180218','120180213','120180214','120180216','120180219','120180220','120180221','120180222','120180323','120180324','120180325','120180331')
GROUP BY
	date(gtro.complete_date_time),
	mm.id",federated
ceshiceshi,ceshiceshi,"SELECT
COALESCE(CHAR(source.trxdate),'null')||COALESCE(CHAR(source.business_type),'null')||COALESCE(CHAR(source.customernumber),'null')||'crossbordertrx' as IDNOUSE,
	source.trxdate AS TRXDATE,
	source.business_type AS payproduct,
year(source.trxdate) * 100 + month(source.trxdate) AS month,
	(CASE WHEN source.business_type='GATEWAY_FOREIGN_EXCHANGE' THEN '3011005001001'
                    WHEN source.business_type='ONLINE_PAY' THEN '3011001004002'
WHEN source.business_type='TRANSFER_DOMESTIC' THEN '3011001004002'
WHEN source.business_type='RZ_AUTH_USER' THEN '3011004003001'
WHEN source.business_type='RECHARGE' THEN '3011001004002'
WHEN source.business_type='GATEWAY_FOREIGN_EXCHANGE_TRANSFER' THEN '3011005001001'
WHEN source.business_type='TRANSFER_FOREIGN' THEN '3011005001001'
WHEN source.business_type='FOREIGNPAY_EXCHANGESETTLEMENT' THEN '3011005001002'
WHEN source.business_type= 'TRANSFER_FOREIGN_RMB' THEN '3011005001003'
WHEN source.business_type='FOREIGNPAY_EXCHANGESETTLEMENT_CNY' THEN 'muyou'
WHEN source.business_type='HG_REPAYMENT' THEN '3011001004002'
WHEN source.business_type='HG_ORDER' THEN '3011001004002'
when source.business_type='TRANSFER_ACCOUNT' THEN '3011001004002'
END) AS product_code,
'3011005001001A' as sales_product_code,
source.business_type as ordertype,

 (CASE WHEN source.business_type='GATEWAY_FOREIGN_EXCHANGE' THEN 0
WHEN source.business_type='ONLINE_PAY' THEN 0
WHEN source.business_type='TRANSFER_DOMESTIC' THEN 0
WHEN source.business_type='RZ_AUTH_USER' THEN 0
WHEN source.business_type='RECHARGE' THEN 0
ELSE  count(1)
END) AS trxcount,

(CASE 
WHEN source.business_type='GATEWAY_FOREIGN_EXCHANGE' THEN 0
WHEN source.business_type='ONLINE_PAY' THEN 0
WHEN source.business_type='TRANSFER_DOMESTIC' THEN 0
WHEN source.business_type='RZ_AUTH_USER' THEN 0
WHEN source.business_type='RECHARGE' THEN 0
ELSE
	SUM(source.trxamount)
END) AS trxamount,

SUM(source.srcfee) AS TRXSOURCEFEE,

SUM(source.srcfee)+SUM(source.ed) AS trxfee,

 (CASE 
WHEN source.business_type='GATEWAY_FOREIGN_EXCHANGE' THEN 0
WHEN source.business_type='ONLINE_PAY' THEN 0
WHEN source.business_type='TRANSFER_DOMESTIC' THEN 0
WHEN source.business_type='RZ_AUTH_USER' THEN 0
WHEN 'source.business_type=RECHARGE' THEN 0
ELSE
	SUM(source.accountingcost)
END) AS accountingcost,
'CBP' AS DATAORIGIN
FROM
	(
		SELECT
		       sb.id AS id,
			sb.merchant_id AS customernumber,
		
			DATE(sb.complete_date_time) AS trxdate,
		
			sb.business_type,
		
			IFNULL(sb.order_amount, 0) AS trxamount,
	
			IFNULL(sb.fee, 0) AS srcfee,
	
			IFNULL(sb.cost_amount, 0) AS accountingcost,
		
			IFNULL(exchange_differences,0) AS ed
		FROM
			statis_business sb
		WHERE
			sb.business_type NOT IN ('OTHER')
		AND sb.`status` = 'SUCCESS'
	) AS source
WHERE source.trxdate >= ${START} AND source.trxdate < ${STOP}
GROUP BY
	source.business_type,
	source.customernumber,
        source.trxdate",federated
SALESBranchdaily,SALESBranchdailye,"select
  P.TRXDATE|| C.PRODUCTLINE || P.SALESNAME||E.NAME as IDNOUSE,
  sum(P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1)) as PROFIT ,
  sum(CASE WHEN (P.BIZTYPEID IN (29,129) and P.TRXTYPEID not in ('POSRENT','POSSALES')) THEN P.ACCOUNTINGPROFIT*coalesce(P.YEJISCALE,1) ELSE P.INNERINCOME*coalesce(P.YEJISCALE,1) END) as income ,
  sum(P.TRXCOUNT*coalesce(P.YEJISCALE,1)) as trxcount ,
  sum(CASE WHEN (P.BIZTYPEID IN (29,129) and P.TRXTYPEID not in ('POSRENT','POSSALES')) THEN 0 ELSE P.ACCOUNTINGCOST*coalesce(P.YEJISCALE,1) END) as accountcost,
  sum(P.TRXAMOUNT*coalesce(P.YEJISCALE,1)) as TRX_AMOUNT ,
  P.TRXDATE as DATA_PERIOD ,
  C.PRODUCTLINE as PRODUCTLINE ,
  P.SALESNAME as SALESNAME,
  coalesce(E.NAME,'_¨å_') as YEJISHUXING 
  from DB2INST1.PUBLISHEDDAILYTRX AS P
  left join DB2INST1.TRXSTATBUSINESSCATEGORIE AS B on 1=1 and P.BUSINESSCATID=B.ID 
  left join DB2INST1.TRXSTATSUBBUSINESSCATEGORIE AS S on 1=1 and P.SUBBUSINESSCAT=S.CODE 
  left join DB2INST1.CUSTOMERINFO AS C on 1=1 and P.RECEIVERID=C.ID 
  left join DB2INST1.PRODUCTCODE_PROFILE AS PP on 1=1 and P.PRODUCT_CODE=PP.PRODUCT_CODE and P.SALES_PRODUCT_CODE=PP.SALES_PRODUCT_CODE 
  left join DB2INST1.PRODUCTCODE AS PC on 1=1 and P.PRODUCT_CODE=PC.PRODUCTCODE and PC.PRODUCTTYPE=2 
  left join DB2INST1.PRODUCTCODE AS SPC on 1=1 and P.SALES_PRODUCT_CODE=SPC.PRODUCTCODE and SPC.PRODUCTTYPE=1 
  left join DB2INST1.EXISTENCE AS E on 1=1 and P.YEJISHUXING=E.ID and E.CLASSTYPE='Department'
  left join DB2INST1.TRXSTATTRXTYPE AS T on 1=1 and P.TRXTYPEID=T.ID 
  where 1=1
  and P.TRXDATE =${START}
  AND (
            C.PRODUCTLINE NOT IN ('ä¸_å¾__')
            AND C.PRODUCTLINE IS NOT NULL
  )
  AND (CASE
                    WHEN PP.ACCOUNTCLASS IS NULL
                    THEN 'çº¿ä_'
                    ELSE PP.ACCOUNTCLASS
                END) NOT IN('___è¡__')
  group by
  P.TRXDATE,
  C.PRODUCTLINE,
  P.SALESNAME,
  E.NAME
  with ur",reportdb_yjkh
COMMISSIONKJ,COMMISSIONKJ,"SELECT
concat(source.business_type,source.customernumber,'COMMISSIONKJ') as IDNOUSE,
CONCAT('999',source.customernumber ) AS RECEIVERID,
       year(source.complete_date_time)*100+month(source.complete_date_time) as MONTH,
last_day(date(${START})) as trxdate,
CASE source.business_type
WHEN 'GATEWAY_FOREIGN_EXCHANGE' THEN
	'3011005001001'
WHEN 'FOREIGN_EXCHANGE' THEN
	'3011005001001'
WHEN 'ONLINE_PAY' THEN
	'3011001004002'
WHEN 'TRANSFER_DOMESTIC' THEN
	'3011001004002'
WHEN 'RZ_AUTH_USER' THEN
	'3011004003001'
WHEN 'RECHARGE' THEN
	'3011001004002'
WHEN 'GATEWAY_FOREIGN_EXCHANGE_TRANSFER' THEN
	'3011005001001'
WHEN 'FOREIGN_EXCHANGE_TRANSFER' THEN
	'3011005001001'
WHEN 'TRANSFER_FOREIGN' THEN
	'3011005001001'
WHEN 'FOREIGNPAY_EXCHANGESETTLEMENT' THEN
	'3011005001002'
WHEN 'TRANSFER_FOREIGN_RMB' THEN
	'3011005001003'
WHEN 'TRANSFER_FOREIGN_CNY' THEN
	'3011005001003'
WHEN 'FOREIGNPAY_EXCHANGESETTLEMENT_CNY' THEN
	'3011005001004 '
WHEN 'HG_REPAYMENT' THEN
	'3011001004002'
WHEN 'HG_ORDER' THEN
	'3011001004002'
when 'TRANSFER_ACCOUNT' then
	'3011001004002'
END AS PRODUCT_CODE,
'COMMISSION_KJ' as TYPE,
source.business_type as ORDERTYPE,
'3011005001001A' as SALES_PRODUCT_CODE,
SUM(-source.realAgentFee) AS TRXFEE,
'CBP' AS DATAORIGIN
FROM
	(SELECT
			mab.merchant_id AS customernumber,
			DATE(mab.complete_date_time) AS complete_date_time,
			mab.business_type AS business_type,
			IFNULL(mab.real_agent_share, 0) AS realAgentFee
		FROM
			m_agent_trade_details mab 		
	) AS source
WHERE source.complete_date_time >= ${START} AND source.complete_date_time < ${STOP}
GROUP BY
	source.business_type,
	source.customernumber",federated
agentfrdata2,agentfrdata2e,"SELECT  D.ID AS DAILYTRXSTAT_ID,
D.RECEIVERID AS CUSTOMER_ID,
CU.CUSTOMERNUMBER AS CUSTOMER_NUM,
(D.TRXAMOUNT-D.REFUNDAMOUNT) AS TRX_TOTAL_AMOUNT,
(D.TRXCOUNT-D.REFUNDCOUNT) AS TRX_TOTAL_NUM,
D.REFUNDAMOUNT AS REFUND_TOTAL_AMOUNT,
D.REFUNDCOUNT AS REFUND_TOTAL_NUM,
D.TRXDATE AS TRX_DATE,
D.TRXCHANNELID AS PAY_INTERFACE_ID,
D.TRXFEE AS INCOME_TOTAL_AMOUNT,
D.FRPCOST AS COST_TOTAL_AMOUNT,
B.NAME AS BANK_CODE,
D.SALES_PRODUCT_CODE AS SALE_PRODUCT_CODE,
SP.PRODUCTNAME  AS SALE_PRODUCT_NAME,
'transferinday' AS BIZ_TYPE,
current_timestamp AS CREATE_TIME
FROM DB2INST1.DAILYTRXSTAT D LEFT JOIN DB2INST1.PRODUCTCODE SP ON D.SALES_PRODUCT_CODE=SP.PRODUCTCODE  LEFT JOIN DB2INST1.TRXSTATBIZTYPE B ON D.BIZTYPEID = B.ID  LEFT JOIN CUSTOMERINFO CU ON D.RECEIVERID=CU.ID
WHERE D.TYPE NOT IN ('COMMISSION', 'COMMISSION_HK', 'POSSHARECOST', 'COMMISSION_RJT', 'COMMISSION_RJTFUND') AND D.TRXDATE >= TRUNC(DATE(${START})-1 MONTHS,'MM') and D.TRXDATE  <= (TRUNC(DATE(${START}),'MM') - 1 days) AND CHAR(D.RECEIVERID) IN (SELECT CUSTOMER_ID FROM YBZFDM.TBL_AGENT_CUSTOMER) AND D.PRODUCT_CODE = '3011101001001' WITH UR",reportdb_read
agentfrMerchantdata,agentfrMerchantdatae,"select ID AS AID,
CUSTOMER_ID AS CUSTOMER_ID,
AGENT_ID AS AGENT_NUM,
current_timestamp AS CREATE_TIME 
from AGENTFR.TBL_AGENCY_RELATION with ur",agentfr
monthlytrxstat2017newincomecost,monthlytrxstat2017newincomecost,"select COALESCE(CHAR(d.product_code),'null')||
COALESCE(CHAR(d.sales_product_code),'null')||
COALESCE(CHAR(d.receiverid),'null')||
COALESCE(CHAR(d.bizTypeId),'null')||
COALESCE(CHAR(d.type),'null')||
COALESCE(CHAR(r.employeeid),'null')||
COALESCE(CHAR(c.productlineid),'null')||
COALESCE(CHAR(c.areaid),'null')||
COALESCE(CHAR(r.isSelf),'null')||
COALESCE(CHAR(r.isShare),'null')||
COALESCE(CHAR(r.shareScale),'null')||
COALESCE(CHAR(r.transfDate),'null')||
COALESCE(CHAR(c.productGroup),'null')||
COALESCE(CHAR(c.bussinessCatId),'null')||
COALESCE(CHAR(c.level),'null')||
COALESCE(CHAR(em.BRANCHCOMPANY),'null')||
COALESCE(CHAR(d.feetype),'null')||
COALESCE(CHAR(month(trxdate)),'null')||
COALESCE(CHAR(year(trxdate)),'null')||
COALESCE(CHAR(month(true_trxdate)),'null')||
COALESCE(CHAR(year(true_trxdate)),'null')||
COALESCE(CHAR(d.PAYERID),'null')||
COALESCE(CHAR(d.TRXCHANNELID),'null')||
COALESCE(CHAR(d.ORDERTYPE),'null')||
COALESCE(CHAR(d.ISCOMPUTEPROFIT),'null')||
COALESCE(CHAR(d.ISCOMPUTEBONUS),'null')||
COALESCE(CHAR(d.USETYPE),'null')||
COALESCE(CHAR(d.PAYPRODUCT),'null') as IDNOUSE,month(trxdate)+year(trxdate)*100 as month,month(true_trxdate)+year(true_trxdate)*100 as true_month,d.product_code,d.sales_product_code,d.receiverid as customerid,d.bizTypeId,d.type,coalesce(r.employeeid,25) as salesid,c.productlineid,c.areaid,c.productGroup,r.isSelf,r.isShare as issharecustomer,coalesce(r.shareScale,1) as salesscale,
r.transfDate,sum(newtrxFee)-sum(newrefundFee)-sum(agentfee) as newincome,
sum(newcost) as newcost,sum(managefee) as managefee,sum(externalcost) as externalcost,c.bussinessCatId as businessCatId,c.level as customerlevel,em.BRANCHCOMPANY,d.feetype,'RECEIVER' as customertype,d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT
  from DailyTrxStat d left join CustomerInfo c on d.receiverid=c.id
  left join CustomerRelationship r on r.customerid=d.receiverid
  left join employeeinfo em on r.EMPLOYEEID=em.ID
  where  d.ISCOMPUTEPROFIT=1 and trxdate>=${START} and trxdate<${STOP}  and (newtrxFee<>0 or newrefundFee<>0 or newcost<>0 or agentfee<>0 or managefee<>0 or externalcost<>0)
  group by d.product_code,d.sales_product_code,d.receiverid,d.bizTypeId,d.type,r.employeeid,c.productlineid,c.areaid,r.isSelf,r.isShare,r.shareScale,r.transfDate,c.productGroup,c.bussinessCatId,c.level,em.BRANCHCOMPANY,d.feetype,month(trxdate),year(trxdate),month(true_trxdate),year(true_trxdate),d.PAYERID,d.TRXCHANNELID,d.ORDERTYPE,d.ISCOMPUTEPROFIT,d.ISCOMPUTEBONUS,d.USETYPE,d.PAYPRODUCT with ur",reportdb
testtrade,testtradee,"SELECT 
		TT.NAME AS TRADE_NAME
		, DEC(SUM((D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE)),18,4) AS INCOME
		, DEC(SUM(D.ACCOUNTINGCOST*CS.SHARESCALE),18,4) AS COST
		,sum(D.AGENTFEE*CS.SHARESCALE) AS AGENTFEE
		, DEC(SUM(D.TRXFEE*CS.SHARESCALE-D.REFUNDFEE*CS.SHARESCALE-D.ACCOUNTINGCOST*CS.SHARESCALE-D.AGENTFEE*CS.SHARESCALE),18,4) AS PROFIT
		FROM DB2INST1.DAILYTRXSTAT D
		LEFT JOIN DB2INST1.CUSTOMERINFO CU ON D.RECEIVERID=CU.ID
		LEFT JOIN DB2INST1.TRXSTATTRXTYPE TT ON D.TYPE=TT.ID 
		LEFT JOIN TBL_CUSTOMER_RELATIONSHIP CS ON CU.ID=CS.CUSTOMER_ID AND CS.MONTH='2018-2_'
		LEFT JOIN TBL_EMPLOYEEINFO EM ON CS.EMPLOYEE_ID=EM.ID 
		WHERE 1=1 AND D.ISCOMPUTEBONUS=1
		AND D.TRXDATE between  '2018-02-01' AND '2018-02-28'
		AND EM.EMPLOYEE_NAME='å¼__èª' AND CU.PRODUCTLINE='_°é__ä¸_º¿__º¿ä¸'
		and (d.type not in ('POSRENT','POSSALES','ACTIVATIONFEE','SYSTEMFEE','SERVICEFEE') or d.type is null)
GROUP BY TT.NAME",reportdb_yjkh
tldbtltblordercomplaindataall,tldbtltblordercomplaindataall,"SELECT ID AS ID,
       ACC_TM AS ACC_TM,
       COMP_WAY AS COMP_WAY,
       COMP_SOU AS COMP_SOU,
       COMPER_CONT AS COMPER_CONT,
       SAL_NM AS SAL_NM,
       SUB_COMPY AS SUB_COMPY,
       ACC_PER AS ACC_PER,
       PROD_SOU AS PROD_SOU,
       MER_ORDERNO AS MER_ORDERNO,
       TRADE_SERIALNO AS TRADE_SERIALNO,
       MER_NO AS MER_NO,
       SIGN_NM AS SIGN_NM,
       MER_NM AS MER_NM,
       ORDER_AMT AS ORDER_AMT,
       TRADE_STS AS TRADE_STS,
       BNK_NO AS BNK_NO,
       OCC_TM AS OCC_TM,
       MOBL_NO AS MOBL_NO,
       BNK_NM AS BNK_NM,
       CHECK_TM AS CHECK_TM,
       CONT_INFO AS CONT_INFO,
       CONT_RESULT AS CONT_RESULT,
       COMP_INFO AS COMP_INFO,
       REMK AS REMK,
       CREATOR AS CREATOR,
       CRT_TM AS CRT_TM,
       MODIFIER AS MODIFIER,
       UPT_TM AS UPT_TM
  FROM TL.TBL_ORDERCOMPLAIN_DATA with ur",tldb
salesmaninfo,salesmaninfo,"select
ee.GONGHAO AS YEEPAYNUMBER,
ee.XINGMING AS SALESNAME,
ee.user_name AS SALESNAME_IN,
ee.yibaoxi AS BRANCHCOMPANY,
ee.bumen AS DEPARTMENT,
ee.zaizhizhuangtai  AS STATUS,
ee.ruzhiri AS HIREDATE,
ee.LIZHIRI AS LEAVEDATE
from db2inst1.ehr_employee_info ee left join db2inst1.employeeinfo e on ee.GONGHAO=e.emp_no 
where ee.xulie='S' 
with ur",reportdb_standby
riskchannel,riskchannel,"SELECT 
C.ID AS ID,
C.CODE AS CODE,
C.NAME AS  NAME,
C.STATUS AS STATUS,
C.BEAN_ID AS BEAN_ID,
C.BANK_CODE AS BANK_CODE,
C.CHANNEL_TYPE AS CHANNEL_TYPE,
C.TRADE_TYPE AS TRADE_TYPE,
C.ACCOUNT_TYPE AS ACCOUNT_TYPE,
C.CARD_TYPE AS CARD_TYPE,
C.BUSINESS_TYPE AS BUSINESS_TYPE,
C.ACCESS_BANK_TYPE AS ACCESS_BANK_TYPE,
C.INDUSTRIES,CE.SCENE_TYPE AS INDUSTRIES,CE.SCENE_TYPE,
CE.REQ_ITEM AS REQ_ITEM,
CE.OPT_ITEM AS OPT_ITEM,
CE.RNV_ITEM AS RNV_ITEM,
CE.PRIORITY AS PRIORITY,
CE.REPORT_TYPE AS REPORT_TYPE,
CE.IS_SIGN AS IS_SIGN,
CE.IS_BANK_SMS AS IS_BANK_SMS,
CE.IS_WHITE AS IS_WHITE,
CE.SUCCESS_RATE AS SUCCESS_RATE,
CE.RISK_LEVEL AS RISK_LEVEL,
CE.CARRIER_TYPE AS CARRIER_TYPE,
CE.SCENE_TYPE_EXT AS SCENE_TYPE_EXT,
CE.WEBSITE_BILL AS WEBSITE_BILL,
CE.WEBSITE_ABSTRACT AS WEBSITE_ABSTRACT,
CE.SMS_ABSTRACT AS SMS_ABSTRACT,
CE.COMMENT AS COMMENT,
(A.MIN_AMOUNT/100) AS MIN_AMOUNT,
(A.MAX_AMOUNT/100) AS MAX_AMOUNT
FROM ROUTER.TBL_BANK_CHANNEL C 
LEFT JOIN ROUTER.TBL_BANK_CHANNEL_EXT CE ON C.CODE=CE.CODE
LEFT JOIN ROUTER.TBL_CHANNEL_AMOUNT A ON C.CODE=A.CHANNEL_CODE",cashier_bank_standby
agentfrCalculation,agentfrCalculatione,"SELECT C.CUSTOMER_NUM,
C.AGENT_ID AS AGENT_ID,
'transferinday' AS BIZ_TYPE,
D.SALE_PRODUCT_NAME,
VALUE(D.TRX_TOTAL_AMOUNT,0.00) AS TRX_TOTAL_AMOUNT,
VALUE(D.TRX_TOTAL_NUM,0) AS TRX_TOTAL_NUM,
VALUE(D.TRX_INCOME_TOTAL_AMOUNT,0.00) AS TRX_INCOME_TOTAL_AMOUNT,
VALUE(D.COST_TOTAL_AMOUNT,0.00) AS COST_TOTAL_AMOUNT,
VALUE(ROUND((TRX_INCOME_TOTAL_AMOUNT-(TRX_TOTAL_NUM*RU.COST_RATIO*100))*RU.PROFIT_RATIO,2) ,0.00) AS PROFIT_AMOUNT,
TRUNC(DATE(${START})-1 MONTHS,'MM') AS TRX_START_DATE,
(TRUNC(DATE(${START}),'MM') - 1 days) AS TRX_END_DATE,
current_timestamp AS CREATE_TIME,
'NORMAL' AS PROFIT_TYPE,
'ACTIVE' AS STATUS,
C.CUSTOMER_NAME AS CUSTOMER_NAME
FROM AGENTFR.TBL_PROFIT_RULE RU,AGENTFR.TBL_AGENCY_RELATION AS C,
(select 
B.CUSTOMER_NUM AS CUSTOMER_NUM,
SALE_PRODUCT_NAME AS SALE_PRODUCT_NAME,
sum(TRX_TOTAL_AMOUNT) AS TRX_TOTAL_AMOUNT,
sum(TRX_TOTAL_NUM) AS TRX_TOTAL_NUM, 
sum(INCOME_TOTAL_AMOUNT) AS TRX_INCOME_TOTAL_AMOUNT, 
sum(COST_TOTAL_AMOUNT) AS COST_TOTAL_AMOUNT,
B.CUSTOMER_ID AS CUSTOMER_ID
from  (SELECT * FROM AGENTFR.TBL_AGENCY_RELATION WHERE STATE='ENABLE' AND AGENT_ID IN (2649,2728,2656,2687,2852,2681,2665,2733,2863,2908,2683,2890)) AS A LEFT JOIN AGENTFR.TBL_CUSTOMER_TRX_DATA_NEW AS B  on A.CUSTOMER_ID=B.CUSTOMER_ID
where  TRX_DATE >= TRUNC(DATE(${START})-1 MONTHS,'MM')  AND TRX_DATE <= (TRUNC(DATE(${START}),'MM') - 1 days)  AND B.BIZ_TYPE = 'transferinday' 
group by B.CUSTOMER_NUM,B.CUSTOMER_ID,B.SALE_PRODUCT_NAME) AS D 
WHERE  C.CUSTOMER_ID=D.CUSTOMER_ID AND RU.AGENT_ID=C.AGENT_ID AND C.STATE='ENABLE' AND C.AGENT_ID IN (2649,2728,2656,2687,2852,2681,2665,2733,2863,2908,2683,2890) AND RU.STATE='ENABLE'",agentfr_standby
riskFraudamt,re_bs,"SELECT ID as IDNOUSE, STATIC_TIME,MERCHANT_ID,PROVINCE_ID,GOODS_TYPE,BANK_ID,BIZ_CODE,SUCC_FRAUD_COUNT,SUCC_FRAUD_AMOUNT,TOTAL_FRAUD_COUNT,TOTAL_FRAUD_AMOUNT,HIT_COUNT,HIT_AMOUNT,CREATE_TIME,UPDATE_TIME FROM frms_portal_yp.report_ol_fraud_and_hit ",frms_portal_yp
tldbtltblmercomplaindataall,tldbtltblmercomplaindataall,"SELECT ID AS ID,
       ACC_TM AS ACC_TM,
       MER_NO AS MER_NO,
       MER_NM AS MER_NM,
       SIGN_NM AS SIGN_NM,
       REGT_TM AS REGT_TM,
       INDUSTRY AS INDUSTRY,
       SAL_NM AS SAL_NM,
       SUB_COMPY AS SUB_COMPY,
       MER_STS AS MER_STS,
       ACCT_STS AS ACCT_STS,
       AGENT_NO AS AGENT_NO,
       AGENT_NM AS AGENT_NM,
       DEAL_STS AS DEAL_STS,
       DEAL_RESULT AS DEAL_RESULT,
       REMK AS REMK,
       DEAL_REASON AS DEAL_REASON,
       INDUS_JUDGE AS INDUS_JUDGE,
       CHECK_RESULT AS CHECK_RESULT,
       CREATOR AS CREATOR,
       CRT_TM AS CRT_TM,
       MODIFIER AS MODIFIER,
       UPT_TM AS UPT_TM
  FROM TL.TBL_MERCOMPLAIN_DATA WITH UR",tldb
newtldbtltblrrs_checkseq,newtldbtltbl_rrs_checkseq,"SELECT ID AS ID,
       PROD AS PROD,
       BIZ AS BIZ,
       SEQ_ID AS SEQ_ID,
       MEC_NO AS MEC_NO,
       REFER AS REFER,
       IS_CHECK AS IS_CHECK,
       CRD_NO AS CRD_NO,
       ID_NO AS ID_NO,
       STATUS AS STATUS,
       RET_CODE AS RET_CODE,
       ERROR_CODE AS ERROR_CODE,
       CONSUME_TM AS CONSUME_TM,
       CT_TM AS CT_TM,
       MF_TM AS MF_TM,
       OCC_TM AS OCC_TM,
       EXT_INFO AS EXT_INFO,
       RET_MSG AS RET_MSG,
       WEBSITE AS WEBSITE,
       IS_WHITE AS IS_WHITE
  FROM TL.TBL_RRS_CHECKSEQ
 WHERE CT_TM >= ${START}
   AND CT_TM < ${STOP} WITH UR",tldb
newtldbtltblrrscheckseq,newtldbtltblrrscheckseq,"SELECT ID AS ID,
       PROD AS PROD,
       BIZ AS BIZ,
       SEQ_ID AS SEQ_ID,
       MEC_NO AS MEC_NO,
       REFER AS REFER,
       IS_CHECK AS IS_CHECK,
       CRD_NO AS CRD_NO,
       ID_NO AS ID_NO,
       STATUS AS STATUS,
       RET_CODE AS RET_CODE,
       ERROR_CODE AS ERROR_CODE,
       CONSUME_TM AS CONSUME_TM,
       CT_TM AS CT_TM,
       MF_TM AS MF_TM,
       OCC_TM AS OCC_TM,
       EXT_INFO AS EXT_INFO,
       RET_MSG AS RET_MSG,
       WEBSITE AS WEBSITE,
       IS_WHITE AS IS_WHITE
  FROM TL.TBL_RRS_CHECKSEQ
 WHERE CT_TM >= ${START}
   AND CT_TM < ${STOP} WITH UR",tldb
newtldbtltblmdayalarmmerchant,newtldbtltblmdayalarmmerchant,"SELECT ID AS ID,
       TRACE_ID AS TRACE_ID,
       MCT_NO AS MCT_NO,
       MCT_NAME AS MCT_NAME,
       SIGN_NAME AS SIGN_NAME,
       SIGN_URL AS SIGN_URL,
       INDUSTRY_ONE_CLASS AS INDUSTRY_ONE_CLASS,
       INDUSTRY_TWO_CLASS AS INDUSTRY_TWO_CLASS,
       SELLER_NO AS SELLER_NO,
       SELLER_NAME AS SELLER_NAME,
       BRANCH_COMP AS BRANCH_COMP,
       HIT_SUSPECT_FIELD AS HIT_SUSPECT_FIELD,
       HIT_SUSPECT_NUM AS HIT_SUSPECT_NUM,
       AT_ADD_SUSPECT_FIELD AS AT_ADD_SUSPECT_FIELD,
       AT_ADD_SUSPECT_NUM AS AT_ADD_SUSPECT_NUM,
       ND_ADD_SUSPECT_FIELD AS ND_ADD_SUSPECT_FIELD,
       ND_ADD_SUSPECT_NUM AS ND_ADD_SUSPECT_NUM,
       DEAL_ST AS DEAL_ST,
       ADD_SUSPECT_AUTO AS ADD_SUSPECT_AUTO,
       DEAL_ALARM_USER AS DEAL_ALARM_USER,
       BELONG_DAY AS BELONG_DAY,
       RANDOM_MARK AS RANDOM_MARK,
       CREATE_TIME AS CREATE_TIME,
       UPDATE_TIME AS UPDATE_TIME,
       UPDATE_USER AS UPDATE_USER
  FROM TL.tbl_m_day_alarm_merchant
 WHERE UPDATE_TIME >= ${START}
   AND UPDATE_TIME < ${STOP} WITH UR",tldb
newtldbtltblmdaycollectinfo,newtldbtltblmdaycollectinfo,"SELECT ID AS ID,
       TRACE_ID AS TRACE_ID,
       MCT_NO AS MCT_NO,
       FIELD_CODE AS FIELD_CODE,
       FIELD_VAL AS FIELD_VAL,
       SUSPECT_ST AS SUSPECT_ST,
       DEAL_RESULT AS DEAL_RESULT,
       DAY_ALARM_HIT AS DAY_ALARM_HIT,
       SUSPECT_ST_TM AS SUSPECT_ST_TM,
       SUSPECT_END_TM AS SUSPECT_END_TM,
       SET_TAGS AS SET_TAGS,
       REMARK AS REMARK,
       BELONG_DAY AS BELONG_DAY,
       CREATE_TIME AS CREATE_TIME,
       UPDATE_TIME AS UPDATE_TIME,
       UPDATE_USER AS UPDATE_USER
  FROM TL.TBL_M_DAY_COLLECT_INFO
 WHERE UPDATE_TIME >= ${START}
   AND UPDATE_TIME < ${STOP} WITH UR",tldb
newtldbtltblrlsruledata0,newtldbtltblrlsruledata0,"SELECT ID AS ID,
       RUL_CD AS RUL_CD,
       RUL_FACTORS AS RUL_FACTORS,
       EXP_TM AS EXP_TM,
       STS AS STS,
       RULE_VALUE AS RULE_VALUE
  FROM TL.TBL_RLS_RULEDATA
 WHERE RUL_TYP = '0' 
   AND RUL_CD LIKE 'b_global%' WITH UR",tldb
newtldbtltblrlsruledata2,newtldbtltblrlsruledata2,"SELECT ID AS ID,
       RUL_CD AS RUL_CD,
       RUL_FACTORS AS RUL_FACTORS,
       EXP_TM AS EXP_TM,
       STS AS STS,
       RULE_VALUE AS RULE_VALUE
  FROM TL.TBL_RLS_RULEDATA
 WHERE RUL_TYP = '2' WITH UR",tldb
newtldbtltblrlsruledata1,newtldbtltblrlsruledata1,"SELECT ID AS ID,
       RUL_CD AS RUL_CD,
       RUL_FACTORS AS RUL_FACTORS,
       EXP_TM AS EXP_TM,
       STS AS STS,
       RULE_VALUE AS RULE_VALUE
  FROM TL.TBL_RLS_RULEDATA
 WHERE RUL_TYP = '1' WITH UR",tldb
newtldbtltblmsuspectnamelist,newtldbtltblmsuspectnamelist,"SELECT ID AS ID,
       UNIQ_NAME_LIST_NO AS UNIQ_NAME_LIST_NO,
       TRACE_ID AS TRACE_ID,
       NAME_LIST_NO AS NAME_LIST_NO,
       FIELD_CODE AS FIELD_CODE,
       FIELD_VAL AS FIELD_VAL,
       TAGS AS TAGS,
       STATUS AS STATUS,
       START_TM AS START_TM,
       END_TM AS END_TM,
       REMARK AS REMARK,
       CREATE_USER AS CREATE_USER,
       CREATE_TIME AS CREATE_TIME,
       UPDATE_USER AS UPDATE_USER,
       UPDATE_TIME AS UPDATE_TIME
  FROM TL.tbl_m_suspect_name_list
 WHERE UPDATE_TIME >= ${START} 
   AND UPDATE_TIME < ${STOP} WITH UR",tldb
agentfrCalculationRecord,agentfrCalculationRecorde,"select AG.ID AS AGENT_ID,'transferinday' AS BIZ_TYPE,
YEAR(TRUNC(DATE(${START})-1 MONTHS,'MM')) AS PROFIT_YEAR,
MONTH(TRUNC(DATE(${START})-1 MONTHS,'MM')) AS PROFIT_MONTH,
VALUE(ATEMP.PROFIT_TOTAL_AMOUNT,0.00) AS PROFIT_TOTAL_AMOUNT,
VALUE(ATEMP.TRX_TOTAL_AMOUNT,0.00) AS TRX_TOTAL_AMOUNT,
VALUE(ATEMP.TRX_TOTAL_NUM,0) AS TRX_TOTAL_NUM,
VALUE(ATEMP.TRX_INCOME_TOTAL_AMOUNT,0.00) AS TRX_INCOME_TOTAL_AMOUNT,
CASE WHEN AG.INVOICE_TYPE='PERSONAL_WITHHOLDING_TAXES' THEN 
(CASE WHEN ATEMP.PROFIT_TOTAL_AMOUNT-ROUND((CASE WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 625000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.4 - 7000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 25000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.3 - 2000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 4000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.2 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 800 THEN (ATEMP.PROFIT_TOTAL_AMOUNT - 800) * 0.2 ELSE 0.00 END),2)>0 
THEN ATEMP.PROFIT_TOTAL_AMOUNT-ROUND((CASE WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 625000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.4 - 7000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 25000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.3 - 2000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 4000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.2 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 800 THEN (ATEMP.PROFIT_TOTAL_AMOUNT - 800) * 0.2 ELSE 0.00 END),2) 
ELSE 0.00 END)
ELSE VALUE(ATEMP.PROFIT_TOTAL_AMOUNT,0.00) END AS REAL_PROFIT_AMOUNT,
CASE WHEN AG.INVOICE_TYPE='PERSONAL_WITHHOLDING_TAXES' THEN ROUND((CASE WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 625000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.4 - 7000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 25000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.3 - 2000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 4000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.2 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 800 THEN (ATEMP.PROFIT_TOTAL_AMOUNT - 800) * 0.2 ELSE 0.00 END),2) ELSE 0.00 END AS TAX_WITHHOLDING,
AG.PROFIT_DIRECTION AS REMIT_DIRECTION,'CALCULATED' AS PROFIT_CONFIRM_STATE,
'TOREMIT' AS REMIT_STATE,current_timestamp AS PROFIT_TIME,AG.INVOICE_TYPE AS INVOICE_TYPE, 'INNER' AS DATATYPE,
'0.00' AS ADJUST_AMOUNT,'0' AS INVOICE,'1' AS VERSION,'0' AS BILL_CONFIRM
from AGENTFR.TBL_AGENT AS AG,
(SELECT A.*,(SELECT sum(PROFIT_AMOUNT) from AGENTFR.TBL_PROFIT_DETAIL where A.ID=AGENT_ID AND STATUS='ACTIVE' AND PROFIT_RECORD_ID IS NULL) AS PROFIT_TOTAL_AMOUNT,
(SELECT sum(TRX_TOTAL_AMOUNT) from AGENTFR.TBL_PROFIT_DETAIL where A.ID=AGENT_ID AND profit_record_id IS NULL) AS TRX_TOTAL_AMOUNT,
(SELECT sum(TRX_TOTAL_NUM) from AGENTFR.TBL_PROFIT_DETAIL where A.ID=AGENT_ID AND profit_record_id IS NULL) AS TRX_TOTAL_NUM,
(SELECT sum(TRX_INCOME_TOTAL_AMOUNT) from AGENTFR.TBL_PROFIT_DETAIL where A.ID=AGENT_ID AND profit_record_id IS NULL) AS TRX_INCOME_TOTAL_AMOUNT
FROM AGENTFR.TBL_AGENT AS A WHERE AGENCY_STATE = 'OPEN' AND PROFIT_DIRECTION = 'BANKCARD' AND ID IN (2649,2728,2656,2687,2852,2681,2665,2733,2863,2908,2683,2890)) AS ATEMP
WHERE AG.ID=ATEMP.ID AND AG.AGENCY_STATE = 'OPEN' AND AG.PROFIT_DIRECTION = 'BANKCARD' AND AG.ID IN (2649,2728,2656,2687,2852,2681,2665,2733,2863,2908,2683,2890)",agentfr_standby
frmsportalypramsolchecklist,frmsportalypramsolchecklist,"SELECT ID AS ID,
       CALL_STATUS AS CALL_STATUS,
       PRODUCT AS PRODUCT,
       REC_USER_ID AS REC_USER_ID,
       REC_USER_NAME AS REC_USER_NAME,
       ORDER_ID AS ORDER_ID,
       PAY_BANK_CARD_NO AS PAY_BANK_CARD_NO,
       BANK_NAME AS BANK_NAME,
       PAY_USER_PHONE AS PAY_USER_PHONE,
       CERTIF_ID AS CERTIF_ID,
       TRANS_VOL/1000 AS TRANS_VOL,
       RULE_CODE AS RULE_CODE,
       SCORE AS SCORE,
       RISK_LEVEL AS RISK_LEVEL,
       STATUS AS STATUS,
       BACK_UP AS BACK_UP,
       OPER_USER_ID AS OPER_USER_ID,
       UPDATE_TIME AS UPDATE_TIME,
       TRANS_TIME AS TRANS_TIME,
       SERVICE_STATE AS SERVICE_STATE,
       AUTHORITY_RESULT AS AUTHORITY_RESULT,
       BIZ_CODE AS BIZ_CODE
  FROM FRMS_PORTAL_YP.RAMS_OL_CHECKLIST
 WHERE TRANS_TIME >= ${START} 
   AND TRANS_TIME < ${STOP}",frms_portal_yp
frmsportalypoffchecklist,frmsportalypoffchecklist,"SELECT ID AS ID,
       MERCHANT_ID AS MERCHANT_ID,
       MERCHANT_NAME AS MERCHANT_NAME,
       AGENT_NO AS AGENT_NO,
       AGENT_NAME AS AGENT_NAME,
       MARKET AS MARKET,
       COMPANY AS COMPANY,
       TRANS_VOL/1000 AS TRANS_VOL,
       REQUEST_ID AS REQUEST_ID,
       CREATE_TIME AS CREATE_TIME,
       TRANS_TIME AS TRANS_TIME,
       COMPLETE_TIME AS COMPLETE_TIME,
       SCORE AS SCORE,
       RULE_CODE AS RULE_CODE,
       PRODUCE_WAY AS PRODUCE_WAY,
       RISK_TYPE AS RISK_TYPE,
       RISK_LEVEL AS RISK_LEVEL,
       RISK_QUALITATIVE AS RISK_QUALITATIVE,
       STATUS AS STATUS,
       UPDATE_TIME AS UPDATE_TIME,
       DEAL_USER AS DEAL_USER
  FROM FRMS_PORTAL_YP.OFF_CHECKLIST
 WHERE CREATE_TIME >= ${START} 
   AND CREATE_TIME < ${STOP}",frms_portal_yp
frmsportalypreportoldealcondition,frmsportalypreportoldealcondition,"SELECT ID AS ID,
       STATIC_TIME AS STATIC_TIME,
       TOTAL_COUNT AS TOTAL_COUNT,
       CASE_NUM AS CASE_NUM,
       LIMIT_NUM AS LIMIT_NUM,
       CASE WHEN COALESCE(TOTAL_COUNT,0) = 0 THEN 0 ELSE LIMIT_NUM/TOTAL_COUNT END AS LIMIT_RATE,
       BLACKLIST_NUM AS BLACKLIST_NUM,
       CREATE_TIME AS CREATE_TIME,
       BIZ_PRODUCT AS BIZ_PRODUCT,
       CARD_CATE AS CARD_CATE,
       BANK AS BANK,
       MERCHANT_ID AS MERCHANT_ID
  FROM FRMS_PORTAL_YP.REPORT_OL_DEAL_CONDITION
 WHERE CREATE_TIME >= ${START}
   AND CREATE_TIME < ${STOP}",frms_portal_yp
riskcustomerinfo,riskcustomerinfo32,"select 'baiweioutkill20161125' as baiweioutkill20161125,c.id as id,c.active,c.customerNumber,c.fullname,c.groupId,c.shortname,c.createDate,bc.name as businessCat,subBusinessCat,c.area,pf1.value as linkman,pf2.value as webUrl,pf.value as signedName,a.balance as accountBalance,ca.balance as creditBalance,ca.creditLimit,c.bindMobile as mobile,c.phone,date(si.lastsettledate) as lastsettledate, pf3.value as netSigned, c.productGroup,pf4.value as address,bc.id as bussinessCatId,pf5.value as province,si.cycleType as cycletype,si.reserveDays,coalesce(cg.grade,'') as gradelevel, 'NETSIGNED' as customertype,c.customerNumber as MERCHANTNO,a.balancelastupdatedate,cd.DOCUMENTNUMBER as legal_idcard,cd.DESCRIPTION as legal_name,pf6.value as audit_Status,a.status as account_status,r.BANKACTID as settle_bankaccount,r.province as settle_bankprovince,r.city as settle_bankcity,r.branchName as settle_bankbranch,ba.fullname as settle_bankname,r.accountName as settle_accountname,pf7.value as icp,c.customertype as signed_type   from Customer c left join profile pf on c.ID=pf.customer_id and pf.name='p_signedName'  left join profile pf1 on c.id=pf1.customer_id and pf1.name='p_linkman'  left join profile pf2 on c.id=pf2.customer_id and pf2.name='p_customerSiteUrl'  left join profile pf3 on c.id=pf3.customer_id and pf3.name='p_signed'  left join profile pf4 on c.id=pf4.customer_id and pf4.name='p_address'  left join profile pf5 on c.id=pf5.customer_id and pf5.name='p_province'  left join profile pf6 on c.id=pf6.customer_id and pf6.name='p_auditStatus' left join profile pf7 on c.ID=pf7.CUSTOMER_ID and pf7.NAME='p_icp' left join account a on (c.id=a.customer_id and a.classtype='LocalAccount' and a.localAccountType='SVA')  left join CreditAccount ca on (c.id=ca.customerId)  left join settlementinfo si on c.id=si.customer_id left join account r on si.bankAccount_id=r.id and r.classtype='RemoteAccount' left join bank ba on r.bank_id=ba.id left join BusinessCategorie  bc on bc.id=c.businessCat  left join customergradeinfo cg on c.id=cg.customerid and cg.status in ('WAITRESCORE','COMPLETE','NOQUESSCORE') left join customerdocinfo  cd on  (c.CUSTOMERNUMBER=cd.CUSTOMERNUMBER and  cd.DOCUMENTNAME='æ³_ººèº»½è¯')  where c.customerType='ENTERPRISE' and c.customerNumber is not null   with ur",COPY2
riskcustomerinfo,riskposagent,"select b.customer_number as CUSTOMERNUMBER,a.code as AGENTCODE,a.name as AGENTNAME,bt.type as AGENTTYPE from tbl_daili_agent a left join tbl_daili_agentrelation b on a.id=b.agent_id left join TBL_DAILI_AGENTBIZTYPE bt  on a.id=bt.AGENT_ID where b.status='ACTIVE' and b.customer_number is not null",opendb
riskcustomerinfo,risknetagent,"select customer_num as CUSTOMERNUMBER,num as AGENTCODE,name as AGENTNAME,'NET' as AGENTTYPE from agentfr.tbl_agency_relation ar left join agentfr.tbl_agent a on a.id = ar.agent_id where ar.state='ENABLE' and a.agency_state!='STOP' and customer_num is not null with ur",agentfr
riskcustomerinfo,riskposarea,"select c.CUSTOMER_NUMBER as CUSTOMERNUMBER,sheng.NAME as PROVINCE,shi.NAME as CITY from poswrite.TBL_POS_CUSTOMER c left join poswrite.TBL_POS_ORGANIZATION shi on c.ORG_CODE=shi.CODE left join poswrite.TBL_POS_ORGANIZATION sheng on shi.PARENT_CODE=sheng.CODE where c.CUSTOMER_NUMBER is not null ",opendb
riskcustomerinfo,riskposcount,"select b.customer_number as CUSTOMERNUMBER, count(*) as POSCOUNT from tbl_pos_pos a, tbl_pos_customer b where a.CUSTOMER_ID=b.id group by b.customer_number having b.customer_number is not null ",opendb
riskcustomerinfo,riskvmark,"select CUSTOMERNUMBER CUSTOMERNUMBER, coalesce(CUSTOMERLEVEL,'V') as VMARK from CUSTOMERGRADELEVEL where CUSTOMERNUMBER is not null with ur",COPY2
riskcustomerinfo,riskaccmark,"select customerExt.CUSTOMERNUMBER as CUSTOMERNUMBER,customerExt.PERFORMANCE_ATTRIBUTE as ACCMARK from SIGNING.TBL_CUSTOMER_EXT customerExt,SIGNING.TBL_PERFORMANCE_ATTRIBUTE attribute  where customerExt.PERFORMANCE_ATTRIBUTE=attribute.ATTRIBUTE_CODE and customerExt.customernumber is not null and customerExt.PERFORMANCE_ATTRIBUTE != '5' with ur",BOSS
riskcustomerinfo,riskmerchantno,"SELECT b.MERCHANT_NO as CUSTOMERNUMBER,a.sn as MERCHANTNO from SIGNING.tbl_yp_cus_info a , SIGNING.TBL_YP_CUS_MER_RELATION b where a.ID=b.TBL_YP_CUS_INFOID",BOSS
riskcustomerinfo,riskproductgroupzgt,"select CUSTOMERNUMBER, 'ZGT' as PRODUCTGROUP from customerext c left join customer cu on c.id=cu.id where c.zgt=1 and customernumber is not null with ur",COPY2
riskcustomerinfo,riskproductgrouptouzitong,"select MERCHANT_ACCOUNT_CODE as CUSTOMERNUMBER, 'TOUZITONG' as PRODUCTGROUP from EWALLET.merchant_to_goods where goods_id in(18,30) and MERCHANT_ACCOUNT_CODE is not null with ur",INNO
riskcustomerinfo,riskproductgroupshoukuanbao,"select distinct(MAINCUSTOMERNUMBER) as CUSTOMERNUMBER, 'SHOUKUANBAO' as PRODUCTGROUP from SKB.TBL_SKB_REGISTER union all select LEDGECUSTOMERNUMBER as CUSTOMERNUMBER, 'SHOUKUANBAO' as PRODUCTGROUP from SKB.TBL_SKB_REGISTER with ur",accnt
riskcustomerinfo,riskbranchcompany,"SELECT s.cust_id as CUSTOMERID, e.branchcompany as BRANCHCOMPANY FROM EmployeeInfo e LEFT JOIN employee2customer s ON e.id = s.emp_id WHERE s.cust_id IN(SELECT customerid FROM customerrelationship) ",reportdb
riskcustomerinfo,riskrelegation,"select CUSTOMER_NUMBER as CUSTOMERNUMBER, 'OFFLINE' as RELEGATION from poswrite.tbl_pos_customer ",opendb
riskcustomerinfo,riskcustomertype,"select CUSTOMER_ID,'ENTERPRISE' as CUSTOMERTYPE from PROFILE where name = 'p_signed' and value = '1' and value is not null with ur",COPY2
riskcustomerinfo,riskcustomercredentiallevel,"select  CUSTOMER_NUMBER as CUSTOMERNUMBER , CUSTOMER_LABEL_VALUE as CUSTOMER_CREDENTIAL_LEVEL 
from SIGNING.TBL_CUSTOMER_LABEL_ATTRIBUTE 
where CUSTOMER_LABEL='customer_credential_level'   
with ur",BOSS
riskcustomerinfo,riskcustomerinfomanage1,"select c.customernumber as CUSTOMERNUMBER,cd5.DOCUMENTNUMBER as business_licence,cd5.AVAILABDATA as business_licence_AVAILABDATE,cd4.DOCUMENTNUMBER as Unified_credit_no,cd4.AVAILABDATA as  Unified_credit_no_AVAILABDATE,cd7.DOCUMENTNUMBER as organization_no,cd7.AVAILABDATA as organization_no_AVAILABDATE,cd8.DOCUMENTNUMBER as tax_regist_no,ca.auditPassTime as audit_date,c.email as email
from mobilebe.CUSTOMER c 
left join mobilebe.customerdocinfo cd4 on cd4.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd4.DOCUMENTNAME='ç»__ç¤¾ä_ä¿¡ç_ä»£ç_' 
left join mobilebe.customerdocinfo cd5 on cd5.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd5.DOCUMENTNAME='_¥ä__§ç_' 
left join mobilebe.customerdocinfo cd7 on cd7.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd7.DOCUMENTNAME='ç»___ºæ_ä»£ç_è¯' 
left join mobilebe.customerdocinfo cd8 on cd8.CUSTOMERNUMBER=c.CUSTOMERNUMBER and cd8.DOCUMENTNAME='ç¨___»èè¯' 
left join mobilebe.CustomerAptitudeAduit ca on c.id=ca.customerid
with ur",COPY2
riskcustomerinfo,risksigneddate1,"select  customernumber as CUSTOMERNUMBER, min(STARTDATE) as SIGNED_DATE
from mobilebe.CONTRACTMANAGER 
group by customernumber
with ur",COPY2
riskcustomerinfo,riskcustomersalesname,"select  e.cust_id as ID,em.name as SALESNAME,em.id as SALESID 
from db2inst1.employee2customer e 
left join db2inst1.employeeinfo em on e.emp_id=em.id ",reportdb
riskcustomerinfo,riskcustomervipmark,"select  CUSTOMER_NUMBER as CUSTOMERNUMBER , case when CUSTOMER_LABEL_VALUE='SVIP' then 2 else 1 end as vipmark 
from SIGNING.TBL_CUSTOMER_LABEL_ATTRIBUTE 
where CUSTOMER_LABEL='customer_vip_level' and status=1 
with ur",BOSS
riskcustomerinfo,riskproductgroupewallet,"select customer_identity_no as customernumber,'EWALLET' as productgroup from zgt.TBL_CUSTOMER_CONFIG where BELONG = 'WALLET' with ur",dzh
riskcustomerinfo,riskskbagent,"SELECT LEDGECUSTOMERNUMBER as CUSTOMERNUMBER,MAINCUSTOMERNUMBER as AGENTCODE,'SKB' as AGENTTYPE FROM SKB.TBL_SKB_REGISTER WITH UR",accnt
riskcustomerinfo,risknobankcardcust,"select merchant_no as ID,merchant_no as CUSTOMERNUMBER,merchant_name as FULLNAME,'YEEYK' as PRODUCTGROUP from MERCHANT.T_MERCHANT_REGISTE",agentfr_mysql
riskcustomerinfo,riskpostpaid_payment_period,"SELECT 
CUSTOMER_NUMBER as CUSTOMERNUMBER,
integer(PAYMENT_PERIOD) as PRODUCTLINEID
FROM FEE.TBL_FRONT_FEE_CUSTOMER WHERE PAYMENT_PERIOD IS NOT NULL with ur",feedb
frmsportalypratemerchantvalueclob,frmsportalypratemerchantvalueclob,"SELECT T1.ID AS RATE_ID,
       T1.MERCHANT_ID AS MERCHANT_ID,
       T1.MERCHANT_NAME AS MERCHANT_NAME,
       T2.MODEL_ID AS MODEL_ID,
       T2.SCORE AS SCORE,
       T2.LEVEL AS LEVEL,
       T2.DETAIL_VALUE_ID AS DETAIL_VALUE_ID,
       T3.DETAIL_VALUE AS DETAIL_VALUE
  FROM FRMS_PORTAL_YP.RATE_MERCHANT T1
  LEFT JOIN FRMS_PORTAL_YP.RATE_MERCHANT_VALUE T2 ON T1.ID = T2.RATE_ID
  LEFT JOIN FRMS_PORTAL_YP.RATE_MERCHANT_CLOB T3 ON T2.DETAIL_VALUE_ID = T3.ID
 WHERE T1.CREATE_TIME >= ${START}
   AND T1.CREATE_TIME < ${STOP}",frms_portal_yp
riskcustomerinfo,riskmerchantext,"SELECT
  MERCHANT_NO AS CUSTOMERNUMBER,
  OFFICIAL_ACCOUNT_TEST_PASSWORD AS OFFICIAL_ACCOUNT_TEST_PASSWORD,
  OFFICIAL_ACCOUNT_TEST_ACCOUNT AS OFFICIAL_ACCOUNT_TEST_ACCOUNT,
 OFFICIAL_ACCOUNT_DOWNLOAD_URL AS OFFICIAL_ACCOUNT_DOWNLOAD_URL,
 OFFICIAL_ACCOUNT_NAME AS OFFICIAL_ACCOUNT_NAME,
 APP_TEST_PASSWORD AS APP_TEST_PASSWORD,
 APP_TEST_ACCOUNT AS APP_TEST_ACCOUNT,
 APP_DOWNLOAD_URL AS APP_DOWNLOAD_URL,
 APP_NAME AS APP_NAME 
  FROM CUSCENTER.TBL_MERCHANTEXT",dzh
riskcustomerinfo,riskcustomermerchant_status,"select 
CUSTOMER_NO AS MERCHANTNO,
STATUS AS MERCHANT_STATUS from CUSCENTER.TBL_CUSTOMERINFO",dzh
riskcustomerinfo,riskcustomerrole,"select
MERCHANT_NO AS customernumber, 
ROLE as CUSTOMER_ROLE from CUSCENTER.TBL_MERCHANTRELATION",dzh
riskcustomerinfo,riskcustomerlasttime,"SELECT
MERCHANT_NO AS customernumber, 
LAST_MODIFY_TIME as LAST_MODIFY_TIME FROM CUSCENTER.TBL_MERCHANT",dzh
riskcustomerinfo,riskcustomerinitgrade,"SELECT
CUSTOMERNUMBER as CUSTOMERNUMBER,
INITGRADE as INITGRADE FROM MOBILEBE.CUSTOMERGRADEINFO",COPY2
riskcustomerinfo,riskservicephone,"select
CUSTOMERNUMBER as CUSTOMERNUMBER,
SERVICEPHONE as SERVICEPHONE from MOBILEBE.MERCHANTINFO",COPY2
frmsportalypreportoltransandwarning,frmsportalypreportoltransandwarning,"SELECT T1.ID AS ID,
       T1.STATIC_TIME AS STATIC_TIME,
       T1.TAG AS TAG,
       T1.MERCHANT_ID AS MERCHANT_ID,
       T2.MERCHAT_NAME AS MERCHAT_NAME,
       T1.PROVINCE_ID AS PROVINCE_ID,
       T1.GOODS_TYPE AS GOODS_TYPE,
       T1.BANK_ID AS BANK_ID,
       T1.BIZ_CODE AS BIZ_CODE,
       T1.TOTAL_TRANS_COUNT AS TOTAL_TRANS_COUNT,
       T1.TOTAL_TRANS_AMOUNT/1000 AS TOTAL_TRANS_AMOUNT,
       T1.SUCC_TRANS_COUNT AS SUCC_TRANS_COUNT,
       T1.SUCC_TRANS_AMOUNT/1000 AS SUCC_TRANS_AMOUNT,
       T1.WARNING_COUNT AS WARNING_COUNT,
       T1.CREATE_TIME AS CREATE_TIME,
       T1.UPDATE_TIME AS UPDATE_TIME,
       T1.CASE_NUM AS CASE_NUM,
       T1.LIMIT_NUM AS LIMIT_NUM,
       T1.BLACKLIST_NUM AS BLACKLIST_NUM,
       CASE WHEN COALESCE(T1.TOTAL_TRANS_COUNT,0) = 0 THEN 0 ELSE CASE_NUM/TOTAL_TRANS_COUNT END AS INTERCEPT_RISK_RATE,
       T1.FRAUD_AMOUNT/1000 AS FRAUD_AMOUNT,
       T3.SUCC_FRAUD_COUNT AS SUCC_FRAUD_COUNT,
       CASE WHEN COALESCE(T1.SUCC_TRANS_COUNT,0) = 0 THEN 0 ELSE SUCC_FRAUD_COUNT/SUCC_TRANS_COUNT END AS SUCC_FRAUD_COUNT_RATE,
       T1.INTERCEPT_FRAUD_AMOUNT/1000 AS INTERCEPT_FRAUD_AMOUNT,
       CASE WHEN COALESCE(T1.SUCC_TRANS_AMOUNT,0) = 0 THEN 0 ELSE FRAUD_AMOUNT/SUCC_TRANS_AMOUNT END AS FRAUD_AMOUNT_RATE,
       CASE WHEN COALESCE(T1.FRAUD_AMOUNT,0) + COALESCE(T1.INTERCEPT_FRAUD_AMOUNT,0) = 0 THEN 0 ELSE INTERCEPT_FRAUD_AMOUNT/(FRAUD_AMOUNT + INTERCEPT_FRAUD_AMOUNT) END AS INTERCEPT_COVER_RATE
  FROM FRMS_PORTAL_YP.REPORT_OL_TRANS_AND_WARNING T1
  LEFT JOIN FRMS_DS_YP.MERCHANT T2 ON T1.MERCHANT_ID = T2.MERCHANT_ID
  LEFT JOIN FRMS_PORTAL_YP.REPORT_OL_FRAUD_AND_HIT T3 ON T1.STATIC_TIME = T3.STATIC_TIME AND T1.MERCHANT_ID = T3.MERCHANT_ID AND T1.PROVINCE_ID = T3.PROVINCE_ID AND T1.GOODS_TYPE = T3.GOODS_TYPE AND T1.BANK_ID = T3.BANK_ID AND T1.BIZ_CODE = T3.BIZ_CODE
 WHERE T1.CREATE_TIME >= ${START}
   AND T1.CREATE_TIME < ${STOP}",frms_portal_yp
exportNCErrororder,NCC,"select  coalesce(to_char(CREATE_TIME,'YYYY-MM-DD:HH24:mi'),'null')||
coalesce(char(ERROR_CODE),'null')||
coalesce(char(ERROR_MSG),'null')||'NCC' as IDNOUSE,TO_CHAR(CREATE_TIME,'YYYY-MM-DD:HH24:mi') AS ORDERTIME,count(*) AS ORDERCOUNT,ERROR_CODE AS ERROR_CODE,ERROR_MSG AS ERROR_MSG 
from NCC.TBL_NC_PAY_ORDER 
where create_time >= ${START} AND create_time < ${STOP}
group by to_char(CREATE_TIME,'YYYY-MM-DD:HH24:mi'),ERROR_CODE, ERROR_MSG",INNO_STANBY
newtldbtltblremitasynreqcurrent,newtldbtltblremitasynreqcurrent,"SELECT ID AS ID,
       PROD AS PROD,
       BIZ AS BIZ,
       REQ_ID AS REQ_ID,
       MEC_NO AS MEC_NO,
       AMT AS AMT,
       TOTAL_AMT AS TOTAL_AMT,
       SPLIT_ORDER AS SPLIT_ORDER,
       RID AS RID,
       BNK_ID AS BNK_ID,
       CRD_NO AS CRD_NO,
       CT_TM AS CT_TM,
       OCC_TM AS OCC_TM,
       REMIT_TM AS REMIT_TM,
       REMIT_BATCH_NO AS REMIT_BATCH_NO,
       REMIT_NO AS REMIT_NO,
       REMIT_SCENE AS REMIT_SCENE,
       BNK_CRD_NAME AS BNK_CRD_NAME,
       ACCOUNT_TYPE AS ACCOUNT_TYPE,
       TRADE_RESULT AS TRADE_RESULT,
       PAY_TM AS PAY_TM,
       PROD_MSG AS PROD_MSG,
       CASE WHEN GOODS_IF = '' OR GOODS_IF IS NULL THEN 'A' ELSE GOODS_IF END AS GOODS_IF,
       IF_ENCRY AS IF_ENCRY
  FROM TL.TBL_REMIT_ASYNREQ
 WHERE CT_TM >= ${START}
   AND CT_TM < ${STOP} WITH UR",tldb
getAllMembers,getAllMemberse,"select 
m.MEMBER_NO as IDNOUSE,
m.MEMBER_NO as MEMBER_NO,
m.REG_TYPE as REG_TYPE,
m.STATUS as STATUS,
m.LEVEL as LEVEL,
m.MEMBER_TYPE as MEMBER_TYPE,
m.PLATFORM_ID as PLATFORM_ID,
m.MEMBER_CATEGORY as MEMBER_CATEGORY,
m.VERIFY_WAY_NUM as VERIFY_WAY_NUM,
m.RISK_LEVEL as RISK_LEVEL,
m.CERT_AUTH_STATUS as CERT_AUTH_STATUS,
r.ACCOUNT_NO as ACCOUNT_NO, 
r.ACCOUNT_TYPE as ACCOUNT_TYPE
from MEMBER.tbl_member m left join MEMBER.TBL_MEMBER_ACCOUNT_R r on m.MEMBER_NO = r.MEMBER_NO where m.CA_STATUS in('VERIFIED','HIGH_VERIFIED') WITH UR",member_standby
newtldbtltblrrsreq,newtldbtltblrrsreq,"SELECT COALESCE(T1.REQ_ID,'NULL')||COALESCE(T1.PROD,'NULL')||COALESCE(T1.BIZ,'NULL')||COALESCE(T1.MEC_NO,'NULL')||TO_CHAR(T1.OCC_TM,'YYYYMMDDHH24MISS') AS REQ_ID_OCC_TM_CHAR,
      T1.ID AS ID,
      T1.REQ_ID AS REQ_ID,
      T1.SEQ_ID AS SEQ_ID,
      T1.RID AS RID,
      T1.PROD AS PROD,
      T1.BIZ AS BIZ,
      T1.USE_TOOL AS USE_TOOL,
      T1.BNK_ID AS BNK_ID,
      T1.CRD_NO AS CRD_NO,
      T1.CRD_AREA AS CRD_AREA,
      T1.CRD_TYP AS CRD_TYP,
      T1.AMT AS AMT,
      T1.MOBILE AS MOBILE,
      T1.MOBILE_AREA AS MOBILE_AREA,
      T1.USR_ID AS USR_ID,
      T1.PAY_ID AS PAY_ID,
      T1.MEC_NO AS MEC_NO,
      T1.USR_IP AS USR_IP,
      T1.USR_IP_AREA AS USR_IP_AREA,
      T1.OCC_TM AS OCC_TM,
      T1.TOOLS_IF AS TOOLS_IF,
      CASE WHEN T1.GOODS_IF = '' OR T1.GOODS_IF IS NULL THEN 'A' ELSE T1.GOODS_IF END AS GOODS_IF,
      T1.RTS_TM AS RTS_TM,
      T1.RTS_RETDESC AS RTS_RETDESC,
      T1.RLSB_TM AS RLSB_TM,
      T1.RLSB_RETDESC AS RLSB_RETDESC,
      T1.RLSW_TM AS RLSW_TM,
      T1.RLSW_RETDESC AS RLSW_RETDESC,
      T1.RDS_TM AS RDS_TM,
      T1.RDS_RETDESC AS RDS_RETDESC,
      T1.DOORGOD_TM AS DOORGOD_TM,
      T1.DOORGOD_RETDESC AS DOORGOD_RETDESC,
      T1.DOORGOD_RETCODE AS DOORGOD_RETCODE,
      T1.PREPARE_TM AS PREPARE_TM,
      T1.CHK_TM AS CHK_TM,
      T1.RK_IP AS RK_IP,
      T1.SUB_SYS AS SUB_SYS,
      T1.CT_TM AS CT_TM,
      T1.MF_TM AS MF_TM,
      T1.CHK_RETDESC AS CHK_RETDESC,
      T1.PREPARE_RETDESC AS PREPARE_RETDESC,
      T1.FIRST_PAY AS FIRST_PAY,
      T1.GOODS_NM AS GOODS_NM,
      T1.SUB_PROD_ID AS SUB_PROD_ID,
      T1.RGS_RETDESC AS RGS_RETDESC,
      T1.RGS_TM AS RGS_TM,
      T1.RBS_RETDESC AS RBS_RETDESC,
      T1.RBS_TM AS RBS_TM,
      T1.RET_SWITCH AS RET_SWITCH,
      T1.RLSG_RETDESC AS RLSG_RETDESC,
      T1.RLSG_TM AS RLSG_TM,
      T1.RETCODE AS RETCODE,
      T1.BANGSUN_TRIGERRULE AS BANGSUN_TRIGERRULE,
      T1.PAYWAY AS PAYWAY,
      T1.TRADE_SRC AS TRADE_SRC,
      T1.PARAM_TYP AS PARAM_TYP,
      T1.MERCHANT_RETCODE AS MERCHANT_RETCODE,
      T1.IF_ENCRY AS IF_ENCRY
 FROM TL.TBL_RRS_SYNREQ_201803 T1
WHERE 
'etlnokill123123123'='etlnokill123123123' and 
T1.CT_TM >= ${START}
  AND T1.CT_TM < ${STOP} WITH UR",his5
newtldbtltblofflinereq,newtldbtltblofflinereq,"SELECT T1.ID AS ID,
T1.REQ_ID AS REQ_ID,
T1.SEQ_ID AS SEQ_ID,
T1.RID AS RID,
T1.PROD AS PROD,
T1.BIZ AS BIZ,
T1.BNK_ID AS BNK_ID,
T1.CRD_NO AS CRD_NO,
T1.CRD_TYP AS CRD_TYP,
T1.AMT AS AMT,
T1.PAY_ID AS PAY_ID,
T1.MEC_NO AS MEC_NO,
T1.USR_IP AS USR_IP,
T1.OCC_TM AS OCC_TM,
CASE WHEN T1.GOODS_IF = '' OR T1.GOODS_IF IS NULL THEN 'A' ELSE T1.GOODS_IF END AS GOODS_IF,
CASE WHEN T1.REQ_IF = '' OR T1.REQ_IF IS NULL THEN 'A' ELSE T1.REQ_IF END AS REQ_IF,
T1.RTS_TM AS RTS_TM,
T1.RTS_RETDESC AS RTS_RETDESC,
T1.RLSB_TM AS RLSB_TM,
T1.RLSB_RETDESC AS RLSB_RETDESC,
T1.RLSW_TM AS RLSW_TM,
T1.RLSW_RETDESC AS RLSW_RETDESC,
T1.RDS_TM AS RDS_TM,
T1.RDS_RETDESC AS RDS_RETDESC,
T1.DOORGOD_TM AS DOORGOD_TM,
T1.DOORGOD_RETDESC AS DOORGOD_RETDESC,
T1.DOORGOD_RETCODE AS DOORGOD_RETCODE,
T1.PREPARE_TM AS PREPARE_TM,
T1.CHK_TM AS CHK_TM,
T1.RK_IP AS RK_IP,
T1.SUB_SYS AS SUB_SYS,
T1.PREPARE_RETDESC AS PREPARE_RETDESC,
T1.RLSG_TM AS RLSG_TM,
T1.RGS_TM AS RGS_TM,
T1.RLSG_RETDESC AS RLSG_RETDESC,
T1.RGS_RETDESC AS RGS_RETDESC,
T1.CHK_RETDESC AS CHK_RETDESC,
T1.RBS_RETDESC AS RBS_RETDESC,
T1.RBS_TM AS RBS_TM,
T1.RETCODE AS RETCODE,
T1.BANGSUN_TRIGERRULE AS BANGSUN_TRIGERRULE,
T1.MERCHANT_RETCODE AS MERCHANT_RETCODE,
T1.ORDER_TYPE AS ORDER_TYPE,
T1.ORDER_TM AS ORDER_TM,
T1.CURRENCY_TYPE AS CURRENCY_TYPE,
T1.POS_TERMINAL_NO AS POS_TERMINAL_NO,
T1.POS_REQUEST_NO AS POS_REQUEST_NO,
T1.POS_BATCH_NO AS POS_BATCH_NO,
T1.POS_NETWORK_NO AS POS_NETWORK_NO,
T1.POS_OPERATOR AS POS_OPERATOR,
T1.CARD_MATERIAL AS CARD_MATERIAL,
T1.BANK_CODE AS BANK_CODE,
T1.TRADE_PRODUCT AS TRADE_PRODUCT,
T1.OPERATE_SE_CODE AS OPERATE_SE_CODE,
T1.PASSWORD_TYPE AS PASSWORD_TYPE,
T1.GOODS_CODE AS GOODS_CODE,
T1.CT_TM AS CT_TM,
T1.MF_TM AS MF_TM,
T1.IF_ENCRY AS IF_ENCRY,
T2.PAY_RESULT AS PAY_RESULT,
T2.PAY_TM AS PAY_TM,
T2.PAY_CD AS PAY_CD,
T2.SYN_ERR_CD AS SYN_ERR_CD,
T2.BANK_SEQ AS BANK_SEQ,
T2.BANK_ORDERNO AS BANK_ORDERNO,
T2.FRP_CODE AS FRP_CODE,
T2.ORIG_PAY_TID AS ORIG_PAY_TID,
T2.BANK_ERROR AS BANK_ERROR,
T2.POSP_RESP_CODE AS POSP_RESP_CODE,
T2.CORE_PLAT_OD_ST AS CORE_PLAT_OD_ST,
T2.BANK_MERCHANT_NO AS BANK_MERCHANT_NO,
T2.ACQUIRER_BANK AS ACQUIRER_BANK,
T2.BANK_PRODUCT_CODE AS BANK_PRODUCT_CODE,
T2.BANK_INTF_ID AS BANK_INTF_ID,
T2.AREA32_MSG AS AREA32_MSG,
T2.AREA32_CODE AS AREA32_CODE,
T2.CT_TM AS A_CT_TM,
T2.MF_TM AS A_MF_TM
FROM tl.tbl_offline_synreq T1
JOIN tl.tbl_offline_asynreq T2 ON T1.PROD = T2.PROD AND T1.BIZ = T2.BIZ AND T1.MEC_NO = T2.MEC_NO AND T1.PAY_ID = T2.ORIG_PAY_TID
WHERE 
'etlnokill123123123'='etlnokill123123123' and 
T1.ORDER_TM >= ${START}
  AND T1.ORDER_TM < ${STOP}
  AND T1.ORDER_TYPE = 'SALE'
  AND T2.ORDER_TM >= ${START}
  AND T2.ORDER_TM < ${STOP} WITH UR",tldb
tlcustomerinfo,tlcustomerinfotrx,"select ID,ACCOUNTBALANCE,CREDITBALANCE,CREDITLIMIT from customerinfo",reportdb
ncMerchantErrorCodeCount,NCC1,"select  coalesce(to_char(CREATE_TIME,'YYYY-MM-DD:HH24:mi'),'null')||
coalesce(char(ERROR_CODE),'null')||
coalesce(char(ERROR_MSG),'null')||
coalesce(char(MERCHANT_NO),'null')||
coalesce(char(BIZ),'null')||
coalesce(char(CASHIER_ID),'null')||'NCC1' as IDNOUSE,
TO_CHAR(CREATE_TIME,'YYYY-MM-DD:HH24:mi') AS ORDERTIME,
count(*) AS ORDERCOUNT,ERROR_CODE AS ERROR_CODE,ERROR_MSG AS ERROR_MSG,
merchant_no as MERCHANT_NO,
CASHIER_ID AS CASHIER_ID,
biz AS BIZ from NCC.TBL_NC_PAY_ORDER 
where create_time >= ${START} AND create_time < ${STOP} AND CASHIER_ID IS NOT NULL 
group by TO_CHAR(CREATE_TIME,'YYYY-MM-DD:HH24:mi'),ERROR_CODE,ERROR_MSG,merchant_no,biz,CASHIER_ID
",INNO_STANBY
ncBankChannelError,NCC2,"select
coalesce(to_char(CREATE_TIME,'YYYY-MM-DD:HH24:mi'),'null')||
coalesce(char(BANK_ERROR),'null')||
coalesce(char(BANK_MSG),'null')||
coalesce(char(FRP_CODE),'null')|| 'NCC2' as IDNOUSE,
to_char(CREATE_TIME,'YYYY-MM-DD:HH24:mi') AS ORDERTIME,
count(*)  AS ORDERCOUNT,
BANK_ERROR AS BANK_ERROR,
BANK_MSG AS BANK_MSG,
frp_code AS FRP_CODE
from NCC.TBL_NC_PAY_ORDER
where create_time >= ${START} AND create_time < ${STOP}
group by
to_char(CREATE_TIME,'YYYY-MM-DD:HH24:mi'),
BANK_ERROR,
BANK_MSG,
frp_code

",INNO_STANBY
RiskMerchantProductlineProfit,RiskMerchantProductlineProfite,"select
t.SIGNED_NAME ||  t.SALESNAME AS IDNOUSE,
t.DATA_PERIOD,
t.SIGNED_NAME,
t.SALESNAME,
t.PRODUCTLINE,
t.TRX_AMOUNT,
t.PROFIT,
T.RANK,
  CASE
        WHEN TMP.BEFORE_RANK-RANK= 0
        THEN '__¹³'
        WHEN TMP.BEFORE_RANK- RANK < 0
        THEN 'ä¸__'
        ELSE 'ä¸__'
    END AS RANK_CHANGE,
CURRENT TIMESTAMP AS CREATE_TIME
from 
(
SELECT
 row_number() over(partition by(PRODUCTLINE) order by PROFIT desc)  AS RANK,
DATA_PERIOD,
SIGNED_NAME,
SALESNAME,
PRODUCTLINE,
TRX_AMOUNT,
PROFIT
FROM
TBL_OPERATION_ANALYSIS_TRX_MERCHANT 
WHERE DATA_PERIOD=${START}
) T
LEFT JOIN
(
select
SIGNED_NAME,
row_number() over(partition by(PRODUCTLINE) order by PROFIT desc) as BEFORE_RANK
from TBL_OPERATION_ANALYSIS_TRX_MERCHANT 
WHERE DATA_PERIOD=date(${START}) - 1 day
) tmp
ON  tmp.SIGNED_NAME=t.SIGNED_NAME
where 
T.RANK <=10",reportdb_yjkh
newtldbtltblrrsreq,newtldbtltblrrsasynreq,"SELECT COALESCE(T2.REQ_ID,'NULL')||COALESCE(T2.PROD,'NULL')||COALESCE(T2.BIZ,'NULL')||COALESCE(T2.MEC_NO,'NULL')||TO_CHAR(T2.OCC_TM,'YYYYMMDDHH24MISS') AS REQ_ID_OCC_TM_CHAR,
      T2.PAY_RESULT AS PAY_RESULT,
      T2.PAY_TM AS PAY_TM,
      T2.PAY_CD AS PAY_CD,
      T2.SYN_CON_TM AS SYN_CON_TM,
      T2.SYN_ERR_CD AS SYN_ERR_CD,
      T2.BIZORDER AS BIZORDER,
      T2.BANK_SEQ AS BANK_SEQ,
      T2.BANK_ORDERNO AS BANK_ORDERNO,
      T2.ORDER_TYPE AS ORDER_TYPE,
      CASE WHEN T2.REQ_IF = '' OR T2.REQ_IF IS NULL THEN 'A' ELSE T2.REQ_IF END AS REQ_IF,
      T2.FRP_CODE AS FRP_CODE
 FROM TL.TBL_RRS_ASYNREQ_201803 T2
WHERE 
'etlnokill123123123'='etlnokill123123123' and 
T2.CT_TM >= ${START}
  AND T2.CT_TM < ${STOP} WITH UR",his5
RiskComplaintSum,RiskComplaintSumE,"SELECT
ACC_TM AS IDNOUSE,
ACC_TM AS DATA_PERIOD,
CURRENT TIMESTAMP AS CREATE_TIME
FROM
TL.TBL_ORDERCOMPLAIN_DATA
WHERE ACC_TM=${START}",fkjs
RiskComplaint,RiskComplaintE,"SELECT
ACC_TM AS DATA_PERIOD,
PRODUCTLINE,
999999999 AS TRX_SUM,
COUNT(1) AS COMPLAINT_SUM,
CURRENT TIMESTAMP AS CREATE_TIME
FROM
TBL_RISK_COMPLAINT_BASE 
WHERE ACC_TM=${START}
GROUP BY PRODUCTLINE,ACC_TM",reportdb_yjkh
riskcomplaintsum1,riskcomplaintsum1e,"SELECT
ACC_TM AS IDNOUSE,
ACC_TM AS DATA_PERIOD,
PRODUCTLINE,
CURRENT TIMESTAMP AS CREATE_TIME
FROM
TL.TBL_ORDERCOMPLAIN_DATA
WHERE ACC_TM=${START}",fkjs
RiskComplaintBase,RiskComplaintBaseE,"SELECT 
ID AS IDNOUNSE
,ACC_TM
,COMP_WAY
,COMP_SOU
,COMPER_CONT
,SAL_NM
,SUB_COMPY
,ACC_PER
,PROD_SOU
,MER_ORDERNO
,TRADE_SERIALNO
,MER_NO
,MER_NO AS SIGN_NM
,MER_NM
,ORDER_AMT
,TRADE_STS
,BNK_NO
,OCC_TM
,MOBL_NO
,BNK_NM
,CHECK_TM
,CONT_INFO
,CONT_RESULT
,COMP_INFO
,REMK
,CREATOR
,CRT_TM
,MODIFIER
,UPT_TM
,MER_NO AS PRODUCTLINE
 FROM
TL.TBL_ORDERCOMPLAIN_DATA
where CRT_TM >= ${START} AND CRT_TM < DATE(${START})+1 DAY",fkjs
RiskComplaintBase,RiskComplaintBaseE2,"SELECT 
CUSTOMERNUMBER  AS MER_NO,
SIGNEDNAME AS SIGN_NM,
PRODUCTLINE
FROM
DB2INST1.CUSTOMERINFO
",reportdb_read
RiskComplaint,RiskComplaintE2,"SELECT 
C.PRODUCTLINE,
CASE WHEN 
 SUM(
t.TRXCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-t.REFUNDCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)
)=0
THEN 888888888
ELSE
SUM(
t.TRXCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-t.REFUNDCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)
)
END
 AS TRX_SUM
FROM DB2INST1.DAILYTRXSTAT T 
LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND T.RECEIVERID=C.ID
LEFT JOIN
            CUSTOMERRELATIONSHIP AS E2C
        ON
            1=1
        AND c.ID=E2C.CUSTOMERID
        LEFT JOIN
            customer2achievement AS c2a
        ON
            1=1
        AND c.customernumber=c2a.customer_number
WHERE TRXDATE =${START}
GROUP BY C.PRODUCTLINE",reportdb_read
RiskComplaintMerchant,RiskComplaintMerchantE,"SELECT
DATE(ACC_TM) AS DATA_PERIOD,
T.MER_NO AS CUSTOMER_NO,
T.SIGN_NM AS SIGN_NAME,
T.PRODUCTLINE,
T.COMPLAINT_SUM,
T.COMPLAINT_AMOUNT,
T.MER_NO AS TRADE_SUM,
BANK_COMPLAINT_SUM,
YL_COMPLAINT_SUM,
KF_COMPLAINT_SUM,
OTHER_COMPLAINT_SUM,
CURRENT TIMESTAMP AS CREATE_TIME
FROM
(select
MER_NO,
SIGN_NM,
PRODUCTLINE,
COUNT(1) AS COMPLAINT_SUM,
SUM(ORDER_AMT) AS COMPLAINT_AMOUNT
FROM
TBL_RISK_COMPLAINT_BASE
where ACC_TM=${START}
GROUP BY MER_NO
) t
left join
(
select
MER_NO,
COUNT(1) AS BANK_COMPLAINT_SUM
FROM
TBL_RISK_COMPLAINT_BASE
where ACC_TM=${START}
AND PROD_SOU='_¶è'
GROUP BY MER_NO
) t2
ON t.MER_NO=t2.MER_NO
left join
(
select
MER_NO,
COUNT(1) AS YL_COMPLAINT_SUM
FROM
TBL_RISK_COMPLAINT_BASE
where ACC_TM=${START}
AND PROD_SOU='_¶è_'
GROUP BY MER_NO
) t3
ON t.MER_NO=t3.MER_NO
left join
(
select
MER_NO,
COUNT(1) AS KF_COMPLAINT_SUM
FROM
TBL_RISK_COMPLAINT_BASE
where ACC_TM=${START}
AND PROD_SOU='å®¢æ_'
GROUP BY MER_NO
) t4
ON t.MER_NO=t4.MER_NO
left join
(
select
MER_NO,
COUNT(1) AS OTHER_COMPLAINT_SUM
FROM
TBL_RISK_COMPLAINT_BASE
where ACC_TM=${START}
AND PROD_SOU='_¶ä_'
GROUP BY MER_NO
) t5
ON t.MER_NO=t5.MER_NO
ORDER BY COMPLAINT_SUM DESC
FETCH FIRST 10 ROW ONLY",reportdb_yjkh
RiskComplaintMerchant,RiskComplaintMerchantE2,"SELECT 
C.CUSTOMERNUMBER AS CUSTOMER_NO,
COUNT(1)  AS TRADE_SUM
FROM DB2INST1.DAILYTRXSTAT T 
LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND T.RECEIVERID=C.ID
WHERE TRXDATE =${START}
GROUP BY C.PRODUCTLINE",reportdb_read
RiskComplaintMerchanSum,RiskComplaintMerchanSumE,"SELECT
DATE(ACC_TM) AS DATA_PERIOD,
T.MER_NO AS CUSTOMER_NO,
T.SIGN_NM AS SIGN_NAME,
T.PRODUCTLINE,
COALESCE(T.COMPLAINT_SUM,0) AS COMPLAINT_SUM,
T.COMPLAINT_AMOUNT,
999999999 AS TRADE_SUM,
COALESCE(T2.BANK_COMPLAINT_SUM,0) AS BANK_COMPLAINT_SUM,
COALESCE(T3.YL_COMPLAINT_SUM,0) AS YL_COMPLAINT_SUM,
COALESCE(T4.KF_COMPLAINT_SUM,0) AS KF_COMPLAINT_SUM,
COALESCE(T5.OTHER_COMPLAINT_SUM,0) AS OTHER_COMPLAINT_SUM,
'0' AS MARK,
CASE WHEN T.COMPLAINT_SUM<TR.COMPLAINT_SUM THEN 'ä¸__'
WHEN T.COMPLAINT_SUM=TR.COMPLAINT_SUM THEN '__¹³'
ELSE 'ä¸__' END AS COMPLAINT_CHANGE,
row_number() over(ORDER BY T.COMPLAINT_SUM DESC) AS COMPLAINT_RANK,
CURRENT TIMESTAMP AS CREATE_TIME
FROM
(select
tr1.ACC_TM,
tr1.MER_NO,
tr1.SIGN_NM,
tr1.PRODUCTLINE,
COUNT(1) AS COMPLAINT_SUM,
SUM(ORDER_AMT) AS COMPLAINT_AMOUNT
FROM
TBL_RISK_COMPLAINT_BASE tr1
where ACC_TM=${START}
GROUP BY MER_NO,PRODUCTLINE,SIGN_NM,ACC_TM
) t
left join
(
select
MER_NO,
COUNT(1) AS BANK_COMPLAINT_SUM
FROM
TBL_RISK_COMPLAINT_BASE
where ACC_TM=${START}
AND COMP_SOU='_¶è'
GROUP BY MER_NO
) t2
ON t.MER_NO=t2.MER_NO
left join
(
select
MER_NO,
COUNT(1) AS YL_COMPLAINT_SUM
FROM
TBL_RISK_COMPLAINT_BASE
where ACC_TM=${START}
AND COMP_SOU ='_¶è_'
GROUP BY MER_NO
) t3
ON t.MER_NO=t3.MER_NO
left join
(
select
MER_NO,
COUNT(1) AS KF_COMPLAINT_SUM
FROM
TBL_RISK_COMPLAINT_BASE
where ACC_TM=${START}
AND COMP_SOU ='å®¢æ_'
GROUP BY MER_NO
) t4
ON t.MER_NO=t4.MER_NO
left join
(
select
MER_NO,
COUNT(1) AS OTHER_COMPLAINT_SUM
FROM
TBL_RISK_COMPLAINT_BASE
where ACC_TM=${START}
AND COMP_SOU ='_¶ä_'
GROUP BY MER_NO
) t5
ON t.MER_NO=t5.MER_NO
LEFT JOIN TBL_RISK_COMPLAINT_MERCHANT TR
ON T.MER_NO=TR.CUSTOMER_NO AND TR.DATA_PERIOD=DATE(${START}) - 1 DAY
ORDER BY t.COMPLAINT_SUM DESC",reportdb_yjkh
RiskComplaintMerchanSum,RiskComplaintMerchanSumE2,"SELECT 
C.CUSTOMERNUMBER AS CUSTOMER_NO,
CASE WHEN 
 SUM(
t.TRXCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-t.REFUNDCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)
)=0
THEN 888888888
ELSE
SUM(
t.TRXCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-t.REFUNDCOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)
)
END
 AS TRADE_SUM
FROM DB2INST1.DAILYTRXSTAT T 
LEFT JOIN
            DB2INST1.CUSTOMERINFO AS C
        ON
            1=1
        AND T.RECEIVERID=C.ID
  LEFT JOIN
            CUSTOMERRELATIONSHIP AS E2C
        ON
            1=1
        AND c.ID=E2C.CUSTOMERID
        LEFT JOIN
            customer2achievement AS c2a
        ON
            1=1
        AND c.customernumber=c2a.customer_number
WHERE TRXDATE =  ${START}
AND C.CUSTOMERNUMBER IS NOT NULL
GROUP BY C.CUSTOMERNUMBER",reportdb_read
tldbtltblmerjudgeresultdata,tldbtltblmerjudgeresultdata,"SELECT ID AS ID,
       TRADE_TM AS TRADE_TM,
       MER_NO AS MER_NO,
       MER_NM AS MER_NM,
       SIGN_NM AS SIGN_NM,
       REGT_TM AS REGT_TM,
       SALE AS SALE,
       SUB_COMPY AS SUB_COMPY,
       MER_STS AS MER_STS,
       ACCT_STS AS ACCT_STS,
       URL AS URL,
       INDUSTRY AS INDUSTRY,
       SECOND_INDUS AS SECOND_INDUS,
       MER_LEVEL AS MER_LEVEL,
       INDUS_PROPERTY AS INDUS_PROPERTY,
       LINEON_OR_LINEOFF AS LINEON_OR_LINEOFF,
       ACTUALSERV_JUDGE AS ACTUALSERV_JUDGE,
       COUNTSERV_JUDGE AS COUNTSERV_JUDGE,
       REMK AS REMK,
       CREATOR AS CREATOR,
       CRT_TM AS CRT_TM,
       MODIFIER AS MODIFIER,
       UPT_TM AS UPT_TM
FROM TL.TBL_MERJUDGE_RESULTDATA WITH UR",tldb
agentDetailMonthData,agentDetailMonthDatae,"SELECT CONCAT(CONCAT(D.ID,(CASE WHEN DC.ID IS NULL THEN 0 ELSE DC.ID END)),PR.ID) AS DID,
A.NUM AS AGENT_NO, 
A.NAME AS AGENT_NAME, 
A.SALES_NAME AS SALES_NAME, 
PR.PROFIT_RATIO AS PROFIT_PERCENT, 
PR.COST_RATIO AS AGENT_FEE, 
SUBSTR(A.SALES_EMAIL,1, CASE WHEN LOCATE('@',A.SALES_EMAIL) = 0 THEN LENGTH(A.SALES_EMAIL) ELSE LOCATE('@',A.SALES_EMAIL)-1 END ) AS SALES_EMAIL, CASE PF.FORMULA WHEN '#TRXINCOMETOTALAMOUNT * #PROFITRATIO' THEN '___å­___·æ__*_ºå_æ¯__ï¼' WHEN '#TRXINCOMETOTALAMOUNT * #PROFITRATIO' THEN '___å­___·æ__*_ºå_æ¯__ï¼' WHEN '#TRXINCOMETOTALAMOUNT - (#TRXTOTALAMOUNT * #COSTRATIO)' THEN '___å­___·æ__-å­___·äº¤__*_ºå_æ¯_____ï¼' WHEN '#TRXTOTALAMOUNT * #PROFITRATIO' THEN '___å­___·äº¤__ï¼______æ¬¾é_é¢__* __¶¦æ¯__' WHEN '#TRXTOTALAMOUNT * #PROFITRATIO' THEN '___å­___·äº¤__ï¼______æ¬¾é_é¢__* __¶¦æ¯__' WHEN '#TRXTOTALAMOUNT*#PROFITRATIO' THEN '___å­___·äº¤__ï¼______æ¬¾é_é¢__* __¶¦æ¯__' WHEN '#TRXTOTALAMOUNT*#SIGNRATIO + #SIGNFIXEDVALUE-#COSTFIXEDVALUE' THEN '___å­___·æ__*_ºå_æ¯__ï¼' WHEN '#TRXTOTALNUM * #PROFITRATIO' THEN '_(äº¤æ__»ç__°ï__æ¬¾æ»ç__°ï_*__¶¦æ¯__' WHEN '#TRXTOTALNUM < 1 ? 0 : (#TRXINCOMETOTALAMOUNT - (#TRXTOTALNUM * #COSTRATIO))' THEN '_______¶å_ï¼(äº¤æ__»ç__°ï__æ¬¾æ»ç__°ï_*___è´¹ç_' WHEN '(#TRXINCOMETOTALAMOUNT-#TRXTOTALAMOUNT*#COSTRATIO)*#PROFITRATIO' THEN '___å­___·æ__¥ï_äº¤æ___*___è´¹ç_ï¼*__¶¦æ¯__' WHEN '(#TRXINCOMETOTALAMOUNT-(#TRXTOTALAMOUNT*#COSTRATIO))*#PROFITRATIO' THEN '___å­___·æ__¥ï_äº¤æ___*___è´¹ç_ï¼*__¶¦æ¯__' ELSE PF.FORMULA END AS PROFIT_EXPRESSION, 
MC.CALC_FORMULA_MEMO AS NEW_PROFIT_EXPRESSION, 
D.CUSTOMER_NUM AS CUSTOMER_NO, 
D.CUSTOMER_NAME AS CUSTOMER_NAME, 
BT.BIZ_TYPE_NAME AS PROFIT_BIZ, 
D.SALE_PRODUCT_NAME AS ACCOUNTING_PRODUCT, 
R.PROFIT_YEAR AS PROFIT_YEAR, 
R.PROFIT_MONTH AS PROFIT_MONTH, 
D.PROFIT_AMOUNT AS PROFIT_AMOUNT, 
CASE A.PRODUCTION_LINE WHEN 'salesCenter' THEN '__¸­å¿' WHEN 'airTravel' THEN '__äº___' WHEN 'digital' THEN '_°å_çº' WHEN 'education' THEN '___è¡__çº' WHEN 'productCenter' THEN 'äº§å_ä¸_' WHEN 'telecommunication' THEN '_µä¿¡è¡__çº' WHEN 'newRetail' THEN '_°é__ä¸_º¿' WHEN 'qm' THEN '_±éº¦äº___' ELSE A.PRODUCTION_LINE END AS PRODUCTLINE, 
D.TRX_START_DATE AS START_TIME, 
D.TRX_END_DATE AS END_TIME, 
D.TRX_TOTAL_AMOUNT AS TRX_AMOUNT, 
D.TRX_TOTAL_NUM AS TRX_COUNT, 
D.TRX_INCOME_TOTAL_AMOUNT AS INCOME, 
D.COST_TOTAL_AMOUNT AS COST, 
D.TRX_INCOME_TOTAL_AMOUNT-D.COST_TOTAL_AMOUNT AS PROFIT, 
CASE D.PROFIT_TYPE WHEN 'NORMAL' THEN 'æ­£å¸¸' WHEN 'SUPPLEMENT' THEN 'è¡¥è_' ELSE D.PROFIT_TYPE END AS PROFIT_TYPE, 
D.DESCRIPTION AS PROFIT_DESCRITION, 
CASE A.TYPE WHEN 'RESOURCES' THEN 'èµ___' WHEN 'ADVISER' THEN 'é¡¾é__' WHEN 'RESOURCES_SD' THEN 'èµ___-_£æ_ä¸__' WHEN 'RESOURCES_O2O' THEN '____-_°é__-_¶å_è¡__çº' WHEN 'STRATEGY_HJ' THEN '____-äº__è¡__çº' WHEN 'RESOURCES_HJ' THEN 'èµ___-äº__è¡__çº' WHEN 'STRATEGY_XJ' THEN '____-æ¶__è¡__çº' WHEN 'RESOURCES_XJ' THEN 'èµ___-æ¶__è¡__çº'  WHEN 'NEWRETAIL_MT' THEN '_°é__-___' WHEN 'NEWRETAIL_DLB' THEN '_°é__-___å®' ELSE A.TYPE END AS AGENT_TYPE, 
DC.ADJUST_AMOUNT AS ADJUST_AMOUNT, 
CASE WHEN DC.ADJUST_AMOUNT IS NULL THEN 0.00 ELSE DC.ADJUST_AMOUNT END + ( CASE WHEN D.PROFIT_AMOUNT IS NULL THEN 0.00 ELSE D.PROFIT_AMOUNT END) AS REAL_PROFIT_AMOUNT,
(CASE WHEN D.TRX_INCOME_TOTAL_AMOUNT-D.COST_TOTAL_AMOUNT=0.00 THEN 0.00 ELSE ( CASE WHEN DC.ADJUST_AMOUNT IS NULL THEN 0.00 ELSE DC.ADJUST_AMOUNT END + CASE WHEN D.PROFIT_AMOUNT IS NULL THEN 0.00 ELSE D.PROFIT_AMOUNT END)/(D.TRX_INCOME_TOTAL_AMOUNT-D.COST_TOTAL_AMOUNT) END) AS REAL_PROFIT_COST_PERCENT
FROM AGENTFR.TBL_PROFIT_RECORD R 
LEFT JOIN AGENTFR.TBL_PROFIT_DETAIL D ON R.ID=D.PROFIT_RECORD_ID 
LEFT JOIN AGENTFR.TBL_AGENT A ON D.AGENT_ID=A.ID 
LEFT JOIN AGENTFR.TBL_PROFIT_RULE PR ON D.BIZ_TYPE=PR.BIZ_TYPE AND D.AGENT_ID=PR.AGENT_ID 
LEFT JOIN AGENTFR.TBL_PROFIT_FORMULA PF ON PR.BIZ_TYPE=PF.BIZ_TYPE AND PR.PROFIT_MODEL=PF.PROFIT_MODEL 
LEFT JOIN AGENTFR.TBL_ADJUST_RECORD AR ON D.AGENT_ID=AR.AGENT_ID AND D.BIZ_TYPE=AR.BIZ_TYPE AND CONCAT(CONCAT(R.PROFIT_YEAR,'-'), CASE LENGTH(R.PROFIT_MONTH) WHEN 1 THEN '0'||R.PROFIT_MONTH ELSE R.PROFIT_MONTH END)=AR.FINISH_YEAR_MONTH 
LEFT JOIN AGENTFR.TBL_ADJUST_DETAIL_CUS DC ON AR.ID=DC.ADJUST_RECORD_ID AND D.CUSTOMER_NUM=DC.CUSTOMER_NUM 
LEFT JOIN AGENTFR.TBL_BIZ_TYPE BT ON D.BIZ_TYPE=BT.BIZ_TYPE_NUM 
LEFT JOIN AGENTFR.TBL_PROFIT_MODEL_CONFIG MC ON PR.PROFIT_MODEL_NEW=MC.PROFIT_MODEL 
WHERE R.PROFIT_YEAR=YEAR(TRUNC(DATE(${START})-1 MONTHS,'MM')) AND R.PROFIT_MONTH=MONTH(TRUNC(DATE(${START})-1 MONTHS,'MM')) AND R.PROFIT_CONFIRM_STATE='CALCULATED' AND A.PRODUCTION_LINE NOT IN ('digital', 'telecommunication', 'airTravel') AND PR.STATE='ENABLE' AND D.STATUS='ACTIVE' with ur",agentfr_standby
agentDetailMonthData1,agentDetailMonthData1e,"SELECT D.ID AS DID,A.NUM AS AGENT_NO, A.NAME AS AGENT_NAME, A.SALES_NAME AS SALES_NAME, SUBSTR(A.SALES_EMAIL,1, CASE WHEN LOCATE('@',A.SALES_EMAIL) = 0 THEN LENGTH(A.SALES_EMAIL) ELSE LOCATE('@',A.SALES_EMAIL)-1 END ) AS SALES_EMAIL, D.CUSTOMER_NUM AS CUSTOMER_NO, D.CUSTOMER_NAME AS CUSTOMER_NAME, BT.BIZ_TYPE_NAME AS PROFIT_BIZ, D.SALE_PRODUCT_NAME AS ACCOUNTING_PRODUCT, R.PROFIT_YEAR AS PROFIT_YEAR, R.PROFIT_MONTH AS PROFIT_MONTH, D.PROFIT_AMOUNT AS PROFIT_AMOUNT, CASE A.PRODUCTION_LINE WHEN 'salesCenter' THEN '__¸­å¿' WHEN 'airTravel' THEN '__äº___' WHEN 'digital' THEN '_°å_çº' WHEN 'education' THEN '___è¡__çº' WHEN 'productCenter' THEN 'äº§å_ä¸_' WHEN 'telecommunication' THEN '_µä¿¡è¡__çº' WHEN 'newRetaili' THEN '_°é__ä¸_º¿' WHEN 'qm' THEN '_±éº¦äº___' ELSE A.PRODUCTION_LINE END AS PRODUCTLINE, D.TRX_START_DATE AS START_TIME, D.TRX_END_DATE AS END_TIME, D.TRX_TOTAL_AMOUNT AS TRX_AMOUNT, D.TRX_TOTAL_NUM AS TRX_COUNT, D.TRX_INCOME_TOTAL_AMOUNT AS INCOME, D.COST_TOTAL_AMOUNT AS COST, D.TRX_INCOME_TOTAL_AMOUNT-D.COST_TOTAL_AMOUNT AS PROFIT, CASE D.PROFIT_TYPE WHEN 'NORMAL' THEN 'æ­£å¸¸' WHEN 'SUPPLEMENT' THEN 'è¡¥è_' ELSE D.PROFIT_TYPE END AS PROFIT_TYPE, D.DESCRIPTION PROFIT_DESCRITION, CASE A.TYPE WHEN 'RESOURCES' THEN 'èµ___' WHEN 'ADVISER' THEN 'é¡¾é__' WHEN 'RESOURCES_SD' THEN 'èµ___-_£æ_ä¸__' WHEN 'RESOURCES_O2O' THEN '____-_°é__-_¶å_è¡__çº' WHEN 'STRATEGY_HJ' THEN '____-äº__è¡__çº' WHEN 'RESOURCES_HJ' THEN 'èµ___-äº__è¡__çº' WHEN 'STRATEGY_XJ' THEN '____-æ¶__è¡__çº' WHEN 'RESOURCES_XJ' THEN 'èµ___-æ¶__è¡__çº' WHEN 'NEWRETAIL_MT' THEN '_°é__-___' WHEN 'NEWRETAIL_DLB' THEN '_°é__-___å®' ELSE A.TYPE END AS AGENT_TYPE, DC.ADJUST_AMOUNT AS ADJUST_AMOUNT, CASE WHEN DC.ADJUST_AMOUNT IS NULL THEN 0.00 ELSE DC.ADJUST_AMOUNT END + ( CASE WHEN D.PROFIT_AMOUNT IS NULL THEN 0.00 ELSE D.PROFIT_AMOUNT END) AS REAL_PROFIT_AMOUNT, 
(CASE WHEN D.TRX_INCOME_TOTAL_AMOUNT-D.COST_TOTAL_AMOUNT=0.00 THEN 0.00 ELSE ( CASE WHEN DC.ADJUST_AMOUNT IS NULL THEN 0.00 ELSE DC.ADJUST_AMOUNT END + CASE WHEN D.PROFIT_AMOUNT IS NULL THEN 0.00 ELSE D.PROFIT_AMOUNT END)/(D.TRX_INCOME_TOTAL_AMOUNT-D.COST_TOTAL_AMOUNT) END )AS REAL_PROFIT_COST_PERCENT,
'' AS AGENT_FEE,
'' AS PROFIT_EXPRESSION,
'' AS NEW_PROFIT_EXPRESSION, 
'' AS PROFIT_PERCENT
FROM AGENTFR.TBL_PROFIT_RECORD R 
LEFT JOIN AGENTFR.TBL_PROFIT_DETAIL D ON R.ID=D.PROFIT_RECORD_ID 
LEFT JOIN AGENTFR.TBL_AGENT A ON D.AGENT_ID=A.ID 
LEFT JOIN AGENTFR.TBL_ADJUST_RECORD AR ON D.AGENT_ID=AR.AGENT_ID AND D.BIZ_TYPE=AR.BIZ_TYPE AND CONCAT(CONCAT(R.PROFIT_YEAR,'-'), CASE LENGTH(R.PROFIT_MONTH) WHEN 1 THEN '0'||R.PROFIT_MONTH ELSE R.PROFIT_MONTH END)=AR.FINISH_YEAR_MONTH 
LEFT JOIN AGENTFR.TBL_ADJUST_DETAIL_CUS DC ON AR.ID=DC.ADJUST_RECORD_ID AND D.CUSTOMER_NUM=DC.CUSTOMER_NUM 
LEFT JOIN AGENTFR.TBL_BIZ_TYPE BT ON D.BIZ_TYPE=BT.BIZ_TYPE_NUM 
WHERE R.PROFIT_YEAR=YEAR(TRUNC(DATE(${START})-1 MONTHS,'MM')) AND R.PROFIT_MONTH=MONTH(TRUNC(DATE(${START})-1 MONTHS,'MM')) AND R.PROFIT_CONFIRM_STATE='CALCULATED' AND A.PRODUCTION_LINE IN('digital','telecommunication','airTravel') AND D.STATUS='ACTIVE'",agentfr_standby
riskPortraitData,rp_e1,"select tmr.MER_NO AS MERCHANT_ID,tmr.COUNTSERV_JUDGE AS CATEGORY,cr.SIGNEDNAME AS MERCHANT_NAME,cr.PRODUCTLINE AS ACHIVE_TYPE,
cr.CREATEDATE AS IN_TIME,BUSINESSCAT AS CATEGORY_1,SUBBUSINESSCATNAME AS CATEGORY_2,
VARCHAR_FORMAT(current TIMESTAMP,'yyyy-mm-dd') AS BUSINESS_DATE,VARCHAR_FORMAT(current TIMESTAMP,'yyyy-mm-dd')||'_'||tmr.MER_NO AS INSERT_MARK,
timestampdiff(64, char(timestamp(current TIMESTAMP) - timestamp(cr.CREATEDATE))) AS MERCHANT_DURATION,
current TIMESTAMP AS START_TIME
from 
(select MER_NO,COUNTSERV_JUDGE from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in 
(select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨') 
tmr 
join TL.CUSTOMERINFO_RISK cr 
on tmr.MER_NO = cr.CUSTOMERNUMBER 
with ur",fkjs
riskPortraitData,rp_e4,"select MERCHANT_ID,sum(TRADE_NUM) AS TRADE_NUM from 
(
select trr.MEC_NO AS MERCHANT_ID,SUM(trr.AMT) AS TRADE_AMOUNT,count(trr.ID) AS TRADE_NUM
from TL.tbl_rrs_req trr 
where trr.prod not in('ACCOUNT','G3MEMBER_TRANSFER' ,'G3MEMBER_WITHDRAW','G3MEMBER_PAYMENT','SETTLEMENT')
and trr.OCC_TM >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.OCC_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.PAY_RESULT='1'
and trr.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨') 
group by trr.MEC_NO
union all
select tor.MEC_NO AS MERCHANT_ID,SUM(tor.AMT) AS TRADE_AMOUNT,count(tor.ID) AS TRADE_NUM
from TL.tbl_offline_req tor 
where tor.ORDER_TM >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and tor.ORDER_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and tor.PAY_RESULT='1'
and tor.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨') 
group by tor.MEC_NO
) as TRADE_RESULT
group by MERCHANT_ID
with ur",fkjs
riskPortraitData,rp_e5,"select sev_tra.MERCHANT_ID,
(CASE 
WHEN yes_tra.TRADE_AMOUNT = 0 THEN NULL
ELSE CAST((yes_tra.TRADE_AMOUNT - sev_tra.TRADE_AMOUNT/7) AS DOUBLE)/yes_tra.TRADE_AMOUNT
END) AS TRADE_DAILY_RATE  
from 
(select cu.customernumber AS MERCHANT_ID,SUM(TRXAMOUNT) AS TRADE_AMOUNT
from dailytrxstat d
left join customerinfo cu on d.RECEIVERID=cu.id
where 1=1
and d.PRODUCT_CODE not in 
('3011002001001','3011101001001','3011002002001','3011101002001','3011004003001','3011004003002','3011001004004','3011005002001','3011001004001','3011005001001','3011005001003','3011001004002','3011001004003')
and d.TRXDATE >= (date(${STOP}) - 8 DAYS)
group by cu.customernumber) AS sev_tra
JOIN
(select cu.customernumber AS MERCHANT_ID,SUM(TRXAMOUNT) AS TRADE_AMOUNT
from dailytrxstat d
left join customerinfo cu on d.RECEIVERID=cu.id
where 1=1
and d.PRODUCT_CODE not in 
('3011002001001','3011101001001','3011002002001','3011101002001','3011004003001','3011004003002','3011001004004','3011005002001','3011001004001','3011005001001','3011005001003','3011001004002','3011001004003')
and d.TRXDATE = (date(${STOP}) - 1 DAYS)
group by cu.customernumber) AS yes_tra
on sev_tra.MERCHANT_ID = yes_tra.MERCHANT_ID
with ur
",reportdb_read
riskPortraitData,rp_e6,"select trac.MEC_NO AS MERCHANT_ID,count(distinct trac.CRD_NO) AS CARD_NUM
from TL.tbl_remit_asynreq_current trac
where trac.PROD in ('DFDF','RJT')
and trac.TRADE_RESULT='1' 
and trac.REMIT_TM >= (current TIMESTAMP - 30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trac.REMIT_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trac.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
group by trac.MEC_NO
with ur",fkjs
riskPortraitData,rp_e7,"select trad.MERCHANT_ID,count(distinct trad. CRD_NO) AS CARD_REPEAT_NUM from 
(select trr.MEC_NO AS MERCHANT_ID,trr.CRD_NO
from TL.tbl_rrs_req trr 
where trr.OCC_TM >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.OCC_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.PAY_RESULT='1'
and trr.prod not in('ACCOUNT','G3MEMBER_TRANSFER' ,'G3MEMBER_WITHDRAW','G3MEMBER_PAYMENT','SETTLEMENT')
and trr.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
union
select tor.MEC_NO AS MERCHANT_ID,CRD_NO
from TL.tbl_offline_req tor 
where tor.ORDER_TM >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and tor.ORDER_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and tor.PAY_RESULT='1'
and tor.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
)
as trad 
where  MERCHANT_ID||'_'|| CRD_NO in 
(select trac.MEC_NO ||'_'||trac.CRD_NO from TL.tbl_remit_asynreq_current trac
where trac.PROD in ('DFDF','RJT')
and trac.TRADE_RESULT='1' 
and trac.REMIT_TM  >= (current TIMESTAMP - 30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trac.REMIT_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trac.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
and trac.MEC_NO != ''
)
group by trad. MERCHANT_ID
with ur",fkjs
riskPortraitData,rp_e8,"select tod.MER_NO AS MERCHANT_ID,count(tod.ID) AS COMPLAINT_NUM
from TL.TBL_ORDERCOMPLAIN_DATA tod 
where tod.MER_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
and TIMESTAMP(tod.ACC_TM) >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and TIMESTAMP(tod.ACC_TM) < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
group by tod.MER_NO
with ur",fkjs
riskPortraitData,rp_e9,"select MERCHANT_ID,sum(TRADE_NUM) AS TRADE_LOST_DAY_NUM from 
(
select trr.MEC_NO AS MERCHANT_ID,SUM(trr.AMT) AS TRADE_AMOUNT,count(trr.ID) AS TRADE_NUM
from TL.tbl_rrs_req trr 
where trr.prod not in('ACCOUNT','G3MEMBER_TRANSFER' ,'G3MEMBER_WITHDRAW','G3MEMBER_PAYMENT','SETTLEMENT')
and trr.OCC_TM >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.OCC_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.PAY_RESULT!='1'
and trr.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
group by trr.MEC_NO
union all
select tor.MEC_NO AS MERCHANT_ID,SUM(tor.AMT) AS TRADE_AMOUNT,count(tor.ID) AS TRADE_NUM
from TL.tbl_offline_req tor
where tor.ORDER_TM >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and tor.ORDER_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and tor.PAY_RESULT!='1'
and tor.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
group by tor.MEC_NO
) as TRADE_RESULT
group by MERCHANT_ID
with ur",fkjs
riskPortraitData,rp_e10,"select MERCHANT_ID,sum(TRADE_NUM) AS TRADE_ALL_NUM from 
(
select trr.MEC_NO AS MERCHANT_ID,SUM(trr.AMT) AS TRADE_AMOUNT,count(trr.ID) AS TRADE_NUM
from TL.tbl_rrs_req trr 
where trr.prod not in('ACCOUNT','G3MEMBER_TRANSFER' ,'G3MEMBER_WITHDRAW','G3MEMBER_PAYMENT','SETTLEMENT')
and trr.OCC_TM >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.OCC_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
group by trr.MEC_NO
union all
select tor.MEC_NO AS MERCHANT_ID,SUM(tor.AMT) AS TRADE_AMOUNT,count(tor.ID) AS TRADE_NUM
from TL.tbl_offline_req tor 
where tor.ORDER_TM >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and tor.ORDER_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and tor.MEC_NO  in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
group by tor.MEC_NO
) as TRADE_RESULT
group by MERCHANT_ID
with ur
",fkjs
riskPortraitData,rp_e11,"select trr.MEC_NO AS MERCHANT_ID,SUM(trr.AMT) AS TRADE_NOTECARD_AMOUNT
from TL.tbl_rrs_req trr 
where trr.OCC_TM >= (current TIMESTAMP -30 DAYS - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.OCC_TM < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and trr.PAY_RESULT='1' and trr.PROD = 'NOCARDPAY'
and trr.MEC_NO in (select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
group by trr.MEC_NO
with ur",fkjs
riskPortraitData,rp_e12,"select rotaw.MERCHANT_ID,sum(rotaw.FRAUD_AMOUNT) AS CHEAT_AMOUNT 
from TL.REPORT_OL_TRANS_AND_WARNING rotaw
where rotaw.MERCHANT_ID in 
(select MER_NO from TL.TBL_MERJUDGE_RESULTDATA where MER_NO||'_'||TRADE_TM in (select MER_NO||'_'||Max(TRADE_TM) from TL.TBL_MERJUDGE_RESULTDATA  group by MER_NO) and COUNTSERV_JUDGE = 'å½©ç¥¨')
and rotaw.CREATE_TIME >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and rotaw.CREATE_TIME < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
group by rotaw.MERCHANT_ID
with ur",fkjs
tesmysql,test_re,select MER_NO AS MERCHANT_ID from TL.TBL_MERJUDGE_RESULTDATA where COUNTSERV_JUDGE = 'å½©ç¥¨' and mer_no != 10013370456 fetch first 2 rows only,fkjs
ehremployeeinfo,ehr_birthday,"select username as YOUXIANGQIANZHUI,DATE_FORMAT(birthday,'%Y-%m-%d')  as birthday,gender  from tbl_user_info",hbird
riskPortraitData,rp_e2,"select cu.customernumber AS MERCHANT_ID,SUM(d.trxfee-d.refundfee-d.accountingcost) AS GROSS_PROFIT
from db2inst1.DAILYTRXSTAT d join customerinfo cu on d.receiverid=cu.id
where d.TRXDATE >= (current TIMESTAMP -30 DAYS  - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
and d.TRXDATE < (current TIMESTAMP - hour(current timestamp) hours - minute(current timestamp) minutes - second(current timestamp) seconds)
group by cu.customernumber
with ur

",reportdb
riskPortraitResult,rpr_temp,"select MERCHANT_ID,CATEGORY,MERCHANT_NAME,ACHIVE_TYPE,IN_TIME,CATEGORY_1,CATEGORY_2,MERCHANT_DURATION,GROSS_PROFIT,
NOW() AS CREATE_TIME,'0' AS STATUS,NOW() AS END_TIME,START_TIME,
TRADE_AMOUNT,BUSINESS_DATE,INSERT_MARK, TRADE_DAILY_RATE,
(case
when TRXFEE is null OR TRXFEE = '' then 0
when REMIT_NUM is null OR REMIT_NUM = '' then null
else TRXFEE/REMIT_NUM
end) AS CARD_AVG_AMOUNT,CARD_NUM,
(case 
when CARD_REPEAT_NUM is null OR CARD_REPEAT_NUM = '' then 0
when CARD_NUM is null OR CARD_NUM = '' then null
else CARD_REPEAT_NUM/CARD_NUM
end)AS CARD_REPEAT_RATE,
(case 
when TRXFEE is null OR TRXFEE = '' then 0
when TRADE_AMOUNT is null OR TRADE_AMOUNT = '' then null
else TRXFEE/TRADE_AMOUNT
end) AS PAY_RATE,CHEAT_AMOUNT,
(case 
when CHEAT_AMOUNT is null OR CHEAT_AMOUNT = '' then 0
when TRADE_NOTECARD_AMOUNT is null OR TRADE_NOTECARD_AMOUNT = '' then null
else CHEAT_AMOUNT/TRADE_NOTECARD_AMOUNT
end)AS CHEAT_RATE,
(case 
when COMPLAINT_NUM is null OR COMPLAINT_NUM = '' then 0
when TRADE_NUM is null OR TRADE_NUM = '' then null
else COMPLAINT_NUM/TRADE_NUM
end)AS COMPLAINT_RATE,
(case 
when TRADE_LOST_DAY_NUM is null OR TRADE_LOST_DAY_NUM = '' then 0
when TRADE_ALL_NUM is null OR TRADE_ALL_NUM = '' then null
else TRADE_LOST_DAY_NUM/TRADE_ALL_NUM
end)
 AS TRADE_FAILED_RATE,
(case 
when GROSS_PROFIT is null OR GROSS_PROFIT = '' then 0
when TRADE_AMOUNT is null OR TRADE_AMOUNT = '' then null
else GROSS_PROFIT/TRADE_AMOUNT
end)
 AS RATE
from rp_data_temp 
where MERCHANT_NAME != ''
and START_TIME > CAST(CAST(SYSDATE()AS DATE)AS DATETIME)",risk_portrait
TrxReportDailyInsuranceBase,TrxReportDailyInsuranceBaseE,"SELECT
D.TRXDATE  || RECEIVER.SIGNEDNAME || TR.DISPLAYNAME || COALESCE(P.PRODUCTNAME,'ç©') || COALESCE(P1.PRODUCTNAME,'ç©') || COALESCE(TRXSTATTRXTYPE.NAME,'ç©') AS IDNOUSE,
            D.TRXDATE AS DATA_PERIOD,
'ä¿__è¡__çº' AS PRODUCTLINE,
CASE WHEN TOOL.FULL_NAME IS NULL THEN RECEIVER.SIGNEDNAME ELSE TOOL.FULL_NAME END AS SIGNEDNAME,
           SUM(D.TRXAMOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            D.REFUNDAMOUNT*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)) AS
            TRX_AMOUNT,
            SUM(
                CASE
                    WHEN D.BIZTYPEID IN (29,129)
                    THEN (D.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
                        D.REFUNDFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
                        D.ACCOUNTINGCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT
                        ,1)+D.REFUNDFRPCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE
                        (c2a.PERCENT,1))
                    ELSE (D.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
                        D.REFUNDFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1))
                END) AS INCOME,
                       SUM(D.TRXFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            D.REFUNDFEE*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)-
            D.ACCOUNTINGCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)+
            D.REFUNDFRPCOST*COALESCE(E2C.SHARESCALE,1)*COALESCE(c2a.PERCENT,1)) AS
            PROFIT,
            TR.DISPLAYNAME AS yewuleixing,
            P.PRODUCTNAME  AS jichuchanpin ,
            P1.PRODUCTNAME AS lingshouchanpin,
            TRXSTATTRXTYPE.NAME        AS TRADE_TYPE,
            CURRENT TIMESTAMP AS CREATE_TIME
        FROM
            DAILYTRXSTAT AS D
        LEFT JOIN
            TRXSTATBIZTYPE TR
        ON
            1=1
        AND D.BIZTYPEID=TR.ID
        LEFT JOIN
            CUSTOMERINFO AS RECEIVER
        ON
            1=1
        AND D.RECEIVERID=RECEIVER.ID
        LEFT JOIN
            CUSTOMERRELATIONSHIP AS E2C
        ON
            1=1
        AND RECEIVER.ID=E2C.CUSTOMERID
        LEFT JOIN
            TRXSTATTRXTYPE
        ON
            1=1
        AND D.TYPE=TRXSTATTRXTYPE.ID
        LEFT JOIN
            PRODUCTCODE AS P
        ON
            1=1
        AND D.PRODUCT_CODE=P.PRODUCTCODE
        AND P.PRODUCTTYPE=2
        LEFT JOIN
            PRODUCTCODE AS P1
        ON
            1=1
        AND D.SALES_PRODUCT_CODE=P1.PRODUCTCODE
        AND P1.PRODUCTTYPE=1
        LEFT JOIN
            customer2achievement AS c2a
        ON
            1=1
        AND RECEIVER.customernumber=c2a.customer_number
        LEFT JOIN YJKH.TBL_DAILY_PRODUCTLINE_TOOL TOOL
        ON RECEIVER.SIGNEDNAME like CONCAT('%',CONCAT(TOOL.SHORT_NAME,'%'))      
        WHERE RECEIVER.PRODUCTLINE='ä¿__è¡__çº'
        AND D.TRXDATE=${START}
GROUP BY D.TRXDATE,RECEIVER.SIGNEDNAME,TR.DISPLAYNAME,P.PRODUCTNAME,P1.PRODUCTNAME,TRXSTATTRXTYPE.NAME,tool.FULL_NAME",reportdb_read
agentfrdailydata,agentfrdailydatae,"SELECT  D.ID AS DAILYTRXSTAT_ID,
D.RECEIVERID AS CUSTOMER_ID,
CU.CUSTOMERNUMBER AS CUSTOMER_NUM,
D.TRXAMOUNT AS TRX_TOTAL_AMOUNT,
D.TRXCOUNT AS TRX_TOTAL_NUM,
D.REFUNDAMOUNT AS REFUND_TOTAL_AMOUNT,
D.REFUNDCOUNT AS REFUND_TOTAL_NUM,
D.TRXDATE AS TRX_DATE,
D.TRXCHANNELID AS PAY_INTERFACE_ID,
D.TRXFEE AS INCOME_TOTAL_AMOUNT,
D.FRPCOST AS COST_TOTAL_AMOUNT,
B.NAME AS BANK_CODE,
D.SALES_PRODUCT_CODE AS SALE_PRODUCT_CODE,
SP.PRODUCTNAME  AS SALE_PRODUCT_NAME,
'transferinday' AS BIZ_TYPE,
'COMMON' AS ORDER_SOURCE,
current_timestamp AS CREATE_TIME
FROM DB2INST1.DAILYTRXSTAT D LEFT JOIN DB2INST1.PRODUCTCODE SP ON D.SALES_PRODUCT_CODE=SP.PRODUCTCODE  LEFT JOIN DB2INST1.TRXSTATBIZTYPE B ON D.BIZTYPEID = B.ID  LEFT JOIN CUSTOMERINFO CU ON D.RECEIVERID=CU.ID
WHERE D.TYPE NOT IN ('COMMISSION', 'COMMISSION_HK', 'POSSHARECOST', 'COMMISSION_RJT', 'COMMISSION_RJTFUND') AND D.TRXDATE >= TIMESTAMP(${START}) and D.TRXDATE  < TRUNC(TIMESTAMP(${START}) + 1 days,'dd') AND CHAR(D.RECEIVERID) IN (SELECT CUSTOMER_ID FROM YBZFDM.TBL_AGENT_CUSTOMER) AND D.PRODUCT_CODE = '3011101001001' WITH UR",reportdb_read
agentfrDailyCalculate,agentfrDailyCalculatee,"SELECT C.CUSTOMER_NUM,
C.AGENT_ID AS AGENT_ID,
'transferinday' AS BIZ_TYPE,
D.SALE_PRODUCT_NAME,
VALUE(D.TRX_TOTAL_AMOUNT,0.00) AS TRX_TOTAL_AMOUNT,
VALUE(D.TRX_TOTAL_NUM,0) AS TRX_TOTAL_NUM,
VALUE(D.TRX_INCOME_TOTAL_AMOUNT,0.00) AS TRX_INCOME_TOTAL_AMOUNT,
VALUE(D.COST_TOTAL_AMOUNT,0.00) AS COST_TOTAL_AMOUNT,
VALUE(ROUND((TRX_INCOME_TOTAL_AMOUNT-(TRX_TOTAL_NUM*RU.COST_RATIO*100))*RU.PROFIT_RATIO,2) ,0.00) AS PROFIT_AMOUNT,
D.TRX_DATE AS TRX_DATE,
D.TRX_DATE AS TRX_START_DATE,
D.TRX_DATE AS TRX_END_DATE,
current_timestamp AS CREATE_TIME,
'NORMAL' AS PROFIT_TYPE,
'ACTIVE' AS STATUS,
C.CUSTOMER_NAME AS CUSTOMER_NAME
FROM AGENTFR.TBL_PROFIT_RULE RU,AGENTFR.TBL_AGENCY_RELATION AS C,
(select 
B.CUSTOMER_NUM AS CUSTOMER_NUM,
SALE_PRODUCT_NAME AS SALE_PRODUCT_NAME,
sum(TRX_TOTAL_AMOUNT) AS TRX_TOTAL_AMOUNT,
sum(TRX_TOTAL_NUM) AS TRX_TOTAL_NUM, 
sum(INCOME_TOTAL_AMOUNT) AS TRX_INCOME_TOTAL_AMOUNT, 
sum(COST_TOTAL_AMOUNT) AS COST_TOTAL_AMOUNT,
B.CUSTOMER_ID AS CUSTOMER_ID,
B.TRX_DATE AS TRX_DATE
from  (SELECT * FROM AGENTFR.TBL_AGENCY_RELATION WHERE STATE='ENABLE' AND AGENT_ID IN (2649,2728,2656,2687,2852,2681,2665,2733,2863,2908,2683,2890)) AS A LEFT JOIN AGENTFR.TBL_AGENTFR_PROFIT_TRX_ORDER_NEW AS B  on A.CUSTOMER_ID=B.CUSTOMER_ID
where  TRX_DATE >= TIMESTAMP(${START}) AND TRX_DATE < TRUNC(TIMESTAMP(${START}) + 1 days,'dd') AND B.BIZ_TYPE = 'transferinday' 
group by B.CUSTOMER_NUM,B.CUSTOMER_ID,B.SALE_PRODUCT_NAME,B.TRX_DATE) AS D 
WHERE  C.CUSTOMER_ID=D.CUSTOMER_ID AND RU.AGENT_ID=C.AGENT_ID AND C.STATE='ENABLE' AND C.AGENT_ID IN (2649,2728,2656,2687,2852,2681,2665,2733,2863,2908,2683,2890) AND RU.STATE='ENABLE'",agentfr_standby
agentfrDailyCalculateRecord,agentfrDailyCalculateRecorde,"select AG.ID AS AGENT_ID,'transferinday' AS BIZ_TYPE,
YEAR(TRUNC(DATE(${START})-1 MONTHS,'MM')) AS PROFIT_YEAR,
MONTH(TRUNC(DATE(${START})-1 MONTHS,'MM')) AS PROFIT_MONTH,
VALUE(ATEMP.PROFIT_TOTAL_AMOUNT,0.00) AS PROFIT_TOTAL_AMOUNT,
VALUE(ATEMP.TRX_TOTAL_AMOUNT,0.00) AS TRX_TOTAL_AMOUNT,
VALUE(ATEMP.TRX_TOTAL_NUM,0) AS TRX_TOTAL_NUM,
VALUE(ATEMP.TRX_INCOME_TOTAL_AMOUNT,0.00) AS TRX_INCOME_TOTAL_AMOUNT,
CASE WHEN AG.INVOICE_TYPE='PERSONAL_WITHHOLDING_TAXES' THEN 
(CASE WHEN ATEMP.PROFIT_TOTAL_AMOUNT-ROUND((CASE WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 625000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.4 - 7000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 25000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.3 - 2000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 4000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.2 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 800 THEN (ATEMP.PROFIT_TOTAL_AMOUNT - 800) * 0.2 ELSE 0.00 END),2)>0 
THEN ATEMP.PROFIT_TOTAL_AMOUNT-ROUND((CASE WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 625000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.4 - 7000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 25000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.3 - 2000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 4000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.2 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 800 THEN (ATEMP.PROFIT_TOTAL_AMOUNT - 800) * 0.2 ELSE 0.00 END),2) 
ELSE 0.00 END)
ELSE VALUE(ATEMP.PROFIT_TOTAL_AMOUNT,0.00) END AS REAL_PROFIT_AMOUNT,
CASE WHEN AG.INVOICE_TYPE='PERSONAL_WITHHOLDING_TAXES' THEN ROUND((CASE WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 625000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.4 - 7000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 25000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.3 - 2000 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 4000 THEN ATEMP.PROFIT_TOTAL_AMOUNT * (1 - 0.2) * 0.2 WHEN ATEMP.PROFIT_TOTAL_AMOUNT > 800 THEN (ATEMP.PROFIT_TOTAL_AMOUNT - 800) * 0.2 ELSE 0.00 END),2) ELSE 0.00 END AS TAX_WITHHOLDING,
AG.PROFIT_DIRECTION AS REMIT_DIRECTION,'CALCULATED' AS PROFIT_CONFIRM_STATE,
'TOREMIT' AS REMIT_STATE,current_timestamp AS PROFIT_TIME,AG.INVOICE_TYPE AS INVOICE_TYPE, 'INNER' AS DATATYPE,
'0.00' AS ADJUST_AMOUNT,'0' AS INVOICE,'1' AS VERSION,'0' AS BILL_CONFIRM
from AGENTFR.TBL_AGENT AS AG,
(SELECT A.*,(SELECT sum(PROFIT_AMOUNT) from AGENTFR.TBL_PROFIT_DETAIL where A.ID=AGENT_ID AND STATUS='ACTIVE' AND PROFIT_RECORD_ID IS NULL) AS PROFIT_TOTAL_AMOUNT,
(SELECT sum(TRX_TOTAL_AMOUNT) from AGENTFR.TBL_PROFIT_DETAIL where A.ID=AGENT_ID AND profit_record_id IS NULL) AS TRX_TOTAL_AMOUNT,
(SELECT sum(TRX_TOTAL_NUM) from AGENTFR.TBL_PROFIT_DETAIL where A.ID=AGENT_ID AND profit_record_id IS NULL) AS TRX_TOTAL_NUM,
(SELECT sum(TRX_INCOME_TOTAL_AMOUNT) from AGENTFR.TBL_PROFIT_DETAIL where A.ID=AGENT_ID AND profit_record_id IS NULL) AS TRX_INCOME_TOTAL_AMOUNT
FROM AGENTFR.TBL_AGENT AS A WHERE AGENCY_STATE = 'OPEN' AND PROFIT_DIRECTION = 'BANKCARD' AND ID IN (2649,2728,2656,2687,2852,2681,2665,2733,2863,2908,2683,2890)) AS ATEMP
WHERE AG.ID=ATEMP.ID AND AG.AGENCY_STATE = 'OPEN' AND AG.PROFIT_DIRECTION = 'BANKCARD' AND AG.ID IN (2649,2728,2656,2687,2852,2681,2665,2733,2863,2908,2683,2890)",agentfr_standby
riskcustomerinfo,riskcustomertag,"select NUMBER as CUSTOMERNUMBER,TAG as PRODUCTLINE from CUSCENTER.TBL_TAG",dzh_standby